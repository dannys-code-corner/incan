"""
Incan Testing Framework

A pytest-like testing library for Incan.

Example:

    from testing import fixture, parametrize, skip, xfail

    @fixture
    def database() -> Database:
        db = Database.connect("test.db")
        yield db
        db.close()

    @parametrize("a, b, expected", [
        (1, 2, 3),
        (0, 0, 0),
    ])
    def test_add(a: int, b: int, expected: int) -> None:
        assert_eq(add(a, b), expected)

    @skip("not implemented")
    def test_future() -> None:
        pass
"""


# =============================================================================
# Markers
# =============================================================================

def skip(reason: str = "") -> None:
    """
    Skip a test unconditionally.

    Example:
        @skip("not implemented yet")
        def test_future_feature() -> None:
            pass
    """
    ...


def xfail(reason: str = "") -> None:
    """
    Mark a test as expected to fail.

    The test runs but failure is not reported as an error.
    If the test passes unexpectedly, it's reported as XPASS.

    Example:
        @xfail("known bug #123")
        def test_known_issue() -> None:
            assert broken_function() == "fixed"
    """
    ...


def slow() -> None:
    """
    Mark a test as slow.

    Slow tests are excluded by default. Run with --slow to include.

    Example:
        @slow
        def test_integration() -> None:
            # Long-running test
            pass
    """
    ...


# =============================================================================
# Fixtures
# =============================================================================

def fixture() -> None:
    """
    Mark a function as a test fixture.

    Fixtures provide setup/teardown and dependency injection for tests.
    Use `yield` to separate setup from teardown.

    Example:
        @fixture
        def temp_file() -> str:
            path = create_temp_file()
            yield path
            delete_file(path)

        def test_write(temp_file: str) -> None:
            write_to_file(temp_file, "data")
            assert read_file(temp_file) == "data"

    Fixtures are injected by parameter name matching.
    """
    ...


# =============================================================================
# Parametrize
# =============================================================================

def parametrize(argnames: str, argvalues: List[Tuple]) -> None:
    """
    Run a test with multiple parameter sets.

    Example:
        @parametrize("x, y, expected", [
            (1, 2, 3),
            (0, 0, 0),
            (-1, 1, 0),
            (100, 200, 300),
        ])
        def test_add(x: int, y: int, expected: int) -> None:
            assert add(x, y) == expected

    This generates:
        test_add[1-2-3] ... PASSED
        test_add[0-0-0] ... PASSED
        test_add[-1-1-0] ... PASSED
        test_add[100-200-300] ... PASSED
    """
    ...


# =============================================================================
# Assertion Helpers (optional, prefer plain assert)
# =============================================================================

def assert(condition: bool) -> None:
    """Assert condition is true."""
    ...


def assert_eq[T](left: T, right: T) -> None:
    """
    Assert two values are equal.

    Example:
        assert_eq(result, expected)
    """
    ...


def assert_ne[T](left: T, right: T) -> None:
    """Assert two values are not equal."""
    ...


def assert_true(condition: bool) -> None:
    """Assert condition is true."""
    ...


def assert_false(condition: bool) -> None:
    """Assert condition is false."""
    ...


def assert_is_some[T](option: Option[T], msg: str = "") -> T:
    """
    Assert Option is Some and return the value.

    Example:
        value = assert_is_some(get_user(id))
        assert value.name == "Alice"
    """
    ...


def assert_is_none[T](option: Option[T], msg: str = "") -> None:
    """Assert Option is None."""
    ...


def assert_is_ok[T, E](result: Result[T, E], msg: str = "") -> T:
    """
    Assert Result is Ok and return the value.

    Example:
        user = assert_is_ok(fetch_user(id))
        assert user.active
    """
    ...


def assert_is_err[T, E](result: Result[T, E], msg: str = "") -> E:
    """Assert Result is Err and return the error."""
    ...


def assert_raises[E](block: () -> None, msg: str = "") -> E:
    """
    Assert that a block raises/panics with error type E.

    Example:
        err = assert_raises[ValueError](lambda: int("not a number"))
    """
    ...


# =============================================================================
# Test Utilities
# =============================================================================

def fail(msg: str) -> None:
    """Explicitly fail a test with a message."""
    ...
