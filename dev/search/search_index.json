{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Incan Documentation","text":"<p>New here? Start with: Start here.</p>"},{"location":"#tooling-setup","title":"Tooling &amp; Setup","text":"<p>How to install, configure, and use Incan Tooling.</p> Document Description Getting Started Installation and first steps Editor Setup IDE configuration and syntax highlighting Language Server LSP for diagnostics, hover, and go-to-definition Formatting Code formatter (<code>incan fmt</code>) Testing Test runner (<code>incan test</code>)"},{"location":"#language-guide","title":"Language Guide","text":"<p>How to write Incan code: Language.</p> Document Description the Book The Incan Book (Walks you through the Basics from a-z) Error Messages Understanding and fixing compiler errors Error Handling Result, Option, and the <code>?</code> operator File I/O Reading, writing files and path handling Async Programming Async/await with Tokio Derives &amp; Traits Derive macros and trait system Scopes &amp; Name Resolution Block scoping, shadowing, and how names are resolved Imports &amp; Modules Module system, imports, and built-in functions Rust Interop Using Rust crates directly from Incan Web Framework Building web apps with Axum"},{"location":"#derives-reference","title":"Derives Reference","text":"Document Description String Representation Debug and Display Comparison Eq, Ord, Hash Copying &amp; Default Clone, Copy, Default Serialization Serialize, Deserialize Custom Behavior Overriding derived behavior"},{"location":"#rfcs-request-for-comments","title":"RFCs (Request for Comments)","text":"<p>Design proposals for upcoming features are recorded in the form of RFCs.</p> RFC Status Track Title RFC 000 Done done Incan Core Language RFC (Phase 1) RFC 001 In Progress proposed / active Test Fixtures RFC 002 Draft proposed / active Parametrized Tests RFC 003 Blocked proposed / active Frontend &amp; WebAssembly Support RFC 004 Draft proposed / active Async Fixtures RFC 005 Draft proposed / active Rust Interop RFC 006 Planned proposed / active Python-Style Generators RFC 007 Planned proposed / active Inline Tests RFC 008 Done done Const Bindings RFC 009 Planned proposed / active Sized Integer Types &amp; Builtin Type Registry RFC 010 Draft proposed / active Temporary Files and Directories RFC 011 Planned proposed / active Precise Error Spans in F-Strings RFC 012 Draft proposed / active JsonValue Type for Dynamic JSON RFC 013 Draft proposed / active Rust Crate Dependencies RFC 014 Draft proposed / active Error Handling in Generated Rust Code RFC 015 Planned proposed / active Hatch-like Tooling (Project Lifecycle CLI) RFC 016 Planned proposed / active <code>loop</code> and <code>break &lt;value&gt;</code> (Loop Expressions) RFC 017 Planned proposed / active Validated newtypes with implicit coercion (pydantic-like feel)"},{"location":"#compiler-contributing","title":"Compiler &amp; Contributing","text":"<p>For contributors</p> <p>Architecture and compiler-internals docs are primarily for contributors. If you\u2019re learning the language, start with the Book and the Language Guide instead of RFCs.</p> <p>Docs for contributors working on the compiler and language evolution:</p> Document Description Roadmap Tracks implementation status and near-term planning RFCs Design proposals for upcoming features are recorded in the form of RFCs Contributing Contributor documentation landing page Compiler Architecture Compilation pipeline, module layout, and internal stages Extending the Language When to add builtins vs new syntax; end-to-end checklists Contributing Index Contributor documentation landing page"},{"location":"roadmap/","title":"Incan Roadmap (Status-Focused)","text":"<p>This page tracks the implementation status and near-term planning (without being prescriptive about timelines).</p> <p>Incan development is driven by RFCs (Request for Comments).</p> <ul> <li>An RFC captures a design proposal for a feature, including syntax, semantics, and implementation details.</li> <li>RFCs are not necessarily implemented in the order they are written.</li> </ul> <p>See the RFCs page for more information about RFCs.</p>"},{"location":"roadmap/#rfc-status-table","title":"RFC status table","text":"<p>This table is autogenerated from the RFC files (it reads each RFC\u2019s <code>**Status:** ...</code> line).</p> RFC Status Track Title RFC 000 Done done Incan Core Language RFC (Phase 1) RFC 001 In Progress proposed / active Test Fixtures RFC 002 Draft proposed / active Parametrized Tests RFC 003 Blocked proposed / active Frontend &amp; WebAssembly Support RFC 004 Draft proposed / active Async Fixtures RFC 005 Draft proposed / active Rust Interop RFC 006 Planned proposed / active Python-Style Generators RFC 007 Planned proposed / active Inline Tests RFC 008 Done done Const Bindings RFC 009 Planned proposed / active Sized Integer Types &amp; Builtin Type Registry RFC 010 Draft proposed / active Temporary Files and Directories RFC 011 Planned proposed / active Precise Error Spans in F-Strings RFC 012 Draft proposed / active JsonValue Type for Dynamic JSON RFC 013 Draft proposed / active Rust Crate Dependencies RFC 014 Draft proposed / active Error Handling in Generated Rust Code RFC 015 Planned proposed / active Hatch-like Tooling (Project Lifecycle CLI) RFC 016 Planned proposed / active <code>loop</code> and <code>break &lt;value&gt;</code> (Loop Expressions) RFC 017 Planned proposed / active Validated newtypes with implicit coercion (pydantic-like feel)"},{"location":"roadmap/#core-phases-overview","title":"Core Phases (overview)","text":"<ul> <li>Core language + runtime</li> <li>Stdlib + tooling (fmt, test, LSP, VS Code extensions)</li> <li>Web backend (Axum)</li> <li>Frontend/WASM (UI, JSX, 3D)</li> <li>Rust interop</li> </ul>"},{"location":"roadmap/#current-focus","title":"Current Focus","text":"<ul> <li>Language stability/feature freeze (core semantics + test surface):<ul> <li>RFC 000 (core semantics) Done</li> <li>RFC 008 (const bindings) Done</li> <li>Tests surface:<ul> <li>RFC 001 (test fixtures) In Progress</li> <li>RFC 002 (parametrized tests) Draft</li> <li>RFC 004 (async fixtures) Draft</li> </ul> </li> </ul> </li> <li>Frontend/WASM (RFC 003): JSX wrapper, signals/runtime, wasm codegen, dev/prod tooling</li> </ul>"},{"location":"roadmap/#ecosystem-keystones-planned","title":"Ecosystem keystones (planned)","text":"<p>These are the cross-cutting capabilities that make Incan feel \u201ccapable\u201d for real engineering work. This list is intentionally kept high-level and status-oriented (RFCs will be added over time).</p> <ul> <li>Standard library contracts for real programs (HTTP, filesystem/paths, process, env, time, logging, config)</li> <li>Capability-based access model for IO/process/env/network (secure-by-default for tools)</li> <li>Interactive execution engine: <code>incan run -i</code> (expression-first) \u2192 eventual Jupyter/kernel interop \u2192 richer workspace UX</li> <li>Packaging/distribution story for tools and projects (reproducible builds, artifact creation)</li> </ul>"},{"location":"roadmap/#status-by-area-high-level","title":"Status by Area (high-level)","text":"<ul> <li>Core language: see RFC 000 / RFC 008</li> <li>Tooling (build/run/fmt/test): see the CLI docs and RFCs 001/002/004/007 for the planned testing surface</li> <li>Rust interop: see RFC 005 / RFC 013 and the Rust Interop guide</li> <li>Web: see Web Framework guide (stabilization ongoing)</li> </ul>"},{"location":"roadmap/#upcoming-next","title":"Upcoming (next)","text":"<ul> <li>WASM/JSX parser &amp; codegen</li> <li>UI runtime (signals/effects/components) + examples</li> <li>Test runner fixture execution (setup/teardown lifecycle)</li> <li>Dev server + prod build pipeline for WASM target</li> <li>Python-style generators (RFC 006) \u2014 <code>yield</code> + <code>Iterator[T]</code> \u2192 Rust <code>gen</code> blocks</li> <li>Inline tests (RFC 007) \u2014 <code>@test</code> in source files, Rust-style proximity</li> </ul>"},{"location":"roadmap/#deferred-later","title":"Deferred / Later","text":"<p>The following items are intentionally deferred to later, and might be revisited in the future:</p> <ul> <li>SSR/SSG for frontend: Server-Side Rendering / Static Site Generation for the WASM/UI stack (render pages ahead of time     or on the server, then hydrate).</li> <li>Desktop/mobile via wgpu: using the wgpu graphics stack to run Incan apps as native desktop/mobile apps (instead of     browser-only).</li> <li>CRDT/collab features: real-time collaboration primitives (Conflict-free Replicated Data Types) for things like     collaborative editing, shared state, etc.</li> </ul>"},{"location":"roadmap/#guides","title":"Guides","text":"<ul> <li>Web framework guide: Web framework</li> <li>Rust interop guide: Rust interop</li> <li>Testing guide: Testing</li> </ul>"},{"location":"roadmap/#interested-in-contributing","title":"Interested in contributing?","text":"<p>See the Contributing page for more information about contributing to Incan.</p>"},{"location":"stability/","title":"Stability policy","text":"<p>Incan is currently in beta. The goal is to be honest about what is stable, what is evolving, and how releases work.</p>"},{"location":"stability/#versioning","title":"Versioning","text":"<p>We follow a SemVer-style model:</p> <ul> <li>Minor versions (<code>0.X</code>) may introduce new language/tooling features.</li> <li>Patch versions (<code>0.X.Y</code>) must not introduce new language features; patch releases are for bug fixes and polish.</li> </ul>"},{"location":"stability/#docs-since-semantics","title":"Docs \u201cSince\u201d semantics","text":"<p>Where the docs show a \u201cSince\u201d field, it tracks the minor version line (for example: <code>0.1</code>, <code>0.2</code>), not patch releases.</p>"},{"location":"stability/#practical-expectations-beta","title":"Practical expectations (beta)","text":"<ul> <li>Expect some surfaces to evolve as the language and toolchain stabilizes.</li> <li>If you are evaluating Incan, use the Start here paths and the CLI reference as the primary sources of truth.</li> </ul>"},{"location":"RFCs/","title":"RFCs (Design records)","text":"<p>RFCs are design/evolution records (PEP-style). They are primarily for contributors and advanced readers.</p> <ul> <li>RFCs are not canonical user docs.</li> <li>User docs may link to RFCs for background and rationale.</li> </ul> <p>For status, see: Roadmap.</p>"},{"location":"RFCs/#index","title":"Index","text":"RFC Status Track Title RFC 000 Done done Incan Core Language RFC (Phase 1) RFC 001 In Progress proposed / active Test Fixtures RFC 002 Draft proposed / active Parametrized Tests RFC 003 Blocked proposed / active Frontend &amp; WebAssembly Support RFC 004 Draft proposed / active Async Fixtures RFC 005 Draft proposed / active Rust Interop RFC 006 Planned proposed / active Python-Style Generators RFC 007 Planned proposed / active Inline Tests RFC 008 Done done Const Bindings RFC 009 Planned proposed / active Sized Integer Types &amp; Builtin Type Registry RFC 010 Draft proposed / active Temporary Files and Directories RFC 011 Planned proposed / active Precise Error Spans in F-Strings RFC 012 Draft proposed / active JsonValue Type for Dynamic JSON RFC 013 Draft proposed / active Rust Crate Dependencies RFC 014 Draft proposed / active Error Handling in Generated Rust Code RFC 015 Planned proposed / active Hatch-like Tooling (Project Lifecycle CLI) RFC 016 Planned proposed / active <code>loop</code> and <code>break &lt;value&gt;</code> (Loop Expressions) RFC 017 Planned proposed / active Validated newtypes with implicit coercion (pydantic-like feel)"},{"location":"RFCs/#see-also","title":"See also","text":"<ul> <li>RFC template: TEMPLATE</li> <li>How to write an RFC: Writing RFCs (how-to)</li> </ul>"},{"location":"RFCs/001_test_fixtures/","title":"RFC 001: Test Fixtures","text":"<p>Status: In Progress Created: 2024-12-07</p>"},{"location":"RFCs/001_test_fixtures/#summary","title":"Summary","text":"<p>Add pytest-style fixtures to Incan's test framework via the <code>@fixture</code> decorator.</p>"},{"location":"RFCs/001_test_fixtures/#motivation","title":"Motivation","text":"<p>Fixtures provide:</p> <ol> <li>Setup/teardown - Automatic resource management for tests</li> <li>Dependency injection - Tests declare what they need by parameter name</li> <li>Reusability - Share setup code across multiple tests</li> <li>Composability - Fixtures can depend on other fixtures</li> </ol>"},{"location":"RFCs/001_test_fixtures/#design","title":"Design","text":""},{"location":"RFCs/001_test_fixtures/#basic-syntax","title":"Basic Syntax","text":"<pre><code>from testing import fixture\n\n@fixture\ndef database() -&gt; Database:\n    \"\"\"Fixture that provides a test database.\"\"\"\n    db = Database.connect(\"test.db\")\n    yield db          # Test runs here\n    db.close()        # Teardown after test\n\ndef test_insert(database: Database) -&gt; None:\n    database.insert(\"key\", \"value\")\n    assert_eq(database.get(\"key\"), \"value\")\n</code></pre>"},{"location":"RFCs/001_test_fixtures/#fixture-scopes","title":"Fixture Scopes","text":"<pre><code>@fixture(scope=\"function\")  # Default: new instance per test\ndef temp_file() -&gt; str:\n    ...\n\n@fixture(scope=\"module\")    # Shared across all tests in file\ndef shared_client() -&gt; Client:\n    ...\n\n@fixture(scope=\"session\")   # Shared across entire test run\ndef global_config() -&gt; Config:\n    ...\n</code></pre>"},{"location":"RFCs/001_test_fixtures/#fixture-dependencies","title":"Fixture Dependencies","text":"<p>Fixtures can depend on other fixtures:</p> <pre><code>@fixture\ndef config() -&gt; Config:\n    return Config.load(\"test.toml\")\n\n@fixture\ndef database(config: Config) -&gt; Database:\n    # config fixture is automatically injected\n    return Database.connect(config.db_url)\n\ndef test_query(database: Database) -&gt; None:\n    # database fixture (and its config dependency) injected\n    result = database.query(\"SELECT 1\")\n    assert_eq(result, 1)\n</code></pre>"},{"location":"RFCs/001_test_fixtures/#autouse-fixtures","title":"Autouse Fixtures","text":"<pre><code>@fixture(autouse=true)\ndef setup_logging() -&gt; None:\n    \"\"\"Automatically applied to all tests in this file.\"\"\"\n    logging.set_level(\"DEBUG\")\n    yield\n    logging.set_level(\"INFO\")\n</code></pre>"},{"location":"RFCs/001_test_fixtures/#implementation","title":"Implementation","text":""},{"location":"RFCs/001_test_fixtures/#phase-1-parser-changes","title":"Phase 1: Parser Changes","text":"<p>Add <code>yield</code> expression support for generators/fixtures:</p> <pre><code>Expr::Yield(Option&lt;Box&lt;Spanned&lt;Expr&gt;&gt;&gt;)\n</code></pre> <p>Parse <code>@fixture</code> decorator with optional arguments:</p> <ul> <li><code>scope: str</code> - \"function\" | \"module\" | \"session\"</li> <li><code>autouse: bool</code> - Whether to auto-apply</li> </ul>"},{"location":"RFCs/001_test_fixtures/#phase-2-test-runner-changes","title":"Phase 2: Test Runner Changes","text":"<ol> <li>Discovery: Scan for <code>@fixture</code> decorated functions</li> <li>Dependency Graph: Build fixture dependency tree</li> <li>Injection: Match test parameters to fixtures by name</li> <li>Lifecycle: Create/teardown fixtures per scope</li> </ol>"},{"location":"RFCs/001_test_fixtures/#phase-3-codegen","title":"Phase 3: Codegen","text":"<p>Generate Rust code that:</p> <ol> <li>Creates fixture instances before test</li> <li>Passes fixtures as arguments</li> <li>Runs teardown after test (even on panic)</li> </ol> <p>Example generated Rust:</p> <pre><code>#[test]\nfn test_insert() {\n    // Setup\n    let database = {\n        let db = Database::connect(\"test.db\");\n        db\n    };\n\n    // Test body\n    let result = std::panic::catch_unwind(|| {\n        database.insert(\"key\", \"value\");\n        assert_eq!(database.get(\"key\"), \"value\");\n    });\n\n    // Teardown (always runs)\n    database.close();\n\n    // Re-raise panic if test failed\n    if let Err(e) = result {\n        std::panic::resume_unwind(e);\n    }\n}\n</code></pre>"},{"location":"RFCs/001_test_fixtures/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/001_test_fixtures/#1-setupteardown-methods","title":"1. Setup/Teardown Methods","text":"<pre><code>class TestDatabase:\n    def setup(self) -&gt; None:\n        self.db = Database.connect(\"test.db\")\n\n    def teardown(self) -&gt; None:\n        self.db.close()\n\n    def test_insert(self) -&gt; None:\n        self.db.insert(\"key\", \"value\")\n</code></pre> <p>Rejected: Less flexible than fixtures, doesn't support dependency injection.</p>"},{"location":"RFCs/001_test_fixtures/#2-context-managers","title":"2. Context Managers","text":"<pre><code>def test_insert() -&gt; None:\n    with Database.connect(\"test.db\") as db:\n        db.insert(\"key\", \"value\")\n</code></pre> <p>Rejected: Requires boilerplate in each test, no reusability.</p>"},{"location":"RFCs/001_test_fixtures/#open-questions","title":"Open Questions","text":"<ol> <li>Generator syntax: Should we use <code>yield</code> or a different keyword?</li> <li>Async fixtures: How to handle <code>async def</code> fixtures with Tokio?</li> <li>Fixture params: Should fixtures support <code>@parametrize</code>?</li> </ol>"},{"location":"RFCs/001_test_fixtures/#checklist","title":"Checklist","text":"<ul> <li>[ ] Parser: <code>yield</code> expression support in fixtures</li> <li>[ ] Parser: <code>@fixture</code> decorator args (scope, autouse)</li> <li>[ ] Runner: fixture discovery and dependency graph</li> <li>[ ] Runner: scoped lifecycle (function/module/session)</li> <li>[ ] Injection: match test parameters to fixtures by name</li> <li>[ ] Teardown: always run (even on panic)</li> <li>[ ] Autouse fixtures honored</li> <li>[ ] Async fixtures design (Tokio) \u2014 pending</li> <li>[ ] Docs/examples updated once implemented</li> </ul>"},{"location":"RFCs/001_test_fixtures/#references","title":"References","text":"<ul> <li>pytest fixtures documentation</li> <li>Rust test setup patterns</li> </ul>"},{"location":"RFCs/002_test_parametrize/","title":"RFC 002: Parametrized Tests","text":"<p>Status: Draft Created: 2024-12-08</p>"},{"location":"RFCs/002_test_parametrize/#summary","title":"Summary","text":"<p>Add pytest-style parametrized tests via the <code>@parametrize</code> decorator.</p>"},{"location":"RFCs/002_test_parametrize/#motivation","title":"Motivation","text":"<p>Parametrized tests allow:</p> <ol> <li>DRY testing - One test definition, many inputs</li> <li>Clear failures - Each parameter set is a separate test case</li> <li>Readable test data - Parameters are explicit, not hidden in loops</li> </ol>"},{"location":"RFCs/002_test_parametrize/#design","title":"Design","text":""},{"location":"RFCs/002_test_parametrize/#basic-syntax","title":"Basic Syntax","text":"<pre><code>from testing import parametrize\n\n@parametrize(\"a, b, expected\", [\n    (1, 2, 3),\n    (0, 0, 0),\n    (-1, 1, 0),\n    (100, 200, 300),\n])\ndef test_add(a: int, b: int, expected: int) -&gt; None:\n    assert_eq(add(a, b), expected)\n</code></pre> <p>Output:</p> <pre><code>test_math.incn::test_add[1-2-3] PASSED\ntest_math.incn::test_add[0-0-0] PASSED\ntest_math.incn::test_add[-1-1-0] PASSED\ntest_math.incn::test_add[100-200-300] PASSED\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#named-parameters","title":"Named Parameters","text":"<pre><code>@parametrize(\"input, expected\", [\n    (\"hello\", \"HELLO\"),\n    (\"World\", \"WORLD\"),\n    (\"\", \"\"),\n], ids=[\"lowercase\", \"mixed\", \"empty\"])\ndef test_upper(input: str, expected: str) -&gt; None:\n    assert_eq(input.upper(), expected)\n</code></pre> <p>Output:</p> <pre><code>test_string.incn::test_upper[lowercase] PASSED\ntest_string.incn::test_upper[mixed] PASSED\ntest_string.incn::test_upper[empty] PASSED\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#multiple-parametrize-decorators","title":"Multiple Parametrize Decorators","text":"<pre><code>@parametrize(\"x\", [1, 2, 3])\n@parametrize(\"y\", [10, 20])\ndef test_multiply(x: int, y: int) -&gt; None:\n    result = x * y\n    assert_true(result &gt; 0)\n</code></pre> <p>Generates 6 tests (cartesian product):</p> <pre><code>test_multiply[1-10], test_multiply[1-20],\ntest_multiply[2-10], test_multiply[2-20],\ntest_multiply[3-10], test_multiply[3-20]\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#complex-types","title":"Complex Types","text":"<pre><code>model TestCase:\n    input: str\n    expected: int\n    description: str\n\n@parametrize(\"case\", [\n    TestCase(input=\"hello\", expected=5, description=\"simple word\"),\n    TestCase(input=\"\", expected=0, description=\"empty string\"),\n    TestCase(input=\"hello world\", expected=11, description=\"with space\"),\n])\ndef test_length(case: TestCase) -&gt; None:\n    assert_eq(len(case.input), case.expected)\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#combining-with-fixtures","title":"Combining with Fixtures","text":"<pre><code>@fixture\ndef database() -&gt; Database:\n    db = Database.connect(\"test.db\")\n    yield db\n    db.close()\n\n@parametrize(\"key, value\", [\n    (\"name\", \"Alice\"),\n    (\"age\", \"30\"),\n])\ndef test_insert(database: Database, key: str, value: str) -&gt; None:\n    database.insert(key, value)\n    assert_eq(database.get(key), value)\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#implementation","title":"Implementation","text":""},{"location":"RFCs/002_test_parametrize/#phase-1-parser-changes","title":"Phase 1: Parser Changes","text":"<p>Parse <code>@parametrize</code> decorator:</p> <pre><code>DecoratorArg::Parametrize {\n    argnames: String,           # \"a, b, expected\"\n    argvalues: Vec&lt;Tuple&gt;,      # [(1,2,3), (0,0,0), ...]\n    ids: Option&lt;Vec&lt;String&gt;&gt;,   # Optional test IDs\n}\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#phase-2-test-discovery","title":"Phase 2: Test Discovery","text":"<p>When discovering tests:</p> <ol> <li>Detect <code>@parametrize</code> decorator</li> <li>Parse argnames and argvalues</li> <li>Generate N <code>TestInfo</code> entries, one per parameter set</li> </ol> <pre><code>struct TestInfo {\n    file_path: PathBuf,\n    function_name: String,\n    markers: Vec&lt;TestMarker&gt;,\n    parameters: Option&lt;ParametrizeInfo&gt;,  // NEW\n}\n\nstruct ParametrizeInfo {\n    argnames: Vec&lt;String&gt;,\n    values: Vec&lt;Value&gt;,\n    id: String,  // e.g., \"1-2-3\" or custom ID\n}\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#phase-3-codegen","title":"Phase 3: Codegen","text":"<p>Generate a separate Rust test function for each parameter set:</p> <pre><code>// From: test_add with params [(1,2,3), (0,0,0)]\n\n#[test]\nfn test_add_1_2_3() {\n    let a: i64 = 1;\n    let b: i64 = 2;\n    let expected: i64 = 3;\n    assert_eq!(add(a, b), expected);\n}\n\n#[test]\nfn test_add_0_0_0() {\n    let a: i64 = 0;\n    let b: i64 = 0;\n    let expected: i64 = 0;\n    assert_eq!(add(a, b), expected);\n}\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#phase-4-output-formatting","title":"Phase 4: Output Formatting","text":"<p>Display parameterized test names:</p> <pre><code>test_math.incn::test_add[1-2-3] PASSED\ntest_math.incn::test_add[0-0-0] PASSED\n</code></pre> <p>On failure, show which parameters failed:</p> <pre><code>FAILED test_math.incn::test_add[1-2-3]\n\n    Parameters: a=1, b=2, expected=3\n\n    assert_eq(add(a, b), expected)\n    AssertionError: 2 != 3\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#edge-cases","title":"Edge Cases","text":""},{"location":"RFCs/002_test_parametrize/#empty-parameter-list","title":"Empty Parameter List","text":"<pre><code>@parametrize(\"x\", [])\ndef test_nothing(x: int) -&gt; None:\n    pass\n</code></pre> <p>Result: No tests generated, warning emitted.</p>"},{"location":"RFCs/002_test_parametrize/#type-mismatches","title":"Type Mismatches","text":"<pre><code>@parametrize(\"x\", [1, \"two\", 3.0])\ndef test_typed(x: int) -&gt; None:\n    pass\n</code></pre> <p>Result: Compile error - parameter types must match function signature.</p>"},{"location":"RFCs/002_test_parametrize/#nested-tuples","title":"Nested Tuples","text":"<pre><code>@parametrize(\"point\", [\n    ((0, 0), \"origin\"),\n    ((1, 1), \"diagonal\"),\n])\ndef test_points(point: Tuple[Tuple[int, int], str]) -&gt; None:\n    coords, name = point\n    ...\n</code></pre>"},{"location":"RFCs/002_test_parametrize/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/002_test_parametrize/#1-loop-in-test","title":"1. Loop in Test","text":"<pre><code>def test_add_all() -&gt; None:\n    cases = [(1,2,3), (0,0,0)]\n    for a, b, expected in cases:\n        assert_eq(add(a, b), expected)\n</code></pre> <p>Rejected:</p> <ul> <li>Stops at first failure</li> <li>No individual test reporting</li> <li>Harder to identify which case failed</li> </ul>"},{"location":"RFCs/002_test_parametrize/#2-test-tables-go-style","title":"2. Test Tables (Go-style)","text":"<pre><code>def test_add() -&gt; None:\n    table = [\n        {\"a\": 1, \"b\": 2, \"expected\": 3},\n        {\"a\": 0, \"b\": 0, \"expected\": 0},\n    ]\n    for case in table:\n        with subtest(case):\n            assert_eq(add(case[\"a\"], case[\"b\"]), case[\"expected\"])\n</code></pre> <p>Rejected: More verbose, requires subtest infrastructure.</p>"},{"location":"RFCs/002_test_parametrize/#open-questions","title":"Open Questions","text":"<ol> <li>Lazy evaluation: Should parameter values be evaluated at collection time or test time?</li> <li>Indirect parametrization: Should parameters be able to reference fixtures?</li> <li>Skip individual params: <code>@parametrize(..., marks=[skip, None, xfail])</code>?</li> </ol>"},{"location":"RFCs/002_test_parametrize/#checklist","title":"Checklist","text":"<ul> <li>[ ] Parser: <code>@parametrize</code> decorator args (argnames, argvalues, ids)</li> <li>[ ] Discovery: expand parameter sets into TestInfo entries</li> <li>[ ] Codegen: generate per-parameter Rust test functions</li> <li>[ ] Reporting: parameterized test names and failure context</li> <li>[ ] Validation: type-check param values vs function signature</li> <li>[ ] Edge cases: empty parameter list warnings</li> <li>[ ] Fixture interaction: combine with fixtures safely</li> </ul>"},{"location":"RFCs/002_test_parametrize/#references","title":"References","text":"<ul> <li>pytest parametrize</li> <li>Rust test macros</li> </ul>"},{"location":"RFCs/003_frontend_wasm/","title":"RFC 003: Frontend &amp; WebAssembly Support","text":"<p>Status: Blocked Category: Major Feature</p>"},{"location":"RFCs/003_frontend_wasm/#summary","title":"Summary","text":"<p>Enable Incan to compile to WebAssembly (WASM) and provide first-class support for building frontend applications, including reactive UI components and 3D graphics. This positions Incan as a full-stack alternative to JavaScript frameworks like React and Three.js.</p>"},{"location":"RFCs/003_frontend_wasm/#motivation","title":"Motivation","text":""},{"location":"RFCs/003_frontend_wasm/#the-python-full-stack-problem","title":"The Python Full-Stack Problem","text":"<p>Python developers building full-stack applications face a common frustration: Python for backend, JavaScript for frontend. The typical stack looks like:</p> <pre><code>Backend: Python (FastAPI, Django, Flask)\n    \u2195 API calls \u2195\nFrontend: JavaScript/TypeScript (React, Vue, Angular)\n</code></pre> <p>This requires:</p> <ul> <li>Learning a second language (JavaScript/TypeScript)</li> <li>Context-switching between paradigms</li> <li>Maintaining two codebases with different tooling</li> <li>Duplicating types/models between backend and frontend</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#existing-python-frontend-solutions","title":"Existing Python \u2192 Frontend Solutions","text":"Solution Approach Limitations Streamlit Python \u2192 widgets Limited UI, data apps only Gradio Python \u2192 components Specialized for ML demos PyScript CPython in WASM Slow startup, ~10MB bundle, GC overhead Reflex Python \u2192 React Generates JavaScript, server-round-trips NiceGUI Python \u2192 Vue Server-side rendering, network latency Anvil Full Python web Proprietary, hosted platform <p>None of these provide:</p> <ul> <li>Native WASM performance (no Python interpreter overhead)</li> <li>True compile-time type safety (not runtime checks)</li> <li>Rust's memory guarantees (no garbage collector)</li> <li>Offline-capable  Single Page Applications (SPAs) (not server-dependent)</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#why-not-rust-directly","title":"Why Not Rust Directly?","text":"<p>Rust + WebAssembly solves the performance and safety issues, but presents barriers for Python developers:</p> <ul> <li>Ownership model \u2014 conceptually foreign to GC-language developers</li> <li>Borrow checker \u2014 rejects code that \"looks correct\"</li> <li>Lifetime annotations \u2014 complex syntax for memory management</li> <li>Verbose syntax \u2014 more ceremony than Python</li> </ul> <p>TypeScript developers have a smaller gap to Rust (similar syntax, static types). But Python developers face a steeper learning curve.</p>"},{"location":"RFCs/003_frontend_wasm/#incans-opportunity","title":"Incan's Opportunity","text":"<p>Full-stack Python without JavaScript \u2014 one language for backend APIs, frontend UIs, and 3D graphics, all compiling to native performance:</p> <pre><code>Incan (Python-like syntax)\n    \u2193 compiles to\nRust (backend) + Rust/WASM (frontend)\n    \u2193 produces\nNative binary (server) + WebAssembly (browser)\n</code></pre> <p>Benefits:</p> <ul> <li>Familiar syntax \u2014 Python developers feel at home</li> <li>Native performance \u2014 no interpreter, no GC pauses</li> <li>True full-stack \u2014 same language, same types, everywhere</li> <li>Rust's safety \u2014 memory safety without learning ownership</li> <li>Modern tooling \u2014 single build system, unified debugging</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#design","title":"Design","text":""},{"location":"RFCs/003_frontend_wasm/#part-1-wasm-compilation-target","title":"Part 1: WASM Compilation Target","text":"<p>Add a <code>--target wasm</code> flag to the Incan compiler:</p> <pre><code>incan build --target wasm app.incn\n</code></pre> <p>This generates:</p> <ul> <li>Rust code with <code>wasm-bindgen</code> annotations</li> <li><code>Cargo.toml</code> configured for <code>wasm32-unknown-unknown</code></li> <li>Build artifacts ready for browser deployment</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#generated-structure","title":"Generated Structure","text":"<pre><code>target/wasm/my_app/\n\u251c\u2500\u2500 Cargo.toml\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 lib.rs          # Generated Rust + wasm-bindgen\n\u251c\u2500\u2500 pkg/                # wasm-pack output\n\u2502   \u251c\u2500\u2500 my_app.js\n\u2502   \u251c\u2500\u2500 my_app_bg.wasm\n\u2502   \u2514\u2500\u2500 my_app.d.ts\n\u2514\u2500\u2500 index.html          # Dev server entry\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#type-mapping-for-wasm","title":"Type Mapping for WASM","text":"Incan Rust (WASM) JS <code>str</code> <code>String</code> <code>string</code> <code>int</code> <code>i64</code> / <code>i32</code> <code>number</code> / <code>BigInt</code> <code>float</code> <code>f64</code> <code>number</code> <code>bool</code> <code>bool</code> <code>boolean</code> <code>list[T]</code> <code>Vec&lt;T&gt;</code> <code>Array</code> <code>dict[K,V]</code> <code>HashMap&lt;K,V&gt;</code> <code>Object</code> / <code>Map</code> <code>Option[T]</code> <code>Option&lt;T&gt;</code> <code>T</code> or <code>null</code> <code>Result[T,E]</code> <code>Result&lt;T,E&gt;</code> <code>T</code> (throws on <code>Err</code>)"},{"location":"RFCs/003_frontend_wasm/#part-2-ui-framework-react-alternative","title":"Part 2: UI Framework (React Alternative)","text":"<p>A reactive component model for building web UIs.</p>"},{"location":"RFCs/003_frontend_wasm/#component-syntax","title":"Component Syntax","text":"<pre><code>from incan.ui import component, signal, html, Element\n\n@component\ndef counter(initial: int = 0) -&gt; Element:\n    \"\"\"A simple counter component.\"\"\"\n    count, set_count = signal(initial)\n\n    def increment() -&gt; None:\n        set_count(count + 1)\n\n    def decrement() -&gt; None:\n        set_count(count - 1)\n\n    return html(\"\"\"\n        &lt;div class=\"counter\"&gt;\n            &lt;span&gt;Count: {count}&lt;/span&gt;\n            &lt;button on:click={increment}&gt;+&lt;/button&gt;\n            &lt;button on:click={decrement}&gt;-&lt;/button&gt;\n        &lt;/div&gt;\n    \"\"\")\n</code></pre> <p>Note: For simple inline handlers, arrow syntax is also supported: <code>&lt;button on:click={() =&gt; set_count(count + 1)}&gt;+&lt;/button&gt;</code></p>"},{"location":"RFCs/003_frontend_wasm/#reactive-state-signals","title":"Reactive State: Signals","text":"<p>Signals provide fine-grained reactivity (like SolidJS/Leptos):</p> <pre><code>from incan.ui import signal, computed, effect\n\n# Create reactive state\nname, set_name = signal(\"World\")\n\n# Derived state (auto-updates when dependencies change)\ngreeting = computed(() =&gt; f\"Hello, {name}!\")\n\n# Side effects\neffect(() =&gt; println(f\"Name changed to: {name}\"))\n\n# Update triggers recomputation\nset_name(\"Incan\")  # Logs: \"Name changed to: Incan\"\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#html-templating","title":"HTML Templating","text":"<p>Embedded HTML with Incan expressions:</p> <pre><code>return html(\"\"\"\n    &lt;div class={active ? \"active\" : \"\"}&gt;\n        &lt;!-- Conditionals --&gt;\n        {\n        if logged_in:\n            &lt;UserProfile user={user} /&gt;\n        else:\n            &lt;LoginForm /&gt;\n        }\n\n        &lt;!-- Loops --&gt;\n        &lt;ul&gt;\n            {\n            for item in items:\n                &lt;li key={item.id}&gt;{item.name}&lt;/li&gt;\n            }\n        &lt;/ul&gt;\n\n        &lt;!-- Event handlers --&gt;\n        &lt;button on:click={handle_click}&gt;Click me&lt;/button&gt;\n        &lt;input on:input={(e) =&gt; set_value(e.target.value)} /&gt;\n    &lt;/div&gt;\n\"\"\")\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#component-props-and-children","title":"Component Props and Children","text":"<pre><code>from incan.ui import component, html, Element, Children\n\n@component\ndef Card(title: str, children: Children) -&gt; Element:\n    return html(\"\"\"\n        &lt;div class=\"card\"&gt;\n            &lt;h2&gt;{title}&lt;/h2&gt;\n            &lt;div class=\"content\"&gt;\n                {children}\n            &lt;/div&gt;\n        &lt;/div&gt;\n    \"\"\")\n\n# Usage\nhtml(\"\"\"\n    &lt;Card title=\"My Card\"&gt;\n        &lt;p&gt;This is the card content.&lt;/p&gt;\n    &lt;/Card&gt;\n\"\"\")\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#lifecycle-and-effects","title":"Lifecycle and Effects","text":"<pre><code>from incan.ui import component, signal, effect, html, Element\n\n@component\ndef dataFetcher(url: str) -&gt; Element:\n    data, set_data = signal(None)\n    loading, set_loading = signal(True)\n\n    # Runs on mount and when url changes\n    effect(async () =&gt; (\n        set_loading(True)\n        result = await fetch(url)\n        set_data(result)\n        set_loading(False)\n    ), deps=[url])\n\n    return html(\"\"\"\n        {\n        if loading:\n            &lt;Spinner /&gt;\n        else:\n            &lt;DataView data={data} /&gt;\n        }\n    \"\"\")\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#routing","title":"Routing","text":"<pre><code>from incan.ui import component, Router, Route, Link, Element\n\n@component\ndef app() -&gt; Element:\n    return html(\"\"\"\n        &lt;Router&gt;\n            &lt;nav&gt;\n                &lt;Link to=\"/\"&gt;Home&lt;/Link&gt;\n                &lt;Link to=\"/about\"&gt;About&lt;/Link&gt;\n                &lt;Link to=\"/users/{id}\"&gt;User&lt;/Link&gt;\n            &lt;/nav&gt;\n\n            &lt;Route path=\"/\" component={Home} /&gt;\n            &lt;Route path=\"/about\" component={About} /&gt;\n            &lt;Route path=\"/users/{id}\" component={UserProfile} /&gt;\n        &lt;/Router&gt;\n    \"\"\")\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#part-2b-jsx-template-syntax-alternative","title":"Part 2b: JSX Template Syntax (Alternative)","text":"<p>As an alternative to <code>html()</code> string templates, Incan supports JSX (JavaScript XML) syntax via the <code>jsx()</code> wrapper. This provides a more familiar experience for developers coming from React/TypeScript, with full IDE support.</p>"},{"location":"RFCs/003_frontend_wasm/#why-a-jsx-wrapper","title":"Why a <code>jsx()</code> Wrapper?","text":"<p>Raw JSX in Incan would create parser ambiguity:</p> <pre><code>result = &lt;div&gt;content&lt;/div&gt;    # JSX? Or...\nresult = x &lt; y                  # Less-than comparison?\n</code></pre> <p>The <code>jsx()</code> wrapper solves this by explicitly marking JSX regions:</p> <pre><code>return jsx(\n    &lt;div&gt;content&lt;/div&gt;\n)\n</code></pre> <p>This approach:</p> <ul> <li>No parser ambiguity \u2014 content inside <code>jsx()</code> is parsed as JSX</li> <li>IDE support \u2014 editors know to provide JSX highlighting/completion</li> <li>Explicit \u2014 follows Incan's \"explicit is better than implicit\" philosophy</li> <li>Similar to Rust \u2014 mirrors Leptos's <code>view!</code> macro approach</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#comparison","title":"Comparison","text":"Approach Syntax IDE Support Parser Complexity <code>html(\"\"\"...\"\"\")</code> String template Limited Simple <code>jsx(...)</code> Native JSX Full Moderate (scoped) <p>Both compile to the same output \u2014 choose based on preference.</p>"},{"location":"RFCs/003_frontend_wasm/#jsx-syntax-in-incan","title":"JSX Syntax in Incan","text":"<pre><code>from incan.ui import component, signal, jsx, Element\n\n@component\ndef counter(initial: int = 0) -&gt; Element:\n    count, set_count = signal(initial)\n\n    def increment() -&gt; None:\n        set_count(count + 1)\n\n    def decrement() -&gt; None:\n        set_count(count - 1)\n\n    return jsx(\n        &lt;div class=\"counter\"&gt;\n            &lt;span&gt;Count: {count}&lt;/span&gt;\n            &lt;button onClick={increment}&gt;+&lt;/button&gt;\n            &lt;button onClick={decrement}&gt;-&lt;/button&gt;\n        &lt;/div&gt;\n    )\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#expressions-in-jsx","title":"Expressions in JSX","text":"<p>Note: The following examples show content inside a <code>jsx()</code> wrapper for brevity.</p> <pre><code># Variables\n&lt;span&gt;{user.name}&lt;/span&gt;\n\n# Expressions\n&lt;div class={is_active ? \"active\" : \"inactive\"}&gt;\n    {items.len()} items\n&lt;/div&gt;\n\n# Function calls\n&lt;span&gt;{format_date(created_at)}&lt;/span&gt;\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#conditionals","title":"Conditionals","text":"<pre><code># If expression\n&lt;div&gt;\n    {\n    if logged_in:\n        &lt;UserProfile user={user} /&gt;\n    else:\n        &lt;LoginForm /&gt;\n    }\n&lt;/div&gt;\n\n# Match expression\n&lt;div&gt;\n    {\n    match status:\n        case Status.Loading: &lt;Spinner /&gt;\n        case Status.Error(msg): &lt;ErrorMessage message={msg} /&gt;\n        case Status.Success(data): &lt;DataView data={data} /&gt;\n    }\n&lt;/div&gt;\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#loops","title":"Loops","text":"<pre><code>&lt;ul&gt;\n    {\n    for item in items:\n        &lt;li key={item.id}&gt;\n            {item.name} - ${item.price}\n        &lt;/li&gt;\n    }\n&lt;/ul&gt;\n\n# With index\n&lt;ol&gt;\n    {\n    for i, item in enumerate(items):\n        &lt;li&gt;{i + 1}. {item.name}&lt;/li&gt;\n    }\n&lt;/ol&gt;\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#event-handlers","title":"Event Handlers","text":"<p>Preferred: Named handler functions</p> <pre><code>def handle_click() -&gt; None:\n    println(\"Button clicked!\")\n\ndef handle_input(e: Event) -&gt; None:\n    set_text(e.target.value)\n\ndef handle_key(e: KeyboardEvent) -&gt; None:\n    if e.key == \"Enter\":\n        submit()\n\n# Reference handlers by name\n&lt;button onClick={handle_click}&gt;Click me&lt;/button&gt;\n&lt;input value={text} onInput={handle_input} onKeyDown={handle_key} /&gt;\n&lt;form onSubmit={handle_submit}&gt;...&lt;/form&gt;\n</code></pre> <p>Alternative: Arrow syntax for simple inline cases</p> <pre><code>&lt;button onClick={() =&gt; set_count(count + 1)}&gt;+&lt;/button&gt;\n&lt;input onInput={(e) =&gt; set_text(e.target.value)} /&gt;\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#components-in-jsx","title":"Components in JSX","text":"<pre><code># Using components\n&lt;Card title=\"Welcome\"&gt;\n    &lt;p&gt;Hello, {user.name}!&lt;/p&gt;\n&lt;/Card&gt;\n\n# With spread props\n&lt;Button {...button_props} /&gt;\n\n# Conditional rendering\n&lt;div&gt;\n    &lt;Header /&gt;\n    {if show_sidebar: &lt;Sidebar /&gt;}\n    &lt;Main /&gt;\n    &lt;Footer /&gt;\n&lt;/div&gt;\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#fragments","title":"Fragments","text":"<pre><code>from incan.ui import component, jsx, Element\n\n# Return multiple elements without wrapper\n@component\ndef list_items() -&gt; Element:\n    return jsx(\n        &lt;&gt;\n            &lt;li&gt;Item 1&lt;/li&gt;\n            &lt;li&gt;Item 2&lt;/li&gt;\n            &lt;li&gt;Item 3&lt;/li&gt;\n        &lt;/&gt;\n    )\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#style-handling","title":"Style Handling","text":"<pre><code># Inline styles (dict)\n&lt;div style={{\"color\": \"red\", \"fontSize\": \"16px\"}}&gt;\n    Styled text\n&lt;/div&gt;\n\n# Dynamic classes\n&lt;div class={[\"base\", active ? \"active\" : \"\", error ? \"error\" : \"\"]}&gt;\n    Content\n&lt;/div&gt;\n\n# CSS modules (future)\n&lt;div class={styles.container}&gt;\n    ...\n&lt;/div&gt;\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#parser-implementation-notes","title":"Parser Implementation Notes","text":"<p>Incan supports two wrapper modes: <code>html()</code> and <code>jsx()</code>. Both compile to the same output (Leptos view nodes), but they parse differently: <code>html()</code> takes a string, while <code>jsx()</code> is native syntax the IDE can understand.</p> <ul> <li> <p><code>html()</code> takes a string:</p> <pre><code>return html(\"\"\"&lt;div&gt;{message}&lt;/div&gt;\"\"\")\n#            \u2191 This is a string literal\n</code></pre> <p>The content inside <code>html()</code> is a string that gets parsed at compile time. Your IDE sees a string, not markup.</p> </li> <li> <p><code>jsx()</code> enables native syntax (inspired by React's JSX syntax):</p> <pre><code>return jsx(&lt;div&gt;{message}&lt;/div&gt;)\n#          \u2191 This is NOT a string \u2014 it's native Incan syntax\n</code></pre> <p>The content inside <code>jsx()</code> is parsed directly by Incan as first-class syntax. Your IDE sees markup, not a string.</p> </li> </ul>"},{"location":"RFCs/003_frontend_wasm/#parser-behavior","title":"Parser Behavior","text":"<p>When the parser encounters <code>jsx(</code>, it switches to JSX mode:</p> <ol> <li><code>&lt;</code> is always a tag open, never less-than</li> <li><code>{...}</code> switches back to Incan expression parsing</li> <li>Self-closing tags: <code>&lt;Component /&gt;</code></li> <li>Attributes: <code>prop={expr}</code> and <code>prop=\"string\"</code></li> </ol>"},{"location":"RFCs/003_frontend_wasm/#why-this-matters","title":"Why This Matters","text":"Aspect <code>html()</code> (string) <code>jsx()</code> (native syntax) What IDE sees A string Markup syntax Syntax highlighting Requires plugin Automatic Autocomplete None Full Error messages \"Invalid string\" \"Unknown component <code>Foo</code>\" Escaping <code>\"\"\"</code> Requires workaround Not an issue"},{"location":"RFCs/003_frontend_wasm/#part-3-3d-graphics-threejs-alternative","title":"Part 3: 3D Graphics (Three.js Alternative)","text":"<p>A scene-graph API for 3D graphics, built on WebGPU via wgpu.</p>"},{"location":"RFCs/003_frontend_wasm/#basic-scene","title":"Basic Scene","text":"<pre><code>from incan.graphics import Scene, Camera, Renderer\nfrom incan.graphics import Mesh, BoxGeometry, StandardMaterial\nfrom incan.graphics import AmbientLight, DirectionalLight\n\n# Create scene\nscene = Scene()\n\n# Add camera\ncamera = Camera.perspective(\n    fov=75,\n    aspect=16/9,\n    near=0.1,\n    far=1000\n)\ncamera.position = Vec3(0, 5, 10)\ncamera.look_at(Vec3.zero())\n\n# Add lighting\nscene.add(AmbientLight(color=0x404040))\nscene.add(DirectionalLight(\n    color=0xffffff,\n    intensity=1.0,\n    position=Vec3(10, 10, 10)\n))\n\n# Add a cube\ncube = Mesh(\n    geometry=BoxGeometry(2, 2, 2),\n    material=StandardMaterial(\n        color=0x00ff00,\n        metalness=0.5,\n        roughness=0.5\n    )\n)\nscene.add(cube)\n\n# Create renderer\nrenderer = Renderer(canvas=\"#canvas\")\n\n# Animation loop\ndef animate(delta: float) -&gt; None:\n    cube.rotation.x += delta\n    cube.rotation.y += delta * 0.5\n    renderer.render(scene, camera)\n\nrenderer.start(animate)\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#geometries","title":"Geometries","text":"<pre><code>from incan.graphics.geometry import (\n    BoxGeometry,\n    SphereGeometry,\n    PlaneGeometry,\n    CylinderGeometry,\n    TorusGeometry,\n    BufferGeometry,  # Custom geometry\n)\n\n# Parametric geometries\nsphere = SphereGeometry(radius=1, segments=32)\nplane = PlaneGeometry(width=10, height=10)\ntorus = TorusGeometry(radius=1, tube=0.4, segments=16)\n\n# Custom geometry from vertices\ncustom = BufferGeometry()\ncustom.set_attribute(\"position\", positions)\ncustom.set_attribute(\"normal\", normals)\ncustom.set_attribute(\"uv\", uvs)\ncustom.set_index(indices)\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#materials","title":"Materials","text":"<pre><code>from incan.graphics.material import (\n    StandardMaterial,   # PBR material\n    BasicMaterial,      # Unlit\n    PhongMaterial,      # Classic lighting\n    ShaderMaterial,     # Custom shaders\n)\n\n# PBR material\npbr = StandardMaterial(\n    color=0xff0000,\n    metalness=0.8,\n    roughness=0.2,\n    normal_map=load_texture(\"normal.png\"),\n    ao_map=load_texture(\"ao.png\"),\n)\n\n# Custom shader\ncustom = ShaderMaterial(\n    vertex_shader=\"\"\"\n        @vertex\n        fn main(@location(0) position: vec3&lt;f32&gt;) -&gt; @builtin(position) vec4&lt;f32&gt; {\n            return uniforms.mvp * vec4(position, 1.0);\n        }\n    \"\"\",\n    fragment_shader=\"\"\"\n        @fragment\n        fn main() -&gt; @location(0) vec4&lt;f32&gt; {\n            return vec4(1.0, 0.0, 0.0, 1.0);\n        }\n    \"\"\",\n    uniforms={\"time\": 0.0}\n)\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#asset-loading","title":"Asset Loading","text":"<pre><code>from incan.graphics import load_gltf, load_texture, load_cubemap\n\n# Load 3D model\nmodel = await load_gltf(\"model.glb\")\nscene.add(model)\n\n# Load texture\ntexture = await load_texture(\"diffuse.png\")\n\n# Load environment map\nskybox = await load_cubemap([\n    \"px.jpg\", \"nx.jpg\",\n    \"py.jpg\", \"ny.jpg\", \n    \"pz.jpg\", \"nz.jpg\"\n])\nscene.environment = skybox\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#animation","title":"Animation","text":"<pre><code>from incan.graphics import AnimationMixer, AnimationClip\n\n# Load animated model\nmodel = await load_gltf(\"character.glb\")\nmixer = AnimationMixer(model)\n\n# Play animation\nwalk = model.animations[\"walk\"]\naction = mixer.clip_action(walk)\naction.play()\n\n# In render loop\ndef animate(delta: float) -&gt; None:\n    mixer.update(delta)\n    renderer.render(scene, camera)\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#physics-integration-optional","title":"Physics Integration (Optional)","text":"<pre><code>from incan.physics import World, RigidBody, Collider\n\n# Create physics world\nworld = World(gravity=Vec3(0, -9.81, 0))\n\n# Add physics to mesh\nbody = RigidBody(\n    position=cube.position,\n    collider=Collider.box(2, 2, 2),\n    mass=1.0\n)\nworld.add(body)\n\n# Sync physics \u2192 graphics\ndef animate(delta: float) -&gt; None:\n    world.step(delta)\n    cube.position = body.position\n    cube.rotation = body.rotation\n    renderer.render(scene, camera)\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#part-4-build-tooling","title":"Part 4: Build Tooling","text":""},{"location":"RFCs/003_frontend_wasm/#development-server","title":"Development Server","text":"<pre><code>incan dev --target wasm\n</code></pre> <p>Features:</p> <ul> <li>Hot module replacement (HMR)</li> <li>Source maps for debugging</li> <li>Automatic browser refresh</li> <li>Error overlay</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#production-build","title":"Production Build","text":"<pre><code>incan build --target wasm --release\n</code></pre> <p>Outputs:</p> <ul> <li>Optimized WASM binary (wasm-opt)</li> <li>Minified JS glue code</li> <li>Tree-shaken bundle</li> <li>Asset hashing for caching</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#project-structure","title":"Project Structure","text":"<pre><code>my_app/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main.incn          # Entry point\n\u2502   \u251c\u2500\u2500 components/\n\u2502   \u2502   \u251c\u2500\u2500 App.incn\n\u2502   \u2502   \u2514\u2500\u2500 Counter.incn\n\u2502   \u2514\u2500\u2500 scenes/\n\u2502       \u2514\u2500\u2500 MainScene.incn\n\u251c\u2500\u2500 assets/\n\u2502   \u251c\u2500\u2500 models/\n\u2502   \u251c\u2500\u2500 textures/\n\u2502   \u2514\u2500\u2500 fonts/\n\u251c\u2500\u2500 public/\n\u2502   \u2514\u2500\u2500 index.html\n\u2514\u2500\u2500 Cargo.toml             # Project config (with Incan metadata)\n</code></pre>"},{"location":"RFCs/003_frontend_wasm/#configuration-cargotoml","title":"Configuration (Cargo.toml)","text":"<p>Incan uses Cargo.toml with <code>[package.metadata.incan]</code> for Incan-specific settings. This follows Rust ecosystem conventions (used by wasm-pack, cargo-deb, etc.). Rust dependencies are auto-injected by the Incan toolchain based on what your Incan code imports and the build target.</p> <pre><code>[package]\nname = \"my_app\"\nversion = \"0.1.0\"\nedition = \"2021\"\n\n# Incan-specific configuration\n[package.metadata.incan]\nentry = \"src/main.incn\"\ntarget = \"wasm\"\n\n[package.metadata.incan.wasm]\noptimize = true\ndebug_symbols = false\n\n[package.metadata.incan.dev]\nport = 3000\nopen_browser = true\n</code></pre> <p>Auto-added dependencies (examples):</p> Incan usage Added to Cargo.toml <code>from incan.ui import component, jsx</code> <code>leptos</code> <code>target = \"wasm\"</code> <code>wasm-bindgen</code> <code>from incan.graphics import Scene</code> <code>wgpu</code>, <code>glam</code> <code>from incan.physics import RigidBody</code> <code>rapier3d</code>"},{"location":"RFCs/003_frontend_wasm/#implementation-strategy","title":"Implementation Strategy","text":""},{"location":"RFCs/003_frontend_wasm/#foundation-layer","title":"Foundation Layer","text":"<ol> <li>WASM codegen target</li> <li>wasm-bindgen integration</li> <li>Basic JS interop</li> </ol>"},{"location":"RFCs/003_frontend_wasm/#ui-layer-builds-on-foundation","title":"UI Layer (builds on Foundation)","text":"<ol> <li>Signal/reactive primitives</li> <li>HTML template parser</li> <li>Component model</li> <li>Event handling</li> <li>Routing</li> </ol>"},{"location":"RFCs/003_frontend_wasm/#graphics-layer-builds-on-foundation","title":"Graphics Layer (builds on Foundation)","text":"<ol> <li>wgpu bindings</li> <li>Scene graph</li> <li>Geometries and materials</li> <li>Asset loading</li> <li>Animation system</li> </ol>"},{"location":"RFCs/003_frontend_wasm/#tooling-layer-parallel","title":"Tooling Layer (parallel)","text":"<ol> <li>Dev server with HMR</li> <li>Production bundler</li> <li>Source maps</li> <li>Error overlay</li> </ol>"},{"location":"RFCs/003_frontend_wasm/#rust-crate-dependencies","title":"Rust Crate Dependencies","text":"Feature Crate Purpose WASM interop wasm-bindgen JS\u2194Rust FFI DOM access web-sys Browser APIs Reactivity Custom or Leptos-inspired Signal system 3D graphics wgpu WebGPU abstraction Math glam Vectors, matrices Asset loading gltf, image 3D models, textures Physics rapier Optional physics"},{"location":"RFCs/003_frontend_wasm/#success-criteria","title":"Success Criteria","text":"<ol> <li>\"Hello World\" WASM app compiles and runs in browser</li> <li>Counter component demonstrates reactive state</li> <li>TodoMVC proves component model completeness  </li> <li>Rotating cube demonstrates basic 3D</li> <li>Animated character demonstrates asset loading + animation</li> <li>Full demo app combines UI + 3D (e.g., 3D product viewer)</li> </ol>"},{"location":"RFCs/003_frontend_wasm/#future-extensions","title":"Future Extensions","text":"<ul> <li>Server-side rendering (SSR) with hydration</li> <li>Static site generation (SSG)</li> <li>Native desktop via wgpu (non-WASM)</li> <li>Mobile via wgpu + platform bindings</li> <li>VR/AR support via WebXR</li> <li>Collaborative editing (CRDTs)</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#references","title":"References","text":"<ul> <li>wasm-bindgen</li> <li>Leptos - Rust reactive framework</li> <li>wgpu - WebGPU for Rust</li> <li>Bevy - Rust game engine</li> <li>Three.js - JS 3D library (inspiration)</li> <li>SolidJS - JS signals (inspiration)</li> </ul>"},{"location":"RFCs/003_frontend_wasm/#checklist","title":"Checklist","text":"<ul> <li>[ ] CLI: <code>incan build --target wasm</code> plumbing</li> <li>[ ] Codegen: wasm-bindgen output for <code>wasm32-unknown-unknown</code></li> <li>[ ] Auto-deps: inject wasm-bindgen/web-sys/leptos/etc. from usage</li> <li>[ ] UI: signals/effect/component runtime surface</li> <li>[ ] Templates: <code>html()</code> strings</li> <li>[ ] Templates: <code>jsx()</code> wrapper parsing/emission</li> <li>[ ] Event handlers: named + arrow inline support</li> <li>[ ] Routing: Router/Route/Link mapping</li> <li>[ ] Dev server: <code>incan dev --target wasm</code> with HMR/overlay</li> <li>[ ] Prod build: wasm-opt/minify/tree-shake/assets</li> <li>[ ] 3D: wgpu bindings + scene graph + loaders</li> <li>[ ] Examples: counter, TodoMVC, rotating cube, 3D demo</li> </ul>"},{"location":"RFCs/004_async_fixtures/","title":"RFC 004: Async Fixtures","text":"<p>Status: Draft Created: 2025-12-10</p>"},{"location":"RFCs/004_async_fixtures/#summary","title":"Summary","text":"<p>Define async fixtures for the Incan test framework, integrating with Tokio so <code>async def</code> fixtures can perform async setup/teardown and participate in fixture dependency injection.</p>"},{"location":"RFCs/004_async_fixtures/#motivation","title":"Motivation","text":"<ul> <li>Enable async setup (e.g., HTTP servers, DB pools, queues).</li> <li>Align with async tests and existing <code>@fixture</code> ergonomics.</li> <li>Ensure teardown always runs, even on panic/cancellation.</li> </ul>"},{"location":"RFCs/004_async_fixtures/#design-goals","title":"Design Goals","text":"<ul> <li>Preserve pytest-like ergonomics: <code>@fixture</code> + <code>yield</code>, but async-capable.</li> <li>Support the same scopes: function / module / session.</li> <li>Integrate with Tokio (single runtime per test run).</li> <li>Ensure deterministic teardown ordering for async fixtures.</li> <li>Work with parametrized tests and regular fixtures.</li> </ul>"},{"location":"RFCs/004_async_fixtures/#proposed-design","title":"Proposed Design","text":""},{"location":"RFCs/004_async_fixtures/#syntax","title":"Syntax","text":"<pre><code>from testing import fixture\n\n@fixture(scope=\"function\")\nasync def http_server() -&gt; ServerHandle:\n    server = await start_server(port=0)\n    yield server\n    await server.shutdown()\n</code></pre>"},{"location":"RFCs/004_async_fixtures/#teardown-guarantee","title":"Teardown guarantee","text":"<p>The test runner ensures fixture teardowns run even if the test panics or is cancelled. For async fixtures, teardown is awaited before proceeding to dependent teardowns.</p>"},{"location":"RFCs/004_async_fixtures/#semantics","title":"Semantics","text":"<ul> <li>Async fixtures must be <code>async def</code> and use <code>yield</code> exactly once.</li> <li>The value yielded is injected into dependent tests/fixtures.</li> <li>Teardown is awaited even if the test panics or is cancelled.</li> <li>Scoping rules mirror sync fixtures; session/module fixtures are awaited once per scope.</li> </ul>"},{"location":"RFCs/004_async_fixtures/#tokio-integration","title":"Tokio Integration","text":"<ul> <li>A single Tokio runtime is created per test run (multi-threaded).</li> <li>Fixtures run on that runtime; no nested runtimes.</li> <li>Blocking operations inside async fixtures must use <code>tokio::task::spawn_blocking</code>.</li> </ul>"},{"location":"RFCs/004_async_fixtures/#fixture-graph-with-mixed-syncasync","title":"Fixture Graph with Mixed Sync/Async","text":"<ul> <li>Dependency resolution builds a DAG of fixtures.</li> <li>If any dependency is async, dependents await it before running.</li> <li>Teardown order is reverse topological; async teardowns are awaited.</li> </ul>"},{"location":"RFCs/004_async_fixtures/#parametrize-interop","title":"Parametrize Interop","text":"<ul> <li>Parametrized tests expand first, then fixtures are resolved per test case.</li> <li>Async fixtures can be used alongside <code>@parametrize</code> without changes to test syntax.</li> </ul>"},{"location":"RFCs/004_async_fixtures/#error-handling","title":"Error Handling","text":"<ul> <li>Setup errors fail the test (or all tests in the scope for module/session fixtures).</li> <li>Teardown errors are reported but do not mask setup failures; aggregate errors if multiple teardowns fail.</li> </ul>"},{"location":"RFCs/004_async_fixtures/#implementation-phases","title":"Implementation Phases","text":"<p>1) Parser/AST</p> <pre><code>- Add `Yield` expression support inside `async def`.\n- Validate single `yield` per fixture function.\n</code></pre> <p>2) Test Runner</p> <pre><code>- Create shared Tokio runtime for the run.\n- Resolve fixture graph; support async setup/teardown with scopes.\n- Ensure teardown runs on panic using `catch_unwind` + `DropGuard`-like patterns.\n</code></pre> <p>3) Codegen</p> <pre><code>- Emit Rust async fixtures as async functions returning the yielded value.\n- Generate await points for setup/teardown.\n- Enforce scoping caches for module/session fixtures.\n</code></pre> <p>4) Parametrize Integration</p> <pre><code>- Expand parametrized tests first, then resolve fixtures per case.\n- Ensure async fixtures are awaited per case (function scope) or cached (module/session).\n</code></pre> <p>5) Documentation &amp; Examples</p> <pre><code>- Add examples for async HTTP server fixture, DB pool fixture, and queue client fixture.\n</code></pre>"},{"location":"RFCs/004_async_fixtures/#open-questions","title":"Open Questions","text":"<ol> <li>Cancellation semantics: how do we handle long-running fixtures on test abort?</li> <li>Timeouts: should fixtures support per-fixture timeout configuration?</li> <li>Runtime configuration: allow opting into current-thread runtime?</li> </ol>"},{"location":"RFCs/004_async_fixtures/#checklist","title":"Checklist","text":"<ul> <li>[ ] Parser: <code>yield</code> inside <code>async def</code> fixtures</li> <li>[ ] Validator: single <code>yield</code> per fixture</li> <li>[ ] Runner: shared Tokio runtime per test run</li> <li>[ ] Runner: async fixture setup/teardown with scopes</li> <li>[ ] Teardown: always awaited, even on panic</li> <li>[ ] Parametrize interop with async fixtures</li> <li>[ ] Error reporting: setup vs teardown aggregation</li> <li>[ ] Docs/examples for async fixtures (HTTP server, DB pool, queue)</li> </ul>"},{"location":"RFCs/005_rust_interop/","title":"RFC 005: Rust Interop","text":"<p>Status: Draft Created: 2025-12-10  </p>"},{"location":"RFCs/005_rust_interop/#summary","title":"Summary","text":"<p>Define seamless Rust interop for Incan: imports like <code>rust::serde_json</code> should work without manual Cargo edits, with clear type mapping, codegen, and build integration.</p>"},{"location":"RFCs/005_rust_interop/#goals","title":"Goals","text":"<ul> <li>Allow importing Rust crates/modules from Incan (<code>rust::serde_json</code>, <code>rust::time::Instant</code>).</li> <li>Auto-manage Cargo dependencies/features based on imports.</li> <li>Generate correct Rust <code>use</code> statements with stable namespacing.</li> <li>Provide a well-defined type mapping and safety model.</li> <li>Avoid surprises around async runtimes and unwind behavior.</li> </ul>"},{"location":"RFCs/005_rust_interop/#non-goals-initial","title":"Non-Goals (initial)","text":"<ul> <li>Procedural macros or derive expansion.</li> <li>Arbitrary trait/lifetime-heavy APIs.</li> <li>Cross-crate macro resolution.</li> </ul>"},{"location":"RFCs/005_rust_interop/#syntax","title":"Syntax","text":"<ul> <li>Whole-crate import:</li> </ul> <pre><code>import rust::serde_json as json\n</code></pre> <ul> <li>Selective import:</li> </ul> <pre><code>from rust::time import Instant, Duration\n</code></pre> <ul> <li>Nested paths:</li> </ul> <pre><code>from rust::chrono::naive::date import NaiveDate\n</code></pre>"},{"location":"RFCs/005_rust_interop/#related-crate-absolute-module-paths","title":"Related: <code>crate::...</code> absolute module paths","text":"<p>This RFC also introduces the Rust-style <code>crate</code> import prefix for Incan module paths:</p> <pre><code># Import from the project root (absolute module path)\nimport crate::config as cfg\nfrom crate::utils import format_date\n</code></pre> <p>Notes:</p> <ul> <li><code>crate::...</code> is for Incan modules (project root), not for selecting a Rust crate in a <code>rust::...</code> import.</li> <li>Parent navigation for Incan modules uses <code>super::...</code> / <code>..</code> and is specified in RFC 000.</li> </ul>"},{"location":"RFCs/005_rust_interop/#type-mapping-initial","title":"Type Mapping (initial)","text":"<ul> <li>Scalars: <code>int</code> \u2194 <code>i64</code>/<code>i32</code>, <code>float</code> \u2194 <code>f64</code>, <code>bool</code> \u2194 <code>bool</code>.</li> <li>Strings: <code>str</code> \u2194 <code>String</code>.</li> <li>Collections: <code>List[T]</code> \u2194 <code>Vec&lt;T&gt;</code>, <code>Dict[K,V]</code> \u2194 <code>HashMap&lt;K,V&gt;</code>.</li> <li>Option/Result: <code>Option[T]</code> \u2194 <code>Option&lt;T&gt;</code>, <code>Result[T,E]</code> \u2194 <code>Result&lt;T,E&gt;</code>.</li> <li>Structs/enums: direct mapping when imported; no automatic derive of complex traits.</li> <li>Borrowed data: restricted initially\u2014prefer owned types; no implicit lifetimes.</li> </ul>"},{"location":"RFCs/005_rust_interop/#codegen","title":"Codegen","text":"<ul> <li>Emit Rust <code>use</code> statements matching imported paths.</li> <li>Namespace collision avoidance: preserve module paths; mangle only if needed.</li> <li>Error surfacing: map Rust errors to Incan <code>Result</code>; no hidden panics.</li> <li>Async: if imported functions are async and use Tokio, ensure runtime compatibility.</li> </ul>"},{"location":"RFCs/005_rust_interop/#cargo-integration","title":"Cargo Integration","text":"<ul> <li>Auto-add <code>[dependencies]</code> entries when <code>rust::</code> imports are used.</li> <li>Allow specifying versions/features in an optional manifest override (future).</li> <li>Default: latest compatible semver or pinned minimal versions (TBD).</li> <li>Feature flags: if <code>rust::tokio::net</code> is imported, enable <code>tokio</code> with required features.</li> </ul>"},{"location":"RFCs/005_rust_interop/#safety-unwind","title":"Safety &amp; Unwind","text":"<ul> <li>Assume Rust panics should not cross the FFI boundary; prefer Result-returning APIs.</li> <li>For now, avoid APIs that require borrowing lifetimes across the boundary.</li> <li>Document any <code>Send</code>/<code>Sync</code> expectations for async interop.</li> </ul>"},{"location":"RFCs/005_rust_interop/#async-interop","title":"Async Interop","text":"<ul> <li>Prefer Tokio-backed crates for async.</li> <li>Ensure a single Tokio runtime in the test runner/CLI; avoid nested runtimes.</li> <li>If a crate requires a current-thread runtime, note incompatibility or provide a flag (future).</li> </ul>"},{"location":"RFCs/005_rust_interop/#build-modes","title":"Build Modes","text":"<ul> <li>Generated Cargo: Incan emits Cargo.toml and src with the needed deps/uses.</li> <li>User-managed Cargo (future): allow opting out and integrating into existing workspaces.</li> </ul>"},{"location":"RFCs/005_rust_interop/#examples","title":"Examples","text":"<pre><code>import rust::serde_json as json\n\ndef encode_user(user: User) -&gt; str:\n    return json::to_string(&amp;user)?\n</code></pre> <pre><code>from rust::time import Instant, Duration\n\ndef elapsed_ms(start: Instant) -&gt; int:\n    return Duration::from_secs_f64(start.elapsed().as_secs_f64()).as_millis()\n</code></pre> <pre><code>from rust::reqwest import Client\n\nasync def fetch_text(url: str) -&gt; Result[str, HttpError]:\n    client = Client::new()\n    resp = await client.get(url).send()?\n    return await resp.text()\n</code></pre>"},{"location":"RFCs/005_rust_interop/#limitations-initial","title":"Limitations (initial)","text":"<ul> <li>No proc-macros/derive.</li> <li>No implicit lifetime bridging; borrowed references not supported across the boundary.</li> <li>Trait-heavy or GAT/lifetime-heavy APIs may not map cleanly.</li> </ul>"},{"location":"RFCs/005_rust_interop/#open-questions","title":"Open Questions","text":"<ol> <li>Version resolution: pin minimal versions or allow user overrides?</li> <li>Feature auto-detection granularity: per-module vs per-crate?</li> <li>Error mapping: when to wrap vs. propagate Rust error types directly?</li> <li>WASM target: which crates are allowed/blocked when targeting wasm32?</li> </ol>"},{"location":"RFCs/005_rust_interop/#checklist","title":"Checklist","text":"<ul> <li>[ ] Syntax parsing for <code>rust::</code> imports</li> <li>[ ] Codegen: emit <code>use</code> statements</li> <li>[ ] Cargo: auto-add dependencies/features</li> <li>[ ] Type mapping rules enforced in codegen/typechecker</li> <li>[ ] Async interop: runtime compatibility</li> <li>[ ] Error handling: map to Result, avoid cross-boundary panics</li> <li>[ ] WASM constraints documented</li> <li>[ ] Examples and docs added</li> </ul>"},{"location":"RFCs/006_generators/","title":"RFC 006: Python-Style Generators","text":"<p>Status: Planned Created: 2024-12-10</p>"},{"location":"RFCs/006_generators/#summary","title":"Summary","text":"<p>Add Python-style generator functions to Incan, compiled to Rust 2024's <code>gen</code> blocks, enabling lazy iteration with familiar <code>yield</code> syntax.</p>"},{"location":"RFCs/006_generators/#motivation","title":"Motivation","text":"<p>Python developers expect generator functions for:</p> <ol> <li>Lazy evaluation - Process large/infinite sequences without loading all into memory</li> <li>Streaming pipelines - Chain transformations without intermediate allocations</li> <li>Stateful iteration - Encapsulate complex iteration logic elegantly</li> <li>Familiarity - <code>yield</code> in a function is a well-understood Python pattern</li> </ol> <p>With Rust 2024's <code>gen</code> blocks now stable, Incan can offer Python-style generators with zero-cost abstractions.</p>"},{"location":"RFCs/006_generators/#design","title":"Design","text":""},{"location":"RFCs/006_generators/#basic-syntax","title":"Basic Syntax","text":"<p>A function becomes a generator when it:</p> <ol> <li>Contains <code>yield</code> expressions</li> <li>Returns <code>Iterator[T]</code></li> </ol> <pre><code># Python-style generator function\ndef count_up(start: int, end: int) -&gt; Iterator[int]:\n    mut i = start\n    while i &lt; end:\n        yield i\n        i += 1\n\n# Usage: lazy iteration\nfor n in count_up(0, 1_000_000):\n    if n &gt; 100:\n        break\n    println(n)\n</code></pre>"},{"location":"RFCs/006_generators/#infinite-generators","title":"Infinite Generators","text":"<pre><code>def fibonacci() -&gt; Iterator[int]:\n    mut a, b = 0, 1\n    while true:\n        yield a\n        a, b = b, a + b\n\n# Take first 10 Fibonacci numbers\nlet fibs = fibonacci().take(10).collect()\n</code></pre>"},{"location":"RFCs/006_generators/#generators-with-filtering","title":"Generators with Filtering","text":"<pre><code>def even_numbers() -&gt; Iterator[int]:\n    mut n = 0\n    while true:\n        yield n\n        n += 2\n\ndef primes() -&gt; Iterator[int]:\n    mut n = 2\n    while true:\n        if is_prime(n):\n            yield n\n        n += 1\n</code></pre>"},{"location":"RFCs/006_generators/#generator-expressions-comprehension-like","title":"Generator Expressions (Comprehension-like)","text":"<pre><code># Existing comprehension (eager, collects to List)\nsquares = [x * x for x in range(10)]\n\n# Generator expression (lazy, returns Iterator)\nsquares_lazy = (x * x for x in range(10))\n</code></pre>"},{"location":"RFCs/006_generators/#distinction-from-fixtures","title":"Distinction from Fixtures","text":"<p>The <code>yield</code> keyword is already used for test fixtures (RFC 001). The distinction:</p> Context Return Type Behavior <code>@fixture</code> function Any <code>T</code> Setup \u2192 yield value \u2192 teardown Generator function <code>Iterator[T]</code> Lazy iteration, multiple yields <pre><code># FIXTURE: yield once for setup/teardown\n@fixture\ndef database() -&gt; Database:\n    db = Database.connect(\"test.db\")\n    yield db        # Single yield: test runs here\n    db.close()      # Teardown\n\n# GENERATOR: yield multiple values lazily\ndef read_lines(path: str) -&gt; Iterator[str]:\n    let file = File.open(path)?\n    for line in file.lines():\n        yield line  # Multiple yields: lazy iteration\n</code></pre> <p>The compiler distinguishes by:</p> <ul> <li><code>@fixture</code> decorator \u2192 fixture semantics</li> <li><code>Iterator[T]</code> return type (no <code>@fixture</code>) \u2192 generator semantics</li> </ul>"},{"location":"RFCs/006_generators/#compilation-strategy","title":"Compilation Strategy","text":"<p>Incan generators compile to Rust 2024 <code>gen</code> blocks:</p> <p>Incan:</p> <pre><code>def count_up(start: int, end: int) -&gt; Iterator[int]:\n    mut i = start\n    while i &lt; end:\n        yield i\n        i += 1\n</code></pre> <p>Generated Rust:</p> <pre><code>fn count_up(start: i64, end: i64) -&gt; impl Iterator&lt;Item = i64&gt; {\n    gen {\n        let mut i = start;\n        while i &lt; end {\n            yield i;\n            i += 1;\n        }\n    }\n}\n</code></pre>"},{"location":"RFCs/006_generators/#key-points","title":"Key Points","text":"<ol> <li><code>gen</code> block wraps the function body</li> <li><code>impl Iterator&lt;Item = T&gt;</code> return type</li> <li>State machine generated automatically by rustc</li> <li>Zero allocation for the iterator itself</li> </ol>"},{"location":"RFCs/006_generators/#iterator-methods","title":"Iterator Methods","text":"<p>Generators return standard iterators, so all iterator methods work:</p> <pre><code>def naturals() -&gt; Iterator[int]:\n    mut n = 0\n    while true:\n        yield n\n        n += 1\n\n# Chaining works naturally\nresult = (\n    naturals()\n    .filter((n) =&gt; (n % 2) == 0)  # filter even numbers\n    .map((n) =&gt; n * n)            # square the numbers\n    .take(5)\n    .collect()\n) # result = [0, 4, 16, 36, 64]\n</code></pre>"},{"location":"RFCs/006_generators/#implementation-plan","title":"Implementation Plan","text":""},{"location":"RFCs/006_generators/#phase-1-parser-changes","title":"Phase 1: Parser Changes","text":"<ol> <li>Detect <code>yield</code> in function body</li> <li>Check return type is <code>Iterator[T]</code></li> <li>Mark function as generator in AST</li> </ol> <pre><code>// AST addition\npub struct FunctionDecl {\n    // ... existing fields ...\n    pub is_generator: bool,  // NEW: detected from yield + Iterator return\n}\n</code></pre>"},{"location":"RFCs/006_generators/#phase-2-type-checker","title":"Phase 2: Type Checker","text":"<ol> <li>Verify <code>yield</code> expressions match <code>Iterator[T]</code> element type</li> <li>Error if <code>yield</code> used without <code>Iterator</code> return type (unless <code>@fixture</code>)</li> <li>Error if <code>Iterator</code> return type without <code>yield</code></li> </ol>"},{"location":"RFCs/006_generators/#phase-3-codegen","title":"Phase 3: Codegen","text":"<ol> <li>Wrap generator function bodies in <code>gen { }</code></li> <li>Transform <code>yield expr</code> to Rust <code>yield expr</code></li> <li>Return type \u2192 <code>impl Iterator&lt;Item = T&gt;</code></li> </ol>"},{"location":"RFCs/006_generators/#phase-4-generator-expressions","title":"Phase 4: Generator Expressions","text":"<p>Lower <code>(expr for x in iter)</code> to anonymous generator:</p> <pre><code>squares = (x * x for x in range(10))\n</code></pre> <p>Becomes:</p> <pre><code>squares = gen {\n    for x in (0..10) {\n        yield x * x;\n    }\n};\n</code></pre>"},{"location":"RFCs/006_generators/#examples","title":"Examples","text":""},{"location":"RFCs/006_generators/#file-processing","title":"File Processing","text":"<pre><code>def read_csv_rows(path: str) -&gt; Iterator[List[str]]:\n    \"\"\"Lazily read CSV rows without loading entire file.\"\"\"\n    file = File.open(path)?\n    for line in file.lines():\n        yield line.split(\",\")\n\n# Process million-row CSV with constant memory\nfor row in read_csv_rows(\"huge.csv\"):\n    process(row)\n</code></pre>"},{"location":"RFCs/006_generators/#pagination","title":"Pagination","text":"<pre><code>def paginate(items: List[T], page_size: int) -&gt; Iterator[List[T]]:\n    \"\"\"Yield pages of items.\"\"\"\n    mut start = 0\n    while start &lt; len(items):\n        let end = min(start + page_size, len(items))\n        yield items[start..end]\n        start = end\n\nfor page in paginate(users, 10):\n    display_page(page)\n</code></pre>"},{"location":"RFCs/006_generators/#tree-traversal","title":"Tree Traversal","text":"<pre><code>def walk_tree(node: Node) -&gt; Iterator[Node]:\n    \"\"\"Depth-first traversal.\"\"\"\n    yield node\n    for child in node.children:\n        for descendant in walk_tree(child):\n            yield descendant\n</code></pre>"},{"location":"RFCs/006_generators/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/006_generators/#1-explicit-gen-keyword","title":"1. Explicit <code>gen</code> Keyword","text":"<pre><code>def fibonacci() -&gt; Iterator[int]:\n    return gen:\n        mut a, b = 0, 1\n        while true:\n            yield a\n            a, b = b, a + b\n</code></pre> <p>Rejected: More verbose, less Pythonic. The <code>Iterator[T]</code> return type already signals generator intent.</p>"},{"location":"RFCs/006_generators/#2-separate-generator-keyword","title":"2. Separate <code>generator</code> Keyword","text":"<pre><code>generator fibonacci() -&gt; int:  # Note: no Iterator wrapper\n    mut a, b = 0, 1\n    while true:\n        yield a\n        a, b = b, a + b\n</code></pre> <p>Rejected: Deviates from Python, which uses regular <code>def</code> for generators.</p>"},{"location":"RFCs/006_generators/#3-no-generators-comprehensions-only","title":"3. No Generators (Comprehensions Only)","text":"<p>Rely on list comprehensions and explicit iterator construction.</p> <p>Rejected: Forces eager evaluation, no good story for infinite sequences.</p>"},{"location":"RFCs/006_generators/#open-questions","title":"Open Questions","text":"<ol> <li> <p>Send/receive: Should generators support <code>yield</code> receiving values (like Python's <code>gen.send()</code>)?     Likely deferred \u2014 Rust's <code>gen</code> blocks don't support this yet.</p> </li> <li> <p>Async generators: <code>async def foo() -&gt; AsyncIterator[T]</code> with <code>yield</code>.     Requires <code>async gen</code> blocks (not yet in Rust). Defer to future RFC.</p> </li> <li> <p>Early return: What happens with <code>return</code> inside a generator? Propose: terminates iteration (like Python).</p> </li> </ol>"},{"location":"RFCs/006_generators/#checklist","title":"Checklist","text":"<ul> <li>[ ] Parser: detect <code>yield</code> + <code>Iterator[T]</code> return type \u2192 mark as generator</li> <li>[ ] Type checker: validate yield types match Iterator element type</li> <li>[ ] Codegen: wrap body in <code>gen { }</code>, emit <code>impl Iterator&lt;Item = T&gt;</code></li> <li>[ ] Generator expressions: <code>(expr for x in iter)</code> syntax</li> <li>[ ] Iterator methods work on generators (<code>.map()</code>, <code>.filter()</code>, <code>.take()</code>, etc.)</li> <li>[ ] Error messages for common mistakes (yield without Iterator, etc.)</li> <li>[ ] Examples and documentation</li> <li>[ ] Integration with existing comprehensions</li> </ul>"},{"location":"RFCs/006_generators/#references","title":"References","text":"<ul> <li>Python Generators</li> <li>Rust RFC 3513: gen blocks</li> <li>Rust 1.85 gen blocks stabilization</li> </ul>"},{"location":"RFCs/007_inline_tests/","title":"RFC 007: Inline Tests","text":"<p>Status: Planned Created: 2024-12-10</p>"},{"location":"RFCs/007_inline_tests/#summary","title":"Summary","text":"<p>Allow <code>@test</code> functions to live alongside production code in the same file, combining Python's familiar decorator syntax with Rust's proximity benefits. Test functions are automatically stripped from production builds.</p>"},{"location":"RFCs/007_inline_tests/#motivation","title":"Motivation","text":""},{"location":"RFCs/007_inline_tests/#the-problem-with-separate-test-files","title":"The Problem with Separate Test Files","text":"<p>Python's convention of <code>tests/test_*.py</code> files works, but has friction:</p> <ol> <li>Context switching \u2014 Edit <code>utils.py</code>, switch to <code>test_utils.py</code>, lose mental context</li> <li>Drift \u2014 Tests get out of sync when code moves/renames</li> <li>Discoverability \u2014 New contributors don't see tests alongside code</li> <li>Small modules \u2014 Creating a separate test file for 10 lines of code feels heavyweight</li> </ol>"},{"location":"RFCs/007_inline_tests/#rusts-solution","title":"Rust's Solution","text":"<p>Rust embeds unit tests in the same file:</p> <pre><code>fn add(a: i64, b: i64) -&gt; i64 { a + b }\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_add() {\n        assert_eq!(add(1, 2), 3);\n    }\n}\n</code></pre> <p>This is stripped from release builds via <code>#[cfg(test)]</code>.</p>"},{"location":"RFCs/007_inline_tests/#incans-opportunity","title":"Incan's Opportunity","text":"<p>Combine Python's ergonomics with Rust's proximity:</p> <pre><code>def add(a: int, b: int) -&gt; int:\n    return a + b\n\n@test\ndef test_add() -&gt; None:\n    assert_eq(add(1, 2), 3)\n</code></pre>"},{"location":"RFCs/007_inline_tests/#design","title":"Design","text":""},{"location":"RFCs/007_inline_tests/#basic-syntax","title":"Basic Syntax","text":"<p>Any function decorated with <code>@test</code> is a test function:</p> <pre><code># src/math.incn\n\ndef factorial(n: int) -&gt; int:\n    if n &lt;= 1:\n        return 1\n    return n * factorial(n - 1)\n\n@test\ndef test_factorial_base() -&gt; None:\n    assert_eq(factorial(0), 1)\n    assert_eq(factorial(1), 1)\n\n@test\ndef test_factorial_recursive() -&gt; None:\n    assert_eq(factorial(5), 120)\n</code></pre>"},{"location":"RFCs/007_inline_tests/#running-tests","title":"Running Tests","text":"<pre><code># Run tests in a specific file\nincan test src/math.incn\n\n# Run all tests in directory (finds @test in all .incn files)\nincan test src/\n\n# Run tests matching pattern\nincan test -k \"factorial\" src/\n</code></pre>"},{"location":"RFCs/007_inline_tests/#build-behavior","title":"Build Behavior","text":"Command <code>@test</code> functions <code>incan build</code> Stripped (not compiled) <code>incan run</code> Stripped (not included) <code>incan test</code> Included and executed <code>incan --check</code> Type-checked but not emitted"},{"location":"RFCs/007_inline_tests/#inline-tests-with-fixtures","title":"Inline Tests with Fixtures","text":"<p>Fixtures work naturally with inline tests:</p> <pre><code># src/database.incn\n\nclass Database:\n    def connect(url: str) -&gt; Database:\n        ...\n\n    def query(self, sql: str) -&gt; List[Row]:\n        ...\n\n@fixture\ndef test_db() -&gt; Database:\n    db = Database.connect(\"sqlite::memory:\")\n    yield db\n    db.close()\n\n@test\ndef test_query(test_db: Database) -&gt; None:\n    result = test_db.query(\"SELECT 1\")\n    assert_eq(len(result), 1)\n</code></pre>"},{"location":"RFCs/007_inline_tests/#private-function-testing","title":"Private Function Testing","text":"<p>Inline tests can access private (non-<code>pub</code>) functions:</p> <pre><code># src/parser.incn\n\ndef parse(source: str) -&gt; AST:\n    tokens = _tokenize(source)  # private helper\n    return _build_ast(tokens)\n\ndef _tokenize(source: str) -&gt; List[Token]:\n    # Private implementation detail\n    ...\n\ndef _build_ast(tokens: List[Token]) -&gt; AST:\n    # Private implementation detail\n    ...\n\n# Tests can access private functions!\n@test\ndef test_tokenize() -&gt; None:\n    tokens = _tokenize(\"1 + 2\")\n    assert_eq(len(tokens), 3)\n</code></pre> <p>This mirrors Rust's <code>use super::*</code> pattern where inline tests access module internals.</p>"},{"location":"RFCs/007_inline_tests/#mixing-inline-and-separate-tests","title":"Mixing Inline and Separate Tests","text":"<p>Both approaches coexist:</p> <pre><code>project/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 math.incn           # Has @test functions inline\n\u2502   \u2514\u2500\u2500 complex_module.incn # No inline tests\n\u2514\u2500\u2500 tests/\n    \u2514\u2500\u2500 test_complex.incn   # Separate test file for complex cases\n</code></pre>"},{"location":"RFCs/007_inline_tests/#compilation-strategy","title":"Compilation Strategy","text":""},{"location":"RFCs/007_inline_tests/#detection","title":"Detection","text":"<p>During parsing, track which functions have <code>@test</code> decorator:</p> <pre><code>pub struct FunctionDecl {\n    pub name: String,\n    pub is_test: bool,  // true if @test decorated\n    // ...\n}\n</code></pre>"},{"location":"RFCs/007_inline_tests/#conditional-compilation","title":"Conditional Compilation","text":"<p>In codegen, check compilation mode:</p> <pre><code>fn emit_function(&amp;mut self, func: &amp;FunctionDecl) {\n    // Skip @test functions in production builds\n    if func.is_test &amp;&amp; !self.test_mode {\n        return;\n    }\n\n    // Emit test attribute when in test mode\n    if func.is_test {\n        self.emitter.line(\"#[test]\");\n    }\n\n    // ... rest of function emission\n}\n</code></pre>"},{"location":"RFCs/007_inline_tests/#generated-rust","title":"Generated Rust","text":"<p>Incan:</p> <pre><code>def add(a: int, b: int) -&gt; int:\n    return a + b\n\n@test\ndef test_add() -&gt; None:\n    assert_eq(add(1, 2), 3)\n</code></pre> <p>Production build (<code>incan build</code>):</p> <pre><code>fn add(a: i64, b: i64) -&gt; i64 {\n    a + b\n}\n// test_add is NOT emitted\n</code></pre> <p>Test build (<code>incan test</code>):</p> <pre><code>fn add(a: i64, b: i64) -&gt; i64 {\n    a + b\n}\n\n#[test]\nfn test_add() {\n    assert_eq!(add(1, 2), 3);\n}\n</code></pre>"},{"location":"RFCs/007_inline_tests/#examples","title":"Examples","text":""},{"location":"RFCs/007_inline_tests/#simple-unit-tests","title":"Simple Unit Tests","text":"<pre><code># src/strings.incn\n\ndef reverse(s: str) -&gt; str:\n    return s[::-1]\n\ndef is_palindrome(s: str) -&gt; bool:\n    return s == reverse(s)\n\n@test\ndef test_reverse() -&gt; None:\n    assert_eq(reverse(\"hello\"), \"olleh\")\n    assert_eq(reverse(\"\"), \"\")\n\n@test\ndef test_palindrome() -&gt; None:\n    assert_true(is_palindrome(\"radar\"))\n    assert_false(is_palindrome(\"hello\"))\n</code></pre>"},{"location":"RFCs/007_inline_tests/#with-parametrize","title":"With Parametrize","text":"<pre><code># src/validators.incn\n\ndef is_valid_email(email: str) -&gt; bool:\n    return \"@\" in email and \".\" in email\n\n@test\n@parametrize(\"email, expected\", [\n    (\"user@example.com\", true),\n    (\"invalid\", false),\n    (\"no-at.com\", false),\n    (\"user@domain\", false),\n])\ndef test_email_validation(email: str, expected: bool) -&gt; None:\n    assert_eq(is_valid_email(email), expected)\n</code></pre>"},{"location":"RFCs/007_inline_tests/#error-case-testing","title":"Error Case Testing","text":"<pre><code># src/division.incn\n\ndef safe_divide(a: int, b: int) -&gt; Result[int, str]:\n    if b == 0:\n        return Err(\"division by zero\")\n    return Ok(a / b)\n\n@test\ndef test_divide_success() -&gt; None:\n    result = safe_divide(10, 2)\n    assert_true(result.is_ok())\n    assert_eq(result.unwrap(), 5)\n\n@test\ndef test_divide_by_zero() -&gt; None:\n    result = safe_divide(10, 0)\n    assert_true(result.is_err())\n    assert_eq(result.unwrap_err(), \"division by zero\")\n</code></pre>"},{"location":"RFCs/007_inline_tests/#test-discovery","title":"Test Discovery","text":"<p>The test runner discovers tests by:</p> <ol> <li>Scanning files \u2014 Find all <code>.incn</code> files in target path</li> <li>Parsing \u2014 Look for <code>@test</code> decorated functions</li> <li>Filtering \u2014 Apply <code>-k</code> pattern if provided</li> <li>Executing \u2014 Run matching tests</li> </ol> <pre><code>$ incan test src/\n\nDiscovered 12 tests in 4 files:\n  src/math.incn: 3 tests\n  src/strings.incn: 2 tests\n  src/validators.incn: 4 tests\n  src/division.incn: 3 tests\n\nRunning tests...\n\u2713 test_factorial_base (0.001s)\n\u2713 test_factorial_recursive (0.001s)\n...\n\n12 passed, 0 failed\n</code></pre>"},{"location":"RFCs/007_inline_tests/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/007_inline_tests/#1-rust-style-test-module","title":"1. Rust-style <code>test</code> Module","text":"<pre><code>def add(a: int, b: int) -&gt; int:\n    return a + b\n\n@test_module\nmodule tests:\n    def test_add() -&gt; None:\n        assert_eq(add(1, 2), 3)\n</code></pre> <p>Rejected: More syntax to learn, less Pythonic. The <code>@test</code> decorator is simpler.</p>"},{"location":"RFCs/007_inline_tests/#2-doctest-only","title":"2. Doctest Only","text":"<pre><code>def add(a: int, b: int) -&gt; int:\n    \"\"\"\n    &gt;&gt;&gt; add(1, 2)\n    3\n    \"\"\"\n    return a + b\n</code></pre> <p>Rejected: Good for simple examples, but insufficient for complex tests with setup/teardown.</p>"},{"location":"RFCs/007_inline_tests/#3-separate-files-only-python-style","title":"3. Separate Files Only (Python-style)","text":"<p>Keep all tests in <code>tests/</code> directory.</p> <p>Rejected: Loses Rust's proximity benefits. Can still use this for integration tests.</p>"},{"location":"RFCs/007_inline_tests/#implementation-plan","title":"Implementation Plan","text":""},{"location":"RFCs/007_inline_tests/#phase-1-parser-changes","title":"Phase 1: Parser Changes","text":"<ol> <li>Recognize <code>@test</code> decorator</li> <li>Mark <code>FunctionDecl.is_test = true</code></li> <li>Track in AST for later filtering</li> </ol>"},{"location":"RFCs/007_inline_tests/#phase-2-test-runner-changes","title":"Phase 2: Test Runner Changes","text":"<ol> <li>Scan source files (not just <code>tests/</code> directory)</li> <li>Discover <code>@test</code> functions in any <code>.incn</code> file</li> <li>Include in test execution</li> </ol>"},{"location":"RFCs/007_inline_tests/#phase-3-codegen-changes","title":"Phase 3: Codegen Changes","text":"<ol> <li>Add <code>test_mode: bool</code> to codegen context</li> <li>Skip <code>@test</code> functions when <code>test_mode = false</code></li> <li>Emit <code>#[test]</code> attribute when <code>test_mode = true</code></li> </ol>"},{"location":"RFCs/007_inline_tests/#phase-4-cli-integration","title":"Phase 4: CLI Integration","text":"<ol> <li><code>incan build</code> \u2014 strips tests (default)</li> <li><code>incan test path/</code> \u2014 discovers and runs inline tests</li> <li><code>incan test -k pattern</code> \u2014 filters tests</li> </ol>"},{"location":"RFCs/007_inline_tests/#checklist","title":"Checklist","text":"<ul> <li>[ ] Parser: recognize <code>@test</code> decorator on functions</li> <li>[ ] AST: track <code>is_test</code> on <code>FunctionDecl</code></li> <li>[ ] Codegen: conditional compilation based on <code>test_mode</code></li> <li>[ ] Test runner: scan source files for <code>@test</code> functions</li> <li>[ ] Test runner: merge inline tests with <code>tests/</code> directory tests</li> <li>[ ] CLI: <code>incan test src/</code> works for inline tests</li> <li>[ ] Documentation and examples</li> <li>[ ] Verify fixtures work with inline tests</li> </ul>"},{"location":"RFCs/007_inline_tests/#references","title":"References","text":"<ul> <li>Rust Testing</li> <li>pytest Discovery</li> <li>RFC 001: Test Fixtures</li> <li>RFC 002: Parametrize</li> </ul>"},{"location":"RFCs/009_sized_integers/","title":"RFC 009: Sized Integer Types &amp; Builtin Type Registry","text":"<p>Status: Planned Created: 2024-12-11 Updated: 2024-12-23</p>"},{"location":"RFCs/009_sized_integers/#summary","title":"Summary","text":"<p>Add explicit sized integer and float types to Incan, enabling precise control over numeric representation for FFI, binary protocols, and memory-sensitive applications.</p> <p>This RFC also introduces a Builtin Type Registry infrastructure (Phase 0) that allows <code>incan_core::lang</code> registries to be the source of truth for builtin type methods, eliminating hardcoded method lookups scattered across the compiler.</p>"},{"location":"RFCs/009_sized_integers/#motivation","title":"Motivation","text":"<p>Currently, Incan has only two numeric types:</p> <ul> <li><code>int</code> \u2192 <code>i64</code> (64-bit signed)</li> <li><code>float</code> \u2192 <code>f64</code> (64-bit float)</li> </ul> <p>This simplicity is great for general-purpose code, but insufficient for:</p> <ol> <li>FFI / Rust Interop \u2014 Calling Rust functions that expect specific sizes</li> <li>Binary Protocols \u2014 Parsing network packets, file formats (PNG, MP3, etc.)</li> <li>Memory Efficiency \u2014 Large arrays where <code>i8</code> vs <code>i64</code> matters (8x difference)</li> <li>Hardware Interfaces \u2014 GPIO pins, registers, embedded systems</li> <li>Cryptography \u2014 Exact bit-width operations</li> </ol>"},{"location":"RFCs/009_sized_integers/#example-problem","title":"Example Problem","text":"<pre><code># Current: Can't express this cleanly\nfrom rust::std::net import TcpStream\n\n# TcpStream::connect expects &amp;str, but port is u16 internally\n# How do we work with u16 port numbers?\n</code></pre>"},{"location":"RFCs/009_sized_integers/#design","title":"Design","text":""},{"location":"RFCs/009_sized_integers/#new-types","title":"New Types","text":"Incan Type Rust Type Description <code>i8</code> <code>i8</code> 8-bit signed (-128 to 127) <code>i16</code> <code>i16</code> 16-bit signed <code>i32</code> <code>i32</code> 32-bit signed <code>i64</code> <code>i64</code> 64-bit signed (same as <code>int</code>) <code>i128</code> <code>i128</code> 128-bit signed <code>u8</code> <code>u8</code> 8-bit unsigned (0 to 255) <code>u16</code> <code>u16</code> 16-bit unsigned <code>u32</code> <code>u32</code> 32-bit unsigned <code>u64</code> <code>u64</code> 64-bit unsigned <code>u128</code> <code>u128</code> 128-bit unsigned <code>f32</code> <code>f32</code> 32-bit float <code>f64</code> <code>f64</code> 64-bit float (same as <code>float</code>) <code>isize</code> <code>isize</code> Pointer-sized signed <code>usize</code> <code>usize</code> Pointer-sized unsigned"},{"location":"RFCs/009_sized_integers/#type-aliases-preserved","title":"Type Aliases (Preserved)","text":"<p>The existing <code>int</code> and <code>float</code> remain as aliases:</p> <pre><code># These are equivalent\nx: int    # Preferred for general code\nx: i64    # Explicit when size matters\n\ny: float  # Preferred for general code  \ny: f64    # Explicit when size matters\n</code></pre>"},{"location":"RFCs/009_sized_integers/#literals","title":"Literals","text":""},{"location":"RFCs/009_sized_integers/#without-suffix-default","title":"Without Suffix (Default)","text":"<p>Unsuffixed literals infer type from context, defaulting to <code>int</code>/<code>float</code>:</p> <pre><code>let x = 42        # int (i64)\nlet y = 3.14      # float (f64)\nlet z: i32 = 42   # i32 (from annotation)\n</code></pre>"},{"location":"RFCs/009_sized_integers/#with-suffix-explicit","title":"With Suffix (Explicit)","text":"<pre><code>let a = 42i8      # i8\nlet b = 42u16     # u16\nlet c = 42i32     # i32\nlet d = 42u64     # u64\nlet e = 3.14f32   # f32\nlet f = 255u8     # u8\n</code></pre>"},{"location":"RFCs/009_sized_integers/#conversions","title":"Conversions","text":""},{"location":"RFCs/009_sized_integers/#explicit-casting-required","title":"Explicit Casting Required","text":"<p>No implicit narrowing \u2014 all conversions are explicit:</p> <pre><code>let big: i64 = 1000\nlet small: i16 = big as i16        # Explicit cast (may truncate)\nlet safe: i16 = i16.try_from(big)? # Safe conversion (returns Result)\n</code></pre>"},{"location":"RFCs/009_sized_integers/#conversion-functions","title":"Conversion Functions","text":"<pre><code># Fallible conversions (return Result)\nlet x: Result[i16, ConversionError] = i16.try_from(big_value)\n\n# Infallible widening (always safe)\nlet wide: i64 = i64.from(small_value)  # i16 -&gt; i64 always works\n\n# Truncating cast (use with caution)\nlet truncated: i8 = big_value as i8    # May lose data\n</code></pre>"},{"location":"RFCs/009_sized_integers/#arithmetic","title":"Arithmetic","text":"<p>Same-type operations return the same type:</p> <pre><code>let a: i32 = 10\nlet b: i32 = 20\nlet c: i32 = a + b  # i32\n\n# Mixed types require explicit conversion\nlet x: i32 = 10\nlet y: i64 = 20\nlet z = x as i64 + y  # Must convert first\n</code></pre>"},{"location":"RFCs/009_sized_integers/#overflow-behavior","title":"Overflow Behavior","text":"<p>Follow Rust's behavior:</p> <ul> <li>Debug builds: Panic on overflow</li> <li>Release builds: Wrap (two's complement)</li> </ul> <p>Explicit wrapping/saturating operations available:</p> <pre><code>let x: u8 = 255\nlet y = x.wrapping_add(1)    # 0 (wrapped)\nlet z = x.saturating_add(1)  # 255 (saturated)\nlet w = x.checked_add(1)     # None (overflow detected)\n</code></pre>"},{"location":"RFCs/009_sized_integers/#examples","title":"Examples","text":""},{"location":"RFCs/009_sized_integers/#binary-protocol-parsing","title":"Binary Protocol Parsing","text":"<pre><code>def parse_header(data: bytes) -&gt; Result[Header, ParseError]:\n    if len(data) &lt; 8:\n        return Err(ParseError.TooShort)\n\n    let magic: u32 = u32.from_le_bytes(data[0..4])\n    let version: u16 = u16.from_le_bytes(data[4..6])\n    let flags: u8 = data[6]\n    let reserved: u8 = data[7]\n\n    return Ok(Header(magic, version, flags))\n</code></pre>"},{"location":"RFCs/009_sized_integers/#network-port-handling","title":"Network Port Handling","text":"<pre><code>def connect(host: str, port: u16) -&gt; Result[Connection, IoError]:\n    let addr = f\"{host}:{port}\"\n    return Connection.open(addr)\n\n# Usage\nlet conn = connect(\"localhost\", 8080u16)?\n</code></pre>"},{"location":"RFCs/009_sized_integers/#memory-efficient-arrays","title":"Memory-Efficient Arrays","text":"<pre><code># Image pixel data - 3 bytes per pixel instead of 24\nmodel Pixel:\n    r: u8\n    g: u8\n    b: u8\n\nlet image: List[Pixel] = load_image(\"photo.png\")\n</code></pre>"},{"location":"RFCs/009_sized_integers/#bit-manipulation","title":"Bit Manipulation","text":"<pre><code>def set_bit(value: u32, bit: u8) -&gt; u32:\n    return value | (1u32 &lt;&lt; bit)\n\ndef clear_bit(value: u32, bit: u8) -&gt; u32:\n    return value &amp; ~(1u32 &lt;&lt; bit)\n\ndef test_bit(value: u32, bit: u8) -&gt; bool:\n    return (value &amp; (1u32 &lt;&lt; bit)) != 0\n</code></pre>"},{"location":"RFCs/009_sized_integers/#implementation-plan","title":"Implementation Plan","text":""},{"location":"RFCs/009_sized_integers/#phase-0-builtin-type-registry","title":"Phase 0: Builtin Type Registry","text":"<p>Before adding new types, establish registry-first infrastructure so the compiler has a single source of truth for:</p> <ul> <li>builtin type spellings (e.g. <code>i32</code>, <code>u8</code>)</li> <li>builtin/surface method vocabulary (e.g. <code>str.upper()</code>, <code>List.append()</code>)</li> <li>metadata like \u201cintroduced in RFC\u201d, stability, and docs</li> </ul> <p>Current crate layout note: in the current workspace, canonical language vocabulary lives in:</p> <ul> <li><code>crates/incan_core/src/lang/types/*</code> for builtin type names</li> <li><code>crates/incan_core/src/lang/surface/*</code> for method/function/type \u201csurface\u201d vocabulary</li> <li><code>crates/incan_syntax</code> for lexer/token/parsing (syntax), consuming registries where appropriate</li> </ul> <p>So Phase 0 should be implemented by extending these registries and migrating compiler call sites to consult them, rather than parsing <code>incan_stdlib</code> source code.</p>"},{"location":"RFCs/009_sized_integers/#problem","title":"Problem","text":"<p>Currently, builtin type methods (e.g., <code>str.upper()</code>, <code>List.append()</code>, <code>FrozenStr.len()</code>) are hardcoded in multiple places:</p> <ul> <li><code>src/frontend/typechecker/check_expr/access.rs</code> \u2014 method return types</li> <li><code>src/backend/ir/emit/mod.rs</code> \u2014 code generation</li> <li><code>src/backend/ir/emit/expressions/methods.rs</code> \u2014 method emission</li> </ul> <p>This creates triple maintenance burden and increases drift risk between docs/spec/compiler behavior.</p>"},{"location":"RFCs/009_sized_integers/#solution","title":"Solution","text":"<ol> <li> <p>Define method vocab in <code>incan_core</code> (source of truth):</p> <ul> <li><code>crates/incan_core/src/lang/surface/methods.rs</code> (surface method vocab registries; re-exported as   <code>incan_core::lang::surface::{string_methods, list_methods, dict_methods, ...}</code> for stable import paths)</li> <li>For sized integer methods, add a new registry section within <code>methods.rs</code> (or a sibling module re-exported from   <code>crates/incan_core/src/lang/surface/mod.rs</code> if it grows too large)</li> </ul> </li> <li> <p>Compiler consumes registries instead of string matches:</p> <ul> <li>Typechecker consults the registries to determine allowed methods and return types.</li> <li>Backend/codegen consults the same registries (or enum/ID mapping derived from them) to emit method calls.</li> </ul> </li> <li> <p>Guardrails</p> <ul> <li>Add tests that ensure registry uniqueness and prevent drift with lexer/parser expectations (parity checks).</li> </ul> </li> </ol>"},{"location":"RFCs/009_sized_integers/#benefits","title":"Benefits","text":"<ul> <li>Single source of truth: <code>incan_core</code> defines the language surface vocabulary.</li> <li>No hardcoding: typechecker and emitter read from registries.</li> <li>Extensibility: adding a method is a single edit in <code>incan_core::lang::surface</code>.</li> <li>Documentation: reference docs can be generated from registries.</li> </ul>"},{"location":"RFCs/009_sized_integers/#scope","title":"Scope","text":"<p>Phase 0 covers:</p> <ul> <li>Registry infrastructure (IDs + metadata tables + docs generation + guardrails)</li> <li>Migration of existing hardcoded types:<ul> <li><code>str</code>, <code>bytes</code></li> <li><code>List</code>, <code>Dict</code>, <code>Set</code></li> <li><code>FrozenStr</code>, <code>FrozenBytes</code></li> <li><code>FrozenList</code>, <code>FrozenSet</code>, <code>FrozenDict</code></li> </ul> </li> <li>Foundation for sized integer methods in Phase 5</li> </ul>"},{"location":"RFCs/009_sized_integers/#phase-1-lexer","title":"Phase 1: Lexer","text":"<p>Add token recognition for:</p> <ul> <li>Type names: <code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>i128</code>, <code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>u128</code>, <code>f32</code>, <code>isize</code>, <code>usize</code></li> <li>Literal suffixes: <code>42i32</code>, <code>255u8</code>, <code>3.14f32</code></li> </ul>"},{"location":"RFCs/009_sized_integers/#phase-2-parser","title":"Phase 2: Parser","text":"<ul> <li>Parse sized type annotations</li> <li>Parse suffixed numeric literals</li> </ul>"},{"location":"RFCs/009_sized_integers/#phase-3-type-checker","title":"Phase 3: Type Checker","text":"<ul> <li>Add sized integer types to type system</li> <li>Enforce explicit conversions (no implicit narrowing)</li> <li>Type inference for unsuffixed literals</li> <li>Use builtin registry (from Phase 0) for method lookups</li> </ul>"},{"location":"RFCs/009_sized_integers/#phase-4-codegen","title":"Phase 4: Codegen","text":"<ul> <li>Map types directly to Rust equivalents</li> <li>Emit proper literal suffixes</li> <li>Generate conversion code</li> <li>Use builtin registry for method emission</li> </ul>"},{"location":"RFCs/009_sized_integers/#phase-5-standard-library","title":"Phase 5: Standard Library","text":"<ul> <li>Add conversion methods (<code>try_from</code>, <code>from</code>, <code>as</code>) to registry</li> <li>Add byte conversion methods (<code>from_le_bytes</code>, <code>to_be_bytes</code>, etc.) to registry</li> <li>Add overflow-handling methods (<code>wrapping_add</code>, <code>saturating_sub</code>, etc.) to registry</li> <li>Implement corresponding Rust methods in <code>incan_stdlib</code></li> </ul>"},{"location":"RFCs/009_sized_integers/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/009_sized_integers/#1-only-add-when-needed-via-rust-interop","title":"1. Only Add When Needed via Rust Interop","text":"<pre><code>from rust::std::primitive import i16, u8\n</code></pre> <p>Rejected: Awkward syntax, doesn't integrate well with literals.</p>"},{"location":"RFCs/009_sized_integers/#2-python-style-arbitrary-precision","title":"2. Python-Style Arbitrary Precision","text":"<p>Python's <code>int</code> is arbitrary precision. We could do the same.</p> <p>Rejected: Doesn't help with FFI, binary protocols, or memory efficiency. Also has performance overhead.</p>"},{"location":"RFCs/009_sized_integers/#3-wrapper-types-only","title":"3. Wrapper Types Only","text":"<pre><code>newtype Port = u16  # Define in stdlib\n</code></pre> <p>Rejected: Still need the underlying sized types.</p>"},{"location":"RFCs/009_sized_integers/#4-c-style-type-names","title":"4. C-Style Type Names","text":"<pre><code>let x: short = 10      # i16\nlet y: unsigned int = 20  # u32\n</code></pre> <p>Rejected: Verbose, platform-dependent sizes in C, Rust-style is clearer.</p>"},{"location":"RFCs/009_sized_integers/#open-questions","title":"Open Questions","text":"<ol> <li>Literal inference: Should <code>let x: u8 = 256</code> be a compile error or runtime panic?</li> <li> <p>Proposal: Compile error for out-of-range literals</p> </li> <li> <p>Default integer type: Keep <code>int</code> as <code>i64</code> or make it platform-dependent like <code>isize</code>?</p> </li> <li> <p>Proposal: Keep as <code>i64</code> for predictability</p> </li> <li> <p>Char type: Add <code>char</code> as a separate type (Rust's 4-byte Unicode scalar)?</p> </li> <li> <p>Proposal: Defer to separate RFC</p> </li> <li> <p>SIMD types: Should we include <code>i8x16</code>, <code>f32x4</code> etc?</p> </li> <li> <p>Proposal: Defer to separate RFC for SIMD</p> </li> <li> <p>List/array indexing: How should <code>int</code> work with indexing?</p> </li> <li>Problem: <code>arr[i]</code> where <code>i: int</code> fails in Rust (needs <code>usize</code>)</li> <li>Option A: Auto-coerce <code>int</code> \u2192 <code>usize</code> in indexing context (ergonomic, implicit)</li> <li>Option B: Require explicit cast <code>arr[i as usize]</code> (explicit, verbose)</li> <li>Option C: Make <code>range()</code> return <code>usize</code> (natural for loops, but breaks if used elsewhere)</li> <li>Proposal: Option A \u2014 compiler inserts <code>as usize</code> for indexing; matches Python's ergonomics</li> </ol>"},{"location":"RFCs/009_sized_integers/#checklist","title":"Checklist","text":""},{"location":"RFCs/009_sized_integers/#phase-0-builtin-type-registry-checklist","title":"Phase 0: Builtin Type Registry (checklist)","text":"<ul> <li>[ ] Extend <code>incan_core::lang::types</code> with sized type vocabulary (<code>i8</code>, <code>u16</code>, <code>f32</code>, <code>usize</code>, ...)</li> <li>[ ] Extend <code>incan_core::lang::surface</code> with sized integer method vocabulary (new registry module)</li> <li>[ ] Typechecker: consult <code>incan_core::lang::surface</code> registries for method typing</li> <li>[ ] Backend: consult <code>incan_core::lang::surface</code> registries (or enum mapping) for method emission</li> <li>[ ] Migrate <code>str</code> methods from hardcoded to registry</li> <li>[ ] Migrate <code>bytes</code> methods from hardcoded to registry</li> <li>[ ] Migrate <code>List</code> methods from hardcoded to registry</li> <li>[ ] Migrate <code>Dict</code> methods from hardcoded to registry</li> <li>[ ] Migrate <code>Set</code> methods from hardcoded to registry</li> <li>[ ] Migrate <code>FrozenStr</code> methods from hardcoded to registry</li> <li>[ ] Migrate <code>FrozenBytes</code> methods from hardcoded to registry</li> <li>[ ] Migrate <code>FrozenList</code>/<code>FrozenSet</code>/<code>FrozenDict</code> methods from hardcoded to registry</li> <li>[ ] Update emitter to use registry for method emission</li> <li>[ ] Remove hardcoded method matches from <code>check_expr/access.rs</code></li> <li>[ ] Remove hardcoded method matches from <code>emit/mod.rs</code></li> </ul>"},{"location":"RFCs/009_sized_integers/#phase-1-4-sized-types","title":"Phase 1-4: Sized Types","text":"<ul> <li>[ ] Lexer: recognize sized type names</li> <li>[ ] Lexer: parse literal suffixes (<code>42i32</code>, <code>3.14f32</code>)</li> <li>[ ] Parser: sized type annotations</li> <li>[ ] Type checker: sized integer types in type system</li> <li>[ ] Type checker: enforce explicit conversions</li> <li>[ ] Type checker: literal range checking</li> <li>[ ] Codegen: emit proper Rust types</li> <li>[ ] Codegen: emit literal suffixes</li> <li>[ ] Codegen: auto-coerce <code>int</code> \u2192 <code>usize</code> for list indexing</li> </ul>"},{"location":"RFCs/009_sized_integers/#phase-5-standard-library-methods","title":"Phase 5: Standard Library Methods","text":"<ul> <li>[ ] Stdlib: add sized type interface traits (<code>I8Methods</code>, <code>U16Methods</code>, etc.)</li> <li>[ ] Stdlib: conversion methods (<code>try_from</code>, <code>from</code>)</li> <li>[ ] Stdlib: byte conversion methods (<code>from_le_bytes</code>, <code>to_be_bytes</code>, etc.)</li> <li>[ ] Stdlib: overflow-handling methods (<code>wrapping_add</code>, <code>saturating_sub</code>, etc.)</li> </ul>"},{"location":"RFCs/009_sized_integers/#documentation","title":"Documentation","text":"<ul> <li>[ ] Documentation update</li> <li>[ ] Examples</li> </ul>"},{"location":"RFCs/009_sized_integers/#references","title":"References","text":"<ul> <li>Rust Primitive Types</li> <li>Rust Integer Overflow</li> <li>Python struct module (for comparison)</li> </ul>"},{"location":"RFCs/010_tempfile/","title":"RFC 010: Temporary Files and Directories","text":"<p>Status: Draft Created: 2024-12-11</p>"},{"location":"RFCs/010_tempfile/#summary","title":"Summary","text":"<p>Add <code>TempFile</code> and <code>TempDir</code> types for creating temporary files and directories that are automatically cleaned up when they go out of scope.</p>"},{"location":"RFCs/010_tempfile/#motivation","title":"Motivation","text":"<p>Temporary files are essential for:</p> <ul> <li>Testing (create fixtures, verify file operations)</li> <li>Safe file updates (write to temp, then rename)</li> <li>Processing pipelines (intermediate results)</li> <li>Caching and scratch space</li> </ul> <p>Python provides <code>tempfile.NamedTemporaryFile</code> and <code>tempfile.TemporaryDirectory</code>. Rust has the widely-used <code>tempfile</code> crate. Incan should provide similar ergonomic temporary file handling.</p>"},{"location":"RFCs/010_tempfile/#python-comparison","title":"Python Comparison","text":"<pre><code>import tempfile\n\n# Python - context manager pattern\nwith tempfile.NamedTemporaryFile(delete=True) as f:\n    f.write(b\"data\")\n    # use f.name to get path\n# file deleted here\n\nwith tempfile.TemporaryDirectory() as d:\n    path = Path(d) / \"config.toml\"\n    path.write_text(\"...\")\n# directory deleted here\n</code></pre> <p>Incan should provide this with RAII instead of context managers.</p>"},{"location":"RFCs/010_tempfile/#design","title":"Design","text":""},{"location":"RFCs/010_tempfile/#tempfile","title":"TempFile","text":"<pre><code># Create a temporary file\ntemp = TempFile.new()?\n\n# Write to it\ntemp.write_text(\"some data\")?\n\n# Get the path (for passing to other functions)\npath = temp.path()\nprocess_file(path)\n\n# File is automatically deleted when `temp` goes out of scope\n</code></pre>"},{"location":"RFCs/010_tempfile/#tempdir","title":"TempDir","text":"<pre><code># Create a temporary directory\ntemp_dir = TempDir.new()?\n\n# Create files inside it\nconfig = temp_dir.path() / \"config.toml\"\nconfig.write_text(default_config)?\n\ndata_dir = temp_dir.path() / \"data\"\ndata_dir.mkdir()?\n\n# Entire directory tree deleted when `temp_dir` goes out of scope\n</code></pre>"},{"location":"RFCs/010_tempfile/#named-temporary-files","title":"Named Temporary Files","text":"<p>For cases where you need a specific suffix/prefix:</p> <pre><code># With custom suffix\ntemp = TempFile.with_suffix(\".json\")?\n\n# With custom prefix\ntemp = TempFile.with_prefix(\"download_\")?\n\n# With both\ntemp = TempFile.builder()\n    .prefix(\"report_\")\n    .suffix(\".pdf\")\n    .build()?\n</code></pre>"},{"location":"RFCs/010_tempfile/#persistence-keep-on-drop","title":"Persistence (Keep on Drop)","text":"<p>Sometimes you want to create a temp file but keep it:</p> <pre><code>temp = TempFile.new()?\ntemp.write_text(data)?\n\n# Keep the file - returns the Path and prevents deletion\nfinal_path = temp.persist()?\nprintln(f\"Saved to: {final_path}\")\n</code></pre>"},{"location":"RFCs/010_tempfile/#explicit-location","title":"Explicit Location","text":"<p>Create temp files in a specific directory:</p> <pre><code># In a specific directory\ntemp = TempFile.in_dir(Path(\"/var/cache/myapp\"))?\n\n# In system temp directory (default)\ntemp = TempFile.new()?  # Uses system temp dir\n</code></pre>"},{"location":"RFCs/010_tempfile/#api-reference","title":"API Reference","text":""},{"location":"RFCs/010_tempfile/#tempfile-methods","title":"TempFile Methods","text":"Method Returns Description <code>TempFile.new()</code> <code>Result[TempFile, IoError]</code> Create temp file in system temp dir <code>TempFile.with_suffix(s)</code> <code>Result[TempFile, IoError]</code> Create with file extension <code>TempFile.with_prefix(s)</code> <code>Result[TempFile, IoError]</code> Create with filename prefix <code>TempFile.in_dir(p)</code> <code>Result[TempFile, IoError]</code> Create in specific directory <code>t.path()</code> <code>Path</code> Get the file's path <code>t.write_text(s)</code> <code>Result[None, IoError]</code> Write string <code>t.write_bytes(b)</code> <code>Result[None, IoError]</code> Write bytes <code>t.read_text()</code> <code>Result[str, IoError]</code> Read as string <code>t.persist()</code> <code>Result[Path, IoError]</code> Keep file, return path"},{"location":"RFCs/010_tempfile/#tempdir-methods","title":"TempDir Methods","text":"Method Returns Description <code>TempDir.new()</code> <code>Result[TempDir, IoError]</code> Create temp directory <code>TempDir.with_prefix(s)</code> <code>Result[TempDir, IoError]</code> Create with name prefix <code>TempDir.in_dir(p)</code> <code>Result[TempDir, IoError]</code> Create in specific parent <code>d.path()</code> <code>Path</code> Get the directory's path <code>d.persist()</code> <code>Result[Path, IoError]</code> Keep directory, return path"},{"location":"RFCs/010_tempfile/#implementation","title":"Implementation","text":""},{"location":"RFCs/010_tempfile/#vocabulary-crate-layout-note","title":"Vocabulary / crate layout note","text":"<p>In the current workspace, user-facing vocabulary is centralized in <code>incan_core</code>. This RFC introduces new surface types and methods, so the canonical spellings should be registered in:</p> <ul> <li><code>crates/incan_core/src/lang/surface/types.rs</code> (add <code>TempFile</code>, <code>TempDir</code>)</li> <li>Add method names to <code>crates/incan_core/src/lang/surface/methods.rs</code> (consolidated surface method registries),     e.g. a <code>tempfile_methods</code> registry for <code>TempFile</code>/<code>TempDir</code> methods like <code>new</code>, <code>with_suffix</code>, <code>persist</code>, etc.</li> </ul>"},{"location":"RFCs/010_tempfile/#backend","title":"Backend","text":"<p>Map to the Rust <code>tempfile</code> crate:</p> <ul> <li><code>TempFile</code> \u2192 <code>tempfile::NamedTempFile</code></li> <li><code>TempDir</code> \u2192 <code>tempfile::TempDir</code></li> </ul> <p>Add <code>tempfile</code> to generated <code>Cargo.toml</code> when these types are used.</p>"},{"location":"RFCs/010_tempfile/#generated-code","title":"Generated Code","text":"<pre><code>temp = TempFile.new()?\ntemp.write_text(\"data\")?\n</code></pre> <p>Generates:</p> <pre><code>let temp = tempfile::NamedTempFile::new()?;\nstd::fs::write(temp.path(), \"data\")?;\n</code></pre>"},{"location":"RFCs/010_tempfile/#use-cases","title":"Use Cases","text":""},{"location":"RFCs/010_tempfile/#testing","title":"Testing","text":"<pre><code>def test_config_loading():\n    temp = TempFile.with_suffix(\".toml\")?\n    temp.write_text(\"\"\"\n        [server]\n        host = \"localhost\"\n        port = 8080\n    \"\"\")?\n\n    config = load_config(temp.path())?\n    assert config.server.port == 8080\n    # temp file cleaned up after test\n</code></pre>"},{"location":"RFCs/010_tempfile/#safe-file-updates","title":"Safe File Updates","text":"<pre><code>def safe_save(path: Path, content: str) -&gt; Result[None, IoError]:\n    # Write to temp file first\n    temp = TempFile.in_dir(path.parent())?\n    temp.write_text(content)?\n\n    # Atomic rename (same filesystem)\n    temp.persist()?.rename(path)?\n    return Ok(None)\n</code></pre>"},{"location":"RFCs/010_tempfile/#download-with-cleanup","title":"Download with Cleanup","text":"<pre><code>async def process_download(url: str) -&gt; Result[Data, AppError]:\n    temp = TempFile.with_suffix(\".zip\")?\n\n    # Download to temp file\n    await download_to(url, temp.path())?\n\n    # Process\n    data = extract_and_parse(temp.path())?\n\n    return Ok(data)\n    # temp file deleted even if extraction fails\n</code></pre>"},{"location":"RFCs/010_tempfile/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/010_tempfile/#1-functions-instead-of-types","title":"1. Functions Instead of Types","text":"<pre><code>path = create_temp_file()?\n# ... use path ...\nremove(path)?  # Manual cleanup\n</code></pre> <p>Rejected: Easy to forget cleanup, especially on error paths.</p>"},{"location":"RFCs/010_tempfile/#2-context-manager-syntax","title":"2. Context Manager Syntax","text":"<pre><code>with TempFile.new() as temp:\n    temp.write_text(\"data\")?\n</code></pre> <p>Rejected: Incan prefers RAII over explicit context managers. The type-based approach is more Rust-like and ensures cleanup even without <code>with</code>.</p>"},{"location":"RFCs/010_tempfile/#open-questions","title":"Open Questions","text":"<ol> <li> <p>Should TempFile implement File trait? Could allow <code>temp.lines()</code>, <code>temp.read_all()</code>, etc.</p> </li> <li> <p>Secure temp files? The <code>tempfile</code> crate provides secure creation (avoids race conditions).     Should we expose options for this?</p> </li> <li> <p>Memory-backed temp files? For small files, an in-memory option could be faster. Worth adding <code>TempFile.in_memory()</code>?</p> </li> </ol>"},{"location":"RFCs/010_tempfile/#references","title":"References","text":"<ul> <li>Python tempfile module</li> <li>Rust tempfile crate</li> <li>RAII pattern</li> </ul>"},{"location":"RFCs/011_fstring_error_spans/","title":"RFC 011: Precise Error Spans in F-Strings","text":"<p>Status: Planned</p>"},{"location":"RFCs/011_fstring_error_spans/#summary","title":"Summary","text":"<p>Improve error messages for f-string interpolation expressions to point to the specific <code>{expr}</code> that caused the error, rather than the entire f-string.</p>"},{"location":"RFCs/011_fstring_error_spans/#motivation","title":"Motivation","text":"<p>Currently, when an error occurs in an f-string expression like:</p> <pre><code>println(f\"[Producer {id}] Sending message {i}\")\n</code></pre> <p>The error points to the entire f-string:</p> <pre><code>type error: Unknown symbol 'i'\n  --&gt; file.incn:16:17\n     |\n  16 |         println(f\"[Producer {id}] Sending message {i}\")\n     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre> <p>Ideally, it should point directly to <code>{i}</code>:</p> <pre><code>type error: Unknown symbol 'i'\n  --&gt; file.incn:16:49\n     |\n  16 |         println(f\"[Producer {id}] Sending message {i}\")\n     |                                                   ^^^\n</code></pre>"},{"location":"RFCs/011_fstring_error_spans/#current-implementation","title":"Current Implementation","text":"<p>The lexer stores f-string parts without position information:</p> <pre><code>pub enum FStringPart {\n    Literal(String),\n    Expr(String),  // Just the expression text, no offset\n}\n</code></pre> <p>The parser uses the f-string token's span for all expression parts.</p>"},{"location":"RFCs/011_fstring_error_spans/#proposed-changes","title":"Proposed Changes","text":""},{"location":"RFCs/011_fstring_error_spans/#1-lexer-changes","title":"1. Lexer Changes","text":"<p>Add offset tracking to <code>FStringPart</code>:</p> <pre><code>pub enum FStringPart {\n    Literal(String),\n    Expr {\n        text: String,\n        offset: usize,  // Byte offset from start of f-string content\n    },\n}\n</code></pre> <p>Update <code>scan_fstring()</code> to track the current offset within the f-string and store it with each expression.</p>"},{"location":"RFCs/011_fstring_error_spans/#2-parser-changes","title":"2. Parser Changes","text":"<p>Update <code>convert_fstring_parts()</code> to compute precise spans:</p> <pre><code>fn convert_fstring_parts(&amp;self, parts: &amp;[LexFStringPart], fstring_start: usize) -&gt; Vec&lt;FStringPart&gt; {\n    parts.iter().map(|p| match p {\n        LexFStringPart::Expr { text, offset } =&gt; {\n            let start = fstring_start + offset;\n            let end = start + text.len() + 2; // +2 for { }\n            FStringPart::Expr(Spanned::new(expr, Span::new(start, end)))\n        }\n        // ...\n    })\n}\n</code></pre>"},{"location":"RFCs/011_fstring_error_spans/#complexity","title":"Complexity","text":"<p>~40 lines of changes across:</p> <ul> <li><code>crates/incan_syntax/src/lexer/strings.rs</code> - Track offsets in <code>scan_fstring()</code></li> <li><code>crates/incan_syntax/src/ast.rs</code> - Update <code>FStringPart</code> (if needed)</li> <li><code>crates/incan_syntax/src/parser.rs</code> - Compute precise spans</li> </ul>"},{"location":"RFCs/011_fstring_error_spans/#priority","title":"Priority","text":"<p>Low - The current implementation (pointing to the f-string) is already usable. This is a polish improvement.</p>"},{"location":"RFCs/011_fstring_error_spans/#references","title":"References","text":"<ul> <li>Issue discovered while testing various examples</li> <li>Current fix: Use f-string token span instead of <code>Span::default()</code></li> </ul>"},{"location":"RFCs/012_json_value/","title":"RFC 012: JsonValue Type for Dynamic JSON","text":"<p>Status: Draft</p>"},{"location":"RFCs/012_json_value/#summary","title":"Summary","text":"<p>Add a <code>JsonValue</code> type for handling JSON with unknown or varying structure at runtime.</p>"},{"location":"RFCs/012_json_value/#motivation","title":"Motivation","text":"<p>Currently, Incan requires defining models with <code>@derive(Serialize, Deserialize)</code> for JSON handling. This works well for known, fixed schemas but falls short for:</p> <ol> <li>Dynamic APIs \u2014 APIs that return varying structures depending on context</li> <li>Exploration \u2014 Prototyping without defining full models</li> <li>Partial parsing \u2014 Extracting specific fields from large JSON without modeling everything</li> <li>Mixed schemas \u2014 JSON where some parts are typed and others are dynamic</li> </ol>"},{"location":"RFCs/012_json_value/#current-approach-works","title":"Current Approach (Works)","text":"<pre><code>@derive(Serialize, Deserialize)\nmodel User:\n    name: str\n    age: int\n\nuser = User.from_json(json_str)?\nprintln(user.name)\n</code></pre>"},{"location":"RFCs/012_json_value/#proposed-addition","title":"Proposed Addition","text":"<pre><code># Parse unknown JSON\ndata = JsonValue.parse(json_str)?\n\n# Access dynamically\nname = data[\"user\"][\"name\"].as_str()\ncount = data[\"count\"].as_int()\nitems = data[\"items\"].as_list()\n\n# Check types at runtime\nif data[\"field\"].is_string():\n    println(data[\"field\"].as_str())\n</code></pre>"},{"location":"RFCs/012_json_value/#detailed-design","title":"Detailed Design","text":""},{"location":"RFCs/012_json_value/#jsonvalue-type","title":"JsonValue Type","text":"<p><code>JsonValue</code> is an enum representing any JSON value:</p> <pre><code>enum JsonValue:\n    Null\n    Bool(bool)\n    Int(int)\n    Float(float)\n    String(str)\n    Array(List[JsonValue])\n    Object(Dict[str, JsonValue])\n</code></pre>"},{"location":"RFCs/012_json_value/#constructors","title":"Constructors","text":"<pre><code># Parse from string\nvalue = JsonValue.parse(json_str) -&gt; Result[JsonValue, str]\n\n# Create values directly\nnull_val = JsonValue.null()\nbool_val = JsonValue.bool(true)\nint_val = JsonValue.int(42)\nstr_val = JsonValue.string(\"hello\")\narr_val = JsonValue.array([val1, val2])\nobj_val = JsonValue.object({\"key\": value})\n</code></pre>"},{"location":"RFCs/012_json_value/#access-methods","title":"Access Methods","text":"<pre><code># Type checking\nvalue.is_null() -&gt; bool\nvalue.is_bool() -&gt; bool\nvalue.is_int() -&gt; bool\nvalue.is_float() -&gt; bool\nvalue.is_string() -&gt; bool\nvalue.is_array() -&gt; bool\nvalue.is_object() -&gt; bool\n\n# Value extraction (returns Option)\nvalue.as_bool() -&gt; Option[bool]\nvalue.as_int() -&gt; Option[int]\nvalue.as_float() -&gt; Option[float]\nvalue.as_str() -&gt; Option[str]\nvalue.as_array() -&gt; Option[List[JsonValue]]\nvalue.as_object() -&gt; Option[Dict[str, JsonValue]]\n</code></pre>"},{"location":"RFCs/012_json_value/#indexing","title":"Indexing","text":"<pre><code># Object field access\nvalue[\"key\"] -&gt; JsonValue  # Returns JsonValue.Null if missing\n\n# Array index access\nvalue[0] -&gt; JsonValue  # Returns JsonValue.Null if out of bounds\n\n# Chained access\nvalue[\"user\"][\"address\"][\"city\"].as_str()\n</code></pre>"},{"location":"RFCs/012_json_value/#serialization","title":"Serialization","text":"<pre><code>value.to_json() -&gt; str  # Serialize back to JSON string\n</code></pre>"},{"location":"RFCs/012_json_value/#rust-implementation","title":"Rust Implementation","text":"<p>Maps to <code>serde_json::Value</code>:</p> <pre><code>pub type JsonValue = serde_json::Value;\n\nimpl JsonValue {\n    pub fn parse(s: &amp;str) -&gt; Result&lt;Self, String&gt; {\n        serde_json::from_str(s).map_err(|e| e.to_string())\n    }\n\n    pub fn is_null(&amp;self) -&gt; bool { self.is_null() }\n    pub fn as_str(&amp;self) -&gt; Option&lt;&amp;str&gt; { self.as_str() }\n    // ... etc\n}\n</code></pre>"},{"location":"RFCs/012_json_value/#hybrid-models","title":"Hybrid Models","text":"<p>Mix typed and dynamic:</p> <pre><code>@derive(Serialize, Deserialize)\nmodel ApiResponse:\n    status: int\n    message: str\n    data: JsonValue  # Dynamic payload\n</code></pre>"},{"location":"RFCs/012_json_value/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/012_json_value/#1-dictstr-any","title":"1. Dict[str, Any]","text":"<p>Rust doesn't have <code>Any</code> like Python. Would require boxing and type erasure.</p>"},{"location":"RFCs/012_json_value/#2-generic-parsing-only","title":"2. Generic parsing only","text":"<p>Keep <code>json_parse[T]()</code> and require models for everything. Rejected because:</p> <ul> <li>Too restrictive for dynamic use cases</li> <li>Poor developer experience for exploration</li> </ul>"},{"location":"RFCs/012_json_value/#3-automatic-dict-conversion","title":"3. Automatic Dict conversion","text":"<p>Auto-convert JSON objects to <code>Dict[str, ???]</code>. Rejected because:</p> <ul> <li>Loses type information</li> <li>Can't handle nested structures uniformly</li> </ul>"},{"location":"RFCs/012_json_value/#implementation-plan","title":"Implementation Plan","text":"<ol> <li>Add <code>JsonValue</code> as a language surface type in <code>incan_core::lang::surface</code> (maps to <code>serde_json::Value</code>)</li> <li>Implement constructors and methods in codegen</li> <li>Add typechecker support for indexing operations</li> <li>Add <code>JsonValue</code> field support in models</li> <li>Document with examples</li> </ol>"},{"location":"RFCs/012_json_value/#open-questions","title":"Open Questions","text":"<ol> <li>Should <code>value[\"key\"]</code> return <code>JsonValue</code> or <code>Option[JsonValue]</code>?</li> <li>Returning <code>JsonValue</code> (with Null for missing) is more ergonomic for chaining</li> <li> <p>Returning <code>Option</code> is more explicit about missing keys</p> </li> <li> <p>Should we support <code>value.key</code> syntax as sugar for <code>value[\"key\"]</code>?</p> </li> <li> <p>How to handle numeric types? JSON has only one number type, but Incan has <code>int</code> and <code>float</code>.</p> </li> </ol>"},{"location":"RFCs/012_json_value/#references","title":"References","text":"<ul> <li>Rust: <code>serde_json::Value</code></li> <li>Python: <code>dict</code> from <code>json.loads()</code></li> <li>TypeScript: <code>any</code> or <code>unknown</code></li> <li>Go: <code>interface{}</code> / <code>any</code></li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/","title":"RFC 013: Rust Crate Dependencies","text":"<p>Status: Draft Created: 2025-12-16 Supersedes: Parts of RFC 005 (Cargo integration section)</p>"},{"location":"RFCs/013_rust_crate_dependencies/#summary","title":"Summary","text":"<p>Define a comprehensive system for specifying Rust crate dependencies in Incan, including inline version annotations, project configuration (<code>incan.toml</code>), and lock files for reproducibility.</p>"},{"location":"RFCs/013_rust_crate_dependencies/#motivation","title":"Motivation","text":"<p>Incan compiles to Rust, meaning access to the Rust ecosystem is a core value proposition. The current implementation has limitations:</p> <ol> <li>Known-good crates work - common crates like <code>serde</code>, <code>tokio</code> have curated defaults</li> <li>Unknown crates error - no user-facing way to specify version/features</li> <li>Workaround is manual - edit generated <code>Cargo.toml</code> (clunky, not reproducible)</li> </ol> <p>This RFC introduces a proper dependency management system that is:</p> <ul> <li>Easy by default - common crates \"just work\"</li> <li>Flexible when needed - any crate can be used with explicit config</li> <li>Reproducible - builds are deterministic via lock files</li> <li>Pythonic - <code>incan.toml</code> feels like <code>pyproject.toml</code></li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#goals","title":"Goals","text":"<ul> <li>Allow any Rust crate with explicit version specification</li> <li>Maintain known-good defaults as convenient fallbacks</li> <li>Support features, git sources, and path dependencies</li> <li>Provide a familiar project configuration format</li> <li>Enable reproducible builds via lock file</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#non-goals-this-rfc","title":"Non-Goals (this RFC)","text":"<ul> <li>Automatic version resolution/upgrade (future: <code>incan update</code>)</li> <li>Private registry support</li> <li>Workspace/multi-project configuration</li> <li>Native FFI bindings beyond Rust</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#1-inline-version-annotations","title":"1. Inline Version Annotations","text":""},{"location":"RFCs/013_rust_crate_dependencies/#11-basic-version","title":"1.1 Basic Version","text":"<pre><code># Pin a specific version\nimport rust::my_crate @ \"1.0\"\nfrom rust::obscure_lib @ \"0.5\" import Widget\n\n# Semver operators (like Cargo)\nimport rust::some_crate @ \"^1.2\"   # &gt;=1.2.0, &lt;2.0.0\nimport rust::other_crate @ \"~1.2\"  # &gt;=1.2.0, &lt;1.3.0\nimport rust::exact_crate @ \"=1.2.3\" # exactly 1.2.3\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#12-version-with-features","title":"1.2 Version with Features","text":"<pre><code># Enable features\nimport rust::tokio @ \"1.0\" with [\"full\"]\nimport rust::serde @ \"1.0\" with [\"derive\", \"rc\"]\n\n# Import from crate with features\nfrom rust::sqlx @ \"0.7\" with [\"runtime-tokio\", \"postgres\"] import Pool\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#13-grammar-extension","title":"1.3 Grammar Extension","text":"<pre><code>(* Extended import syntax for rust:: crates *)\nrust_import     = \"import\" \"rust\" \"::\" crate_path [ version_spec ] [ \"as\" IDENT ]\n                | \"from\" \"rust\" \"::\" crate_path [ version_spec ] \"import\" import_list ;\n\ncrate_path      = IDENT { \"::\" IDENT } ;\nversion_spec    = \"@\" version_string [ \"with\" feature_list ] ;\nversion_string  = STRING ;  (* \"1.0\", \"^1.2\", \"~0.5\", \"=1.2.3\" *)\nfeature_list    = \"[\" STRING { \",\" STRING } \"]\" ;\nimport_list     = IDENT { \",\" IDENT } ;\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#2-project-configuration-incantoml","title":"2. Project Configuration (<code>incan.toml</code>)","text":"<p>The <code>incan.toml</code> format is inspired by Python's <code>pyproject.toml</code> - familiar, readable, and declarative.</p>"},{"location":"RFCs/013_rust_crate_dependencies/#21-minimal-example","title":"2.1 Minimal Example","text":"<pre><code>[project]\nname = \"my_app\"\nversion = \"0.1.0\"\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#22-full-example","title":"2.2 Full Example","text":"<pre><code>[project]\nname = \"my_app\"\nversion = \"0.1.0\"\ndescription = \"An example Incan application\"\nauthors = [\"Alice &lt;alice@example.com&gt;\"]\nlicense = \"MIT\"\nreadme = \"README.md\"\n\n# Minimum Incan version required\nrequires-incan = \"&gt;=0.2.0\"\n\n# Entry point for `incan run`\n[project.scripts]\nmain = \"src/main.incn\"\n\n# Rust crate dependencies\n[rust.dependencies]\n# Simple version string\nreqwest = \"0.12\"\nrand = \"0.8\"\n\n# Version with features\nsqlx = { version = \"0.7\", features = [\"runtime-tokio\", \"postgres\", \"mysql\"] }\ntokio = { version = \"1.35\", features = [\"full\"] }\nserde = { version = \"1.0\", features = [\"derive\"] }\n\n# Git dependency\nmy_internal_crate = { git = \"https://github.com/company/crate\", tag = \"v1.0.0\" }\n\n# Path dependency (for local development)\nlocal_lib = { path = \"../my-local-lib\" }\n\n# Optional dependencies (enabled via features)\n[rust.dependencies.optional]\nfancy_logging = { version = \"0.3\", optional = true }\n\n# Development dependencies (not included in release builds)\n[rust.dev-dependencies]\ncriterion = \"0.5\"\nproptest = \"1.0\"\n\n# Build configuration\n[build]\n# Rust edition for generated code\nrust-edition = \"2021\"\n\n# Optimization level: \"debug\", \"release\", \"release-lto\"\nprofile = \"release\"\n\n# Target triple (optional, defaults to host)\n# target = \"x86_64-unknown-linux-gnu\"\n\n# Feature flags for the Incan project itself\n[project.features]\ndefault = [\"json\"]\njson = []  # Enables JSON serialization support\nfull = [\"json\", \"fancy_logging\"]\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#23-section-reference","title":"2.3 Section Reference","text":"Section Description <code>[project]</code> Project metadata (name, version, authors, etc.) <code>[project.scripts]</code> Entry points for CLI commands <code>[project.features]</code> Optional feature flags <code>[rust.dependencies]</code> Rust crate dependencies <code>[rust.dev-dependencies]</code> Development-only dependencies <code>[build]</code> Build configuration options"},{"location":"RFCs/013_rust_crate_dependencies/#24-dependency-specification-formats","title":"2.4 Dependency Specification Formats","text":"<pre><code>[rust.dependencies]\n# String shorthand - just version\ncrate_a = \"1.0\"\n\n# Table form - version + features\ncrate_b = { version = \"1.0\", features = [\"foo\", \"bar\"] }\n\n# Table form - git source\ncrate_c = { git = \"https://github.com/...\", branch = \"main\" }\ncrate_d = { git = \"https://github.com/...\", tag = \"v1.0.0\" }\ncrate_e = { git = \"https://github.com/...\", rev = \"abc1234\" }\n\n# Table form - path source\ncrate_f = { path = \"../local-crate\" }\n\n# Optional dependency\ncrate_g = { version = \"1.0\", optional = true }\n\n# Default features disabled\ncrate_h = { version = \"1.0\", default-features = false, features = [\"only-this\"] }\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#3-lock-file-incanlock","title":"3. Lock File (<code>incan.lock</code>)","text":"<p>For reproducible builds, Incan generates a lock file capturing exact resolved versions.</p>"},{"location":"RFCs/013_rust_crate_dependencies/#31-format","title":"3.1 Format","text":"<pre><code># Auto-generated by Incan - do not edit manually\n# Regenerate with: incan lock\n\n[metadata]\nincan-version = \"0.2.0\"\ngenerated = \"2025-12-16T10:30:00Z\"\n\n[[rust.package]]\nname = \"tokio\"\nversion = \"1.35.1\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\nchecksum = \"abc123def456...\"\nfeatures = [\"full\"]\n\n[[rust.package]]\nname = \"serde\"\nversion = \"1.0.195\"\nsource = \"registry+https://github.com/rust-lang/crates.io-index\"\nchecksum = \"def789abc012...\"\nfeatures = [\"derive\"]\n\n[[rust.package]]\nname = \"my_internal_crate\"\nversion = \"1.0.0\"\nsource = \"git+https://github.com/company/crate?tag=v1.0.0#commit-sha\"\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#32-cli-commands","title":"3.2 CLI Commands","text":"Command Description <code>incan build</code> Build; uses lock file if present, creates if not <code>incan lock</code> Regenerate lock file from current dependencies <code>incan update</code> Update dependencies to latest compatible versions <code>incan update &lt;crate&gt;</code> Update specific crate only"},{"location":"RFCs/013_rust_crate_dependencies/#4-resolution-rules","title":"4. Resolution Rules","text":"<p>When resolving a Rust crate dependency, the following precedence applies (highest to lowest):</p> <pre><code>1. incan.toml [rust.dependencies]  \u2192 explicit project config wins\n2. Inline version annotation       \u2192 import rust::foo @ \"1.0\"\n3. Known-good defaults             \u2192 curated list in compiler\n4. Error                           \u2192 unknown crate without version\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#41-known-good-defaults","title":"4.1 Known-Good Defaults","text":"<p>The compiler maintains a curated list of common crates with tested version/feature combinations. These serve as convenient defaults, not restrictions:</p> <pre><code>// In compiler (simplified)\nstatic KNOWN_GOOD: &amp;[(&amp;str, &amp;str)] = &amp;[\n    (\"serde\", r#\"{ version = \"1.0\", features = [\"derive\"] }\"#),\n    (\"tokio\", r#\"{ version = \"1\", features = [\"rt-multi-thread\", \"macros\"] }\"#),\n    (\"reqwest\", r#\"{ version = \"0.11\", features = [\"json\"] }\"#),\n    // ... etc\n];\n</code></pre> <p>Users can override these defaults via <code>incan.toml</code> or inline annotations.</p>"},{"location":"RFCs/013_rust_crate_dependencies/#42-conflict-resolution","title":"4.2 Conflict Resolution","text":"<pre><code># This is an error - conflicting versions\nimport rust::tokio @ \"1.0\"   # Inline says 1.0\n# incan.toml says tokio = \"2.0\"\n</code></pre> <p>Error message:</p> <pre><code>error: conflicting versions for `tokio`\n\n  --&gt; src/main.incn:3\n    import rust::tokio @ \"1.0\"\n\n  --&gt; incan.toml:12\n    tokio = \"2.0\"\n\nRemove the inline version to use incan.toml, or update incan.toml to match.\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#5-error-messages","title":"5. Error Messages","text":""},{"location":"RFCs/013_rust_crate_dependencies/#51-unknown-crate-without-version","title":"5.1 Unknown Crate Without Version","text":"<pre><code>error: unknown Rust crate `my_obscure_lib`\n\n  --&gt; src/main.incn:5\n    import rust::my_obscure_lib\n\nThis crate isn't in the known-good list. Specify a version:\n\n    import rust::my_obscure_lib @ \"1.0\"\n\nOr add it to incan.toml:\n\n    [rust.dependencies]\n    my_obscure_lib = \"1.0\"\n\nTip: Check https://crates.io/crates/my_obscure_lib for available versions.\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#52-feature-not-found","title":"5.2 Feature Not Found","text":"<pre><code>error: feature `nonexistent` not found in crate `tokio`\n\n  --&gt; src/main.incn:3\n    import rust::tokio @ \"1.0\" with [\"nonexistent\"]\n\nAvailable features: full, rt, rt-multi-thread, macros, time, sync, net, ...\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#53-version-not-found","title":"5.3 Version Not Found","text":"<pre><code>error: version `99.0` of `serde` does not exist\n\n  --&gt; src/main.incn:3\n    import rust::serde @ \"99.0\"\n\nLatest version: 1.0.195\nTip: Check https://crates.io/crates/serde/versions for available versions.\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#6-implementation-phases","title":"6. Implementation Phases","text":""},{"location":"RFCs/013_rust_crate_dependencies/#phase-1-inline-versions-minimal-viable","title":"Phase 1: Inline Versions (Minimal Viable)","text":"<ul> <li>Add <code>@ \"version\"</code> syntax to parser (implemented in <code>crates/incan_syntax</code>)</li> <li>Pass version to <code>ProjectGenerator</code></li> <li>Fall back to <code>*</code> with warning for unknown crates without version (temporary)</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#phase-2-features-support","title":"Phase 2: Features Support","text":"<ul> <li>Add <code>with [\"feature\"]</code> syntax (implemented in <code>crates/incan_syntax</code>)</li> <li>Update codegen to emit features in Cargo.toml</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#phase-3-project-configuration","title":"Phase 3: Project Configuration","text":"<ul> <li>Parse <code>incan.toml</code> if present</li> <li>Merge with inline annotations per resolution rules</li> <li>Add <code>incan init</code> to create starter <code>incan.toml</code></li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#phase-4-lock-file","title":"Phase 4: Lock File","text":"<ul> <li>Generate <code>incan.lock</code> on first build</li> <li>Use locked versions on subsequent builds</li> <li>Add <code>incan lock</code>, <code>incan update</code> commands</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#phase-5-advanced-sources","title":"Phase 5: Advanced Sources","text":"<ul> <li>Git dependencies (<code>git = \"...\"</code>)</li> <li>Path dependencies (<code>path = \"...\"</code>)</li> <li>Optional dependencies</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#7-examples","title":"7. Examples","text":""},{"location":"RFCs/013_rust_crate_dependencies/#71-simple-usage-phase-1","title":"7.1 Simple Usage (Phase 1+)","text":"<pre><code># Known-good crate - just works\nimport rust::serde\n\n# Unknown crate - must specify version\nimport rust::obscure_parser @ \"2.1\"\n\n# Known-good with different version\nimport rust::tokio @ \"1.35\"  # Override default\n\ndef main() -&gt; None:\n    print(\"Hello, Rust ecosystem!\")\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#72-full-project-phase-3","title":"7.2 Full Project (Phase 3+)","text":"<p>incan.toml:</p> <pre><code>[project]\nname = \"web_service\"\nversion = \"0.1.0\"\n\n[rust.dependencies]\naxum = \"0.7\"\ntokio = { version = \"1\", features = [\"full\"] }\nsqlx = { version = \"0.7\", features = [\"runtime-tokio\", \"postgres\"] }\ntracing = \"0.1\"\n</code></pre> <p>src/main.incn:</p> <pre><code># No version needed - defined in incan.toml\nfrom rust::axum import Router, Json\nfrom rust::sqlx import PgPool\nimport rust::tracing\n\nasync def main() -&gt; None:\n    tracing::info(\"Starting server...\")\n    app = Router::new()\n    # ...\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#73-mixed-inline-and-config","title":"7.3 Mixed Inline and Config","text":"<p>incan.toml:</p> <pre><code>[project]\nname = \"mixed_example\"\nversion = \"0.1.0\"\n\n[rust.dependencies]\nserde = { version = \"1.0\", features = [\"derive\"] }\n</code></pre> <p>src/main.incn:</p> <pre><code># From incan.toml\nimport rust::serde\n\n# Inline - not in incan.toml\nimport rust::uuid @ \"1.0\" with [\"v4\"]\n\n# Override known-good default for one-off use\nfrom rust::chrono @ \"0.4\" with [\"serde\", \"clock\"] import DateTime, Utc\n</code></pre>"},{"location":"RFCs/013_rust_crate_dependencies/#8-comparison-with-pyprojecttoml","title":"8. Comparison with pyproject.toml","text":"pyproject.toml incan.toml Notes <code>[project]</code> <code>[project]</code> Same structure <code>dependencies = [...]</code> <code>[rust.dependencies]</code> Namespaced for Rust <code>[project.optional-dependencies]</code> <code>[rust.dependencies.optional]</code> Similar <code>[tool.pytest]</code> N/A Tool-specific config not in scope <code>requires-python</code> <code>requires-incan</code> Minimum version"},{"location":"RFCs/013_rust_crate_dependencies/#9-open-questions","title":"9. Open Questions","text":"<ol> <li>Workspace support: Should <code>incan.toml</code> support workspaces with multiple packages?</li> <li>Private registries: How to authenticate with private Cargo registries?</li> <li>Version ranges in toml: Allow <code>tokio = \"&gt;=1.30, &lt;2.0\"</code> or require Cargo syntax?</li> <li>Auto-update policy: Should <code>incan update</code> respect semver or allow major updates?</li> </ol>"},{"location":"RFCs/013_rust_crate_dependencies/#10-checklist","title":"10. Checklist","text":""},{"location":"RFCs/013_rust_crate_dependencies/#implementing-phase-1-inline-versions","title":"Implementing Phase 1: Inline Versions","text":"<ul> <li>[ ] Parser: <code>@ \"version\"</code> syntax</li> <li>[ ] Codegen: pass version to ProjectGenerator</li> <li>[ ] Error: unknown crate without version (warning + <code>*</code> fallback)</li> <li>[ ] Docs: update rust_interop.md</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#implementing-phase-2-features","title":"Implementing Phase 2: Features","text":"<ul> <li>[ ] Parser: <code>with [\"features\"]</code> syntax</li> <li>[ ] Codegen: emit features in Cargo.toml</li> <li>[ ] Error: unknown feature</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#implementing-phase-3-project-configuration","title":"Implementing Phase 3: Project Configuration","text":"<ul> <li>[ ] Parser: <code>incan.toml</code> format</li> <li>[ ] CLI: <code>incan init</code> command</li> <li>[ ] Resolution: merge inline + toml + defaults</li> <li>[ ] Error: version conflicts</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#implementing-phase-4-lock-file","title":"Implementing Phase 4: Lock File","text":"<ul> <li>[ ] Generate <code>incan.lock</code></li> <li>[ ] CLI: <code>incan lock</code> command</li> <li>[ ] CLI: <code>incan update</code> command</li> <li>[ ] Build: use lock file when present</li> </ul>"},{"location":"RFCs/013_rust_crate_dependencies/#implementing-phase-5-advanced-sources","title":"Implementing Phase 5: Advanced Sources","text":"<ul> <li>[ ] Git dependencies</li> <li>[ ] Path dependencies</li> <li>[ ] Optional dependencies</li> <li>[ ] Dev dependencies</li> </ul>"},{"location":"RFCs/014_generated_code_error_handling/","title":"RFC 014: Error Handling in Generated Rust Code","text":"<p>Status: Draft</p>"},{"location":"RFCs/014_generated_code_error_handling/#summary","title":"Summary","text":"<p>The Incan compiler currently emits <code>.unwrap()</code> calls in generated Rust code for operations that can fail at runtime. This causes cryptic Rust panics when users encounter edge cases. This RFC proposes a phased approach to improve error handling in generated code.</p>"},{"location":"RFCs/014_generated_code_error_handling/#problem","title":"Problem","text":"<p>Generated Rust code contains several <code>.unwrap()</code> patterns that can panic:</p> <pre><code>// Dict access - panics if key doesn't exist\nmap.get(&amp;key).unwrap().clone()\n\n// String parsing - panics if string isn't a valid number\ninput.parse::&lt;i64&gt;().unwrap()\n\n// List indexing - panics if index out of bounds\nvec[index]  // or explicit .get(i).unwrap()\n\n// List.index() - panics if value not found\n__incan_list_find_index(&amp;vec, &amp;value).unwrap()\n</code></pre> <p>When these panic, users see Rust stack traces instead of helpful Incan error messages:</p> <pre><code>thread 'main' panicked at 'called `Option::unwrap()` on a `None` value'\n</code></pre>"},{"location":"RFCs/014_generated_code_error_handling/#goals","title":"Goals","text":"<ol> <li>Clear error messages: Users should see Incan-level errors, not Rust panics</li> <li>Source locations: Errors should reference Incan source lines when possible</li> <li>Graceful degradation: Some operations should return <code>None</code>/default instead of panicking</li> <li>Future-proof: Design should support Incan-level error handling via <code>Result</code>/<code>Option</code>, <code>match</code>, and <code>?</code></li> </ol>"},{"location":"RFCs/014_generated_code_error_handling/#proposed-solution","title":"Proposed Solution","text":""},{"location":"RFCs/014_generated_code_error_handling/#phase-1-better-panic-messages-immediate","title":"Phase 1: Better Panic Messages (Immediate)","text":"<p>Replace bare <code>.unwrap()</code> with <code>.unwrap_or_else()</code> that provides context:</p> <pre><code>// Before\nmap.get(&amp;key).unwrap().clone()\n\n// After\nmap.get(&amp;key)\n    .unwrap_or_else(|| panic!(\"KeyError: '{}' not found in dict\", key))\n    .clone()\n</code></pre> <p>For string parsing:</p> <pre><code>// Before\ninput.parse::&lt;i64&gt;().unwrap()\n\n// After\ninput.parse::&lt;i64&gt;()\n    .unwrap_or_else(|_| panic!(\"ValueError: cannot convert '{}' to int\", input))\n</code></pre>"},{"location":"RFCs/014_generated_code_error_handling/#phase-2-runtime-error-type","title":"Phase 2: Runtime Error Type","text":"<p>Introduce an Incan runtime error type that captures context:</p> <pre><code>// In generated prelude\n#[derive(Debug)]\npub enum IncanError {\n    KeyError { key: String, context: &amp;'static str },\n    ValueError { value: String, expected: &amp;'static str },\n    IndexError { index: usize, len: usize },\n    TypeError { found: &amp;'static str, expected: &amp;'static str },\n}\n\nimpl std::fmt::Display for IncanError {\n    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;'_&gt;) -&gt; std::fmt::Result {\n        match self {\n            IncanError::KeyError { key, context } =&gt; \n                write!(f, \"KeyError: '{}' not found{}\", key, context),\n            // ... etc\n        }\n    }\n}\n</code></pre>"},{"location":"RFCs/014_generated_code_error_handling/#phase-3-optional-error-recovery","title":"Phase 3: Optional Error Recovery","text":"<p>For operations where returning <code>None</code>/default makes sense:</p> <pre><code># Dict.get() returns Option\nvalue = my_dict.get(\"key\")  # Returns Option[T]\n\n# With default\nvalue = my_dict.get(\"key\", default=\"fallback\")\n</code></pre> <p>Generated as:</p> <pre><code>let value = my_dict.get(\"key\").cloned();  // Option&lt;T&gt;\nlet value = my_dict.get(\"key\").cloned().unwrap_or(\"fallback\".to_string());\n</code></pre>"},{"location":"RFCs/014_generated_code_error_handling/#phase-4-incan-level-error-handling-no-tryexcept","title":"Phase 4: Incan-Level Error Handling (no <code>try/except</code>)","text":"<p>Incan should not adopt Python-style <code>try/except</code> blocks. Instead, error handling stays explicit and type-driven:</p> <ul> <li>Fallible operations return <code>Result[T, IncanError]</code> (or <code>Option[T]</code> where absence is expected)</li> <li>Callers handle errors via <code>match</code> (or propagate with <code>?</code>)</li> </ul> <p>Example (handle a parse failure by falling back to a default):</p> <pre><code># Incan uses a match expression to handle errors, instead of a try-except block (like Python)\nmatch int(user_input):\n    Ok(v) =&gt; value = v\n    Err(_) =&gt; value = 0\n</code></pre> <p>Generated as:</p> <pre><code>let value = match user_input.parse::&lt;i64&gt;() {\n    Ok(v) =&gt; v,\n    Err(_) =&gt; 0,\n};\n</code></pre> <p>Note: this is where Incan is deliberately more rust-like than Python.</p>"},{"location":"RFCs/014_generated_code_error_handling/#specific-improvements","title":"Specific Improvements","text":""},{"location":"RFCs/014_generated_code_error_handling/#dict-access","title":"Dict Access","text":"<ul> <li><code>d[key]</code><ul> <li>Current:</li> </ul> </li> </ul> <pre><code>.get(...).expect(\"KeyError: key not found in dict\").clone()\n</code></pre> <pre><code>- **Proposed**:\n</code></pre> <pre><code>.get(...).unwrap_or_else(|| panic!(\"KeyError: key not found in dict\")).clone()\n</code></pre> <pre><code>- **Note**: string-literal keys include the key in the message today.\n</code></pre> <ul> <li><code>d.get(key)</code><ul> <li>Proposed:</li> </ul> </li> </ul> <pre><code>.get(&amp;k).cloned() // -&gt; Option&lt;V&gt;\n</code></pre> <ul> <li><code>d.get(key, default)</code><ul> <li>Proposed:</li> </ul> </li> </ul> <pre><code>.get(&amp;k).cloned().unwrap_or(default)\n</code></pre>"},{"location":"RFCs/014_generated_code_error_handling/#string-parsing","title":"String Parsing","text":"<ul> <li><code>int(s)</code><ul> <li>Current: depends on input form<ul> <li>string literal:</li> </ul> </li> </ul> </li> </ul> <pre><code>.parse::&lt;i64&gt;().expect(\"ValueError: ...\")\n</code></pre> <pre><code>    - known `String` variable:\n</code></pre> <pre><code>.parse::&lt;i64&gt;().unwrap_or_else(|_| panic!(\"ValueError: ...\", s))\n</code></pre> <pre><code>    - non-string:\n</code></pre> <pre><code>(x as i64)\n</code></pre> <pre><code>- **Proposed**: parse strings with a `ValueError` message; cast non-strings for performance.\n</code></pre> <ul> <li><code>float(s)</code><ul> <li>Current: depends on input form<ul> <li>string literal:</li> </ul> </li> </ul> </li> </ul> <pre><code>.parse::&lt;f64&gt;().expect(\"ValueError: ...\")\n</code></pre> <pre><code>    - known `String` variable:\n</code></pre> <pre><code>.parse::&lt;f64&gt;().unwrap_or_else(|_| panic!(\"ValueError: ...\", s))\n</code></pre> <pre><code>    - non-string:\n</code></pre> <pre><code>(x as f64)\n</code></pre> <pre><code>- **Proposed**: parse strings with a `ValueError` message; cast non-strings for performance.\n</code></pre>"},{"location":"RFCs/014_generated_code_error_handling/#list-operations","title":"List Operations","text":"<ul> <li><code>list[i]</code><ul> <li>Current (panics with Rust bounds message today):</li> </ul> </li> </ul> <pre><code>vec[(i as usize)].clone()\n</code></pre> <pre><code>- **Proposed**:\n</code></pre> <pre><code>vec.get(i as usize)\n    .cloned()\n    .unwrap_or_else(|| panic!(\"IndexError: index {} out of range for list of length {}\", i, vec.len()))\n</code></pre> <ul> <li><code>list.index(v)</code><ul> <li>Current:</li> </ul> </li> </ul> <pre><code>__incan_list_find_index(&amp;vec, &amp;v).expect(\"ValueError: value not found in list\")\n</code></pre> <pre><code>- **Proposed**:\n</code></pre> <pre><code>__incan_list_find_index(&amp;vec, &amp;v).unwrap_or_else(|| panic!(\"ValueError: value not found in list\"))\n</code></pre>"},{"location":"RFCs/014_generated_code_error_handling/#implementation-plan","title":"Implementation Plan","text":"<ol> <li>Phase 1: Update codegen to emit better panic messages</li> <li>Phase 2: Add IncanError type to generated prelude</li> <li>Phase 3: Add <code>Dict.get(key, default=...)</code> and introduce a new safe list API     (e.g. <code>List.get(index, default=...)</code> or <code>List.at(index)</code> returning <code>Option[T]</code>)     and update codegen to use Rust's <code>Vec::get</code>.</li> </ol>"},{"location":"RFCs/014_generated_code_error_handling/#alternatives-considered","title":"Alternatives Considered","text":""},{"location":"RFCs/014_generated_code_error_handling/#always-return-result","title":"Always Return Result","text":"<p>Make all fallible operations return <code>Result&lt;T, IncanError&gt;</code>. Rejected because:</p> <ul> <li>Requires pervasive <code>?</code> or <code>.unwrap()</code> in generated code</li> <li>Doesn't match Python/Incan semantics where these operations \"just work\"</li> <li>Would require pervasive <code>Result</code> handling (via <code>match</code>/<code>?</code>) to be usable</li> </ul>"},{"location":"RFCs/014_generated_code_error_handling/#silent-defaults","title":"Silent Defaults","text":"<p>Return default values instead of panicking (e.g., <code>0</code> for missing int parse). Rejected because:</p> <ul> <li>Hides bugs</li> <li>Doesn't match Python semantics (Python raises exceptions)</li> <li>Makes debugging harder</li> </ul>"},{"location":"RFCs/014_generated_code_error_handling/#references","title":"References","text":"<ul> <li>Python's exception model</li> <li>Rust's <code>unwrap_or_else</code> pattern</li> <li>RFC 013: Rust Crate Dependencies \u2014 related codegen concerns</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/","title":"RFC 015: Hatch-like Tooling (Project Lifecycle CLI)","text":"<p>Status: Planned Created: 2025-12-23  </p>"},{"location":"RFCs/015_hatch_like_tooling/#summary","title":"Summary","text":"<p>Introduce a first-class, batteries-included project lifecycle CLI\u2014similar in spirit to Python\u2019s Hatch\u2014for:</p> <ul> <li>Versioning: <code>incan version &lt;major|minor|patch|alpha|beta|rc|dev&gt;</code> (with optional <code>--dry-run</code>)</li> <li>Project scaffolding: <code>incan init</code> (in-place) and <code>incan new &lt;name&gt;</code> (new directory)</li> <li>Matrix testing (tox/nox-style): <code>incan test --matrix ...</code> with declarative environments</li> <li>Additional \u201chatch-like\u201d ergonomics where it fits Incan\u2019s workflow (format/lint/release/build/publish).</li> </ul> <p>This RFC defines the CLI surface, the project metadata format, and the implementation boundaries so we don\u2019t bake policy into ad-hoc scripts.</p>"},{"location":"RFCs/015_hatch_like_tooling/#motivation","title":"Motivation","text":"<p>Incan is a compiler + runtime ecosystem, but day-to-day developer experience is heavily shaped by tooling:</p> <ul> <li>Starting a new project should be one command.</li> <li>Bumping versions should be correct and consistent across the compiler, generated projects, and any package metadata.</li> <li>Running tests should support repeatable environments and matrix execution,     without forcing users to learn Cargo internals.</li> <li>Release workflows should be scriptable and standard across projects.</li> </ul> <p>Python\u2019s Hatch demonstrates that a single tool can cover the project lifecycle. This RFC adapts the useful parts to Incan.</p>"},{"location":"RFCs/015_hatch_like_tooling/#goals","title":"Goals","text":"<ul> <li>Provide an ergonomic, consistent, and scriptable CLI for common workflows:<ul> <li><code>init</code>, <code>new</code>, <code>version</code>, <code>test</code>, <code>fmt</code>, <code>lint</code>, <code>build</code>, (future: <code>publish</code>)</li> </ul> </li> <li>Define a single source of truth for project metadata (name, version, dependencies, entrypoint).</li> <li>Enable matrix testing via a declarative config.</li> <li>Keep generated projects deterministic and reproducible.</li> <li>Avoid \u201cmagic\u201d: every generated file is readable and intended to be edited.</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#non-goals-initial","title":"Non-Goals (initial)","text":"<ul> <li>Implement a public package registry client (publish/install) in this RFC (can be a follow-up RFC).</li> <li>Replace Cargo for Rust-level dependency resolution (we can orchestrate Cargo, not reinvent it).</li> <li>Provide virtualenv-style isolation identical to Python (we\u2019ll use explicit env configs and reproducible commands instead).</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#terminology","title":"Terminology","text":"<ul> <li>Project: An Incan repository containing Incan sources and metadata.</li> <li>Environment: A named test/build configuration (toolchain, flags, features, timeouts).</li> <li>Matrix: Running an environment set across multiple dimensions (e.g., debug/release, features on/off).</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#project-metadata","title":"Project Metadata","text":"<p>Add <code>incan.toml</code> at repo root (similar to <code>pyproject.toml</code>), as the canonical metadata source.</p> <p>Example:</p> <pre><code>[project]\nname = \"hello_incan\"\nversion = \"0.1.0-alpha.1\"\nentrypoint = \"src/main.incn\"\n\n[project.dependencies]\n# Rust interop dependencies (RFC 013)\nrand = \"0.8\"\nserde = { version = \"1.0\", features = [\"derive\"] }\n\n[tool.incan]\nformatter = { line_length = 100 }\n\n[tool.incan.test]\ntimeout_secs = 5\n\n[[tool.incan.env]]\nname = \"unit\"\ncommand = [\"incan\", \"test\"]\n\n[[tool.incan.env]]\nname = \"smoke\"\ncommand = [\"incan\", \"smoke-test\"]\n</code></pre> <p>Notes:</p> <ul> <li><code>version</code> is SemVer-compatible with pre-release tags.</li> <li>Rust dependencies integrate with RFC 013 rules.</li> <li>Environments are explicit; no implicit \u201cdev shell\u201d assumptions.</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#cli-design","title":"CLI Design","text":""},{"location":"RFCs/015_hatch_like_tooling/#incan-new-name","title":"<code>incan new &lt;name&gt;</code>","text":"<p>Create a new directory containing a minimal Incan project scaffold:</p> <ul> <li><code>incan.toml</code></li> <li><code>src/main.incn</code> (hello world)</li> <li><code>README.md</code></li> <li><code>.gitignore</code></li> </ul> <p>Flags:</p> <ul> <li><code>--bin</code> / <code>--lib</code> (default: <code>--bin</code>)</li> <li><code>--dir &lt;path&gt;</code> (default: <code>./&lt;name&gt;</code>)</li> <li><code>--force</code> (overwrite)</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#incan-init","title":"<code>incan init</code>","text":"<p>Initialize <code>incan.toml</code> (and <code>src/main.incn</code>) in the current directory.</p> <p>Flags:</p> <ul> <li><code>--force</code> (overwrite metadata)</li> <li><code>--detect</code> (attempt to infer: entrypoint, existing version strings, etc.)</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#incan-version-bump","title":"<code>incan version &lt;bump&gt;</code>","text":"<p>Update the project version in <code>incan.toml</code> and any derived files that must match.</p> <p>Bumps:</p> <ul> <li><code>major</code>, <code>minor</code>, <code>patch</code></li> <li><code>alpha</code>, <code>beta</code>, <code>rc</code>, <code>dev</code></li> </ul> <p>Rules:</p> <ul> <li><code>major/minor/patch</code> operate on the release core and clear pre-release unless <code>--keep-prerelease</code>.</li> <li><code>alpha/beta/rc/dev</code>:<ul> <li>If no prerelease exists, append <code>-&lt;tag&gt;.1</code></li> <li>If same prerelease exists, increment numeric suffix</li> <li>If different prerelease exists, switch tag and reset to <code>.1</code></li> </ul> </li> </ul> <p>Flags:</p> <ul> <li><code>--dry-run</code></li> <li><code>--set &lt;version&gt;</code> (explicit override)</li> <li><code>--keep-prerelease</code></li> <li><code>--message &lt;msg&gt;</code> (for future integration with changelog/commit tooling)</li> </ul> <p>Output should print:</p> <ul> <li>old version</li> <li>new version</li> <li>modified files</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#incan-test","title":"<code>incan test</code>","text":"<p>Default test runner entrypoint.</p> <p>Behavior:</p> <ul> <li>If <code>tool.incan.env</code> exists, running <code>incan test</code> executes the default environment (or <code>unit</code>).</li> <li>Otherwise, runs Incan\u2019s standard checks: <code>cargo test</code> for compiler/runtime crates     and <code>incan test</code> for Incan-level tests (if present).</li> </ul> <p>Flags:</p> <ul> <li><code>--env &lt;name&gt;</code> (select an env)</li> <li><code>--matrix &lt;expr&gt;</code> (see below)</li> <li><code>--list-envs</code></li> <li><code>--timeout &lt;secs&gt;</code></li> <li><code>--jobs &lt;n&gt;</code> (parallel env execution)</li> <li><code>--fail-fast</code></li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#matrix-execution","title":"Matrix execution","text":"<p>Matrix is defined either in <code>incan.toml</code> or via CLI:</p> <p>Config:</p> <pre><code>[tool.incan.matrix]\naxes = { profile = [\"debug\", \"release\"], features = [\"default\", \"json\"] }\n\n[[tool.incan.matrix.include]]\nprofile = \"release\"\nfeatures = \"json\"\nenv = \"unit\"\n</code></pre> <p>CLI expression (initial, simple):</p> <ul> <li><code>--matrix profile=debug,release features=default,json</code></li> </ul> <p>Execution strategy:</p> <ul> <li>Expand combinations</li> <li>Run each as a named environment with injected variables:<ul> <li><code>INCAN_PROFILE</code>, <code>INCAN_FEATURES</code>, <code>INCAN_TIMEOUT</code></li> </ul> </li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#additional-commands-recommended","title":"Additional Commands (Recommended)","text":"<p>These exist today in Makefiles across many repos. This RFC explicitly prefers CLI-native equivalents so projects do not need Make as a dependency.</p> <ul> <li><code>incan fmt</code> / <code>incan fmt --check</code></li> <li><code>incan lint</code> (clippy-like checks for compiler + emitted code)</li> <li><code>incan smoke-test</code> (build + tests + examples + benchmark smoke-check, mirroring current repo conventions)</li> <li><code>incan doctor</code> (environment diagnostics: toolchain version, cargo, PATH, permissions)</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#implementation-plan","title":"Implementation Plan","text":""},{"location":"RFCs/015_hatch_like_tooling/#phase-1-metadata-scaffolding","title":"Phase 1: Metadata + scaffolding","text":"<ul> <li>Add <code>incan.toml</code> parsing (serde + toml)</li> <li>Implement <code>incan new</code>, <code>incan init</code></li> <li>Teach codegen/project generation to consult <code>incan.toml</code> when present</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#phase-2-version-command","title":"Phase 2: Version command","text":"<ul> <li>Implement SemVer parsing + bump logic</li> <li>Apply updates to <code>incan.toml</code></li> <li>Optional: update any secondary manifests (only if this repo\u2019s policy requires it)</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#phase-3-environment-matrix-runner","title":"Phase 3: Environment + matrix runner","text":"<ul> <li>Parse env definitions</li> <li>Implement <code>incan test --env</code></li> <li>Implement <code>incan test --matrix</code></li> <li>Add <code>--jobs</code> + <code>--fail-fast</code></li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#phase-4-polish-docs","title":"Phase 4: Polish + docs","text":"<ul> <li>Add guide pages: <code>docs/tooling/project_lifecycle.md</code></li> <li>Provide \u201cnew project\u201d tutorial for Python users</li> <li>Add examples of matrix testing</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#alternatives-considered","title":"Alternatives Considered","text":"<ul> <li>Rely solely on Makefile targets: simple but inconsistent across repos, hard to compose and introspect;     also adds an extra tool dependency we don\u2019t need.</li> <li>Embed everything in Cargo: good for Rust, but Incan\u2019s source-of-truth isn\u2019t Cargo.toml;     also doesn\u2019t cover project scaffolding or Incan-centric metadata.</li> <li>Adopt an existing tool (justfile, cargo-make): helps execution but doesn\u2019t solve metadata/version semantics.</li> </ul>"},{"location":"RFCs/015_hatch_like_tooling/#open-questions","title":"Open Questions","text":"<ol> <li>Should <code>incan.toml</code> be mandatory for new projects, or optional?</li> <li>Should <code>incan version</code> also update the compiler crate versions (workspace crates), or only project metadata?</li> <li>How do we want to represent \u201cdev\u201d versions (e.g., <code>-dev.1</code> vs <code>-dev+&lt;sha&gt;</code>)?</li> <li>Do we need a lockfile for <code>incan.toml</code> dependencies beyond Cargo.lock (likely no, but clarify)?</li> </ol>"},{"location":"RFCs/015_hatch_like_tooling/#checklist","title":"Checklist","text":"<ul> <li>[ ] Define <code>incan.toml</code> schema and document it</li> <li>[ ] Implement <code>incan new</code> and <code>incan init</code></li> <li>[ ] Implement <code>incan version</code> bump logic</li> <li>[ ] Implement env runner and matrix expansion</li> <li>[ ] Docs + examples</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/","title":"RFC 016: <code>loop</code> and <code>break &lt;value&gt;</code> (Loop Expressions)","text":"<p>Status: Planned Created: 2025-12-24  </p>"},{"location":"RFCs/016_loop_and_break_value/#summary","title":"Summary","text":"<p>Add a <code>loop:</code> keyword for explicit infinite loops, and extend <code>break</code> to optionally carry a value: <code>break &lt;expr&gt;</code>.</p> <p>This enables treating <code>loop:</code> as an expression that can produce a value (similar to Rust\u2019s <code>loop { ... }</code>), while keeping <code>while</code> as the general conditional loop construct.</p>"},{"location":"RFCs/016_loop_and_break_value/#motivation","title":"Motivation","text":"<p>Today, users express infinite loops as <code>while True:</code>. The compiler may emit Rust <code>loop {}</code> for this pattern, but the source language has no explicit infinite-loop construct and cannot express \u201cbreak with a value\u201d.</p> <p>Adding <code>loop:</code> and <code>break &lt;value&gt;</code> provides:</p> <ul> <li>Clearer intent in source (<code>loop:</code> reads as \u201cinfinite loop\u201d).</li> <li>A foundation for expression-oriented control flow without \u201cinitialize then mutate\u201d patterns.</li> <li>A natural home for \u201csearch until found\u201d patterns that return a value.</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#goals","title":"Goals","text":"<ul> <li>Introduce <code>loop:</code> as an explicit infinite loop construct.</li> <li>Allow <code>break</code> to optionally carry a value: <code>break &lt;expr&gt;</code>.</li> <li>Allow <code>loop:</code> to be used in expression position (e.g., assignment RHS).</li> <li>Keep existing <code>break</code> (no value) valid and well-defined.</li> <li>Keep <code>while True:</code> valid (and optionally desugar <code>loop:</code> to <code>while True:</code> or vice-versa).</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#non-goals","title":"Non-goals","text":"<ul> <li>Labeled <code>break</code> / <code>continue</code> syntax changes (may be addressed in a follow-up RFC).</li> <li><code>break</code> with multiple values / tuple sugar (users can return tuples explicitly).</li> <li>Making <code>while</code> an expression (this RFC keeps \u201cvalue-yielding loops\u201d scoped to <code>loop:</code>).</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#proposed-syntax","title":"Proposed syntax","text":""},{"location":"RFCs/016_loop_and_break_value/#loop","title":"<code>loop:</code>","text":"<pre><code>loop:\n    # body\n    ...\n</code></pre>"},{"location":"RFCs/016_loop_and_break_value/#break-with-optional-value","title":"<code>break</code> (with optional value)","text":"<pre><code>break\nbreak some_expr\n</code></pre>"},{"location":"RFCs/016_loop_and_break_value/#semantics","title":"Semantics","text":""},{"location":"RFCs/016_loop_and_break_value/#loop-execution","title":"Loop execution","text":"<ul> <li><code>loop:</code> executes its body repeatedly until it is exited via <code>break</code> (or an error/abort).</li> <li><code>continue</code> skips to the next iteration (existing behavior).</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#break-values","title":"<code>break</code> values","text":"<ul> <li><code>break</code> exits the innermost <code>loop:</code>. If it includes a value, that value becomes the value produced by the <code>loop:</code> expression.</li> <li><code>break</code> without a value is equivalent to <code>break ()</code> (i.e., produces <code>Unit</code>).</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#expression-result-type","title":"Expression result type","text":"<p><code>loop:</code> is an expression with a single result type:</p> <ul> <li>If every reachable <code>break</code> in the loop is <code>break</code> (no value), the loop\u2019s type is <code>Unit</code>.</li> <li>If one or more <code>break</code> statements include values, the loop\u2019s type is the least upper bound (LUB) / unification   result of all <code>break</code> value types.<ul> <li>If the compiler cannot unify the break value types, it is a type error.</li> </ul> </li> <li>If a <code>loop:</code> has no reachable <code>break</code>, it is considered non-terminating.<ul> <li>Initial implementation may treat this as a type error unless we also introduce a <code>Never</code>/<code>!</code> type.</li> </ul> </li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#interaction-with-generators-yield","title":"Interaction with generators (<code>yield</code>)","text":"<p><code>break</code> and <code>yield</code> are different control-flow concepts:</p> <ul> <li><code>break</code> exits a loop.</li> <li><code>yield</code> produces one element of an <code>Iterator[T]</code> and suspends execution (RFC 006).</li> </ul> <p>Inside a generator function, <code>loop:</code> behaves like any other loop construct:</p> <ul> <li><code>yield expr</code> produces a value and suspends the generator.</li> <li><code>break</code> exits the loop; the generator may continue after the loop, or terminate if nothing follows.</li> </ul> <p>Open design question:</p> <ul> <li>If <code>loop:</code> is allowed as an expression inside generator bodies, <code>break &lt;value&gt;</code> would produce a value for the <code>loop:</code>   expression, but this value is distinct from generator output (which is produced only by <code>yield</code>).   We can either allow this (it is orthogonal), or restrict \u201cloop-as-expression\u201d in generators initially for simplicity.</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#interaction-with-asyncawait","title":"Interaction with async/await","text":"<p><code>await</code> is an async suspension point: it pauses an <code>async def</code> until a <code>Future</code> is ready. It does not replace loops.</p> <p>You typically combine them:</p> <pre><code>async def wait_until_done() -&gt; None:\n    loop:\n        if await done():\n            break\n</code></pre> <p>If you need polling/backoff, <code>await</code> controls waiting between iterations:</p> <pre><code>async def wait_with_backoff() -&gt; None:\n    loop:\n        if done():\n            break\n        await sleep(0.01)\n\n    return\n</code></pre>"},{"location":"RFCs/016_loop_and_break_value/#examples","title":"Examples","text":""},{"location":"RFCs/016_loop_and_break_value/#example-1-compute-a-value-without-external-mutation","title":"Example 1: Compute a value without external mutation","text":"<pre><code>answer = loop:\n    if some_condition():\n        break 42\n</code></pre> <p>Equivalent with <code>while True:</code> (today):</p> <pre><code>mut answer = 0\nwhile True:\n    # Without `break &lt;value&gt;`, you typically compute a result via external mutation.\n    if some_condition():\n        answer = 42\n        break\n</code></pre>"},{"location":"RFCs/016_loop_and_break_value/#example-2-search-until-found","title":"Example 2: Search until found","text":"<pre><code>found = loop:\n    item = next_item()\n    if item.is_ok():\n        break item\n</code></pre> <p>Equivalent with <code>while True:</code> (today):</p> <pre><code>mut found = None\nwhile True:\n    item = next_item()\n    if item.is_ok():\n        found = item\n        break\n</code></pre> <p>Alternative with a conditional <code>while</code> (works when you can express the loop as \u201crepeat until condition\u201d):</p> <pre><code>item = next_item()\nwhile not item.is_ok():\n    item = next_item()\n\n# Here: item.is_ok() == true\nfound = item\n</code></pre> <p>Why keep <code>loop:</code> / <code>break &lt;value&gt;</code> anyway?</p> <ul> <li><code>loop:</code> supports multiple exit points naturally (success, timeout, error), without extra state variables.</li> <li><code>break &lt;value&gt;</code> makes the loop expression-oriented, so you can write <code>found = loop: ... break value</code> directly.</li> <li>A conditional <code>while</code> often forces pre-initialization (or a <code>do-while</code> construct) to compute the first value.</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#example-3-break-without-value","title":"Example 3: <code>break</code> without value","text":"<pre><code>loop:\n    if done():\n        break\n</code></pre>"},{"location":"RFCs/016_loop_and_break_value/#lowering-codegen-strategy-rust-backend","title":"Lowering / codegen strategy (Rust backend)","text":""},{"location":"RFCs/016_loop_and_break_value/#desugaring-options","title":"Desugaring options","text":"<p>The compiler may implement <code>loop:</code> in one of two ways:</p> <ol> <li>AST-level sugar: desugar <code>loop:</code> to <code>while True:</code> early, and keep codegen optimizations.</li> <li>Dedicated IR node: lower <code>loop:</code> directly to an IR <code>Loop</code> statement/expression, and emit Rust <code>loop {}</code>.</li> </ol> <p>If <code>break &lt;value&gt;</code> is introduced, a dedicated IR representation is recommended, because Rust requires:</p> <ul> <li><code>loop { ... break expr; }</code> for value-yielding loops, and</li> <li>the <code>loop</code> construct (not <code>while</code>) to yield a value.</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#ir-changes","title":"IR changes","text":"<p>If we treat <code>loop:</code> as an expression, IR likely needs:</p> <ul> <li>An expression form (e.g., <code>IrExprKind::Loop { body: Vec&lt;IrStmt&gt;, result_ty: IrType }</code>), or</li> <li>A block-expression convention where a <code>Loop</code> statement plus <code>break value</code> composes into an expression value.</li> </ul> <p>Additionally, <code>IrStmtKind::Break</code> should be extended to carry an optional value expression (and still optionally support labels in the future).</p>"},{"location":"RFCs/016_loop_and_break_value/#backwards-compatibility","title":"Backwards compatibility","text":"<ul> <li>Existing programs remain valid.</li> <li><code>while True:</code> remains valid and may continue to codegen to Rust <code>loop {}</code>.</li> <li><code>break</code> without value remains valid.</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#alternatives-considered","title":"Alternatives considered","text":""},{"location":"RFCs/016_loop_and_break_value/#implementation-notes-current-crate-layout","title":"Implementation notes (current crate layout)","text":"<p>This RFC introduces new syntax and vocabulary:</p> <ul> <li>A new keyword: <code>loop</code></li> <li>An extended form of <code>break</code> (<code>break &lt;value&gt;</code>)</li> </ul> <p>In the current workspace, those changes should be implemented in:</p> <ul> <li><code>crates/incan_core/src/lang/keywords.rs</code>: add <code>loop</code> to the keyword registry (with correct RFC provenance)</li> <li><code>crates/incan_syntax</code>: lexer emits <code>TokenKind::Keyword(KeywordId::Loop)</code> and parser handles <code>loop:</code> and <code>break &lt;expr&gt;</code></li> <li><code>crates/incan_core</code> docgen/tests: update reference docs + add parity/guardrail tests so registry \u2194 lexer stay aligned</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#alternative-a-only-keep-while-true","title":"Alternative A: Only keep <code>while True:</code>","text":"<p>Pros:</p> <ul> <li>No new keyword.</li> </ul> <p>Cons:</p> <ul> <li>Harder to justify <code>break &lt;value&gt;</code> on <code>while</code>.</li> <li>Less clear intent in source.</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#alternative-b-make-while-an-expression-too","title":"Alternative B: Make <code>while</code> an expression too","text":"<p>Pros:</p> <ul> <li>Fewer constructs.</li> </ul> <p>Cons:</p> <ul> <li>More semantic surface and surprises (\u201c<code>while</code> yields a value?\u201d).</li> <li>Less aligned with Rust codegen constraints.</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#open-questions","title":"Open questions","text":"<ul> <li>Do we want a <code>Never</code>/<code>!</code> type for non-terminating <code>loop:</code> expressions?</li> <li>Do we want labeled loops (and labeled <code>break</code>/<code>continue</code>) in the same RFC or separately?</li> <li>Should <code>loop:</code> be allowed in statement position only initially, with expression usage added later?</li> </ul>"},{"location":"RFCs/016_loop_and_break_value/#possible-future-syntax-sugar-loop-until","title":"Possible future syntax sugar: <code>loop ... until ...</code>","text":"<p>We may add a compact, statement-level sugar for \u201crepeat an action until a condition holds\u201d:</p> <pre><code>loop item.next() until item.is_ok()\n</code></pre> <p>Desugaring (action first, then test, then break):</p> <pre><code>loop:\n    item.next()\n    if item.is_ok():\n        break\n</code></pre> <p>Notes:</p> <ul> <li><code>until &lt;expr&gt;</code> must typecheck to <code>bool</code>.</li> <li>This form is intended as a statement (it does not yield a value by itself).</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/","title":"RFC 017: Validated newtypes with implicit coercion (pydantic-like feel)","text":"<p>Status: Planned Created: 2026-01-12 Target: v0.2  </p>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#01-vs-02-whats-implemented-when","title":"0.1 vs 0.2 (what\u2019s implemented when)","text":"<p>This RFC describes the intended v0.2 direction.</p> <p>For v0.1 stabilization, we may land only the minimum foundations needed so newtype construction and model/class construction semantics \u201cmake sense\u201d (e.g., reserved hook recognition, no validation bypass paths, better diagnostics).</p>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#area","title":"Area","text":"<ul> <li>Incan Language (syntax/semantics)</li> <li>Runtime / Core crates (stdlib/core/derive)</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#summary","title":"Summary","text":"<p>Introduce a pydantic-like \u201cvalidated boundary\u201d for <code>newtype</code> by standardizing a canonical validation/conversion hook on every newtype and allowing the compiler to perform implicit coercion from the underlying type in well-defined contexts (function arguments, typed initializers, and model/class field initialization). Invalid input fails fast with a <code>ValidationError</code> panic by default to preserve \u201cpydantic feel\u201d.</p> <p>Because panics can be a poor fit for reusable library code and long-running services, the proposal also keeps an explicit <code>Result</code>-returning constructor for recoverable flows, and introduces opt-out controls (e.g. <code>@no_implicit_coercion</code>) plus structured/aggregated validation errors for model/class initialization.</p>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#motivation","title":"Motivation","text":"<p>We want guardrails for common primitives (especially numerics) without forcing boilerplate everywhere. In practice, many values originate from boundaries (CLI/config/env/API), and teams want \u201cit just works\u201d-ergonomics with strong invariants and high-quality error messages.</p> <p>Today, users can implement validation manually (e.g. helper constructors returning <code>Result</code>), but this requires explicit calls at every use site. The desired \u201cpydantic feel\u201d is:</p> <ul> <li>pass raw values at boundaries</li> <li>have them coerced + validated automatically</li> <li>get a clear <code>ValidationError</code> on invalid inputs</li> </ul> <p>Concrete \u201cpydantic-like\u201d types this model can express (v1 targets):</p> <ul> <li>Constrained numerics (pure): <code>PositiveInt</code>, <code>NonNegativeInt</code>, \u201cfinite float\u201d, etc.</li> <li>Parsing/normalization types (pure): e.g. <code>HttpUrl</code>, <code>UUID4</code>, <code>IPvAnyAddress</code> implemented as parse + normalize (no DNS/network   IO).</li> <li>Human-friendly boundary parsing stays explicit: e.g. <code>BytesCount = newtype int[ge=0]</code> plus an explicit   <code>parse_byte_size(str) -&gt; Result[BytesCount, ValidationError]</code> (v1 does not introduce implicit <code>str -&gt; int</code> parsing).</li> <li>Redaction/masking types: e.g. <code>SecretStr</code> can be a normal <code>newtype str</code>; masking is a formatter/serializer concern (outside   this RFC\u2019s compiler changes).</li> </ul> <p>Conversely, some pydantic types are intentionally out-of-scope for v1 implicit coercion because they are non-deterministic (filesystem existence checks like <code>FilePath</code>, clock-based checks like <code>PastDate</code>, etc.). Those can still exist as explicit constructors, or via a future \u201cimpure validation\u201d extension.</p>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#proposal-sketch","title":"Proposal sketch","text":""},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#newtype-validationconversion-hook-canonical","title":"Newtype validation/conversion hook (canonical)","text":"<p>For a newtype:</p> <pre><code>type Attempts = newtype int:\n    def from_underlying(n: int) -&gt; Result[Attempts, ValidationError]:\n        if n &lt;= 0:\n            return Err(ValidationError(\"attempts must be &gt;= 1\"))\n        return Ok(Attempts(n))\n</code></pre> <p>Notes:</p> <ul> <li><code>from_underlying</code> is the canonical \u201cvalidated conversion\u201d from the newtype\u2019s underlying type.</li> <li>It is defined in the newtype body (supported today by parser); there is no separate <code>impl</code> block in Incan.</li> <li>If a newtype does not define <code>from_underlying</code>, the compiler auto-generates a default implementation:<ul> <li><code>from_underlying(x) = Ok(T(x))</code> (no extra validation).</li> <li>If the underlying type includes constraints (e.g. <code>int[gt=0]</code>), the generated <code>from_underlying</code> enforces those constraints.</li> </ul> </li> <li><code>from_underlying</code> is treated as a reserved hook name for newtypes (compiler-recognized for coercion/validation).</li> <li>Contract (important for predictability and tooling):<ul> <li><code>from_underlying</code> must be deterministic and side-effect free (no IO, no global mutation, no time/random dependence,   no randomized hashing dependence).</li> <li><code>from_underlying</code> must not panic; it returns <code>Err(ValidationError)</code> on invalid input.</li> <li>On <code>Ok(...)</code>, it must return exactly the validated newtype instance corresponding to the input (no \u201cpartial\u201d values).</li> <li>This intentionally rules out validators that consult the filesystem, the clock, randomness, or the network; those   require explicit validation, or a future opt-in extension with tighter guardrails.</li> </ul> </li> </ul> <p>Relationship to <code>TryFrom[T]</code> (stdlib):</p> <ul> <li>Incan already has a <code>TryFrom[T]</code> trait with <code>@classmethod def try_from(cls, value: T) -&gt; Result[Self, str]</code>.</li> <li>This RFC introduces <code>from_underlying(...) -&gt; Result[T, ValidationError]</code> as a dedicated hook because:<ul> <li>we want a structured <code>ValidationError</code> (paths, chains, constraint metadata) rather than a plain <code>str</code>, and</li> <li>Incan does not yet have <code>impl</code> blocks for newtypes, so a compiler-recognized hook inside the newtype body keeps the   surface area minimal.</li> </ul> </li> <li>Future-friendly: the compiler could auto-provide <code>TryFrom[U]</code> for a newtype by delegating to <code>from_underlying</code> and   stringifying the error, but <code>from_underlying</code> remains the canonical validation contract.</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#constrained-underlying-type-syntax-nice-surface-form","title":"Constrained underlying type syntax (nice surface form)","text":"<p>To avoid the semantic implication that <code>int(...)</code> accepts constraint keyword arguments at runtime, represent constraints as type-level parameters using bracket syntax:</p> <p>(Inspiration: this is similar in spirit to Python's <code>typing.Annotated[...]</code> constraints and pydantic's constrained types. The goal is \u201cfeel\u201d, not copying pydantic syntax.)</p> <pre><code>type NonNegativeInt = newtype int[ge=0]\ntype PositiveInt = newtype int[gt=0]\n</code></pre> <p>Semantics:</p> <ul> <li><code>int(\"5\")</code> remains a plain conversion to <code>int</code> (no constraints).</li> <li>The constraints live on the constrained type (<code>int[ge=0]</code>) and are enforced by the newtype\u2019s validation hook (<code>from_underlying</code>)   and by implicit coercion sites.</li> <li>This keeps constraint syntax in the \u201ctype parameter\u201d family (similar to <code>list[T]</code>, <code>Result[T, E]</code>) rather than looking   like a runtime call with keyword arguments.</li> <li>For v1, constrained primitive types are intended to be used as the underlying type of a <code>newtype</code> (not as a general   \u201cdrop-in replacement\u201d for <code>int</code>/<code>float</code> everywhere). This keeps the surface area small while preserving the feel.</li> </ul> <p>Constraint vocabulary (v1, proposal):</p> <ul> <li><code>int[...]</code>: <code>ge</code>, <code>gt</code>, <code>le</code>, <code>lt</code> (values must be compile-time constants: literals or named <code>const</code>s)</li> <li><code>float[...]</code> (optional for v1): <code>ge</code>, <code>gt</code>, <code>le</code>, <code>lt</code> (values must be compile-time constants: literals or named <code>const</code>s)<ul> <li>IEEE note: comparisons with NaN are always false, so NaN should fail all constraints by default.</li> </ul> </li> </ul> <p>Constraint semantics:</p> <ul> <li><code>ge</code>: greater than or equal (\\(\\ge\\))</li> <li><code>gt</code>: greater than (\\(&gt;\\))</li> <li><code>le</code>: less than or equal (\\(\\le\\))</li> <li><code>lt</code>: less than (\\(&lt;\\))</li> </ul> <p>Syntax notes:</p> <ul> <li>Multiple constraints are allowed: <code>int[ge=0, lt=10]</code> (order-insensitive; all constraints must hold).</li> <li>Constraint parameters are compile-time constants (not arbitrary expressions).</li> <li>Only a single constraint block is permitted on a primitive type (e.g. <code>int[...]</code> cannot be followed by another <code>[...]</code>).</li> <li>Duplicate keys are rejected (e.g. <code>int[gt=0, gt=1]</code> is an error).</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#newtype-on-newtype-transitive-coercion","title":"Newtype-on-newtype (transitive coercion)","text":"<p>Newtypes should be able to wrap other newtypes:</p> <pre><code>type PositiveInt = newtype int[gt=0]\ntype RetryAttempts = newtype PositiveInt\n</code></pre> <p>In this case, implicit coercion should be transitive:</p> <ul> <li>expected <code>RetryAttempts</code>, got <code>int</code><ul> <li>coerce <code>int -&gt; PositiveInt</code> (validate <code>gt=0</code>)</li> <li>then coerce <code>PositiveInt -&gt; RetryAttempts</code></li> </ul> </li> </ul> <p>Because each newtype has exactly one underlying type, the coercion chain is deterministic. The compiler should reject cycles (if they can be formed) with a clear diagnostic.</p>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#implicit-coercion-sites-compiler-rewriting","title":"Implicit coercion sites (compiler rewriting)","text":"<p>When a context expects a validated newtype <code>T_target</code> but receives a value of some type <code>S0</code>, the compiler may insert implicit coercions consisting only of validated newtype conversions (<code>from_underlying</code>), potentially chained across nested newtypes.</p> <p>Critically, the compiler does not insert ambient primitive conversions (e.g. <code>str -&gt; int</code>, <code>int -&gt; float</code>) as part of implicit coercion. If you want parsing/coercion between primitives, write it explicitly at the call site (e.g. <code>int(\"5\")</code>).</p>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#proposed-contexts","title":"Proposed contexts","text":"<ol> <li>Function arguments</li> <li>Typed initializers</li> <li>Model/class field initialization</li> <li>Newtype construction (checked by default; <code>T(x)</code> treated as a coercion/validation site)</li> </ol>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#controls-policy-avoid-hidden-panics","title":"Controls &amp; policy (avoid hidden panics)","text":"<p>Implicit coercion is intended as a boundary ergonomics feature, but it can introduce hidden panics in reusable library code (especially when used via function arguments). Provide opt-out controls so library/service authors can make call sites explicit.</p>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#failure-behavior-pydantic-like","title":"Failure behavior (pydantic-like)","text":"<p>If <code>from_underlying(...)</code> returns <code>Err(e)</code> during implicit coercion, panic with a <code>ValidationError</code> (or wrap the returned <code>e</code> into a <code>ValidationError</code>), similar to pydantic raising/throwing a validation exception.</p> <p>Aggregation policy:</p> <ul> <li>Function arguments and typed initializers: fail fast (panic on first invalid coercion).</li> <li>Model/class field initialization: aggregate all field coercion errors and panic once with a multi-error   <code>ValidationError</code> for better diagnostics.</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#impact-compatibility","title":"Impact / compatibility","text":"<ul> <li>Behavioral: introduces implicit conversions at specific boundaries; must be carefully scoped to avoid \u201cmagic everywhere\u201d.</li> <li>Runtime: implicit coercion failure panics; this must be clearly documented as a boundary feature.</li> <li>Performance: newtypes should remain zero-cost wrappers in generated code; validation cost is paid only at coercion sites   and should not allocate/box unless the user\u2019s <code>from_underlying</code> does so.</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#implementation-notes-high-level","title":"Implementation notes (high-level)","text":"<p>Likely layers:</p> <ul> <li>Syntax/parser: support constrained primitive type syntax like <code>int[gt=0]</code> as a type-level annotation.</li> <li>Frontend/typechecker: detect coercion sites and insert validated coercion nodes.</li> <li>Lowering/codegen: emit calls to <code>from_underlying</code> and panic with rich errors on failure.</li> <li>Stdlib/core: define <code>ValidationError</code> shape and formatting.</li> <li>Docs: document coercion behavior and explicit alternatives.</li> <li>Tests: parser + typechecker + codegen + runtime behavior.</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#unresolved-questions","title":"Unresolved questions","text":"<ul> <li>Panic strategy: unwind vs abort for <code>ValidationError</code> panics.</li> <li>Constraint catalog scope for v1.</li> <li>Non-panicking coercion mode (<code>Result</code> mode).</li> <li>Serialization/FFI boundaries.</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#checklist-comprehensive","title":"Checklist (comprehensive)","text":""},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#spec-semantics","title":"Spec / semantics","text":"<ul> <li>[ ] Lock down the canonical hook name and signature:<ul> <li>[ ] <code>from_underlying(underlying: U) -&gt; Result[Self, ValidationError]</code> as the compiler-recognized entrypoint</li> <li>[ ] deterministic / side-effect free contract, and \u201cmust not panic\u201d rule</li> </ul> </li> <li>[ ] Define the failure policy precisely per coercion site:<ul> <li>[ ] function args + typed initializers: fail-fast (panic on first invalid coercion)</li> <li>[ ] model/class construction: aggregate all field coercion failures and panic once</li> </ul> </li> <li>[ ] Define transitive coercion rules for newtype-on-newtype (chain building + cycle detection).</li> <li>[ ] Define opt-out controls (library-friendly):<ul> <li>[ ] <code>@no_implicit_coercion</code> (type-level) and/or per-site opt-out</li> <li>[ ] \u201cResult mode\u201d / explicit construction guidance</li> </ul> </li> <li>[ ] Define constraint semantics for <code>int[...]</code> / <code>float[...]</code>:<ul> <li>[ ] permitted keys (<code>ge/gt/le/lt</code>) + compile-time const rules for values</li> <li>[ ] NaN policy for float constraints</li> <li>[ ] duplicate keys + incompatible constraint combinations diagnostics</li> </ul> </li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#syntax-ast","title":"Syntax / AST","text":"<ul> <li>[ ] Parser: support constrained primitive type syntax in type position (e.g. <code>int[gt=0]</code>, <code>float[ge=0.0]</code>).</li> <li>[ ] AST: represent constrained types in a structured way (not as ad-hoc strings).</li> <li>[ ] Formatter: preserve / normalize constraint formatting (order-insensitive, stable output).</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#frontend-typechecker","title":"Frontend (typechecker)","text":"<ul> <li>[ ] Recognize <code>from_underlying</code> as a reserved newtype hook and validate its shape:<ul> <li>[ ] static (no receiver)</li> <li>[ ] exactly one parameter of the underlying type (including constrained underlying types)</li> <li>[ ] return type is <code>Result[Newtype, ValidationError]</code></li> </ul> </li> <li>[ ] For newtypes without <code>from_underlying</code>, define and implement the auto-generated default behavior:<ul> <li>[ ] <code>Ok(T(x))</code> if no constraints</li> <li>[ ] enforce constraints from underlying type if present</li> </ul> </li> <li>[ ] Insert implicit coercions at the approved sites:<ul> <li>[ ] function arguments</li> <li>[ ] typed initializers</li> <li>[ ] model/class field initialization</li> <li>[ ] newtype construction <code>T(x)</code> (checked by default)</li> </ul> </li> <li>[ ] Ensure the compiler does not insert ambient primitive conversions (no <code>str -&gt; int</code>, no <code>int -&gt; float</code>).</li> <li>[ ] Diagnostics quality:<ul> <li>[ ] span-accurate errors pointing at the call site / field initializer</li> <li>[ ] actionable hints (show explicit <code>T.from_underlying(...)</code> / <code>try_...</code> alternatives)</li> <li>[ ] include coercion chain in errors (e.g. <code>int -&gt; PositiveInt -&gt; RetryAttempts</code>)</li> </ul> </li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#lowering-ir","title":"Lowering / IR","text":"<ul> <li>[ ] Introduce an explicit IR representation for \u201cvalidated coercion\u201d (preferred) or document the exact rewriting strategy.</li> <li>[ ] Ensure lowering avoids recursion traps (e.g. <code>T(x)</code> inside <code>impl T</code> / inside the hook itself).</li> <li>[ ] Preserve deterministic evaluation order for default values and coercion calls.</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#codegen-rust-emission","title":"Codegen (Rust emission)","text":"<ul> <li>[ ] Emit <code>from_underlying(...)</code> calls at coercion sites.</li> <li>[ ] Emit failure behavior:<ul> <li>[ ] fail-fast sites: panic with <code>ValidationError</code> (include message + path context)</li> <li>[ ] aggregated sites: collect multiple errors and panic once</li> </ul> </li> <li>[ ] Keep generated code zero-cost outside coercion sites (no extra allocations on happy path beyond user code).</li> <li>[ ] Decide and document when generated code may use <code>.expect(...)</code> / <code>.unwrap(...)</code> vs structured error helpers.</li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#runtime-core-crates","title":"Runtime / core crates","text":"<ul> <li>[ ] Define canonical <code>ValidationError</code> type:<ul> <li>[ ] structured fields (path, kind, message, optional nested causes)</li> <li>[ ] stable formatting (human-readable + optionally machine-readable)</li> </ul> </li> <li>[ ] Provide helper APIs for:<ul> <li>[ ] creating per-field errors</li> <li>[ ] aggregating multiple errors</li> <li>[ ] panic/raise helpers with <code>#[track_caller]</code></li> </ul> </li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#tooling-docs","title":"Tooling / docs","text":"<ul> <li>[ ] Update Book + Reference docs:<ul> <li>[ ] explain <code>from_underlying</code></li> <li>[ ] document implicit coercion sites and opt-out controls</li> <li>[ ] show explicit alternatives (<code>Result</code>-returning flows)</li> </ul> </li> <li>[ ] Add examples:<ul> <li>[ ] constrained numeric newtypes</li> <li>[ ] parsing/normalization newtypes (pure)</li> <li>[ ] model/class aggregated validation example</li> </ul> </li> </ul>"},{"location":"RFCs/017_validated_newtypes_with_implicit_coercion/#testing-must-be-comprehensive","title":"Testing (must be comprehensive)","text":"<ul> <li>[ ] Parser tests for constraint syntax and errors.</li> <li>[ ] Typechecker tests:<ul> <li>[ ] correct insertion of coercions at each site</li> <li>[ ] no ambient primitive conversions</li> <li>[ ] transitive coercion chains + cycle detection errors</li> <li>[ ] spans + hint text assertions for key diagnostics</li> </ul> </li> <li>[ ] Codegen snapshot tests:<ul> <li>[ ] emitted <code>from_underlying</code> calls at each coercion site</li> <li>[ ] emitted aggregation logic for model/class initialization</li> </ul> </li> <li>[ ] Runtime behavior tests:<ul> <li>[ ] panic messages include correct path/field context</li> <li>[ ] aggregated errors contain all invalid fields</li> </ul> </li> </ul>"},{"location":"RFCs/TEMPLATE/","title":"RFC Template","text":"<p>Use this template for RFCs in <code>docs/RFCs/</code>. Keep the RFC focused: one coherent proposal, with clear motivation, semantics, and implementation strategy.</p>"},{"location":"RFCs/TEMPLATE/#title","title":"Title","text":"<p>RFC NNN: \\&lt;short descriptive title&gt;</p>"},{"location":"RFCs/TEMPLATE/#status","title":"Status","text":"<ul> <li>Status: Draft | In Progress | Implemented | Deferred</li> <li>Author(s): \\&lt;name/handle&gt;</li> <li>Issue: \\&lt;link to issue&gt;</li> <li>RFC PR: \\&lt;link to PR&gt;</li> </ul>"},{"location":"RFCs/TEMPLATE/#summary","title":"Summary","text":"<p>One paragraph describing what this RFC proposes.</p>"},{"location":"RFCs/TEMPLATE/#motivation","title":"Motivation","text":"<p>Explain the problem and why it matters:</p> <ul> <li>What\u2019s painful/confusing today?</li> <li>Who benefits?</li> <li>Why is this better than the status quo?</li> </ul>"},{"location":"RFCs/TEMPLATE/#guide-level-explanation-how-users-think-about-it","title":"Guide-level explanation (how users think about it)","text":"<p>Explain the feature as a user would understand it. Include examples.</p> <pre><code># Example code\n</code></pre>"},{"location":"RFCs/TEMPLATE/#reference-level-explanation-precise-rules","title":"Reference-level explanation (precise rules)","text":"<p>Define exact semantics, typing rules, and edge cases.</p> <ul> <li>Syntax changes (grammar-ish description, if needed)</li> <li>Type checking rules</li> <li>Runtime behavior</li> <li>Errors / diagnostics</li> </ul>"},{"location":"RFCs/TEMPLATE/#design-details","title":"Design details","text":""},{"location":"RFCs/TEMPLATE/#syntax","title":"Syntax","text":"<p>Describe new/changed syntax.</p>"},{"location":"RFCs/TEMPLATE/#semantics","title":"Semantics","text":"<p>Describe behavior precisely.</p>"},{"location":"RFCs/TEMPLATE/#interaction-with-existing-features","title":"Interaction with existing features","text":"<p>How this composes with:</p> <ul> <li>async/await</li> <li>traits/derives</li> <li>imports/modules</li> <li>error handling (Result/Option)</li> <li>Rust interop</li> </ul>"},{"location":"RFCs/TEMPLATE/#compatibility-migration","title":"Compatibility / migration","text":"<ul> <li>Is this breaking?</li> <li>If yes, provide a migration strategy and examples.</li> </ul>"},{"location":"RFCs/TEMPLATE/#alternatives-considered","title":"Alternatives considered","text":"<p>List plausible alternatives and why they\u2019re worse.</p>"},{"location":"RFCs/TEMPLATE/#drawbacks","title":"Drawbacks","text":"<p>What does this cost (complexity, performance, mental model)?</p>"},{"location":"RFCs/TEMPLATE/#implementation-plan","title":"Implementation plan","text":"<p>Concrete steps (expected touchpoints):</p> <ul> <li>Frontend changes (lexer/parser/AST/typechecker)</li> <li>Backend changes (IR/lowering/emission)</li> <li>Stdlib/runtime changes</li> <li>Tooling changes (fmt/test/LSP)</li> <li>Tests to add (unit/integration/fixtures)</li> </ul>"},{"location":"RFCs/TEMPLATE/#unresolved-questions","title":"Unresolved questions","text":"<p>Open questions to decide before implementation lands.</p>"},{"location":"RFCs/done/000_core_rfc/","title":"RFC 000: Incan Core Language RFC (Phase 1)","text":"<p>Status: Done Created: 2024-11-26</p> <p>This RFC consolidates the core semantics decisions for Incan's first implementation phase.</p>"},{"location":"RFCs/done/000_core_rfc/#1-core-semantics","title":"1. Core Semantics","text":""},{"location":"RFCs/done/000_core_rfc/#11-typing-model","title":"1.1 Typing Model","text":"<ul> <li>Required types: All bindings, parameters, and return types must have explicit types; no gradual or optional typing.</li> <li>Compile-time enforcement: Type mismatches fail at compile time, not runtime.</li> <li>Inference: Local type inference is allowed where unambiguous (e.g., <code>x=42</code> infers <code>int</code>), but function signatures require explicit types.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#12-bindings-and-mutability","title":"1.2 Bindings and Mutability","text":"<ul> <li>Immutable by default: Bindings are immutable unless marked <code>mut</code>.</li> <li>Syntax: <code>x = value</code> for immutable; <code>mut x = value</code> for mutable.</li> <li>Optional <code>let</code>: <code>let x = value</code> is equivalent to <code>x = value</code>; <code>let</code> is optional for Pythonic feel.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#13-receivers-self-mut-self","title":"1.3 Receivers (<code>self</code> / <code>mut self</code>)","text":"<ul> <li><code>self</code> is a keyword, not a convention; it must appear explicitly in method signatures.</li> <li>Immutable receiver: <code>def method(self, ...)</code> \u2014 read-only access to fields.</li> <li>Mutable receiver: <code>def method(mut self, ...)</code> \u2014 can mutate fields.</li> <li>Static dispatch: Method calls resolve statically unless trait objects are used.</li> <li>No full borrow checker: Simplified mutability model (<code>self</code> vs <code>mut self</code>) without Rust's full ownership/borrowing.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#14-error-handling-result","title":"1.4 Error Handling (<code>Result</code> / <code>?</code>)","text":"<ul> <li><code>Result[T, E]</code>: Primary error type; represents <code>Ok(value)</code> or <code>Err(error)</code>.</li> <li><code>Option[T]</code>: Represents <code>Some(value)</code> or <code>None</code>; for optional values.</li> <li><code>?</code> operator: If expression is <code>Err(e)</code>, early-return with that error; if <code>Ok(v)</code>, unwrap to <code>v</code>.</li> <li>Compile-time enforcement: Functions using <code>?</code> must return a compatible <code>Result</code>.</li> <li>Panics are exceptional: Reserved for unrecoverable errors; normal errors use <code>Result</code>.</li> <li><code>unwrap()</code>/<code>expect()</code> are for unrecoverable paths only; normal errors use <code>Result</code> + <code>?</code>.</li> <li>Optional sugar: <code>Result[T, E1 | E2]</code> may be provided as syntax sugar, desugaring to a generated enum so <code>?</code> still operates on a single concrete error type. Prefer one error type per function; use <code>map_err</code> / <code>From</code> conversions as needed.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#15-traits","title":"1.5 Traits","text":"<ul> <li>Behavior-only: Traits define methods only; no storage/fields. Traits must not declare fields; if a trait assumes fields exist, they must be provided by the adopter. This is enforced at compile time.</li> <li>Default methods: Traits can provide default implementations that may assume fields exist on the adopter.</li> <li>Deterministic composition: Multiple traits compose left-to-right; order is explicit and compile-time resolved.</li> <li>No Python MRO: No dynamic method resolution order; conflicts must be resolved explicitly.</li> <li>No runtime patching: Traits cannot be added at runtime; no monkey-patching.</li> <li>Conflict resolution: When multiple traits provide the same method, the adopting class must explicitly resolve (e.g., <code>TraitA.method(self, ...)</code>).</li> <li>Optional <code>@requires</code>: Annotation to declare expected fields/methods on adopters.</li> </ul> <pre><code>trait Loggable:\n  def log(self, msg: str):\n    print(f\"[{self.name}] {msg}\")   # assumes self.name exists\n\n# With explicit requires (optional ergonomic)\n@requires(name: str)\ntrait Loggable:\n  def log(self, msg: str):\n    print(f\"[{self.name}] {msg}\")\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#16-models","title":"1.6 Models","text":"<ul> <li>Data-first containers: Declarative fields with optional validation.</li> <li>Own storage: Models own their fields.</li> <li>Validation: Via <code>@derive(Validate)</code> or manual <code>validate(self) -&gt; Result[Self, E]</code> methods.</li> <li>Cannot inherit from classes: Models are not classes; they are data containers.</li> <li>Can implement traits: Models can adopt storage-free traits.</li> </ul> <pre><code>@derive(Validate)\nmodel User:\n  id: UserId\n  email: Email\n  is_active: bool = true\n\n  def validate(self) -&gt; Result[User, ValidationError]:\n    if not self.is_active and not self.email.as_str().endswith(\"@example.com\"):\n      return Err(ValidationError.InactiveExternal)\n    return Ok(self)\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#17-classes","title":"1.7 Classes","text":"<ul> <li>General-purpose types: Fields, methods, single inheritance, trait composition.</li> <li>Own storage: Classes own their fields.</li> <li>Single inheritance: <code>class Child extends Parent</code>.</li> <li>Trait composition: <code>class Service with TraitA, TraitB</code>.</li> </ul> <pre><code>class Service with Loggable:\n  name: str\n  repo: UserRepo\n\n  def onboard(self, user: User) -&gt; Result[User, ValidationError]:\n    self.log(f\"creating {user.email.as_str()}\")\n    return self.repo.save(user)\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#18-newtypes","title":"1.8 Newtypes","text":"<ul> <li>Zero-cost wrappers: Enforce invariants at construction.</li> <li>Constructors return <code>Result</code>: Validation failures are explicit. Newtypes must be constructed via their validated constructors; direct field construction is disallowed. Codegen enforces the constructor path.</li> <li>Type-safe: Newtypes are distinct from their underlying type.</li> </ul> <pre><code>type Email = newtype str:\n  @validate new\n  def from_str(v: str) -&gt; Result[Email, ValidationError]:\n    if \"@\" not in v:\n      return Err(ValidationError.EmailMissingAt)\n    return Ok(Email(v.lower()))\n\ntype UserId = newtype uuid\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#19-enums","title":"1.9 Enums","text":"<ul> <li>Algebraic data types: Variants can carry data.</li> <li>Exhaustive matching: <code>match</code> must cover all variants.</li> </ul> <pre><code>enum ValidationError:\n  EmailMissingAt\n  InactiveExternal\n  RepoError(str)\n\nenum Option[T]:\n  Some(T)\n  None\n\nenum Result[T, E]:\n  Ok(T)\n  Err(E)\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#110-functions","title":"1.10 Functions","text":"<ul> <li><code>def</code> keyword: <code>def name(params) -&gt; ReturnType:</code>.</li> <li><code>async def</code>: For async functions.</li> <li>Explicit return types: Required for all functions.</li> <li>No implicit returns: Functions must use <code>return</code>. (Future: implicit last-expression returns could be considered, but are not allowed now.)</li> </ul> <pre><code>def load_config(path: Path) -&gt; Result[Config, IoError]:\n  raw = read_file(path)?\n  return Config.parse(raw)?\n\nasync def fetch_all(urls: List[str]) -&gt; List[Bytes]:\n  tasks = [fetch(u) for u in urls]\n  return await gather(tasks)\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#2-builtin-types-and-traits","title":"2. Builtin Types and Traits","text":""},{"location":"RFCs/done/000_core_rfc/#21-core-types","title":"2.1 Core Types","text":"Type Description <code>int</code> Signed integer (platform-sized or explicit: <code>i32</code>, <code>i64</code>) <code>float</code> Floating point (<code>f32</code>, <code>f64</code>) <code>bool</code> Boolean (<code>true</code>, <code>false</code>) <code>str</code> UTF-8 string <code>bytes</code> Byte sequence <code>List[T]</code> Growable list <code>Dict[K, V]</code> Hash map <code>Set[T]</code> Hash set <code>Tuple[T, ...]</code> Fixed-size heterogeneous tuple <code>Option[T]</code> <code>Some(T)</code> or <code>None</code> <code>Result[T, E]</code> <code>Ok(T)</code> or <code>Err(E)</code> <code>Unit</code> Void/unit type (empty tuple)"},{"location":"RFCs/done/000_core_rfc/#22-core-traits","title":"2.2 Core Traits","text":"Trait Description Python Analog <code>Debug</code> Debug formatting <code>__repr__</code> <code>Display</code> User-facing formatting <code>__str__</code> <code>Eq</code> Equality comparison <code>__eq__</code> <code>PartialEq</code> Partial equality <code>__eq__</code> <code>Ord</code> Total ordering <code>__lt__</code>, <code>__le__</code>, etc. <code>PartialOrd</code> Partial ordering <code>__lt__</code>, <code>__le__</code>, etc. <code>Hash</code> Hashable <code>__hash__</code> <code>Clone</code> Explicit duplication <code>copy.copy</code> <code>Default</code> Default construction <code>__init__</code> with defaults <code>From[T]</code> Conversion from <code>T</code> <code>@classmethod</code> constructor <code>Into[T]</code> Conversion into <code>T</code> \u2014 <code>TryFrom[T]</code> Fallible conversion from <code>T</code> \u2014 <code>TryInto[T]</code> Fallible conversion into <code>T</code> \u2014 <code>Iterator</code> Iteration protocol <code>__iter__</code>, <code>__next__</code> <code>IntoIterator</code> Convert to iterator <code>__iter__</code> <code>Error</code> Error behavior <code>Exception</code>"},{"location":"RFCs/done/000_core_rfc/#23-derives","title":"2.3 Derives","text":"<p>Derives auto-generate trait implementations for models and newtypes:</p> Derive Generated <code>@derive(Debug)</code> Debug formatting <code>@derive(Display)</code> Display formatting <code>@derive(Eq)</code> Equality + PartialEq <code>@derive(Ord)</code> Ordering + PartialOrd <code>@derive(Hash)</code> Hash implementation <code>@derive(Clone)</code> Clone implementation <code>@derive(Default)</code> Default construction <code>@derive(Validate)</code> Validation hooks <p>Multiple derives: <code>@derive(Debug, Eq, Hash, Clone)</code>.</p>"},{"location":"RFCs/done/000_core_rfc/#3-grammar-ebnf-like","title":"3. Grammar (EBNF-like)","text":"<pre><code>(* Top-level declarations *)\nprogram        = { declaration } ;\ndeclaration    = model_decl | class_decl | trait_decl | newtype_decl\n               | enum_decl | function_decl | import_decl ;\n\n(* Imports *)\nimport_decl    = import_stmt | from_import_stmt ;\n\nimport_stmt    = \"import\" ( python_import | rust_import | module_path ) [ \"as\" IDENT ] ;\nfrom_import_stmt\n              = \"from\" rust_import \"import\" import_item { \",\" import_item }\n              | \"from\" module_path \"import\" import_item { \",\" import_item } ;\n\nimport_item    = IDENT [ \"as\" IDENT ] ;\n\npython_import  = \"python\" STRING ;\nrust_import    = \"rust\" \"::\" IDENT { \"::\" IDENT } ;\n\n(* Module paths *)\nmodule_path    = parent_prefix IDENT { ( \"::\" | \".\" ) IDENT } ;\nparent_prefix  = { \"..\" }\n              | { \"super\" ( \"::\" | \".\" ) } ;\n(*\n  Note: Absolute (project-root) module paths via `crate::...` are specified by RFC 005.\n*)\n\n(* Model *)\nmodel_decl     = { decorator } \"model\" IDENT [ type_params ] \":\"\n                 INDENT { field_decl | method_decl } DEDENT ;\nfield_decl     = IDENT \":\" type [ \"=\" expr ] ;\n\n(* Class *)\nclass_decl     = { decorator } \"class\" IDENT [ type_params ]\n                 [ \"extends\" IDENT ] [ \"with\" trait_list ] \":\"\n                 INDENT { field_decl | method_decl } DEDENT ;\ntrait_list     = IDENT { \",\" IDENT } ;\n\n(* Trait *)\ntrait_decl     = { decorator } \"trait\" IDENT [ type_params ] \":\"\n                 INDENT { method_decl } DEDENT ;\n\n(* Newtype *)\nnewtype_decl   = \"type\" IDENT \"=\" \"newtype\" type [ \":\" INDENT { method_decl } DEDENT ] ;\n\n(* Enum *)\nenum_decl      = \"enum\" IDENT [ type_params ] \":\"\n                 INDENT { variant_decl } DEDENT ;\nvariant_decl   = IDENT [ \"(\" type_list \")\" ] ;\n\n(* Function / Method *)\nfunction_decl  = { decorator } [ \"async\" ] \"def\" IDENT \"(\" params \")\" \"-&gt;\" type \":\"\n                 INDENT { statement } DEDENT ;\nmethod_decl    = { decorator } [ \"async\" ] \"def\" IDENT \"(\" receiver [ \",\" params ] \")\" \"-&gt;\" type \":\"\n                 INDENT { statement } DEDENT\n               | { decorator } [ \"async\" ] \"def\" IDENT \"(\" params \")\" \"-&gt;\" type \":\" \"...\" ;\n\nreceiver       = \"self\" | \"mut\" \"self\" ;\nparams         = [ param { \",\" param } ] ;\nparam          = IDENT \":\" type [ \"=\" expr ] ;\n\n(* Decorators *)\ndecorator      = \"@\" IDENT [ \"(\" decorator_args \")\" ] ;\ndecorator_args = expr { \",\" expr } | IDENT \":\" type { \",\" IDENT \":\" type } ;\n\n(Note: Core supports both `import foo.bar` and `from foo import bar`. Decorator syntax is reserved; semantics are defined per decorator in later phases/stdlib.)\n\n(* Types *)\ntype           = simple_type | generic_type | function_type ;\nsimple_type    = IDENT | \"Unit\" ;\ngeneric_type   = IDENT \"[\" type_list \"]\" ;\ntype_list      = type { \",\" type } ;\ntype_params    = \"[\" IDENT { \",\" IDENT } \"]\" ;\nfunction_type  = \"(\" type_list \")\" \"-&gt;\" type ;\n\n(* Expressions *)\nexpr           = primary | binary_expr | unary_expr | call_expr | index_expr\n               | field_expr | method_expr | await_expr | try_expr | match_expr\n               | if_expr | list_comp | dict_comp | closure_expr ;\n               (* Note: Python-style lambda intentionally omitted in favor of arrow closures *)\n\nclosure_expr   = \"(\" [ IDENT { \",\" IDENT } ] \")\" \"=&gt;\" expr ;\n\nprimary        = IDENT | literal | \"(\" expr \")\" | \"self\" ;\nliteral        = INT | FLOAT | STRING | \"true\" | \"false\" | \"None\"\n               | list_literal | dict_literal | tuple_literal ;\nlist_literal   = \"[\" [ expr { \",\" expr } ] \"]\" ;\ndict_literal   = \"{\" [ dict_entry { \",\" dict_entry } ] \"}\" ;\ndict_entry     = expr \":\" expr ;\ntuple_literal  = \"(\" expr \",\" [ expr { \",\" expr } ] \")\" ;\n\nbinary_expr    = expr binary_op expr ;\nbinary_op      = \"+\" | \"-\" | \"*\" | \"/\" | \"%\" | \"==\" | \"!=\" | \"&lt;\" | \"&gt;\" | \"&lt;=\" | \"&gt;=\"\n               | \"and\" | \"or\" | \"in\" | \"not in\" ;\nunary_expr     = unary_op expr ;\nunary_op       = \"-\" | \"not\" ;\n\ncall_expr      = expr \"(\" [ arg_list ] \")\" ;\narg_list       = arg { \",\" arg } ;\narg            = expr | IDENT \"=\" expr ;\n\nindex_expr     = expr \"[\" expr \"]\" ;\nfield_expr     = expr \".\" IDENT ;\nmethod_expr    = expr \".\" IDENT \"(\" [ arg_list ] \")\" ;\nawait_expr     = \"await\" expr ;\ntry_expr       = expr \"?\" ;\n\nmatch_expr     = \"match\" expr \":\" INDENT { match_arm } DEDENT ;\nmatch_arm      = \"case\" pattern \":\" INDENT { statement } DEDENT\n               | pattern \"=&gt;\" expr\n               | pattern \"=&gt;\" INDENT { statement } DEDENT ;\npattern        = IDENT | literal | IDENT \"(\" pattern_list \")\" | \"_\" ;\npattern_list   = pattern { \",\" pattern } ;\n\nif_expr        = \"if\" expr \":\" INDENT { statement } DEDENT\n                 { \"elif\" expr \":\" INDENT { statement } DEDENT }\n                 [ \"else\" \":\" INDENT { statement } DEDENT ] ;\n\nlist_comp      = \"[\" expr \"for\" IDENT \"in\" expr [ \"if\" expr ] \"]\" ;\ndict_comp      = \"{\" expr \":\" expr \"for\" IDENT \"in\" expr [ \"if\" expr ] \"}\" ;\n\n(* Statements *)\nstatement      = assignment | return_stmt | if_stmt | while_stmt | for_stmt\n               | expr_stmt | pass_stmt ;\nassignment     = [ \"let\" | \"mut\" ] IDENT [ \":\" type ] \"=\" expr ;\nreturn_stmt    = \"return\" [ expr ] ;\nif_stmt        = if_expr ;\nwhile_stmt     = \"while\" expr \":\" INDENT { statement } DEDENT ;\nfor_stmt       = \"for\" IDENT \"in\" expr \":\" INDENT { statement } DEDENT ;\nexpr_stmt      = expr ;\npass_stmt      = \"pass\" | \"...\" ;\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#4-type-rules","title":"4. Type Rules","text":""},{"location":"RFCs/done/000_core_rfc/#41-assignment","title":"4.1 Assignment","text":"<ul> <li>LHS type must match RHS type exactly (or be inferred).</li> <li><code>mut</code> bindings can be reassigned; non-<code>mut</code> bindings cannot.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#42-function-signatures","title":"4.2 Function Signatures","text":"<ul> <li>All parameters must have explicit types.</li> <li>Return type must be explicit.</li> <li>Functions using <code>?</code> must return <code>Result[T, E]</code> where <code>E</code> is compatible with the propagated error.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#43-method-resolution","title":"4.3 Method Resolution","text":"<ol> <li>Check the type's own methods.</li> <li>Check composed traits in left-to-right order.</li> <li>If conflict, require explicit resolution or compile error.</li> </ol>"},{"location":"RFCs/done/000_core_rfc/#44-trait-adoption","title":"4.4 Trait Adoption","text":"<ul> <li><code>class X with TraitA, TraitB</code>: <code>X</code> must satisfy all trait requirements.</li> <li>Missing required methods \u2192 compile error.</li> <li>Conflicting methods \u2192 must resolve explicitly.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#45-error-propagation","title":"4.5 Error Propagation (<code>?</code>)","text":"<ul> <li><code>expr?</code> on <code>Result[T, E]</code>:<ul> <li>If <code>Err(e)</code>: return <code>Err(e)</code> from enclosing function.</li> <li>If <code>Ok(v)</code>: evaluate to <code>v</code>.</li> </ul> </li> <li>Enclosing function must return <code>Result[_, E]</code> (or compatible).</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#46-newtype-invariants","title":"4.6 Newtype Invariants","text":"<ul> <li>Newtype constructors returning <code>Result</code> enforce invariants.</li> <li>Cannot construct newtype directly; must use constructor.</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#5-invariants","title":"5. Invariants","text":"<ol> <li>No implicit mutation: All mutations require <code>mut</code>.</li> <li>No silent errors: Errors surface via <code>Result</code>; <code>?</code> propagates explicitly.</li> <li>No runtime trait patching: Trait composition is static.</li> <li>Deterministic dispatch: Method resolution is predictable (no MRO).</li> <li>Type safety: All types known at compile time; no dynamic typing.</li> <li>Explicit receiver: <code>self</code> is required in method signatures.</li> </ol>"},{"location":"RFCs/done/000_core_rfc/#6-examples","title":"6. Examples","text":""},{"location":"RFCs/done/000_core_rfc/#complete-example","title":"Complete Example","text":"<pre><code>import polars::prelude as pl\n\n# Structured error type\nenum AppError:\n  ValidationError(str)\n  IoError(str)\n  NotFound\n\n# Newtype with invariant\ntype Email = newtype str:\n  @validate new\n  def from_str(v: str) -&gt; Result[Email, AppError]:\n    if \"@\" not in v:\n      return Err(AppError.ValidationError(\"missing @\"))\n    return Ok(Email(v.lower()))\n\n  def as_str(self) -&gt; str:\n    return self.0   # access underlying value\n\n# Model with validation\n@derive(Debug, Eq, Clone)\nmodel User:\n  id: int\n  email: Email\n  is_active: bool = true\n\n  def validate(self) -&gt; Result[User, AppError]:\n    if not self.is_active:\n      return Err(AppError.ValidationError(\"inactive\"))\n    return Ok(self)\n\n# Trait\ntrait Loggable:\n  def log(self, msg: str):\n    print(f\"[{self.name}] {msg}\")\n\n# Class with trait\nclass UserService with Loggable:\n  name: str\n  users: Dict[int, User]\n\n  def create(mut self, email_str: str) -&gt; Result[User, AppError]:\n    email = Email.from_str(email_str)?\n    user = User(id=len(self.users) + 1, email=email).validate()?\n    self.users[user.id] = user\n    self.log(f\"created user {user.id}\")\n    return Ok(user)\n\n  def get(self, id: int) -&gt; Result[User, AppError]:\n    match self.users.get(id):\n      case Some(user): Ok(user)\n      case None: Err(AppError.NotFound)\n\n# Usage\ndef main() -&gt; Result[Unit, AppError]:\n  mut svc = UserService(name=\"user-svc\", users={})\n  user = svc.create(\"ada@example.com\")?\n  print(f\"Created: {user}\")\n  return Ok(())\n</code></pre>"},{"location":"RFCs/done/000_core_rfc/#7-checklist","title":"7. Checklist","text":""},{"location":"RFCs/done/000_core_rfc/#core-semantics","title":"Core Semantics","text":"<ul> <li>[x] Required typing</li> <li>[x] Immutable-by-default bindings</li> <li>[x] <code>self</code> / <code>mut self</code> receivers</li> <li>[x] <code>Result</code> / <code>Option</code> / <code>?</code> error handling</li> <li>[x] Behavior-only traits with deterministic composition</li> <li>[x] Models vs Classes distinction</li> <li>[x] Newtypes with validation</li> <li>[x] Enums (algebraic data types)</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#builtin-types","title":"Builtin Types","text":"<ul> <li>[x] Primitives: <code>int</code>, <code>float</code>, <code>bool</code>, <code>str</code>, <code>bytes</code></li> <li>[x] Collections: <code>List</code>, <code>Dict</code>, <code>Set</code>, <code>Tuple</code></li> <li>[x] Error types: <code>Result</code>, <code>Option</code></li> <li>[x] <code>Unit</code> type</li> </ul>"},{"location":"RFCs/done/000_core_rfc/#builtin-traits","title":"Builtin Traits","text":"<ul> <li>[x] <code>Debug</code>, <code>Display</code></li> <li>[x] <code>Eq</code>, <code>PartialEq</code>, <code>Ord</code>, <code>PartialOrd</code></li> <li>[x] <code>Hash</code></li> <li>[x] <code>Clone</code></li> <li>[x] <code>Default</code></li> <li>[x] <code>From</code>, <code>Into</code>, <code>TryFrom</code>, <code>TryInto</code></li> <li>[x] <code>Iterator</code>, <code>IntoIterator</code></li> <li>[x] <code>Error</code></li> </ul>"},{"location":"RFCs/done/000_core_rfc/#derives","title":"Derives","text":"<ul> <li>[x] <code>@derive(Debug, Display, Eq, Ord, Hash, Clone, Default, Validate)</code></li> </ul>"},{"location":"RFCs/done/000_core_rfc/#grammar","title":"Grammar","text":"<ul> <li>[x] Declarations: model, class, trait, newtype, enum, function</li> <li>[x] Expressions: calls, <code>?</code>, match, if, comprehensions</li> <li>[x] Statements: assignment, return, control flow</li> <li>[x] Receivers: <code>self</code>, <code>mut self</code></li> </ul>"},{"location":"RFCs/done/000_core_rfc/#type-rules","title":"Type Rules","text":"<ul> <li>[x] Assignment typing</li> <li>[x] Function signature requirements</li> <li>[x] Method resolution order</li> <li>[x] Trait adoption rules</li> <li>[x] Error propagation (<code>?</code>)</li> <li>[x] Newtype invariants</li> </ul>"},{"location":"RFCs/done/008_const_bindings/","title":"RFC 008: Const Bindings","text":"<p>Status: Done Created: 2025-12-10 Implemented: 2025-12-23  </p>"},{"location":"RFCs/done/008_const_bindings/#summary","title":"Summary","text":"<p>Introduce explicit constant bindings in Incan using the industry-standard declaration form:</p> <pre><code>const PI: float = 3.14\nconst HOST = \"127.0.0.1\"  # type may be inferred when obvious\n</code></pre> <p>The goal is to let users declare compile-time constants with clear intent and to allow codegen to emit Rust <code>const</code> where possible.</p>"},{"location":"RFCs/done/008_const_bindings/#goals","title":"Goals","text":"<ul> <li>Provide a clear, conventional syntax (<code>const NAME [: Type] = &lt;const-expr&gt;</code>).</li> <li>Enforce const-evaluable expressions at compile time (reject runtime-dependent values).</li> <li>Generate Rust <code>const</code> bindings when allowed; fall back to errors rather than silently downgrading.</li> <li>Keep scope simple initially (module-level constants).</li> </ul>"},{"location":"RFCs/done/008_const_bindings/#non-goals-initial","title":"Non-Goals (initial)","text":"<ul> <li>Block-level <code>const</code> semantics (can be added later).</li> <li><code>static</code>/<code>static mut</code> support.</li> <li>Inline const expressions (e.g., <code>const_len(...)</code>) or const generics.</li> <li>Complex const-eval (function calls, IO, random, runtime-derived values).</li> </ul>"},{"location":"RFCs/done/008_const_bindings/#syntax","title":"Syntax","text":"<p>Module-level bindings:</p> <pre><code>const PI: float = 3.14159\nconst APP_NAME: str = \"incan\"\nconst MAX_RETRIES: int = 5\n\n# With type inference when the literal is unambiguous\nconst DEFAULT_PORT = 8080\n</code></pre> <p>Rules (initial):</p> <ul> <li>Required initializer.</li> <li>Optional type annotation; if omitted, the type must be inferrable from the literal.</li> <li>Only allowed at module scope (phase 1).</li> </ul>"},{"location":"RFCs/done/008_const_bindings/#const-evaluable-expressions-phase-1","title":"Const-Evaluable Expressions (phase 1)","text":"<p>Allowed:</p> <ul> <li>Literals: int, float, bool, str, bytes.</li> <li>Simple unary/binary ops on const literals: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>&amp;&amp;/||</code>, comparisons, string concatenation (<code>\"a\" + \"b\"</code>).</li> <li>Tuple/list/dict/set literals whose elements/keys/values are themselves const-evaluable.</li> </ul> <p>Disallowed (initial):</p> <ul> <li>Function/method calls (including builtins).</li> <li>Comprehensions, ranges, f-strings.</li> <li>Accessing variables, environment, or runtime state.</li> <li>Imports resolved at runtime.</li> </ul> <p>If an expression is not const-evaluable, the compiler should emit a clear error at the binding site.</p>"},{"location":"RFCs/done/008_const_bindings/#codegen","title":"Codegen","text":"<ul> <li>Emit Rust <code>const</code> for accepted const bindings.</li> <li>For string/bytes literals, emit as <code>&amp;'static</code> where appropriate; otherwise use <code>const</code> with owned types that are <code>const</code>-constructible.</li> <li>If the expression cannot be represented as a Rust <code>const</code>, fail the build with an actionable error (no silent fallback to <code>let</code>).</li> </ul>"},{"location":"RFCs/done/008_const_bindings/#typechecker","title":"Typechecker","text":"<ul> <li>Enforce const-evaluable expression rules.</li> <li>Ensure the inferred/annotated type matches the initializer.</li> <li>Restrict scope to module-level for phase 1.</li> </ul>"},{"location":"RFCs/done/008_const_bindings/#future-work-not-in-scope-here","title":"Future Work (not in scope here)","text":"<ul> <li>Block-level <code>const</code>.</li> <li><code>static</code> (single-instance data) and safety rules.</li> <li>Inline const expressions / const-eval helpers.</li> <li>Allowing a limited set of pure builtins in const context (e.g., length of const literals).</li> </ul>"},{"location":"RFCs/done/008_const_bindings/#examples","title":"Examples","text":"<pre><code>const VERSION: str = \"0.1.0\"\nconst DEFAULT_TIMEOUT_SECS: float = 2.5\nconst GREETING = \"hello\" + \" world\"\nconst PORTS = [80, 443]\nconst HEADERS = {\"User-Agent\": \"incan\"}\n</code></pre> <p>Invalid (should error):</p> <pre><code>const NOW = time.now()            # function call\nconst HOST = env(\"HOST\")          # runtime dependency\nconst STEP = 1 + x                # depends on non-const symbol\n</code></pre>"},{"location":"RFCs/done/008_const_bindings/#checklist","title":"Checklist","text":"<ul> <li>[x] Lexer/parser support for <code>const</code> binding declarations.</li> <li>[x] AST node for const bindings (module scope).</li> <li>[x] Typechecker: const-eval rules and errors for non-const expressions.</li> <li>[x] Codegen: emit Rust <code>const</code>; error on non-representable expressions.</li> <li>[x] Docs: guide section + examples.</li> <li>[x] Tests: parser/typechecker/codegen coverage.</li> </ul>"},{"location":"_snippets/callouts/beta_expectations/","title":"Beta expectations","text":"<p>Incan is currently in Beta.</p> <p>What this means for you:</p> <ul> <li>Things may change quickly (especially ergonomics and tooling).</li> <li>Some pages may be incomplete; prefer the canonical entrypoints (Start here, Tooling start here, Language start here).</li> <li>If the docs imply a feature exists but you can\u2019t find it, treat it as either:<ul> <li>overpromise (docs should label as future), or</li> <li>discoverability gap (docs should link better), or</li> <li>product gap (feature not implemented yet).</li> </ul> </li> </ul> <p>Keep an eye on the GitHub Releases for new releases and changes.</p>"},{"location":"_snippets/callouts/generated_doc_warning/","title":"Generated doc warning","text":"<p>This page is generated.</p> <p>If you are a maintaner</p> <ul> <li>Do not edit it by hand.</li> <li>If it looks wrong/outdated, regenerate it from source and commit the result.</li> </ul>"},{"location":"_snippets/callouts/no_install_fallback/","title":"No install fallback","text":"<p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre>"},{"location":"_snippets/commands/install_build_run/","title":"Install build run","text":"Recommended: install to PATHFallback: no install <pre><code>make install\nincan --version\n</code></pre> <p>Notes:</p> <ul> <li><code>make install</code> installs <code>incan</code> to <code>~/.cargo/bin</code>.</li> <li>If <code>incan</code> is not found, make sure <code>~/.cargo/bin</code> is on your <code>PATH</code>.</li> </ul> <pre><code>make release\n./target/release/incan --version\n</code></pre>"},{"location":"_snippets/contributing/compiler_pipeline_checklist/","title":"Compiler pipeline checklist","text":"<p>Keep the pipeline aligned (to avoid language/tooling drift):</p> <ul> <li>Syntax crate (<code>crates/incan_syntax/</code>): lexer \u2192 parser \u2192 AST \u2192 diagnostics</li> <li>Formatter (<code>src/format/</code>): prints AST back (idempotent; never emits invalid syntax)</li> <li>Semantic core (<code>crates/incan_core/</code>): canonical vocab / shared semantic helpers (avoid duplicating \u201cmeaning\u201d in multiple   layers)</li> <li>Compiler (<code>src/frontend/</code>, <code>src/backend/</code>):<ul> <li>typechecker validates and annotates</li> <li>lowering turns AST into IR</li> <li>emission generates correct Rust</li> </ul> </li> <li>Runtime/stdlib (<code>crates/incan_stdlib/</code>, <code>stdlib/</code>): behavior that can live outside the compiler should live here</li> </ul> <p>Rule of thumb: prefer pushing shared meaning \u201cdown\u201d into <code>incan_core</code>/<code>incan_syntax</code>/<code>incan_stdlib</code>, and keep the <code>incan</code> (root) crate focused on orchestration and pipeline wiring.</p>"},{"location":"_snippets/language/callouts/derives_vs_dunders_vs_traits/","title":"Derives vs dunders vs traits","text":"<p>Derives vs dunders vs traits (pick the mechanism)</p> <ul> <li><code>@derive(...)</code>: ask the compiler to generate a default/structural implementation for a built-in behavior   (usually field-based).</li> <li>Dunder methods (e.g. <code>__eq__</code>, <code>__lt__</code>, <code>__hash__</code>, <code>__str__</code>): provide a custom implementation of that behavior.   If you define the dunder, you do not need to also <code>@derive</code> the corresponding trait.</li> <li>Custom traits (<code>trait ...</code> + <code>with TraitName</code>): define domain capabilities. Implement required methods (and   override defaults) by writing normal methods.</li> <li><code>Debug</code> is special: <code>{:?}</code> is always compiler-generated; <code>__repr__</code> is not user-overridable (use <code>__str__</code> + <code>{}</code>   for custom output).</li> </ul>"},{"location":"_snippets/language/examples/match_arms_rust_style/","title":"Match arms rust style","text":"<pre><code>def main() -&gt; None:\n    match parse_port(\"8080\"):\n        Ok(port) =&gt; println(f\"port={port}\")\n        Err(e) =&gt; println(f\"error: {e}\")\n</code></pre>"},{"location":"_snippets/tables/rfcs_index/","title":"Rfcs index","text":"RFC Status Track Title RFC 000 Done done Incan Core Language RFC (Phase 1) RFC 001 In Progress proposed / active Test Fixtures RFC 002 Draft proposed / active Parametrized Tests RFC 003 Blocked proposed / active Frontend &amp; WebAssembly Support RFC 004 Draft proposed / active Async Fixtures RFC 005 Draft proposed / active Rust Interop RFC 006 Planned proposed / active Python-Style Generators RFC 007 Planned proposed / active Inline Tests RFC 008 Done done Const Bindings RFC 009 Planned proposed / active Sized Integer Types &amp; Builtin Type Registry RFC 010 Draft proposed / active Temporary Files and Directories RFC 011 Planned proposed / active Precise Error Spans in F-Strings RFC 012 Draft proposed / active JsonValue Type for Dynamic JSON RFC 013 Draft proposed / active Rust Crate Dependencies RFC 014 Draft proposed / active Error Handling in Generated Rust Code RFC 015 Planned proposed / active Hatch-like Tooling (Project Lifecycle CLI) RFC 016 Planned proposed / active <code>loop</code> and <code>break &lt;value&gt;</code> (Loop Expressions) RFC 017 Planned proposed / active Validated newtypes with implicit coercion (pydantic-like feel)"},{"location":"contributing/","title":"Contributing: Start here","text":"<p>This section is for contributors working on the Incan compiler/tooling and language evolution.</p> <p>If you\u2019re new, start with:</p> <ul> <li>Architecture</li> <li>Layering rules</li> </ul>"},{"location":"contributing/#how-to-guides-do","title":"How-to guides (do)","text":"<ul> <li>Extending the Language \u2014 when to add builtins vs new syntax; end-to-end checklists</li> </ul>"},{"location":"contributing/#tutorials-learn","title":"Tutorials (learn)","text":"<ul> <li>Contributor Book (Advanced, Rust-first): Book index</li> </ul>"},{"location":"contributing/#explanation-understand","title":"Explanation (understand)","text":"<ul> <li>Architecture \u2014 compilation pipeline, module layout, internal stages</li> <li>Readable, maintainable Rust \u2014 team conventions and engineering practices</li> </ul>"},{"location":"contributing/#reference-look-up","title":"Reference (look up)","text":"<ul> <li>Layering rules \u2014 dependency boundaries and guardrails</li> </ul>"},{"location":"contributing/#design-rfcs-and-roadmap","title":"Design (RFCs and roadmap)","text":"<p>RFCs are design records (not canonical user docs):</p> <ul> <li>RFC index</li> <li>Roadmap</li> </ul> <p>Before proposing new language features (syntax/semantics), read:</p> <ul> <li>Proposals: issues vs RFCs</li> </ul>"},{"location":"contributing/explanation/architecture/","title":"Incan Compiler Architecture","text":"<p>This document describes the internal architecture of the Incan compiler.</p>"},{"location":"contributing/explanation/architecture/#compilation-pipeline","title":"Compilation Pipeline","text":"<p>This diagram shows the compilation pipeline of the Incan compiler in high level.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                FRONTEND                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502     .incn source \u2500\u2500\u25ba Lexer \u2500\u2500\u25ba Parser \u2500\u2500\u25ba TypeChecker \u2500\u2500\u25ba AST (typed)       \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                     \u2502\n                                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                 BACKEND                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502   AST \u2500\u2500\u25ba AstLowering \u2500\u2500\u25ba IR \u2500\u2500\u25ba IrEmitter \u2500\u2500\u25ba TokenStream \u2500\u2500\u25ba Rust source  \u2502\n\u2502                                     \u25b2                                       \u2502\n\u2502                                     \u2514\u2500\u2500\u25ba prettyplease (formatting)          \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                     \u2502\n                                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           PROJECT GENERATION                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502       ProjectGenerator \u2500\u2500\u25ba Cargo.toml + src/*.rs \u2500\u2500\u25ba cargo build/run        \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"contributing/explanation/architecture/#glossary","title":"Glossary","text":"Term Meaning Frontend Parses <code>.incn</code> and typechecks it, producing a typed AST (or diagnostics). <code>.incn</code> source The source code of an Incan program. Lexer Tokenizes source text into tokens (used by the parser). It converts source code into a token stream the parser can understand. Parser Parses lexer tokens into an AST. AST The abstract syntax tree (syntax structure + spans for diagnostics). Typechecker Resolves names/imports and checks types, annotating the AST with type information. Typed AST AST after typechecking, with resolved types attached to relevant nodes. Backend Generates Rust code from the typed AST. Lowering Transforms typed AST \u2192 IR (including ownership/mutability/conversion decisions). IR A Rust-oriented, ownership-aware intermediate representation used for code generation. IrEmitter Emits IR into a Rust <code>TokenStream</code> before final formatting. TokenStream Rust <code>TokenStream</code> from codegen (<code>proc_macro2</code> via <code>quote</code>/<code>syn</code>). This is the final output of the compiler before being formatted to Rust code. prettyplease Formats Rust syntax/TokenStream into human-readable Rust source code. Rust source The generated Rust code as text. ProjectGenerator Writes the generated Rust code into a standalone Cargo project (and can invoke <code>cargo build/run</code>). Cargo project Generated Rust project directory (<code>Cargo.toml</code>, <code>src/*</code>, and build artifacts). Cargo Rust\u2019s build system and package manager. CLI Command-line entrypoint for compile/build/run/fmt/test workflows. LSP IDE server running frontend stages; returns diagnostics/hover/definition via the Language Server Protocol. Runtime crates <code>incan_stdlib</code> / <code>incan_derive</code> crates used by generated programs (not the compiler)."},{"location":"contributing/explanation/architecture/#walkthrough-incan-build","title":"Walkthrough: <code>incan build</code>","text":"<p>This section describes what happens internally when you run <code>incan build path/to/main.incn</code>.</p> <pre><code>incan build file.incn\n  \u2502\n  \u251c\u2500\u2500\u25b6 1) Collect modules (imports)\n  \u2502       - Parse the entry file and any imported local modules\n  \u2502       - Produces: a list of parsed modules (source + AST) in dependency order\n  \u2502\n  \u251c\u2500\u2500\u25b6 2) Type check (with imports)\n  \u2502       - Name resolution + type checking across the module set\n  \u2502       - Produces: a typed AST (or structured diagnostics)\n  \u2502\n  \u251c\u2500\u2500\u25b6 3) Backend preparation\n  \u2502       - Scan for feature usage (e.g. serde / async / web / helpers)\n  \u2502       - Collect `rust::` crate imports for Cargo dependency injection\n  \u2502\n  \u251c\u2500\u2500\u25b6 4) Code generation\n  \u2502       - Lower typed AST \u2192 ownership-aware IR\n  \u2502       - Emit IR \u2192 Rust TokenStream \u2192 formatted Rust source\n  \u2502       - If imports are present: generate a nested Rust module tree\n  \u2502\n  \u251c\u2500\u2500\u25b6 5) Project generation\n  \u2502       - Write a standalone Cargo project (Cargo.toml + src/*.rs)\n  \u2502       - Default output dir: target/incan/&lt;project_name&gt;/\n  \u2502\n  \u2514\u2500\u2500\u25b6 6) Build\n          - `cargo build --release`\n          - Binary path: target/incan/&lt;project_name&gt;/target/release/&lt;project_name&gt;\n</code></pre> <p>Notes:</p> <ul> <li>Debugging individual stages: Use CLI stage flags (<code>--lex</code>, <code>--parse</code>, <code>--check</code>, <code>--emit-rust</code>) to inspect   intermediate outputs (see Getting Started).</li> <li>Multi-file projects: Import resolution rules and module layout are described in Imports &amp; Modules.</li> <li>Rust interop dependencies: <code>rust::</code> imports trigger Cargo dependency injection with a strict policy   (see Rust Interop and RFC 013).</li> <li>Runtime boundary: Generated programs depend on <code>incan_stdlib</code> and <code>incan_derive</code>, but the compiler does not (see <code>crates/</code>).</li> </ul>"},{"location":"contributing/explanation/architecture/#module-layout","title":"Module Layout","text":"<pre><code>Frontend (turns source text into a typed AST)\n  \u251c\u2500\u2500\u25b6 Lexing + parsing\n  \u2502     - Converts `.incn` text into an AST\n  \u2502     - Attaches spans for precise diagnostics\n  \u251c\u2500\u2500\u25b6 Name resolution + type checking\n  \u2502     - Builds symbol tables, resolves imports\n  \u2502     - Produces a typed AST (or structured errors)\n  \u2514\u2500\u2500\u25b6 Diagnostics (shared)\n        - Pretty, source-context errors used by CLI / Formatter / LSP\n\nBackend (turns typed AST into Rust code)\n  \u251c\u2500\u2500\u25b6 Feature scanning\n  \u2502     - Detects language features used (serde/async/web/this/etc.)\n  \u2502     - Collects required Rust crates / routes / runtime needs\n  \u251c\u2500\u2500\u25b6 IR + lowering\n  \u2502     - Lowers typed AST to a Rust-oriented, ownership-aware IR\n  \u2502     - Central place for ownership/mutability/conversion decisions\n  \u2514\u2500\u2500\u25b6 Emission + formatting\n        - Emits Rust (TokenStream \u2192 formatted Rust source)\n        - Applies consistent interop rules (borrows/clones/String conversions)\n\nProject generation (turns Rust code into a runnable Cargo project)\n  \u251c\u2500\u2500\u25b6 Planning (pure)\n  \u2502     - Compute dirs/files + chosen cargo action (build/run)\n  \u251c\u2500\u2500\u25b6 Execution (side effects)\n  \u2502     - Writes files, creates dirs, shells out to cargo\n  \u2514\u2500\u2500\u25b6 Dependency policy\n        - Controlled mapping for `rust::` imports (no silent wildcard deps)\n\nCLI (user-facing orchestration)\n  \u251c\u2500\u2500\u25b6 Compile actions\n  \u2502     - build/run: Frontend \u2192 Backend \u2192 Project generation \u2192 cargo\n  \u251c\u2500\u2500\u25b6 Developer actions\n  \u2502     - lex/parse/check/emit-rust: inspect intermediate stages\n  \u2514\u2500\u2500\u25b6 Tool actions\n        - fmt: format valid syntax\n        - test: discover/run tests (pytest-style)\n\nLSP (IDE-facing orchestration)\n  \u251c\u2500\u2500\u25b6 Language server\n  \u2502     - Runs Frontend (and selected tooling) on edits\n  \u2514\u2500\u2500\u25b6 Protocol adapters\n        - Converts compiler diagnostics into LSP diagnostics (and more over time)\n\nRuntime crates (used by generated Rust programs, not the compiler)\n  \u251c\u2500\u2500\u25b6 incan_stdlib\n  \u2502      - Traits + helpers (prelude, reflection, JSON helpers, etc.)\n  \u2514\u2500\u2500\u25b6 incan_derive\n        - Proc-macro derives to generate impls for stdlib traits\n</code></pre>"},{"location":"contributing/explanation/architecture/#semantic-core","title":"Semantic Core","text":"<p>Incan has a semantic core crate (<code>incan_core</code>) that holds pure, deterministic helpers shared by the compiler and runtime, without creating dependency cycles.</p> <ul> <li>Location: <code>crates/incan_core</code></li> <li>Purpose: centralize semantic policy and pure helpers so compile-time behavior and runtime behavior cannot drift.</li> <li>Used by: compiler (typechecker, const-eval, lowering/codegen decisions) and stdlib/runtime helpers.</li> <li>Constraints: pure/deterministic (no IO, no global state) and no dependencies on compiler crates.</li> </ul> <p>See crate-level documentation in <code>crates/incan_core</code> for the contract, extension checklist, and drift-prevention expectations; tests in <code>tests/semantic_core_*</code> serve as the source of truth for covered domains.</p>"},{"location":"contributing/explanation/architecture/#syntax-frontend","title":"Syntax Frontend","text":"<p>Incan has a shared syntax frontend crate (<code>incan_syntax</code>) that centralizes lexer/parser/AST/diagnostics in a dependency-light crate suitable for reuse across compiler and tooling.</p> <ul> <li>Location: <code>crates/incan_syntax</code></li> <li>Purpose: provide a single, shared syntax layer (lexing, parsing, AST, diagnostics) to prevent drift between   compiler, formatter, LSP, and future interactive tooling.</li> <li>Used by: compiler frontend and tooling (formatter/LSP); depends on <code>incan_core::lang</code> registries for vocabulary ids.</li> <li>Constraints: syntax-only (no name resolution/type checking/IR); no dependencies on compiler crates.</li> </ul>"},{"location":"contributing/explanation/architecture/#frontend-srcfrontend","title":"Frontend (<code>src/frontend/</code>)","text":"Module Purpose <code>lexer</code> Tokenization (re-exported from <code>crates/incan_syntax</code>) <code>parser</code> Parser (re-exported from <code>crates/incan_syntax</code>) <code>ast</code> Untyped AST (<code>Spanned&lt;T&gt;</code> for diagnostics) (re-exported from <code>crates/incan_syntax</code>) <code>module.rs</code> Import path modeling and module metadata <code>resolver.rs</code> Multi-file module resolution <code>typechecker/</code> Two-pass collection + type checking <code>symbols.rs</code> Symbol table and scope management <code>diagnostics</code> Syntax/parse diagnostics (re-exported from <code>crates/incan_syntax</code>)"},{"location":"contributing/explanation/architecture/#typechecker-submodules-typechecker","title":"Typechecker submodules (<code>typechecker/</code>)","text":"File Responsibility <code>mod.rs</code> <code>TypeChecker</code> API (<code>check_program</code>, imports) <code>collect.rs</code> Pass 1: register types/functions/imports <code>check_decl.rs</code> Pass 2: validate declarations <code>check_stmt.rs</code> Statement checking (assign/return/control) <code>check_expr/</code> Expression checking (calls/indexing/ops/match)"},{"location":"contributing/explanation/architecture/#backend-srcbackend","title":"Backend (<code>src/backend/</code>)","text":"Module Purpose <code>ir/codegen.rs</code> Entry point (<code>IrCodegen</code>): lowering + emission <code>ir/lower/</code> AST \u2192 IR lowering (types + ownership decisions) <code>ir/emit/</code> IR \u2192 Rust via <code>syn</code>/<code>quote</code> <code>ir/emit_service/</code> Emission helpers split by layer <code>ir/conversions.rs</code> Centralized conversions (<code>&amp;str</code> \u2192 <code>String</code>) <code>ir/types.rs</code> IR types (<code>IrType</code>) <code>ir/expr.rs</code> IR expressions (<code>TypedExpr</code>, builtins, methods) <code>ir/stmt.rs</code> IR statements (<code>IrStmt</code>) <code>ir/decl.rs</code> IR declarations (<code>IrDecl</code>) <code>project.rs</code> Cargo project scaffolding and generation"},{"location":"contributing/explanation/architecture/#expression-emission-srcbackendiremitexpressions","title":"Expression Emission (<code>src/backend/ir/emit/expressions/</code>)","text":"<p>The expression emitter is split into focused submodules for maintainability:</p> Submodule Purpose <code>mod.rs</code> <code>emit_expr</code> entry point and dispatch <code>builtins.rs</code> Builtin calls (<code>print</code>, <code>len</code>, <code>range</code>, etc.) <code>methods.rs</code> Known methods + fallback method calls <code>calls.rs</code> Function calls and binary operations <code>indexing.rs</code> Index/slice/field access <code>comprehensions.rs</code> List and dict comprehensions <code>structs_enums.rs</code> Struct constructors and enum-related expressions <code>format.rs</code> f-strings and range expressions <code>lvalue.rs</code> Assignment targets <p>Enum-based dispatch: Built-in functions and known methods use enum types (<code>BuiltinFn</code>, <code>MethodKind</code>) instead of string matching. This provides compile-time exhaustiveness checking and makes it easier to add new builtins/methods (see Extending Incan).</p>"},{"location":"contributing/explanation/architecture/#cli-srccli","title":"CLI (<code>src/cli/</code>)","text":"Module Purpose <code>commands.rs</code> Command handlers (<code>build</code>, <code>run</code>, <code>fmt</code>) <code>test_runner.rs</code> pytest-style test discovery and execution <code>prelude.rs</code> Stdlib loading (embedded <code>.incn</code> files)"},{"location":"contributing/explanation/architecture/#tooling","title":"Tooling","text":"Module Purpose <code>format/</code> Source formatter <code>lsp/</code> LSP backend logic (diagnostics/hover) <code>bin/</code> Extra binaries (e.g. <code>lsp</code>)"},{"location":"contributing/explanation/architecture/#key-data-types","title":"Key Data Types","text":"<pre><code>AST (frontend)          IR (backend)              Rust (output)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500       \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500        \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nast::Program       \u2500\u2500\u25ba  IrProgram            \u2500\u2500\u25ba  TokenStream\nast::Declaration   \u2500\u2500\u25ba  IrDecl               \u2500\u2500\u25ba  (syn Items)\nast::Statement     \u2500\u2500\u25ba  IrStmt               \u2500\u2500\u25ba  (syn Stmts)\nast::Expr          \u2500\u2500\u25ba  TypedExpr            \u2500\u2500\u25ba  (syn Expr)\nast::Type          \u2500\u2500\u25ba  IrType               \u2500\u2500\u25ba  (syn Type)\n</code></pre>"},{"location":"contributing/explanation/architecture/#ownership-data-flow","title":"Ownership &amp; Data Flow","text":"<ol> <li>Frontend parses and typechecks, producing an owned <code>ast::Program</code></li> <li>Backend borrows <code>&amp;ast::Program</code>, produces owned <code>IrProgram</code></li> <li>Emitter borrows <code>&amp;IrProgram</code>, produces owned <code>TokenStream</code></li> <li>prettyplease formats <code>TokenStream</code> to <code>String</code></li> <li>ProjectGenerator writes files to disk</li> </ol>"},{"location":"contributing/explanation/architecture/#entry-points","title":"Entry Points","text":"<ul> <li>CLI: <code>src/main.rs</code> \u2192 <code>cli::run()</code></li> <li>Codegen: <code>IrCodegen::new()</code> \u2192 <code>.generate(&amp;ast)</code></li> <li>LSP: <code>src/bin/lsp.rs</code></li> </ul>"},{"location":"contributing/explanation/architecture/#extending-the-language","title":"Extending the Language","text":"<p>Incan\u2019s compiler is intentionally staged (Lexer \u2192 Parser/AST \u2192 Typechecker \u2192 IR \u2192 Rust). This makes the system easier to reason about, but it also means \u201clanguage changes\u201d can touch multiple layers.</p> <p>For contributor guidance on when to add a builtin vs when to add new syntax, plus end-to-end checklists, see:</p> <ul> <li>Extending Incan: Builtins vs New Syntax</li> </ul>"},{"location":"contributing/explanation/layering/","title":"Layering Rules","text":"<p>This repository follows a strict dependency direction to keep semantics shared and prevent accidental drift between the compiler and the runtime:</p> <ul> <li><code>incan</code> (compiler) may depend on <code>incan_core</code>.</li> <li><code>incan</code> must not depend on <code>incan_stdlib</code> except as a dev-dependency for parity tests.</li> <li><code>incan_stdlib</code> depends on <code>incan_core</code>.</li> <li>Generated user programs depend on <code>incan_stdlib</code>.</li> </ul> <pre><code>flowchart TD\n  incanCompiler[\"incan (compiler)\"] --&gt; incanCore[\"incan_core\"]\n  incanStdlib[\"incan_stdlib\"] --&gt; incanCore\n  generatedProgram[\"generated program\"] --&gt; incanStdlib</code></pre> <p>CI/Test guardrails enforce that <code>incan</code> keeps <code>incan_stdlib</code> out of its normal dependencies. If you need runtime helpers inside tests, add them under <code>[dev-dependencies]</code> only.</p>"},{"location":"contributing/explanation/layering/#why-we-do-this","title":"Why we do this","text":"<p>We want one \u201csource of truth\u201d for language behavior so the compiler and runtime don\u2019t drift:</p> <ul> <li>Semantics must match: if const-eval validates something, runtime should do the same thing the same way (especially   for Unicode-sensitive string operations and numeric edge cases).</li> <li>Diagnostics/panics must stay aligned: user-facing error messages should not diverge between compile-time and   runtime.</li> <li>Compiler stays lean: the compiler shouldn\u2019t accidentally pull in runtime-only APIs or heavy dependencies.</li> </ul>"},{"location":"contributing/explanation/layering/#what-goes-where-contracts-vs-implementations","title":"What goes where (contracts vs implementations)","text":"<p><code>incan_core</code>:</p> <pre><code>- Pure helpers that define *meaning/policy* (e.g., string indexing/slicing rules, numeric promotion, canonical error\n  message constants).\n- Must be deterministic and side-effect free.\n- Should not depend on compiler internals (AST, spans, lexer/parser state).\n</code></pre> <p><code>incan_stdlib</code>:</p> <pre><code>- Runtime helpers used by generated Rust code.\n- Should delegate behavior to `incan_core` for policy/consistency, and implement runtime-only actions (like\n  panicking) using the shared error messages/taxonomy.\n</code></pre> <p><code>incan</code> (compiler):</p> <pre><code>- Parsing, typing, lowering, codegen, diagnostics.\n- May use `incan_core` to implement checks/const-eval and to keep error text aligned.\n- Must not use `incan_stdlib` in normal builds; only in tests for parity.\n</code></pre>"},{"location":"contributing/explanation/layering/#allowed-forbidden-dependencies","title":"Allowed / forbidden dependencies","text":"<p>Allowed:</p> <pre><code>- `incan` \u2192 `incan_core` (normal dependency)\n- `incan_stdlib` \u2192 `incan_core` (normal dependency)\n- `incan` \u2192 `incan_stdlib` (dev-dependency only, for tests)\n</code></pre> <p>*Forbidden:</p> <pre><code>- `incan` \u2192 `incan_stdlib` in `[dependencies]` (this breaks layering)\n- `incan_core` \u2192 `incan` or `incan_stdlib`\n</code></pre>"},{"location":"contributing/explanation/layering/#common-pitfalls","title":"Common pitfalls","text":"<ul> <li> <p>Adding a \u201cquick helper\u201d in <code>incan_stdlib</code> and calling it from the compiler.</p> <ul> <li>Fix: move the policy/logic to <code>incan_core</code> and keep only runtime glue (panics, wrappers) in <code>incan_stdlib</code>.</li> </ul> </li> <li> <p>Emitting direct Rust operations that bypass shared semantics (e.g., slicing Rust <code>String</code> by byte indices).</p> <ul> <li>Fix: emit calls to <code>incan_stdlib</code> wrappers which themselves delegate to <code>incan_core</code>.</li> </ul> </li> <li> <p>Duplicating error messages as string literals in multiple places.</p> <ul> <li>Fix: put canonical text in <code>incan_core</code> and reuse it from both compiler and runtime.</li> </ul> </li> </ul>"},{"location":"contributing/explanation/layering/#guardrails-how-it-is-enforced","title":"Guardrails (how it is enforced)","text":"<ul> <li>Dependency gate: <code>tests/layering_guard.rs</code> fails if <code>incan_stdlib</code> appears in the compiler crate\u2019s     <code>[dependencies]</code> section of the root <code>Cargo.toml</code>. (Keeping <code>incan_stdlib</code> in <code>[dev-dependencies]</code> for parity tests     is allowed.)</li> </ul>"},{"location":"contributing/explanation/layering/#how-to-add-shared-behavior-safely","title":"How to add shared behavior safely","text":"<p>When you notice drift risk (compiler vs runtime):</p> <ol> <li>Put the policy in <code>incan_core</code> (pure function + typed error or canonical message).</li> <li>Add a thin wrapper in <code>incan_stdlib</code> that calls semantics and performs runtime-only behavior (panic, allocation,    conversions).</li> <li>Update compiler const-eval / typechecking to use the semantics helper directly (never stdlib).</li> <li>Add a parity test in <code>tests/</code> that compares compiler/semantics/runtime behavior for the edge case.</li> </ol>"},{"location":"contributing/explanation/readable-maintainable-rust/","title":"Readable &amp; Maintainable Rust: A Practical Guide","text":"<p>This document contains a pragmatic set of principles, patterns, and guardrails for writing Rust that\u2019s easy to understand and safe to evolve. It draws from The Rust Book and the Rust API Guidelines.</p> <p>Incan contributors are expected to follow these principles and patterns when writing Rust code.</p>"},{"location":"contributing/explanation/readable-maintainable-rust/#table-of-contents","title":"Table of Contents","text":"<ul> <li>What \u201cReadable\u201d Means in Rust</li> <li>What \u201cMaintainable\u201d Means in Rust</li> <li>Pragmatic Checklist</li> <li>Idiomatic Examples<ul> <li>Errors: Internal vs External</li> <li>Public API: Trait-Oriented, Minimal Exposure</li> <li>Ownership Clarity: Borrow When Possible</li> <li>Macro Discipline</li> </ul> </li> <li>Project Scaffolding<ul> <li>lib.rs and main.rs</li> <li><code>rustfmt.toml</code></li> <li><code>Cargo.toml</code></li> <li>Typical CI Steps</li> </ul> </li> <li>Common Pitfalls</li> <li>Simple Heuristic</li> </ul>"},{"location":"contributing/explanation/readable-maintainable-rust/#what-readable-means-in-rust","title":"What \u201cReadable\u201d Means in Rust","text":"<p>Readable Rust is code that a competent Rustacean can scan and understand quickly, without excessive file-hopping or ownership gymnastics.</p> <ol> <li>Idiomatic ownership &amp; borrowing</li> <li>Prefer borrowing (<code>&amp;T</code>, <code>&amp;mut T</code>) over cloning; clone only at clear boundaries.</li> <li>Lifetimes are implicit when possible; explicit lifetimes are localized and named meaningfully when needed.</li> <li> <p>Avoid <code>Rc&lt;RefCell&lt;_&gt;&gt;</code> in single-threaded code and <code>Arc&lt;Mutex&lt;_&gt;&gt;</code> in multi-threaded code unless truly necessary.</p> </li> <li> <p>Type-first design</p> </li> <li>Use newtypes to encode domain invariants (e.g., <code>UserId</code>, <code>NonEmptyStr</code>).</li> <li>Prefer expressive enums over ad-hoc booleans/strings (e.g., <code>enum State { Pending, Running, Failed }</code>).</li> <li> <p>Return domain-specific results: <code>Result&lt;Order, OrderError&gt;</code> beats <code>Result&lt;T, String&gt;</code>.</p> </li> <li> <p>Clear error handling</p> </li> <li>Use <code>Result&lt;T, E&gt;</code> pervasively; reserve panics for programmer errors (<code>unreachable!</code>, <code>expect</code> with invariant context).</li> <li> <p>Propagate with <code>?</code>; keep error messages actionable; don\u2019t lose context when mapping.</p> </li> <li> <p>Minimal magic</p> </li> <li>Macros remove boilerplate but don\u2019t hide logic or create opaque DSLs.</li> <li> <p>Generics are purposeful; trait bounds are explicit and readable.</p> </li> <li> <p>Consistent naming &amp; layout</p> </li> <li>Follow conventions: <code>snake_case</code> (functions/vars), <code>CamelCase</code> (types/traits), <code>SCREAMING_SNAKE_CASE</code> (consts).</li> <li> <p>Module/file sizes are reasonable; split by responsibility, not arbitrary layers.</p> </li> <li> <p>Local reasoning</p> </li> <li>Functions are small, pure where possible, with limited side effects and clear inputs/outputs.</li> </ol>"},{"location":"contributing/explanation/readable-maintainable-rust/#what-maintainable-means-in-rust","title":"What \u201cMaintainable\u201d Means in Rust","text":"<p>Maintainable Rust withstands change with minimal risk and effort\u2014thanks to stable seams, guardrails, and predictable behavior.</p> <ol> <li>Stable, minimal public API</li> <li>Public types/traits are small and composable; prefer capability-oriented traits over \u201cgod traits.\u201d</li> <li>Keep internals private (<code>mod</code> visibility) unless exposure is justified.</li> <li> <p>Avoid leaking concrete types when <code>impl Trait</code> or trait objects suffice.</p> </li> <li> <p>Explicit boundaries &amp; layering</p> </li> <li>Separate pure domain logic, adapters, and IO. Keep <code>async</code> at the edges.</li> <li> <p>One clear responsibility per module; lifecycle ownership is explicit.</p> </li> <li> <p>Error taxonomy</p> </li> <li>Categorize errors (user, infra, programming) and indicate recoverability.</li> <li>Prefer stable, typed public errors (e.g., via <code>thiserror</code>) and keep error messages actionable and consistent.</li> <li> <p>In this repo: compiler diagnostics are typically built with <code>miette</code>, and shared runtime/semantic errors should         stay aligned (see Layering Rules).</p> </li> <li> <p>Concurrency discipline</p> </li> <li>Make <code>Send + Sync</code> requirements explicit; guard shared state predictably.</li> <li>Use structured concurrency (task groups, cancellation) over \u201cfire-and-forget.\u201d</li> <li> <p>Prefer channels/async streams for coordination when appropriate.</p> </li> <li> <p>Tooling baked in</p> </li> <li><code>rustfmt</code> and <code>clippy</code> are non-negotiable in CI; tune lints to project needs.</li> <li>Dependency hygiene: <code>cargo-audit</code>, <code>cargo-deny</code>, <code>cargo-udeps</code>; pin MSRV.</li> <li> <p>Tests include unit, integration, doctests, property-based (<code>proptest</code>), fuzzing (<code>cargo-fuzz</code>) for parsers.</p> </li> <li> <p>Safety &amp; invariants</p> </li> <li><code>unsafe</code> is rare, isolated, and annotated with SAFETY: comments plus tests.</li> <li> <p>Invariants are encoded in types and constructors, not just comments.</p> </li> <li> <p>Performance with restraint</p> </li> <li>Measure before optimizing (e.g., <code>criterion</code>); avoid premature micro-optimizations.</li> <li>Favor simpler code that compiles fast unless profiling proves otherwise.</li> </ol>"},{"location":"contributing/explanation/readable-maintainable-rust/#pragmatic-checklist","title":"Pragmatic Checklist","text":"<p>If these are true, your Rust is both readable and maintainable:</p> <ul> <li>\u2705 Formatting &amp; lints: <code>cargo +nightly fmt --all -- --check</code> and <code>cargo clippy --deny warnings</code> pass; lint level tuned   to project.</li> <li>\u2705 Boundaries: Modules align with responsibilities; public surface area small and documented.</li> <li>\u2705 Errors: Clear <code>Result&lt;T, E&gt;</code> with actionable messages; categorized <code>E</code>.</li> <li>\u2705 Ownership: Minimal clones; predictable lifetimes; borrowing favored.</li> <li>\u2705 Tests: Unit + integration + doctests exist; critical logic property-tested; parser/unsafe areas fuzzed.</li> <li>\u2705 Docs: <code>rustdoc</code> examples compile; <code>README</code> shows usage; <code>SAFETY:</code> annotations present where needed.</li> <li>\u2705 CI: Audit, deny, udeps, MSRV checks run; semantic versioning for releases.</li> <li>\u2705 Async/concurrency: Structured, cancellable; no hidden global mutable state.</li> </ul>"},{"location":"contributing/explanation/readable-maintainable-rust/#idiomatic-examples","title":"Idiomatic Examples","text":""},{"location":"contributing/explanation/readable-maintainable-rust/#1-errors-internal-vs-external","title":"1) Errors: Internal vs External","text":"<pre><code>// External API error (stable, documented)\nuse thiserror::Error;\n\n#[derive(Debug, Error)]\npub enum ClientError {\n    #[error(\"network error: {0}\")]\n    Network(String),\n    #[error(\"invalid request: {0}\")]\n    InvalidRequest(String),\n    #[error(\"timeout after {0:?}\")]\n    Timeout(std::time::Duration),\n}\n\n// Internal plumbing should preserve context while avoiding opaque stringly errors.\nfn perform_io() -&gt; Result&lt;(), std::io::Error&gt; {\n    let _data = std::fs::read(\"config.json\")?;\n    // ...\n    Ok(())\n}\n</code></pre>"},{"location":"contributing/explanation/readable-maintainable-rust/#2-public-api-trait-oriented-minimal-exposure","title":"2) Public API: Trait-Oriented, Minimal Exposure","text":"<pre><code>pub trait Storage {\n    fn put(&amp;self, key: &amp;str, bytes: &amp;[u8]) -&gt; Result&lt;(), StorageError&gt;;\n    fn get(&amp;self, key: &amp;str) -&gt; Result&lt;Option&lt;Vec&lt;u8&gt;&gt;, StorageError&gt;;\n}\n\npub struct S3Storage { /* fields private */ }\n\nimpl Storage for S3Storage {\n    fn put(&amp;self, key: &amp;str, bytes: &amp;[u8]) -&gt; Result&lt;(), StorageError&gt; {\n        // ...\n        Ok(())\n    }\n    fn get(&amp;self, key: &amp;str) -&gt; Result&lt;Option&lt;Vec&lt;u8&gt;&gt;, StorageError&gt; {\n        // ...\n        Ok(None)\n    }\n}\n\n// Factory returns impl Trait to avoid leaking concrete type\npub fn storage_from_env() -&gt; impl Storage {\n    S3Storage { /* ... */ }\n}\n</code></pre>"},{"location":"contributing/explanation/readable-maintainable-rust/#3-ownership-clarity-borrow-when-possible","title":"3) Ownership Clarity: Borrow When Possible","text":"<pre><code>fn normalize(input: &amp;str) -&gt; String {\n    input.trim().to_lowercase()\n}\n</code></pre> <p>Avoid:</p> <pre><code>fn normalize(input: String) -&gt; String {\n    // Forces ownership and can cause unnecessary clones elsewhere\n    input.trim().to_lowercase()\n}\n</code></pre>"},{"location":"contributing/explanation/readable-maintainable-rust/#4-macro-discipline","title":"4) Macro Discipline","text":"<pre><code>/// Generates simple enum Display impls.\n/// Use sparingly; document the expansion in examples.\n#[macro_export]\nmacro_rules! impl_display {\n    ($t:ty, $($v:ident),+ $(,)?) =&gt; {\n        impl std::fmt::Display for $t {\n            fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;'_&gt;) -&gt; std::fmt::Result {\n                match self {\n                    $(Self::$v =&gt; write!(f, stringify!($v)),)+\n                }\n            }\n        }\n    };\n}\n</code></pre>"},{"location":"contributing/explanation/readable-maintainable-rust/#project-scaffolding","title":"Project Scaffolding","text":""},{"location":"contributing/explanation/readable-maintainable-rust/#librs-and-mainrs","title":"lib.rs and main.rs","text":"<pre><code>#![forbid(unsafe_code)]\n#![deny(clippy::all, clippy::cargo)]\n#![warn(clippy::pedantic)]\n#![allow(clippy::module_name_repetitions)] // tune to taste\n</code></pre>"},{"location":"contributing/explanation/readable-maintainable-rust/#rustfmttoml","title":"<code>rustfmt.toml</code>","text":"<pre><code>edition = \"2024\"\nmax_width = 120\n</code></pre>"},{"location":"contributing/explanation/readable-maintainable-rust/#cargotoml","title":"<code>Cargo.toml</code>","text":"<pre><code>[package]\nedition = \"2024\"\nrust-version = \"1.85\" # MSRV pinned (keep in sync with CI)\n\n[dependencies]\nthiserror = \"1\"\n\n[features]\ndefault = []\n</code></pre>"},{"location":"contributing/explanation/readable-maintainable-rust/#typical-ci-steps","title":"Typical CI Steps","text":"<pre><code>cargo +nightly fmt --all -- --check\ncargo clippy --all-targets --all-features -- -D warnings\ncargo test --all --verbose\ncargo audit\ncargo deny check\ncargo +nightly udeps --all-targets\n</code></pre> <p>Note: MSRV is enforced via CI running build/test with a pinned toolchain.</p>"},{"location":"contributing/explanation/readable-maintainable-rust/#common-pitfalls","title":"Common Pitfalls","text":"<ul> <li>Overusing generics: Complex bounds and many type params \u2192 prefer trait objects or smaller traits.</li> <li>Lifetime gymnastics: If lifetimes leak everywhere, restructure ownership or use owned buffers at boundaries.</li> <li>Macro-heavy APIs: If consumers must \u201cthink in macros,\u201d reconsider the design.</li> <li>Ambiguous errors: <code>Result&lt;T, String&gt;</code> in public API \u2192 hard to evolve safely.</li> <li>Panics on recoverable paths: Reserve panics for invariants; use <code>Result</code> elsewhere.</li> <li>Async everywhere: Keep <code>async</code> at IO boundaries; don\u2019t make pure functions <code>async</code>.</li> <li>Global mutable state: Hide state behind interfaces; avoid implicit singletons.</li> </ul>"},{"location":"contributing/explanation/readable-maintainable-rust/#simple-heuristic","title":"Simple Heuristic","text":"<p>If a teammate can fix a bug or add a feature without asking you to explain ownership or lifetimes, and CI tells them when they\u2019re wrong\u2014your Rust is both readable and maintainable.</p>"},{"location":"contributing/how-to/benchmarks_and_profiling/","title":"Benchmarks &amp; profiling (repository)","text":"<p>This page is for contributors working on Incan\u2019s performance: running the repository benchmark suite, adding new benchmarks, and profiling the compiler.</p> <p>If you want to speed up your program, see Performance (how-to).</p>"},{"location":"contributing/how-to/benchmarks_and_profiling/#benchmark-suite","title":"Benchmark suite","text":"<p>The repository includes a benchmark suite that compares generated binaries against Rust and Python baselines.</p>"},{"location":"contributing/how-to/benchmarks_and_profiling/#available-benchmarks","title":"Available benchmarks","text":"Category Benchmark Description Compute <code>fib</code> Iterative Fibonacci (N=1,000,000) Compute <code>collatz</code> Collatz sequence (1,000,000 numbers) Compute <code>gcd</code> GCD of 10,000,000 pairs Compute <code>mandelbrot</code> 2000\u00d72000 escape iterations Compute <code>nbody</code> N-body simulation (500,000 steps) Compute <code>primes</code> Sieve up to 50,000,000 Sorting <code>quicksort</code> In-place sort (1M integers) Sorting <code>mergesort</code> Merge sort (1M integers)"},{"location":"contributing/how-to/benchmarks_and_profiling/#running-benchmarks","title":"Running benchmarks","text":"<pre><code># Prerequisites (macOS)\nbrew install hyperfine jq bc\n\n# Build the compiler\ncargo build --release\n\n# Run all benchmarks\nmake benchmarks\n\n# Or run the benchmark runner directly\n./benchmarks/run_all.sh\n</code></pre>"},{"location":"contributing/how-to/benchmarks_and_profiling/#running-an-individual-benchmark","title":"Running an individual benchmark","text":"<pre><code>cd benchmarks/compute/fib\n\n# Build Incan version\n../../../target/release/incan build fib.incn\ncp ../../../target/incan/fib/target/release/fib ./fib_incan\n\n# Build Rust baseline\nrustc -O fib.rs -o fib_rust\n\n# Compare\nhyperfine --warmup 2 --min-runs 5 \\\n  './fib_incan' \\\n  './fib_rust' \\\n  'python3 fib.py'\n</code></pre>"},{"location":"contributing/how-to/benchmarks_and_profiling/#results","title":"Results","text":"<p>For current measured results, see <code>benchmarks/results/results.md</code> in the repository.</p>"},{"location":"contributing/how-to/benchmarks_and_profiling/#profiling","title":"Profiling","text":""},{"location":"contributing/how-to/benchmarks_and_profiling/#profiling-generated-code-your-benchmarkprogram","title":"Profiling generated code (your benchmark/program)","text":"<pre><code># Build (incan always builds the generated project in release mode today)\nincan build myprogram.incn\n\n# Profile with Instruments (macOS)\nxcrun xctrace record --template \"Time Profiler\" \\\n  --launch ./target/incan/myprogram/target/release/myprogram\n\n# Profile with perf (Linux)\nperf record ./target/incan/myprogram/target/release/myprogram\nperf report\n</code></pre>"},{"location":"contributing/how-to/benchmarks_and_profiling/#profiling-the-compiler","title":"Profiling the compiler","text":"<pre><code># Profile compilation itself\ncargo flamegraph --bin incan -- build examples/advanced/async_await.incn\n\n# Or with samply (macOS)\nsamply record ./target/release/incan build large_program.incn\n</code></pre>"},{"location":"contributing/how-to/benchmarks_and_profiling/#adding-a-new-benchmark","title":"Adding a new benchmark","text":"<ol> <li>Create a directory under <code>benchmarks/compute/</code> or <code>benchmarks/sorting/</code>.</li> <li>Add three implementations: <code>name.incn</code>, <code>name.rs</code>, <code>name.py</code>.</li> <li>Each should print a single result line for verification.</li> <li>Run <code>./benchmarks/run_all.sh</code> to include it in the suite.</li> </ol>"},{"location":"contributing/how-to/ci_and_automation/","title":"CI &amp; automation (repository / contributors)","text":"<p>This page collects the canonical commands for CI-friendly, deterministic automation for this repository  (compiler/tooling contributors).</p> <p>If you\u2019re trying to set up CI for an Incan project (using the <code>incan</code> CLI), see: CI and Automation as part of the Tooling How-To.</p>"},{"location":"contributing/how-to/ci_and_automation/#recommended-commands","title":"Recommended commands","text":""},{"location":"contributing/how-to/ci_and_automation/#build","title":"Build","text":"<p>Build the project:</p> <pre><code>make build\n</code></pre>"},{"location":"contributing/how-to/ci_and_automation/#format-and-lint-rust-codebase","title":"Format and lint (Rust codebase)","text":"<p>Run all quality checks (formatting, linting, unused dependencies):</p> <pre><code>make check\n</code></pre>"},{"location":"contributing/how-to/ci_and_automation/#tests","title":"Tests","text":"<p>Run all tests:</p> <pre><code>make test\n</code></pre>"},{"location":"contributing/how-to/ci_and_automation/#examples-smoke-test","title":"Examples (smoke test)","text":"<p>Run all examples:</p> <pre><code>make examples\n</code></pre> <p>Timeouts</p> <p>You can tune timeouts via <code>INCAN_EXAMPLES_TIMEOUT</code> (default is 5 seconds).</p>"},{"location":"contributing/how-to/ci_and_automation/#full-smoke-test","title":"Full smoke test","text":"<p>Run all tests, examples, and benchmarks:</p> <pre><code>make smoke-test\n</code></pre>"},{"location":"contributing/how-to/ci_and_automation/#docs-site-build","title":"Docs site build","text":"<p>Build the docs site:</p> <pre><code>make docs-build\n</code></pre>"},{"location":"contributing/how-to/extending_language/","title":"Extending Incan: Builtins vs New Syntax","text":"<p>This document is for contributors who want to add new language features.</p> <p>Incan is implemented as a multi-stage compiler:</p> <ul> <li>Frontend: Lexer \u2192 Parser \u2192 AST \u2192 Typechecker (<code>typechecker/</code>)</li> <li>Backend: Lowering (AST \u2192 IR) \u2192 Emitter (IR \u2192 Rust)</li> </ul> <p>That separation is intentional (clarity, correctness, debuggability), but it means that adding new syntax typically touches multiple stages.</p> <p>Required reading (contributors)</p> <p>Before making language changes, read these end-to-end:</p> <ul> <li>Incan Compiler Architecture \u2014 internal pipeline + module layout</li> <li>How Incan works \u2014 conceptual pipeline schematic</li> <li>RFC index \u2014 required for new language features (syntax/semantics), not for bugs/chores</li> </ul>"},{"location":"contributing/how-to/extending_language/#architecture-schematic-high-level","title":"Architecture schematic (high-level)","text":"<pre><code>flowchart TD\n    incanSource[Incan_source_.incn] --&gt; parser[Parse_and_validate]\n    parser --&gt; typecheck[Typecheck_and_resolve]\n    typecheck --&gt; lower[Lower_to_Rust]\n    lower --&gt; cargo[Cargo_build]\n    cargo --&gt; binary[Executable]</code></pre>"},{"location":"contributing/how-to/extending_language/#where-things-live-crates-and-modules","title":"Where things live (crates and modules)","text":"<p>Incan\u2019s \u201clanguage surface\u201d spans a small number of key crates/modules:</p> Crate/Module Purpose <code>crates/incan_syntax</code> Lexer/parser/AST/diagnostics (shared by compiler, formatter, and LSP to prevent drift) <code>crates/incan_core</code> Semantic registries + pure helpers shared across the ecosystem (should not drift) <code>crates/incan_stdlib</code> Runtime support for generated programs (preferred home for \u201cjust a function\u201d behavior) <code>crates/incan_derive</code> Derives used by generated Rust programs (runtime-side) <code>src/frontend</code> Module resolution + typechecker (turns syntax into a typed program) <code>src/backend</code> Lowering + IR + emission (turns typed program into Rust) <code>src/format/</code> Source formatter (<code>incan fmt</code>) <code>src/lsp/</code> Language server (reuses frontend to provide IDE diagnostics) <p>When you\u2019re unsure where to implement something, start by deciding which crate owns the responsibility.</p>"},{"location":"contributing/how-to/extending_language/#rule-of-thumb","title":"Rule of Thumb","text":"<p>Prefer a library/builtin over a new keyword.</p> <p>Add a new keyword / syntax form only when the feature:</p> <ul> <li>Introduces control-flow that cannot be expressed as a call (e.g. <code>match</code>, <code>yield</code>, <code>await</code>, <code>?</code>)</li> <li>Requires special typing rules that would be awkward or misleading as a function</li> <li>Needs non-standard evaluation of its operands (short-circuiting, implicit returns, pattern binding, etc.)</li> </ul> <p>If the feature is \u201csome behavior\u201d (logging, printing, tracing, helpers), it should usually be:</p> <ul> <li>A stdlib function (preferred), or</li> <li>A compiler builtin (when it must lower to special Rust code).</li> </ul>"},{"location":"contributing/how-to/extending_language/#path-a-adding-a-function-stdlib-or-compiler-builtin","title":"Path A: Adding a Function (Stdlib or Compiler Builtin)","text":""},{"location":"contributing/how-to/extending_language/#a1-stdlib-function-no-new-syntax","title":"A.1:   Stdlib function (no new syntax)","text":"<p>Use this when the behavior can live in runtime support crates (e.g. <code>incan_stdlib</code>), without compiler special casing.</p> <p>Typical work:</p> <ul> <li>Add runtime implementation in <code>crates/incan_stdlib/</code></li> <li>Expose it via the prelude if appropriate</li> <li>Document it in the language guide</li> </ul> <p>This avoids changing the lexer/parser/AST/IR.</p>"},{"location":"contributing/how-to/extending_language/#a2-compiler-builtin-function-special-loweringemission","title":"A.2:  Compiler builtin function (special lowering/emission)","text":"<p>Use this when you want a function-call surface syntax, but it must emit a particular Rust pattern.</p> <p>Incan already has enum-dispatched builtins in IR (<code>BuiltinFn</code>) and emission logic in <code>emit/expressions/builtins.rs</code>.</p> <p>End-to-end checklist:</p> <ul> <li>Frontend symbol table: add the builtin name and signature so it typechecks<ul> <li><code>src/frontend/symbols.rs</code> \u2192 <code>SymbolTable::add_builtins()</code></li> </ul> </li> <li>IR builtin enum: add a new variant and name mapping<ul> <li><code>src/backend/ir/expr.rs</code> \u2192 <code>enum BuiltinFn</code> + <code>BuiltinFn::from_name()</code></li> </ul> </li> <li>Lowering: ensure calls to that name lower to <code>IrExprKind::BuiltinCall</code><ul> <li><code>src/backend/ir/lower/expr.rs</code> uses <code>BuiltinFn::from_name(name)</code> for identifiers</li> </ul> </li> <li>Emission: emit the Rust code for the new builtin<ul> <li><code>src/backend/ir/emit/expressions/builtins.rs</code> \u2192 <code>emit_builtin_call()</code></li> </ul> </li> <li>Docs/tests: add/adjust as needed</li> </ul> <p>This path is often much cheaper than adding new syntax, while still letting you control the generated Rust.</p>"},{"location":"contributing/how-to/extending_language/#a2-compiler-builtin-method-special-method-loweringemission","title":"A.2:  Compiler builtin method (special method lowering/emission)","text":"<p>Use this when you want to add a method on existing types (e.g. <code>list.some_method()</code>) that needs special Rust emission.</p> <p>Incan has enum-dispatched methods in IR (<code>MethodKind</code>) and emission logic in <code>emit/expressions/methods.rs</code>.</p> <p>End-to-end checklist:</p> <ul> <li>IR method enum: add a new variant and name mapping<ul> <li><code>src/backend/ir/expr.rs</code> \u2192 <code>enum MethodKind</code> + <code>MethodKind::from_name()</code></li> </ul> </li> <li>Lowering: automatic (uses <code>MethodKind::from_name(name)</code> for all method calls)<ul> <li><code>src/backend/ir/lower/expr.rs</code> already handles this</li> </ul> </li> <li>Emission: emit the Rust code for the new method<ul> <li><code>src/backend/ir/emit/expressions/methods.rs</code> \u2192 <code>emit_known_method_call()</code></li> </ul> </li> <li>Docs/tests: add/adjust as needed</li> </ul> <p>Unknown methods pass through as regular Rust method calls, so you don't break Rust interop by adding known methods.</p>"},{"location":"contributing/how-to/extending_language/#path-b-add-a-new-keyword-syntax-form","title":"Path B: Add a New Keyword / Syntax Form","text":"<p>Use this only when the feature is genuinely syntactic/control-flow.</p> <p>End-to-end checklist (typical):</p> <p>Lexer: <code>crates/incan_syntax/src/lexer/*</code></p> <ul> <li>Add a <code>KeywordId</code> and a <code>KEYWORDS</code> entry (canonical spelling/metadata) in <code>crates/incan_core/src/lang/keywords.rs</code></li> <li>Ensure tokenization emits <code>TokenKind::Keyword(KeywordId::YourKeyword)</code></li> <li>Update lexer parity tests (keyword/operator/punctuation registry parity)</li> </ul> <p>Word-operators (special case)</p> <p>If the new \u201ckeyword\u201d is meant to behave like an operator (it participates in expression precedence like <code>and</code>, <code>or</code>, <code>not</code>, <code>in</code>, <code>is</code>), treat it as a word-operator:</p> <ul> <li>Add it to <code>crates/incan_core/src/lang/operators.rs</code> (precedence/fixity source of truth)</li> <li>Add a corresponding <code>KeywordId</code> + <code>KEYWORDS</code> entry in <code>crates/incan_core/src/lang/keywords.rs</code> (so the lexer will   still lex it as a keyword)</li> <li>Update expression parsing in <code>crates/incan_syntax/src/parser/expr.rs</code> to place it at the right precedence level</li> </ul> <p>Parser: <code>crates/incan_syntax/src/parser/*</code></p> <ul> <li>Parse the syntax and build a new AST node (usually an <code>Expr</code> or <code>Statement</code> variant)</li> </ul> <p>AST: <code>crates/incan_syntax/src/ast.rs</code></p> <ul> <li>Add the new <code>Expr::&lt;YourNode&gt;</code> or <code>Statement::&lt;YourNode&gt;</code> variant</li> </ul> <p>Formatter: <code>src/format/formatter.rs</code></p> <ul> <li>Teach the formatter how to print the new node</li> </ul> <p>Typechecker:<code>src/frontend/typechecker/</code></p> <ul> <li><code>check_decl.rs</code> \u2013 add type-level rules (models, classes, traits)</li> <li><code>check_stmt.rs</code> \u2013 add statement-level rules (assignments, control flow)</li> <li><code>check_expr/*.rs</code> \u2013 add expression-level rules (calls, operators, match)</li> </ul> <p>(Optional) Scanners: <code>src/backend/ir/scanners.rs</code></p> <ul> <li>Ensure feature detection traverses the new node if relevant</li> </ul> <p>Lowering (AST \u2192 IR): <code>src/backend/ir/lower/*</code></p> <ul> <li>Lower the new AST node into an IR representation</li> </ul> <p>IR (if needed): <code>src/backend/ir/expr.rs</code> / <code>stmt.rs</code> / <code>decl.rs</code></p> <ul> <li>Add a new <code>IrExprKind</code>/<code>IrStmtKind</code> variant if the feature is not expressible via existing IR</li> </ul> <p>Emitter (IR \u2192 Rust): <code>src/backend/ir/emit/**/*.rs</code></p> <ul> <li>Emit correct Rust for the new IR node</li> </ul> <p>Editor tooling (optional but recommended): <code>editors/*</code></p> <ul> <li><code>editors/vscode/*</code>: keyword highlighting / indentation patterns</li> </ul> <p>Docs + tests</p> <ul> <li>Add a guide snippet and at least one parse/typecheck/codegen regression test</li> </ul>"},{"location":"contributing/how-to/extending_language/#practical-guidance","title":"Practical guidance","text":"<ul> <li>If you find yourself adding a keyword to achieve \u201ca function with a special implementation\u201d, pause and consider making   it a builtin function instead.</li> <li>If you add a new AST/IR enum variant, rely on Rust\u2019s exhaustiveness errors as your checklist: the compiler will tell you   which match arms you need to update.</li> </ul>"},{"location":"contributing/how-to/writing_rfcs/","title":"Writing RFCs (how-to)","text":"<p>This guide is for contributors writing an RFC (design record) in this repo.</p> <p>RFC stands for \u201cRequest for Comments\u201d.</p> <p>Before you start</p> <p>Always check whether there is already an RFC or a proposal RFC-issue for the feature you want to propose.</p> <p>Start here:</p> <ul> <li>Proposals: issues vs RFCs</li> <li>RFC index</li> </ul>"},{"location":"contributing/how-to/writing_rfcs/#when-you-should-write-an-rfc","title":"When you should write an RFC","text":"<p>Write an RFC when the user-facing meaning of the language changes, for example:</p> <ul> <li>new syntax/keyword</li> <li>new semantics (what code means)</li> <li>new type system rule or inference behavior</li> <li>a stdlib contract that becomes \u201cpart of the language\u201d (stable surface users rely on)</li> <li>a tooling change that affects a stable user-facing contract (for example: a new CLI command/flag/config)</li> </ul>"},{"location":"contributing/how-to/writing_rfcs/#workflow","title":"Workflow","text":"<ol> <li> <p>(Optional) Start with an issue    File an \u201cRFC proposal\u201d issue to align on the problem and scope.</p> </li> <li> <p>Create the RFC file</p> <ul> <li>Copy the template: RFC template</li> <li>Create a new file under <code>workspaces/docs-site/docs/RFCs/</code> named: <code>NNN_short_slug.md</code>   (example: <code>017_match_guards.md</code>)</li> <li>Pick the next available <code>NNN</code> from the RFC index.</li> </ul> </li> <li> <p>Fill in the RFC     Keep it focused: one coherent proposal. Make sure you cover the following:</p> <ul> <li>motivation + examples</li> <li>precise rules (semantics/type rules/edge cases)</li> <li>alternatives considered</li> <li>migration/compatibility</li> <li>acceptance criteria (\u201cdone when\u2026\u201d)</li> <li>implementation plan + touchpoints (frontend/backend/stdlib/tooling/tests)</li> </ul> </li> <li> <p>Open a PR</p> <ul> <li>Link the PR in the RFC\u2019s \u201cStatus\u201d section.</li> <li>Expect iteration: RFCs usually evolve over review.</li> </ul> </li> <li> <p>Discuss    Use the PR discussion (and/or the linked issue) to gather feedback and converge.</p> </li> </ol>"},{"location":"contributing/how-to/writing_rfcs/#after-acceptance","title":"After acceptance","text":"<ul> <li>If implemented: move the RFC to <code>workspaces/docs-site/docs/RFCs/done/</code>.</li> <li>If deferred: keep it in place but update the status to <code>Deferred</code> and summarize why.</li> </ul>"},{"location":"contributing/how-to/writing_rfcs/#tips-for-a-good-rfc","title":"Tips for a good RFC","text":"<ul> <li>Prefer concrete examples over abstract prose.</li> <li>Write the reference-level rules as if someone will implement them.</li> <li>Call out non-goals explicitly.</li> <li>If it\u2019s too big: split it into a sequence of smaller RFCs.</li> </ul>"},{"location":"contributing/tutorials/book/","title":"Incan Contributor Book (Advanced, Rust-first)","text":"<p>This is a linear, Rust-first track for contributors working on the Incan compiler, tooling, and docsite.</p> <p>This book is intentionally opinionated and may duplicate some material from the standalone contributing pages so it can be read end-to-end like a book.</p>"},{"location":"contributing/tutorials/book/#before-you-start-required","title":"Before you start (required)","text":"<ul> <li>Architecture \u2014 compilation pipeline + module layout</li> <li>Extending the language \u2014 builtin vs new syntax decision + end-to-end checklists</li> <li>Layering rules \u2014 dependency boundaries and guardrails</li> <li>Readable, maintainable Rust \u2014 conventions and guardrails for changing the Rust codebase</li> <li>RFC index \u2014 required for new language features (syntax/semantics), not for bugs/chores</li> </ul>"},{"location":"contributing/tutorials/book/#chapters","title":"Chapters","text":"<p>Read in order:</p> <ol> <li>01. Architecture tour</li> <li>02. Layering and boundaries</li> <li>03. Proposals: issues vs RFCs</li> <li>04. Your first change: add a builtin</li> <li>05. Your first syntax change</li> <li>06. Tooling loop: formatter + tests</li> <li>07. Tooling loop: LSP</li> <li>08. Docsite contributor loop</li> </ol>"},{"location":"contributing/tutorials/book/01_architecture_tour/","title":"1. Architecture tour","text":"<p>This chapter builds a mental model for how Incan turns <code>.incn</code> into an executable, and where that logic lives in the repo.</p>"},{"location":"contributing/tutorials/book/01_architecture_tour/#the-pipeline-conceptual","title":"The pipeline (conceptual)","text":"<pre><code>flowchart TD\n    incanSource[Incan_source_.incn] --&gt; parser[Parse_and_validate]\n    parser --&gt; typecheck[Typecheck_and_resolve]\n    typecheck --&gt; lower[Lower_to_Rust]\n    lower --&gt; cargo[Cargo_build]\n    cargo --&gt; binary[Executable]</code></pre> <p>Keep this picture in your head while reading the code. Most contributing work is \u201cadd a feature\u201d and ensure each stage continues to compose.</p>"},{"location":"contributing/tutorials/book/01_architecture_tour/#the-big-pieces","title":"The big pieces","text":"<p>At a high level, the compiler/toolchain splits into:</p> <ul> <li>Syntax frontend: lexer + parser + AST + syntax diagnostics</li> <li>Compiler frontend: module resolution + typechecking</li> <li>Backend: lowering + Rust emission</li> <li>Project generation: writes a Cargo project, builds/runs it</li> <li>Tooling: formatter, LSP, test runner, and other developer-facing workflows</li> </ul>"},{"location":"contributing/tutorials/book/01_architecture_tour/#where-to-look-in-the-repository","title":"Where to look in the repository","text":"<p>You can orient yourself with these anchors:</p> <ul> <li><code>crates/incan_syntax/</code>:<ul> <li>shared lexer/parser/AST/diagnostics</li> <li>used by compiler, formatter, and LSP to avoid drift</li> </ul> </li> <li><code>src/frontend/</code>:<ul> <li>module resolution (<code>module.rs</code>, <code>resolver.rs</code>)</li> <li>typechecker (<code>typechecker/</code>)</li> <li>symbol table + scope rules (<code>symbols.rs</code>)</li> </ul> </li> <li><code>src/backend/</code>:<ul> <li>IR + lowering (<code>ir/lower/</code>)</li> <li>emission (<code>ir/emit/</code>) producing Rust code</li> <li>project generation (<code>project.rs</code>)</li> </ul> </li> <li><code>src/cli/</code>:<ul> <li>CLI entrypoints and commands (<code>build</code>, <code>run</code>, <code>fmt</code>, <code>test</code>)</li> </ul> </li> <li><code>src/lsp/</code>:<ul> <li>language server implementation that reuses frontend stages</li> </ul> </li> </ul> <p>If you want the deep version (module layout, key types, entry points), read:</p> <ul> <li>Architecture</li> </ul>"},{"location":"contributing/tutorials/book/01_architecture_tour/#contributor-workflow-touch-points","title":"Contributor workflow: \u201ctouch points\u201d","text":"<p>Most changes you\u2019ll make land in one of these patterns:</p> <ul> <li>Builtin or special lowering: change typechecking + lowering/emission</li> <li>New syntax: change lexer/parser/AST + formatter + typechecker + lowering/emission</li> <li>Tooling: reuse the same syntax/frontend layers (formatter and LSP should not drift from the compiler)</li> </ul>"},{"location":"contributing/tutorials/book/01_architecture_tour/#next","title":"Next","text":"<p>Next chapter: 02. Layering and boundaries.</p>"},{"location":"contributing/tutorials/book/02_layering_and_boundaries/","title":"2. Layering and boundaries","text":"<p>Incan is easiest to evolve when dependencies are clean. This chapter explains how to avoid \u201cclever\u201d shortcuts that create cycles, leaky abstractions, or drift between tooling and the compiler.</p>"},{"location":"contributing/tutorials/book/02_layering_and_boundaries/#the-principle","title":"The principle","text":"<p>Each layer should depend \u201cinward\u201d on more stable layers, not sideways on more complex ones.</p> <p>When in doubt:</p> <ul> <li>Prefer data passing over calling across layers</li> <li>Prefer pure helpers over global state</li> <li>Prefer shared crates for shared policy (instead of copy/paste)</li> </ul>"},{"location":"contributing/tutorials/book/02_layering_and_boundaries/#the-practical-rules","title":"The practical rules","text":"<p>The canonical rules live here:</p> <ul> <li>Layering rules</li> <li>Readable, maintainable Rust</li> </ul> <p>In practice, the patterns you want are:</p> <ul> <li><code>incan_syntax</code> is shared: lexer/parser/AST/diagnostics are reused by compiler, formatter, and LSP.</li> <li><code>incan_core</code> is a semantic core: shared, pure semantics and registries that must not drift.</li> <li>Compiler crates should not depend on runtime crates: runtime is for generated programs, not for the compiler.</li> </ul>"},{"location":"contributing/tutorials/book/02_layering_and_boundaries/#a-common-failure-mode","title":"A common failure mode","text":"<p>You add a feature, it \u201cworks\u201d in the CLI, but:</p> <ul> <li>the formatter prints it differently,</li> <li>the LSP can\u2019t parse it,</li> <li>or the language reference/keywords drift from implementation.</li> </ul> <p>When you feel tempted to \u201cjust implement it in the CLI\u201d:</p> <ul> <li>stop and ask which layer actually owns the behavior, and</li> <li>keep the ownership boundary crisp.</li> </ul>"},{"location":"contributing/tutorials/book/02_layering_and_boundaries/#next","title":"Next","text":"<p>Next chapter: 03. Proposals: issues vs RFCs.</p>"},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/","title":"3. Proposals: issues vs RFCs","text":"<p>This chapter explains how we decide between filing:</p> <ul> <li>a GitHub issue (bug/feature/chore), or</li> <li>an RFC (design record) for a larger change.</li> </ul> <p>The goal is to keep the project moving while making sure new language features are deliberate and reviewed.</p>"},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/#the-short-rule","title":"The short rule","text":"<ul> <li>Bugs / chores: file an issue in github. No RFC required.</li> <li>New language features (syntax, semantics, type system behavior): RFC required.</li> <li>Tooling features: issue by default; RFC when the change affects stable contracts or needs design discussion.</li> </ul> <p>If a change alters how <code>.incn</code> behaves for users, assume \u201cRFC required\u201d unless a maintainer says otherwise.</p>"},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/#what-is-an-rfc-in-this-repo","title":"What is an RFC (in this repo)?","text":"<p>RFCs are PEP-style design records (proposal + rationale + trade-offs). They are not canonical user docs, but user docs may link to them for background.</p> <p>Start here:</p> <ul> <li>RFC index: RFCs</li> <li>Template: RFC template</li> </ul>"},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/#how-to-file","title":"How to file","text":""},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/#1-file-an-issue-bugfeaturechore","title":"1) File an issue (bug/feature/chore)","text":"<p>Use an issue when you can describe the work without needing agreement on a new language design. Pick the template that best fits your situation:</p> <ul> <li> <p>Bug report: a bug in compiler/tooling (e.g. codegen emits invalid Rust for an edge case).   Include a minimal <code>.incn</code> repro, expected output, and actual output.</p> </li> <li> <p>Feature request: a feature you want (but no language design required).   Include the problem statement, a concrete example, and acceptance criteria (\u201cdone when\u2026\u201d).</p> </li> <li> <p>Chore: maintenance work (no user-visible change).   Include the motivation and a small checklist of the intended changes.</p> </li> <li> <p>Documentation: missing documentation, typos or grammar/style issues, or drift (doc claims a feature exists but it\u2019s planned/bugged/wrong),    Include the doc link, proposed wording, and a tracking issue link.</p> </li> <li> <p>Question: you\u2019re unsure which direction is correct and want to engage the community for feedback or assistance.   Include context, what you already tried, and 1\u20132 concrete questions you want answered.  </p> </li> <li> <p>Task: a scoped piece of work (e.g. performance regression in a hot path).   Include before/after timings, benchmark notes, and the suspected hotspot.</p> </li> </ul>"},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/#2-write-an-rfc-new-language-features","title":"2) Write an RFC (new language features)","text":"<p>Write an RFC when you propose a new user-visible language capability or meaning change, such as:</p> <ul> <li>new keyword / syntax form</li> <li>new type system rule</li> <li>new standard library contract that effectively becomes part of the language</li> </ul> <p>Essentially, anytime the 'look-and-feel' of the language itself would be affected, an RFC is required.</p>"},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/#how-to-file-an-rfc-workflow","title":"How to file an RFC (workflow)","text":"<p>Use the RFC template and follow the detailed workflow here: Writing RFCs (how-to)</p> <p>An RFC should answer:</p> <ul> <li>What problem are we solving?</li> <li>Why is this the right solution?</li> <li>What are alternatives?</li> <li>What is the migration story?</li> <li>What are the acceptance criteria?</li> </ul>"},{"location":"contributing/tutorials/book/03_proposals_issues_vs_rfcs/#next","title":"Next","text":"<p>Next chapter: 04. Your first change: add a builtin.</p>"},{"location":"contributing/tutorials/book/04_add_a_builtin/","title":"4. Your first change: add a builtin","text":"<p>This chapter is a guided walkthrough for adding a builtin: a function that looks like a normal call in Incan, but lowers/emits to a specific Rust pattern.</p> <p>If you haven\u2019t read it yet, start with: Extending the language</p>"},{"location":"contributing/tutorials/book/04_add_a_builtin/#decide-stdlib-function-vs-compiler-builtin","title":"Decide: stdlib function vs compiler builtin","text":"<p>Use a stdlib function when the behavior can live entirely in runtime support code.</p> <p>Use a compiler builtin when you need:</p> <ul> <li>special typing rules,</li> <li>special lowering/emission,</li> <li>or you want the surface syntax to stay \u201cfunction-call-like\u201d while generating nontrivial Rust.</li> </ul>"},{"location":"contributing/tutorials/book/04_add_a_builtin/#end-to-end-checklist-compiler-builtin","title":"End-to-end checklist (compiler builtin)","text":"<p>Before you start, sanity-check which layer your change belongs in (to avoid language/tooling drift):</p> <p>Keep the pipeline aligned (to avoid language/tooling drift):</p> <ul> <li>Syntax crate (<code>crates/incan_syntax/</code>): lexer \u2192 parser \u2192 AST \u2192 diagnostics</li> <li>Formatter (<code>src/format/</code>): prints AST back (idempotent; never emits invalid syntax)</li> <li>Semantic core (<code>crates/incan_core/</code>): canonical vocab / shared semantic helpers (avoid duplicating \u201cmeaning\u201d in multiple   layers)</li> <li>Compiler (<code>src/frontend/</code>, <code>src/backend/</code>):<ul> <li>typechecker validates and annotates</li> <li>lowering turns AST into IR</li> <li>emission generates correct Rust</li> </ul> </li> <li>Runtime/stdlib (<code>crates/incan_stdlib/</code>, <code>stdlib/</code>): behavior that can live outside the compiler should live here</li> </ul> <p>Rule of thumb: prefer pushing shared meaning \u201cdown\u201d into <code>incan_core</code>/<code>incan_syntax</code>/<code>incan_stdlib</code>, and keep the <code>incan</code> (root) crate focused on orchestration and pipeline wiring.</p>"},{"location":"contributing/tutorials/book/04_add_a_builtin/#what-you-will-usually-touch","title":"What you will usually touch","text":"<p>Builtin changes typically land in the compiler (<code>incan</code> crate), so you will usually touch:</p> <ol> <li>Frontend symbol table (so it typechecks)<ul> <li><code>src/frontend/symbols.rs</code> \u2192 builtin name + signature</li> </ul> </li> <li>IR builtin enum (so lowering can represent it explicitly)<ul> <li><code>src/backend/ir/expr.rs</code> \u2192 <code>BuiltinFn</code> variant + name mapping</li> </ul> </li> <li>Lowering (so calls become <code>BuiltinCall</code>)<ul> <li><code>src/backend/ir/lower/expr.rs</code></li> </ul> </li> <li>Emission (so Rust output matches the intended pattern)<ul> <li><code>src/backend/ir/emit/expressions/builtins.rs</code></li> </ul> </li> <li>Tests and docs<ul> <li>add a regression test (parse/typecheck/codegen)</li> <li>add/adjust docs if it changes user-visible behavior</li> </ul> </li> </ol>"},{"location":"contributing/tutorials/book/04_add_a_builtin/#a-suggested-first-builtin-exercise","title":"A suggested \u201cfirst builtin\u201d exercise","text":"<p>Pick a small builtin where you can clearly verify the generated Rust (and add a regression test):</p> <ul> <li>a builtin that maps to a single Rust stdlib call</li> <li>a builtin that needs a small helper function emitted</li> </ul> <p>Keep it small: your goal is to learn the pipeline and leave the codebase in a better state.</p>"},{"location":"contributing/tutorials/book/04_add_a_builtin/#running-your-feedback-loop","title":"Running your feedback loop","text":"<p>After implementing the builtin, validate it through the toolchain:</p> <ul> <li><code>make pre-commit</code> still passes (fmt + clippy + udeps + tests + release build)</li> <li><code>make smoke-test</code> still passes (end-to-end sanity check)</li> <li>the LSP still parses/diagnoses edited files (no syntax drift)</li> </ul> <p>Optionally, consider adding a tiny example showing the new builtin in use, to lock in the intended behavior. Note that examples are intended for user-visible behavior, not for internal implementation details.</p>"},{"location":"contributing/tutorials/book/04_add_a_builtin/#next","title":"Next","text":"<p>Next chapter: 05. Your first syntax change.</p>"},{"location":"contributing/tutorials/book/05_add_new_syntax/","title":"5. Your first syntax change","text":"<p>New syntax is the most invasive type of change: it touches multiple stages and increases long-term maintenance cost.</p> <p>This chapter shows how to do it safely and predictably.</p> <p>RFC required for new language features</p> <p>If you are proposing a new user-visible language feature (syntax or semantics), write an RFC first:</p> <ul> <li>RFC index</li> <li>RFC template</li> </ul> <p>Bugfixes and chores do not require an RFC.</p>"},{"location":"contributing/tutorials/book/05_add_new_syntax/#before-you-start","title":"Before you start","text":"<p>Read:</p> <ul> <li>Extending the language (the builtin-vs-syntax decision and checklists)</li> </ul>"},{"location":"contributing/tutorials/book/05_add_new_syntax/#your-mental-checklist","title":"Your mental checklist","text":"<p>Keep the pipeline aligned (to avoid language/tooling drift):</p> <ul> <li>Syntax crate (<code>crates/incan_syntax/</code>): lexer \u2192 parser \u2192 AST \u2192 diagnostics</li> <li>Formatter (<code>src/format/</code>): prints AST back (idempotent; never emits invalid syntax)</li> <li>Semantic core (<code>crates/incan_core/</code>): canonical vocab / shared semantic helpers (avoid duplicating \u201cmeaning\u201d in multiple   layers)</li> <li>Compiler (<code>src/frontend/</code>, <code>src/backend/</code>):<ul> <li>typechecker validates and annotates</li> <li>lowering turns AST into IR</li> <li>emission generates correct Rust</li> </ul> </li> <li>Runtime/stdlib (<code>crates/incan_stdlib/</code>, <code>stdlib/</code>): behavior that can live outside the compiler should live here</li> </ul> <p>Rule of thumb: prefer pushing shared meaning \u201cdown\u201d into <code>incan_core</code>/<code>incan_syntax</code>/<code>incan_stdlib</code>, and keep the <code>incan</code> (root) crate focused on orchestration and pipeline wiring.</p> <p>You should expect Rust exhaustiveness errors to guide your work when you add enum variants.</p>"},{"location":"contributing/tutorials/book/05_add_new_syntax/#pick-a-first-syntax-change-that-stays-small","title":"Pick a \u201cfirst syntax change\u201d that stays small","text":"<p>A good first syntax change:</p> <ul> <li>is local (one new statement or expression form),</li> <li>has a simple typing rule,</li> <li>emits Rust in an obvious way,</li> <li>can be covered by 1\u20132 regression tests.</li> </ul> <p>Avoid starting with a feature that requires new runtime types, new module system rules, or complex ownership behavior.</p>"},{"location":"contributing/tutorials/book/05_add_new_syntax/#next","title":"Next","text":"<p>Next chapter: 06. Tooling loop: formatter + tests.</p>"},{"location":"contributing/tutorials/book/06_tooling_loop_formatter_and_tests/","title":"6. Tooling loop: formatter + tests","text":"<p>This chapter explains the contributor \u201cinner loop\u201d for making changes safely:</p> <ul> <li>format code consistently</li> <li>run tests quickly</li> <li>prevent drift between syntax, compiler, and tooling</li> </ul>"},{"location":"contributing/tutorials/book/06_tooling_loop_formatter_and_tests/#end-to-end-checklist","title":"End-to-end checklist","text":"<p>Just like in the previous chapter, use this checklist to keep the pipeline aligned while you work:</p> <p>Keep the pipeline aligned (to avoid language/tooling drift):</p> <ul> <li>Syntax crate (<code>crates/incan_syntax/</code>): lexer \u2192 parser \u2192 AST \u2192 diagnostics</li> <li>Formatter (<code>src/format/</code>): prints AST back (idempotent; never emits invalid syntax)</li> <li>Semantic core (<code>crates/incan_core/</code>): canonical vocab / shared semantic helpers (avoid duplicating \u201cmeaning\u201d in multiple   layers)</li> <li>Compiler (<code>src/frontend/</code>, <code>src/backend/</code>):<ul> <li>typechecker validates and annotates</li> <li>lowering turns AST into IR</li> <li>emission generates correct Rust</li> </ul> </li> <li>Runtime/stdlib (<code>crates/incan_stdlib/</code>, <code>stdlib/</code>): behavior that can live outside the compiler should live here</li> </ul> <p>Rule of thumb: prefer pushing shared meaning \u201cdown\u201d into <code>incan_core</code>/<code>incan_syntax</code>/<code>incan_stdlib</code>, and keep the <code>incan</code> (root) crate focused on orchestration and pipeline wiring.</p>"},{"location":"contributing/tutorials/book/06_tooling_loop_formatter_and_tests/#formatter-incan-fmt","title":"Formatter (<code>incan fmt</code>)","text":"<p>The formatter is part of the toolchain and should remain aligned with the parser/AST:</p> <ul> <li>it should be idempotent (formatting twice yields the same output)</li> <li>it should never print invalid syntax</li> </ul> <p>See:</p> <ul> <li>Code formatting</li> </ul> <p>Where it lives:</p> <ul> <li><code>src/format/</code></li> </ul>"},{"location":"contributing/tutorials/book/06_tooling_loop_formatter_and_tests/#testing-rust-tests-integration-checks","title":"Testing (Rust tests + integration checks)","text":"<p>Depending on your change, you will usually run:</p> <ul> <li><code>make test</code> for the Rust unit/integration test suite (fast feedback)</li> <li><code>make pre-commit</code> before pushing (fmt + clippy + udeps + tests + release build)</li> <li><code>make smoke-test</code> when you want extra confidence (build + tests + examples + benchmarks-incan)</li> </ul> <p>See:</p> <ul> <li>Testing</li> </ul>"},{"location":"contributing/tutorials/book/06_tooling_loop_formatter_and_tests/#a-practical-workflow","title":"A practical workflow","text":"<p>When you add a feature:</p> <ol> <li>add/adjust a small Rust regression test (parse/typecheck/codegen)</li> <li>run <code>make test</code></li> <li>run <code>make pre-commit</code> before opening the PR</li> <li>run <code>make smoke-test</code> if the change touches the pipeline end-to-end (parser/typechecker/codegen/tooling)</li> </ol>"},{"location":"contributing/tutorials/book/06_tooling_loop_formatter_and_tests/#next","title":"Next","text":"<p>Next chapter: 07. Tooling loop: LSP.</p>"},{"location":"contributing/tutorials/book/07_tooling_loop_lsp/","title":"7. Tooling loop: LSP","text":"<p>The language server is the \u201calways-on\u201d feedback loop for contributors and users. If the compiler changes, the LSP must not drift.</p>"},{"location":"contributing/tutorials/book/07_tooling_loop_lsp/#what-the-lsp-should-do","title":"What the LSP should do","text":"<p>At minimum, the LSP should:</p> <ul> <li>parse current files</li> <li>report syntax and type errors</li> <li>provide basic navigation (hover/definition/completion)</li> </ul>"},{"location":"contributing/tutorials/book/07_tooling_loop_lsp/#how-it-works-high-level","title":"How it works (high level)","text":"<p>The LSP reuses Incan\u2019s compiler frontend stages to produce diagnostics from edits.</p> <p>See:</p> <ul> <li>LSP</li> <li>LSP architecture</li> <li>LSP protocol support</li> </ul>"},{"location":"contributing/tutorials/book/07_tooling_loop_lsp/#a-contributor-checklist","title":"A contributor checklist","text":"<p>After you change syntax or typing rules:</p> <ul> <li>ensure the LSP can still parse and typecheck files using the new feature</li> <li>add a small regression test if a prior bug involved \u201cCLI works, LSP breaks\u201d</li> </ul>"},{"location":"contributing/tutorials/book/07_tooling_loop_lsp/#next","title":"Next","text":"<p>Next chapter: 08. Docsite contributor loop.</p>"},{"location":"contributing/tutorials/book/08_docsite_contributor_loop/","title":"8. Docsite contributor loop","text":"<p>Incan\u2019s docs are a product surface. Contributors should be able to run the docsite locally and validate changes before committing.</p>"},{"location":"contributing/tutorials/book/08_docsite_contributor_loop/#run-the-site-locally","title":"Run the site locally","text":"<p>From the repo root:</p> <pre><code>make docs\n</code></pre> <p>This should build and serve the site so you can click through it locally.</p>"},{"location":"contributing/tutorials/book/08_docsite_contributor_loop/#how-the-docs-are-structured","title":"How the docs are structured","text":"<p>We organize docs using the Divio model:</p> <ul> <li>tutorials (learn)</li> <li>how-to guides (do)</li> <li>reference (look up)</li> <li>explanation (understand)</li> </ul> <p>When adding or moving content, prefer improving clarity and findability over creating new one-off pages.</p>"},{"location":"contributing/tutorials/book/08_docsite_contributor_loop/#reuse-patterns-snippets","title":"Reuse patterns (snippets)","text":"<p>We reuse common content via snippets in <code>workspaces/docs-site/docs/_snippets/</code>:</p> <ul> <li>commands</li> <li>callouts</li> <li>diagrams</li> <li>tables</li> </ul>"},{"location":"contributing/tutorials/book/08_docsite_contributor_loop/#mermaid-diagrams","title":"Mermaid diagrams","text":"<p>Mermaid diagrams are stored as DSL-only <code>.mmd</code> files and included via snippets. Keep diagrams as DSL-only content, and wrap them in a Mermaid fence where included.</p>"},{"location":"contributing/tutorials/book/08_docsite_contributor_loop/#contributor-checklist-for-doc-changes","title":"Contributor checklist for doc changes","text":"<p>Before opening a PR:</p> <ul> <li>ensure <code>make docs</code> works locally</li> <li>run a strict build: <code>make docs-build</code></li> <li>keep snippets reusable and scoped (don\u2019t copy/paste long command sequences everywhere)</li> </ul>"},{"location":"language/","title":"Language: Start here","text":"<p>This section is about writing <code>.incn</code> programs: syntax, semantics, patterns, and mental models.</p> <p>If you\u2019re not sure where you fit, start at Start here.</p>"},{"location":"language/#deciding-if-incan-fits","title":"Deciding if Incan fits","text":"<ul> <li>Why Incan?</li> <li>How Incan works</li> </ul>"},{"location":"language/#tutorials-learn","title":"Tutorials (learn)","text":"<ul> <li>The Incan Book (Basics): Book index</li> <li>Web framework tutorial: Web Framework (advanced; reads like tutorial + how-to)</li> </ul>"},{"location":"language/#how-to-guides-do","title":"How-to guides (do)","text":"<ul> <li>Async Programming</li> <li>Error Messages</li> <li>File I/O</li> <li>Performance</li> <li>Rust Interop</li> </ul>"},{"location":"language/#reference-look-up","title":"Reference (look up)","text":"<ul> <li>Generated language reference: Language reference (generated)</li> <li>Formatting / style (canonical <code>incan fmt</code> guide): Code formatting</li> <li>Numeric semantics: Numeric Semantics</li> <li>Strings: Strings</li> <li>Derives reference cluster:</li> </ul> Guide Derives String Representation <code>Debug</code>, <code>Display</code> Comparison <code>Eq</code>, <code>Ord</code>, <code>Hash</code> Copying &amp; Default <code>Clone</code>, <code>Copy</code>, <code>Default</code> Serialization <code>Serialize</code>, <code>Deserialize</code> Custom Behavior Overriding derived behavior"},{"location":"language/#explanation-understand","title":"Explanation (understand)","text":"<ul> <li>Control flow</li> <li>Closures</li> <li>Consts</li> <li>Derives &amp; Traits</li> <li>Enums</li> <li>Error Handling</li> <li>Imports &amp; Modules</li> <li>Models &amp; Classes</li> <li>Scopes &amp; Name Resolution</li> </ul>"},{"location":"language/#see-also","title":"See also","text":"<ul> <li>Tooling: Tooling start here</li> <li>RFCs (design records): RFC index</li> </ul>"},{"location":"language/explanation/closures/","title":"Closures (Arrow Functions)","text":"<p>Incan supports anonymous functions using arrow syntax, inspired by Rust and JavaScript (rather than Python).</p>"},{"location":"language/explanation/closures/#incan-arrow-syntax","title":"Incan Arrow Syntax","text":"<pre><code># No parameters (parentheses required)\nget_value = () =&gt; 42\n\n# Single parameter (parentheses required)\ndouble = (x) =&gt; x * 2\n\n# Multiple parameters  \nadd = (x, y) =&gt; x + y\n\n# With expressions\nis_positive = (n) =&gt; n &gt; 0\n</code></pre>"},{"location":"language/explanation/closures/#when-to-use-closures","title":"When to Use Closures","text":"<p>Closures are ideal for:</p> <ul> <li>Short inline functions passed to higher-order functions</li> <li>Callbacks  </li> <li>Simple transformations in comprehensions or map/filter operations</li> </ul> <pre><code># Good use of closure\nnumbers = [1, 2, 3, 4, 5]\ndoubled = numbers.map((x) =&gt; x * 2)\n</code></pre> <p>For complex logic with multiple statements, prefer named functions:</p> <pre><code># Better as a named function\ndef process_user(user: User) -&gt; Result[str, str]:\n    if not user.is_active:\n        return Err(\"User inactive\")\n    # ... more logic\n    return Ok(user.name)\n</code></pre>"},{"location":"language/explanation/closures/#type-inference","title":"Type Inference","text":"<p>Closure parameters use type inference \u2014 the compiler determines types from context:</p> <pre><code># Types inferred from usage\nadd = (x, y) =&gt; x + y\nresult = add(3, 4)  # x and y inferred as int\n</code></pre> <p>For explicit typing, use a named function instead.</p> <p>Why Not Python's <code>lambda</code>?</p> <p>Python's lambda syntax has limitations:</p> <pre><code># Python lambda - single expression only, awkward syntax\nadd = lambda x, y: x + y\nsquare = lambda x: x ** 2\n</code></pre> <p>We deliberately chose not to include Python-style <code>lambda</code> in Incan for several reasons:</p> <ol> <li>Readability \u2014 <code>lambda x, y: x + y</code> is less clear than <code>(x, y) =&gt; x + y</code></li> <li>Consistency with Rust \u2014 Incan compiles to Rust, which uses <code>|x, y| expr</code> closures</li> <li>Modern syntax \u2014 Arrow functions are familiar from JavaScript, TypeScript, and Rust</li> <li>Visual distinction \u2014 The <code>=&gt;</code> arrow clearly separates parameters from body</li> </ol> <p>Comparison</p> Python Incan Rust (generated) <code>lambda: 42</code> <code>() =&gt; 42</code> <code>\\|\\| 42</code> <code>lambda x: x * 2</code> <code>(x) =&gt; x * 2</code> <code>\\|x\\| x * 2</code> <code>lambda x, y: x + y</code> <code>(x, y) =&gt; x + y</code> <code>\\|x, y\\| x + y</code> <p>Key Differences from Python</p> <ol> <li>Parentheses always required \u2014 Even single parameters: <code>(x) =&gt; x + 1</code>, not <code>x =&gt; x + 1</code></li> <li>Arrow syntax \u2014 Uses <code>=&gt;</code> instead of <code>:</code></li> <li>No <code>lambda</code> keyword \u2014 The parentheses and arrow are sufficient</li> </ol>"},{"location":"language/explanation/consts/","title":"Const bindings","text":"<p><code>const</code> declares a compile-time constant: a name whose value is validated during compilation and can be baked into the output program.</p>"},{"location":"language/explanation/consts/#why-is-const-a-thing","title":"Why is <code>const</code> a thing?","text":"<p>In Incan, <code>const</code> exists to make intent explicit and to unlock compiler guarantees:</p> <ul> <li>Intent: communicates \u201cthis never changes\u201d to readers and tools.</li> <li>Safety: prevents accidental mutation/reassignment and enforces deep immutability for baked data.</li> <li>Performance: allows the compiler to bake data into the output (including <code>'static</code> backing data when needed).</li> <li>Reproducibility: keeps \u201cconfiguration tables\u201d and other fixed data out of runtime control flow.</li> </ul> <p>Coming from Python?</p> <p>In Python, \u201cconstants\u201d are mostly a convention (e.g. <code>MAX_RETRIES = 5</code>) and can still be reassigned at runtime. In Incan, <code>const</code> is a language feature with compile-time validation and immutability guarantees.</p>"},{"location":"language/explanation/consts/#how-do-i-use-it","title":"How do I use it?","text":"<ul> <li>Syntax: <code>const NAME [: Type] = &lt;expr&gt;</code></li> <li>Scope: <code>const</code> is currently module-level only (see RFC 008)</li> <li>Type annotations: optional; if omitted, the compiler must be able to infer the type</li> <li>Initializer rules: the initializer must be const-evaluable (no runtime calls)</li> </ul> <p>Rule of thumb</p> <p>If you can\u2019t evaluate the initializer without running the program (IO, time, function calls, loops), it doesn\u2019t belong in a <code>const</code>.</p>"},{"location":"language/explanation/consts/#how-is-const-different-from-a-regular-variable","title":"How is <code>const</code> different from a regular variable?","text":"<ul> <li><code>const</code>:<ul> <li>evaluated at compile time</li> <li>cannot depend on runtime values or non-const variables</li> <li>deeply immutable (no mutating APIs for baked strings/bytes/collections)</li> </ul> </li> <li>regular variables (<code>let</code> / bindings):<ul> <li>computed at runtime</li> <li>can call functions, use loops, read inputs, etc.</li> <li>may be mutable (<code>mut</code>) depending on the binding</li> </ul> </li> </ul> <p>Coming from TS/JS?</p> <p>In TypeScript/JavaScript, <code>const</code> mostly means \u201cthis binding can\u2019t be reassigned\u201d (the value can still be mutable), and it can be computed at runtime.</p> <p>In Incan, <code>const</code> means \u201ccompile-time constant\u201d: the initializer must be const-evaluable, and the result is exposed as a read-only (frozen) value.</p>"},{"location":"language/explanation/consts/#what-can-a-const-initializer-do","title":"What can a <code>const</code> initializer do?","text":"<p>Allowed:</p> <ul> <li>literals: <code>int</code>, <code>float</code>, <code>bool</code>, <code>str</code>, <code>bytes</code></li> <li>simple unary/binary ops on const literals: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, comparisons, boolean ops, string concatenation</li> <li>tuple/list/dict/set literals whose elements/keys/values are themselves const-evaluable</li> <li>references to other <code>const</code> bindings</li> </ul> <p>Disallowed:</p> <ul> <li>function/method calls (including builtins)</li> <li>comprehensions, ranges, f-strings</li> <li>accessing non-const variables or runtime state</li> </ul> <p>If the initializer is not const-evaluable, the compiler emits an error at the binding site.</p>"},{"location":"language/explanation/consts/#why-are-there-rust-native-vs-frozen-consts","title":"Why are there \u201cRust-native\u201d vs \u201cFrozen\u201d consts?","text":"<p>Incan supports two const \u201cfamilies\u201d because Rust\u2019s <code>const</code> rules are strict and because Incan wants deep immutability for baked data:</p> <ul> <li>Rust-native consts:<ul> <li>map directly to a Rust <code>const</code></li> <li>best for numbers, booleans, and tuples of those</li> </ul> </li> <li>Frozen consts:<ul> <li>for data that should be baked into the program but exposed through a read-only API</li> <li>includes strings/bytes and common containers (lists/dicts/sets)</li> <li>represented using frozen stdlib wrappers like <code>FrozenStr</code>, <code>FrozenBytes</code>, <code>FrozenList[T]</code>, <code>FrozenDict[K, V]</code>,   <code>FrozenSet[T]</code></li> <li>the compiler emits baked <code>'static</code> backing data and constructs frozen wrappers from it</li> </ul> </li> </ul> <p>Important detail: in <code>const</code> context, Incan treats <code>str</code>/<code>bytes</code> and common containers as frozen to preserve deep immutability. In other words, <code>const</code> is not \u201cjust a <code>let</code> that runs earlier\u201d.</p> <p>Coming from Rust?</p> <p>This is similar to Rust\u2019s split between \u201cthings that can be <code>const</code>\u201d and \u201cthings that need <code>'static</code> backing data and a safe API\u201d.</p>"},{"location":"language/explanation/consts/#examples","title":"Examples","text":""},{"location":"language/explanation/consts/#rust-native-consts","title":"Rust-native consts","text":"<pre><code>const MAX_RETRIES: int = 5\nconst TIMEOUT_SECS: float = 2.5\nconst IS_DEBUG: bool = False\nconst PORT = 8080  # type may be inferred\nconst GREETING = \"hello\" + \" world\"  # string concatenation is allowed\n</code></pre>"},{"location":"language/explanation/consts/#frozen-consts-deeply-immutable","title":"Frozen consts (deeply immutable)","text":"<pre><code>const GREETING: FrozenStr = \"hello\"\nconst NUMS: FrozenList[int] = [1, 2, 3]\nconst HEADERS: FrozenDict[FrozenStr, FrozenStr] = {\"User-Agent\": \"incan\"}\nconst DATA: FrozenBytes = b\"\\x00\\x01\"\n</code></pre>"},{"location":"language/explanation/consts/#consts-can-reference-other-consts","title":"Consts can reference other consts","text":"<pre><code>const BASE: int = 10\nconst LIMIT: int = BASE * 2\n</code></pre>"},{"location":"language/explanation/consts/#errors","title":"Errors","text":"<ul> <li>If the initializer is not const-evaluable (calls, comprehensions, ranges, f-strings, non-const variables).</li> <li>If a const dependency cycle exists (consts reference each other in a loop).</li> <li>If types do not match (explicit type annotation incompatible with the initializer).</li> </ul>"},{"location":"language/explanation/consts/#see-also","title":"See also","text":"<ul> <li>RFC 008: Const bindings</li> </ul>"},{"location":"language/explanation/control_flow/","title":"Control flow","text":"<p>This page explains branching and looping constructs in Incan.</p>"},{"location":"language/explanation/control_flow/#branching-with-if","title":"Branching with <code>if</code>","text":"<pre><code>def classify(n: int) -&gt; str:\n    if n &lt; 0:\n        return \"negative\"\n    elif n == 0:\n        return \"zero\"\n    else:\n        return \"positive\"\n</code></pre>"},{"location":"language/explanation/control_flow/#pattern-matching-with-match","title":"Pattern matching with <code>match</code>","text":"<p>Use <code>match</code> to branch on enum values like <code>Result</code> and <code>Option</code>.</p> <pre><code>def main() -&gt; None:\n    result = parse_port(\"8080\")\n\n    match result:\n        case Ok(port): println(f\"port={port}\")\n        case Err(e): println(f\"error: {e}\")\n</code></pre>"},{"location":"language/explanation/control_flow/#looping-with-for","title":"Looping with <code>for</code>","text":"<p>Incan supports Python-like <code>for</code> loops:</p> <pre><code>def main() -&gt; None:\n    items = [\"Alice\", \"Bob\", \"Cara\"]\n\n    for name in items:\n        println(name)\n</code></pre> <p>Break early when needed:</p> <pre><code>for name in items:\n    if name == \"Bob\":\n        break\n</code></pre>"},{"location":"language/explanation/control_flow/#see-also","title":"See also","text":"<ul> <li>Book chapter: 4. Control flow</li> <li>Enums and <code>match</code>: Enums</li> <li>Error-driven control flow (<code>Result</code>/<code>Option</code>): Error Handling</li> </ul>"},{"location":"language/explanation/derives_and_traits/","title":"Derives and traits (Explanation)","text":"<p>This page explains the mental model behind derives, dunder overrides, and traits in Incan. For the exact catalog of supported derives and signatures, see the Reference:</p> <ul> <li>Derives &amp; traits (Reference)</li> </ul>"},{"location":"language/explanation/derives_and_traits/#the-three-mechanisms-and-when-to-use-each","title":"The three mechanisms (and when to use each)","text":"<p>Incan uses three mechanisms to implement behavior:</p> <ul> <li><code>@derive(...)</code>: out-of-the-box behavior</li> <li>dunder methods: custom behavior</li> <li>traits: domain capabilities</li> </ul>"},{"location":"language/explanation/derives_and_traits/#derive-out-of-the-box-behavior","title":"Derive (out-of-the-box behavior)","text":"<p>Use <code>@derive(...)</code> when the default, structural behavior is what you want (for example: field-based equality).</p> <p>Incan derives are intentionally \u201cPython-first\u201d:</p> <ul> <li>You get common behaviors without writing boilerplate</li> <li>Behaviors are still explicit in your type definition</li> </ul> <p>Read more about <code>@derive(...)</code>: out-of-the-box behavior.</p>"},{"location":"language/explanation/derives_and_traits/#dunder-methods-custom-behavior","title":"Dunder methods (custom behavior)","text":"<p>Use dunder methods when you need custom semantics for a built-in capability:</p> <ul> <li><code>__str__</code>: custom string output</li> <li><code>__eq__</code>: custom equality</li> <li><code>__lt__</code>: custom ordering</li> <li><code>__hash__</code>: custom hashing</li> </ul> <p>Incan treats \u201cderive + corresponding dunder\u201d as a conflict. The idea is to avoid ambiguity and keep the mental model simple: \u201ceither it\u2019s the default behavior, or it\u2019s my behavior.\u201d</p> <p>Read more about dunder methods: custom behavior.</p>"},{"location":"language/explanation/derives_and_traits/#traits-domain-capabilities","title":"Traits (domain capabilities)","text":"<p>Use traits for reusable, domain-specific capabilities:</p> <ul> <li>You define a contract once</li> <li>Multiple types can opt into it via <code>with TraitName</code></li> <li>Traits can include default method bodies</li> </ul> <p>Traits are not \u201cthe derive system.\u201d Derives are a convenience for a small set of built-in capabilities; traits are a general language feature for authoring reusable behavior.</p> <p>Read more about traits: domain capabilities.</p>"},{"location":"language/explanation/derives_and_traits/#debug-vs-display-two-string-representations","title":"Debug vs Display: two string representations","text":"<p>Incan intentionally separates two kinds of \u201cstringification\u201d:</p> <ul> <li>Debug (<code>{:?}</code>): developer-facing, structured, and not user-overridable</li> <li>Display (<code>{}</code>): user-facing output; you can override via <code>__str__</code></li> </ul> <p>This mirrors the common \u201clogs vs user output\u201d split: Debug is stable and structural; Display is designed for human-friendly formatting.</p>"},{"location":"language/explanation/derives_and_traits/#compiler_expand-stdlib-marker","title":"<code>@compiler_expand</code> (stdlib marker)","text":"<p>You may see <code>@compiler_expand</code> used in stdlib sources. It is not a user feature.</p> <p>The intended meaning is:</p> <ul> <li>the stdlib contains stubs that declare vocabulary and signatures</li> <li>the compiler is responsible for providing the actual implementation for those stubs</li> </ul> <p>This lets the stdlib function as documentation and a vocabulary registry, without requiring users to learn a special compiler-only mechanism.</p> <p>See also:</p> <ul> <li>How derives work</li> </ul>"},{"location":"language/explanation/derives_and_traits/#field-defaults-and-construction-pydantic-like-ergonomics","title":"Field defaults and construction (pydantic-like ergonomics)","text":"<p>Field defaults (<code>field: T = expr</code>) are part of Incan\u2019s \u201cpydantic-like\u201d ergonomics:</p> <ul> <li>If you omit a field and it has a default, the default is used</li> <li>If a field has no default, you must provide it at construction time</li> </ul> <p>Separately, <code>@derive(Default)</code> provides <code>Type.default()</code> as a baseline constructor. It uses field defaults when present, and otherwise falls back to type defaults.</p>"},{"location":"language/explanation/derives_and_traits/#see-also","title":"See also","text":"<ul> <li>Models and classes</li> <li>How derives work</li> <li>Strings and formatting (Book)</li> <li>Traits and derives (Book)</li> </ul>"},{"location":"language/explanation/enums/","title":"Enums in Incan","text":"<p>Enums in Incan are algebraic data types (ADTs): a type with a closed set of variants, where each variant can carry different data.</p> <p>You use enums when a value can be one of a few well-defined shapes and you want the compiler to enforce that you handle every case.</p> Coming from Python? <p>Python\u2019s <code>Enum</code> is mainly \u201cnamed constants\u201d. When Python code needs variants with data it often ends up using class hierarchies and <code>isinstance(...)</code> checks, which are not exhaustive and are easy to break during refactors.</p> <p>Here\u2019s one representative before/after:</p> <p>Python (common workaround):</p> <pre><code>class Shape:\n    pass\n\nclass Circle(Shape):\n    def __init__(self, radius: float):\n        self.radius = radius\n\nclass Rectangle(Shape):\n    def __init__(self, width: float, height: float):\n        self.width = width\n        self.height = height\n\ndef area(shape: Shape) -&gt; float:\n    if isinstance(shape, Circle):\n        return 3.14159 * shape.radius * shape.radius\n    elif isinstance(shape, Rectangle):\n        return shape.width * shape.height\n    raise ValueError(\"unknown shape\")\n</code></pre> <p>Note: Python 3.10+ has <code>match</code>/<code>case</code>, but it still won\u2019t enforce exhaustiveness the way Incan does.</p> <p>Incan (enum + exhaustive <code>match</code>):</p> <pre><code>enum Shape:\n    Circle(float)\n    Rectangle(float, float)\n\ndef area(shape: Shape) -&gt; float:\n    match shape:\n        Circle(r) =&gt; return 3.14159 * r * r\n        Rectangle(w, h) =&gt; return w * h\n</code></pre> <p>If you add a new variant later, the compiler will point you at the <code>match</code> sites that must be updated.</p> Coming from Rust? <p>This is the same concept as Rust\u2019s <code>enum</code> + exhaustive <code>match</code> (sum types with payload-carrying variants).</p> <p>Differences are mostly surface syntax: - Variants are declared in an indented block under <code>enum</code> (no braces/commas). - Construction uses Incan\u2019s syntax (e.g. <code>Status.Active</code> / <code>Message.Move(1, 2)</code>), rather than Rust\u2019s <code>Type::Variant(...)</code>.</p>"},{"location":"language/explanation/enums/#a-motivating-example","title":"A motivating example","text":"<pre><code>enum Shape:\n    Circle(float)          # radius\n    Rectangle(float, float)  # width, height\n    Triangle(float, float)   # base, height\n\ndef area(shape: Shape) -&gt; float:\n    match shape:\n        Circle(r) =&gt; return 3.14159 * r * r\n        Rectangle(w, h) =&gt; return w * h\n        Triangle(b, h) =&gt; return 0.5 * b * h\n</code></pre> <p>If you add a new variant later, the compiler will point you at the <code>match</code> sites that must be updated.</p>"},{"location":"language/explanation/enums/#basic-syntax","title":"Basic syntax","text":""},{"location":"language/explanation/enums/#simple-enum-no-data","title":"Simple Enum (No Data)","text":"<pre><code>enum Status:\n    Pending\n    Active\n    Completed\n    Cancelled\n</code></pre> <p>Usage:</p> <pre><code>status = Status.Active\n\nmatch status:\n    Pending =&gt; println(\"Waiting...\")\n    Active =&gt; println(\"In progress\")\n    Completed =&gt; println(\"Done!\")\n    Cancelled =&gt; println(\"Aborted\")\n</code></pre>"},{"location":"language/explanation/enums/#enum-with-data-variants","title":"Enum with Data (Variants)","text":"<p>Each variant can carry different types and amounts of data:</p> <pre><code>enum Message:\n    Quit                           # No data\n    Move(int, int)                 # Two ints (x, y)\n    Write(str)                     # A string\n    ChangeColor(int, int, int)     # RGB values\n</code></pre> <p>Usage:</p> <pre><code>msg = Message.Move(10, 20)\n\nmatch msg:\n    Quit =&gt; println(\"Goodbye\")\n    Move(x, y) =&gt; println(f\"Moving to ({x}, {y})\")\n    Write(text) =&gt; println(f\"Message: {text}\")\n    ChangeColor(r, g, b) =&gt; println(f\"RGB({r}, {g}, {b})\")\n</code></pre>"},{"location":"language/explanation/enums/#generic-enums","title":"Generic enums","text":"<p>Enums can be generic \u2014 parameterized over types:</p> <pre><code>enum Option[T]:\n    Some(T)\n    None\n\nenum Result[T, E]:\n    Ok(T)\n    Err(E)\n</code></pre> <p>Note: These are Incan's built-in types for handling optional values and errors.</p>"},{"location":"language/explanation/enums/#custom-generic-enum","title":"Custom Generic Enum","text":"<pre><code>enum Tree[T]:\n    Leaf(T)\n    Node(Tree[T], Tree[T])\n\n# A binary tree of integers\ntree = Node(\n    Leaf(1),\n    Node(Leaf(2), Leaf(3))\n)\n</code></pre>"},{"location":"language/explanation/enums/#pattern-matching","title":"Pattern matching","text":"<p>The <code>match</code> expression is how you work with enums. It's exhaustive \u2014 the compiler ensures you handle all variants.</p>"},{"location":"language/explanation/enums/#basic-match","title":"Basic Match","text":"<pre><code>enum Direction:\n    North\n    South\n    East\n    West\n\ndef describe(dir: Direction) -&gt; str:\n    match dir:\n        North =&gt; return \"Going up\"\n        South =&gt; return \"Going down\"\n        East =&gt; return \"Going right\"\n        West =&gt; return \"Going left\"\n</code></pre>"},{"location":"language/explanation/enums/#extracting-data","title":"Extracting Data","text":"<pre><code>enum ApiResponse:\n    Success(str, int)        # (data, status_code)\n    Error(str)               # error message\n    Loading\n\ndef handle(response: ApiResponse) -&gt; None:\n    match response:\n        Success(data, code) =&gt;\n            println(f\"Got {code}: {data}\")\n        Error(msg) =&gt;\n            println(f\"Failed: {msg}\")\n        Loading =&gt;\n            println(\"Please wait...\")\n</code></pre>"},{"location":"language/explanation/enums/#wildcard-pattern","title":"Wildcard Pattern","text":"<p>Use <code>_</code> to match any remaining variants:</p> <pre><code>match status:\n    Active =&gt; println(\"Working on it\")\n    _ =&gt; println(\"Not active\")  # Matches Pending, Completed, Cancelled\n</code></pre> <p>Warning: Wildcards can hide bugs when you add new variants. Prefer explicit matches.</p>"},{"location":"language/explanation/enums/#guards","title":"Guards","text":"<p>Add conditions to patterns:</p> <pre><code>enum Temperature:\n    Celsius(float)\n    Fahrenheit(float)\n\ndef describe(temp: Temperature) -&gt; str:\n    match temp:\n        Celsius(c) if c &gt; 30 =&gt; return \"Hot (Celsius)\"\n        Celsius(c) if c &lt; 10 =&gt; return \"Cold (Celsius)\"\n        Celsius(_) =&gt; return \"Moderate (Celsius)\"\n        Fahrenheit(f) if f &gt; 86 =&gt; return \"Hot (Fahrenheit)\"\n        Fahrenheit(f) if f &lt; 50 =&gt; return \"Cold (Fahrenheit)\"\n        Fahrenheit(_) =&gt; return \"Moderate (Fahrenheit)\"\n</code></pre>"},{"location":"language/explanation/enums/#common-patterns","title":"Common patterns","text":"<p>For practical recipes (state machines, commands, error types, expression trees), see:</p> <ul> <li>Modeling with enums</li> </ul>"},{"location":"language/explanation/enums/#enums-vs-models-vs-classes","title":"Enums vs models vs classes","text":"Use Case Enum Model Class Fixed set of variants \u2713 Data that can be one of several shapes \u2713 Exhaustive handling required \u2713 Simple data container (DTO, config) \u2713 Serialization focus (<code>@derive</code>) \u2713 Validation and defaults \u2713 Inheritance/polymorphism needed \u2713 Mutable state with methods \u2713 Open extension (new types later) \u2713 <pre><code># Enum: closed set, exhaustive matching\nenum PaymentMethod:\n    CreditCard(str, str)     # number, expiry\n    PayPal(str)              # email\n    BankTransfer(str, str)   # account, routing\n\n# Model: data-first, serialization\n@derive(Serialize, Deserialize)\nmodel PaymentRequest:\n    method: PaymentMethod\n    amount: float\n    currency: str = \"USD\"\n\n# Class: behavior-first, inheritance\nclass PaymentProcessor:\n    def process(self, amount: float) -&gt; Result[Receipt, Error]:\n        ...\n</code></pre> <p>See also: Models and Classes Guide</p>"},{"location":"language/explanation/enums/#built-in-enums","title":"Built-in enums","text":"<p>Incan provides these enums in the standard library:</p>"},{"location":"language/explanation/enums/#optiont","title":"Option[T]","text":"<p>Represents an optional value:</p> <pre><code>enum Option[T]:\n    Some(T)\n    None\n</code></pre> <p>See: Error Handling Guide</p>"},{"location":"language/explanation/enums/#resultt-e","title":"Result[T, E]","text":"<p>Represents success or failure:</p> <pre><code>enum Result[T, E]:\n    Ok(T)\n    Err(E)\n</code></pre> <p>See: Error Handling Guide</p>"},{"location":"language/explanation/enums/#ordering","title":"Ordering","text":"<p>Comparison result:</p> <pre><code>enum Ordering:\n    Less\n    Equal\n    Greater\n</code></pre>"},{"location":"language/explanation/enums/#summary","title":"Summary","text":"Concept Description <code>enum</code> Define a type with fixed variants Variants Each case of an enum, optionally with data Generic enum Enum parameterized over types: <code>Option[T]</code> <code>match</code> Exhaustive pattern matching on enums Destructuring Extract data from variants: <code>Some(x) =&gt;</code> <p>Enums are one of Incan's most powerful features \u2014 use them for:</p> <ul> <li>Modeling states and state machines</li> <li>Error types with rich context</li> <li>Command/message types</li> <li>Any \"one of these things\" scenario</li> </ul> <p>The compiler guarantees you handle all cases, eliminating a whole class of bugs caused by missing or forgotten cases.</p>"},{"location":"language/explanation/enums/#see-also","title":"See Also","text":"<ul> <li>Error Handling \u2014 Using <code>Result</code> and <code>Option</code></li> <li>Pattern Matching RFC \u2014 Match expression grammar</li> <li>Models and Classes \u2014 When to use class vs enum</li> </ul>"},{"location":"language/explanation/error_handling/","title":"Error handling","text":"<p>Incan treats errors as values: functions that can fail return a <code>Result[T, E]</code>, and callers handle success/error explicitly. This makes failure modes visible in APIs, encourages structured error types, and keeps control flow clear.</p>"},{"location":"language/explanation/error_handling/#quick-start","title":"Quick start","text":"<pre><code>def load_config(path: Path) -&gt; Result[Config, AppError]:\n    content = path.read_text().map_err(AppError.Io)?\n    config = parse_toml[Config](content).map_err(AppError.Parse)?\n    return Ok(config)\n</code></pre> <p>The key ideas:</p> <ul> <li>return <code>Result[T, E]</code> for operations that can fail</li> <li>use <code>?</code> to propagate failures</li> <li>use <code>match</code> when you want to handle success/error differently</li> </ul> Coming from Python? <p>Python uses exceptions, which can introduce hidden control flow (\u201canything can throw from anywhere\u201d). Python 3.10+ has <code>match</code>/<code>case</code>, but it still won\u2019t enforce exhaustiveness the way Incan does.</p> <p>A rough translation is:</p> <ul> <li>Python: exceptions propagate implicitly</li> <li>Incan: <code>?</code> propagates explicitly (and is visible in the return type)</li> </ul> <p>Python (implicit propagation):</p> <pre><code>def load_config(path: str) -&gt; Config:\n    content = read_file(path)     # may raise IOError\n    return parse_config(content)  # may raise ParseError\n</code></pre> <p>Incan (explicit propagation):</p> <pre><code>def load_config(path: Path) -&gt; Result[Config, AppError]:\n    content = path.read_text().map_err(AppError.Io)?\n    config = parse_toml[Config](content).map_err(AppError.Parse)?\n    return Ok(config)\n</code></pre> <p>Quick mapping:</p> Python Incan <code>try/except</code> wraps code <code>match</code> on Result Exceptions propagate implicitly <code>?</code> propagates explicitly <code>raise</code> throws exception <code>return Err(e)</code> Runtime error if unhandled Compile error if unhandled Python `try/except`<pre><code>try:\n    config = load_config(\"app.toml\")\nexcept (IOError, ValueError) as e:\n    log(e)\n    config = default_config()\n</code></pre> <p>vs.</p> Incan `match`<pre><code>match load_config(Path(\"app.toml\")):\n    Ok(config) =&gt; config\n    Err(e) =&gt;\n        log(e)\n        default_config()\n</code></pre> Coming from TS/JS? <p>In JS/TS, <code>try/catch</code> works, but failures are often effectively \u201cuntyped\u201d at the boundary (anything can be thrown, and caught values are frequently <code>unknown</code>).</p> <p>In Incan, fallibility is explicit in the return type, and you handle it with <code>Result</code> + <code>match</code> (or propagate it with <code>?</code>).</p> <p>JS/TS <code>try/catch</code> \u2192 Incan <code>Result</code>:</p> <pre><code>async function loadConfig(path: string): Promise&lt;Config&gt; {\n  try {\n    const content = await readFile(path); // may throw / reject\n    return parseConfig(content);          // may throw\n  } catch (e) {\n    return defaultConfig();\n  }\n}\n</code></pre> <pre><code>def load_config(path: Path) -&gt; Result[Config, AppError]:\n    content = path.read_text().map_err(AppError.Io)?\n    config = parse_toml[Config](content).map_err(AppError.Parse)?\n    return Ok(config)\n\ndef load_config_or_default(path: Path) -&gt; Config:\n    match load_config(path):\n        Ok(cfg) =&gt; return cfg\n        Err(_) =&gt; return default_config()\n</code></pre>"},{"location":"language/explanation/error_handling/#core-types","title":"Core types","text":""},{"location":"language/explanation/error_handling/#resultt-e","title":"<code>Result[T, E]</code>","text":"<p><code>Result</code> represents an operation that can succeed (<code>Ok(T)</code>) or fail (<code>Err(E)</code>).</p> <pre><code>def divide(a: int, b: int) -&gt; Result[int, str]:\n    if b == 0:\n        return Err(\"division by zero\")\n    return Ok(a / b)\n\ndef main() -&gt; None:\n    match divide(10, 2):\n        Ok(value) =&gt; println(f\"Result: {value}\")\n        Err(msg) =&gt; println(f\"Error: {msg}\")\n</code></pre>"},{"location":"language/explanation/error_handling/#optiont","title":"<code>Option[T]</code>","text":"<p><code>Option</code> (optional) represents a value that may or may not exist.</p> <pre><code>def find_user(id: int) -&gt; Option[User]:\n    if id in users:\n        return Some(users[id])\n    return None\n\ndef main() -&gt; None:\n    match find_user(42):\n        Some(user) =&gt; println(f\"Found: {user.name}\")\n        None =&gt; println(\"User not found\")\n</code></pre> <p>Coming from Python?</p> <p>In Python, <code>Optional[T]</code> is a type hint that indicates the value may be <code>None</code>. In Incan, <code>Option[T]</code> is an explicit enum that the compiler can reason about and enforce.</p>"},{"location":"language/explanation/error_handling/#the-operator-propagation","title":"The <code>?</code> operator (propagation)","text":"<p>The <code>?</code> operator provides concise error propagation: if the left-hand side is <code>Err(e)</code>, return early with that error; otherwise unwrap the <code>Ok(...)</code> value.</p> <pre><code>def process() -&gt; Result[Data, Error]:\n    data = fetch_data()?\n    valid = validate(data)?\n    return Ok(valid)\n</code></pre> <p>Rules of thumb:</p> <ul> <li><code>?</code> can only be used in a function that returns <code>Result[...]</code> (or another compatible \u201cfallible\u201d type, if/when added).</li> <li>use <code>match</code> instead of <code>?</code> when you want to recover, retry, or branch based on the error.</li> </ul>"},{"location":"language/explanation/error_handling/#a-common-compile-time-error","title":"A common compile-time error","text":"<p><code>?</code> is only allowed when the function can return an error.</p> <pre><code>def main() -&gt; None:\n    data = fetch_data()?  # error: can't use ? in a non-Result function\n</code></pre>"},{"location":"language/explanation/error_handling/#structured-error-types","title":"Structured error types","text":"<p>Prefer structured errors over strings so callers can pattern match on failure modes and carry context.</p> <pre><code>enum ProcessError:\n    NetworkFailure(str, int)     # (url, status)\n    ValidationFailed(str, str)   # (field, reason)\n    NotFound(str)                # resource\n\ndef process() -&gt; Result[Data, ProcessError]:\n    return Err(ProcessError.NotFound(\"user\"))\n</code></pre>"},{"location":"language/explanation/error_handling/#common-helpers","title":"Common helpers","text":""},{"location":"language/explanation/error_handling/#transform-errors-with-map_err","title":"Transform errors with <code>map_err</code>","text":"<p>Use this when you want to convert one error type into another at a boundary.</p> <pre><code>def load_config(path: Path) -&gt; Result[Config, AppError]:\n    content = path.read_text().map_err(AppError.Io)?\n    config = parse_toml[Config](content).map_err(AppError.Parse)?\n    return Ok(config)\n</code></pre>"},{"location":"language/explanation/error_handling/#provide-defaults-with-unwrap_or","title":"Provide defaults with <code>unwrap_or</code>","text":"<p>Use this for optional values where a default makes sense.</p> <pre><code>def get_setting(key: str) -&gt; str:\n    return settings.get(key).unwrap_or(\"default_value\")\n</code></pre>"},{"location":"language/explanation/error_handling/#convert-optiont-to-resultt-e-with-ok_or","title":"Convert <code>Option[T]</code> to <code>Result[T, E]</code> with <code>ok_or</code>","text":"<p>Use this when absence should become a recoverable error.</p> <pre><code>def require_user(id: int) -&gt; Result[User, str]:\n    return find_user(id).ok_or(\"user not found\")\n</code></pre>"},{"location":"language/explanation/error_handling/#unwrap-and-panic","title":"<code>unwrap()</code> and <code>panic()</code>","text":"<p><code>unwrap()</code> extracts a value from <code>Option</code>/<code>Result</code>, and panics if it is <code>None</code>/<code>Err(...)</code>.</p> <p>Panics are appropriate for programmer errors and \u201cshould never happen\u201d states, but not for expected failures (like user input or network calls).</p> <p>Prefer:</p> <ul> <li><code>match</code> for explicit handling</li> <li><code>unwrap_or(...)</code> / <code>unwrap_or_else(...)</code> when you have a reasonable fallback</li> <li>structured <code>Result</code> errors for recoverable failure</li> </ul>"},{"location":"language/explanation/error_handling/#see-also","title":"See also","text":"<ul> <li>Example: Error Handling</li> <li>Async programming</li> <li>Error handling recipes</li> <li>Error trait</li> <li>Modeling errors with enums</li> </ul>"},{"location":"language/explanation/how_derives_work/","title":"How derives work (Explanation)","text":"<p>This page explains what Incan \u201cderives\u201d mean at compile time, without requiring you to read compiler source.</p> <p>For the derive catalog and exact user-facing rules, see:</p> <ul> <li>Derives &amp; traits (Reference)</li> </ul>"},{"location":"language/explanation/how_derives_work/#the-intent","title":"The intent","text":"<p>Incan\u2019s derive system exists to give you out-of-the-box behavior (Debug, Display, Eq, Ord, Hash, Clone, Default, serde derives, etc.) without boilerplate.</p> <p>At a high level:</p> <ul> <li>you write <code>@derive(...)</code> on a <code>model</code>/<code>class</code>/<code>enum</code>/<code>newtype</code></li> <li>the compiler generates the corresponding implementations in generated Rust (or compiler-injected impls)</li> </ul>"},{"location":"language/explanation/how_derives_work/#where-the-derive-vocabulary-lives","title":"Where the \u201cderive vocabulary\u201d lives","text":"<p>Incan\u2019s stdlib contains trait definitions that act as documentation vocabulary for derive names and dunder hooks.</p> <p>You may see <code>@compiler_expand</code> in stdlib sources:</p> <ul> <li>it is not a user feature</li> <li>it marks \u201ccompiler-provided implementation\u201d stubs in the stdlib</li> </ul> <p>The compiler is responsible for providing the implementation; the stdlib is the stable vocabulary and signature registry.</p>"},{"location":"language/explanation/how_derives_work/#derives-vs-dunders","title":"Derives vs dunders","text":"<p>Incan separates two cases:</p> <ul> <li>Derives: default, structural behavior (field-based)</li> <li>Dunder hooks: custom behavior (<code>__str__</code>, <code>__eq__</code>, <code>__lt__</code>, <code>__hash__</code>)</li> </ul> <p>If you try to do both for the same capability, that\u2019s a conflict and should be treated as an error: the compiler must not have to guess which implementation \u201cwins\u201d.</p> <p>Example conflicts:</p> <pre><code>@derive(Eq)\nmodel User:\n    id: int\n\n    def __eq__(self, other: User) -&gt; bool:\n        return self.id == other.id\n</code></pre> <p>The authoritative rule set (including the full conflict list) lives in:</p> <ul> <li>Derives &amp; traits (Reference)</li> </ul>"},{"location":"language/explanation/how_derives_work/#non-goals-deliberate-omissions","title":"Non-goals (deliberate omissions)","text":"<p>Some Python/Rust features are intentionally not part of Incan\u2019s trait/derive surface area:</p> <ul> <li>Context managers (<code>__enter__</code> / <code>__exit__</code>): prefer scope-based cleanup RAII (Resource Acquisition Is  Initialization)   style</li> <li>Destructors (<code>__del__</code> / <code>Drop</code> as a user feature): cleanup is automatic; exposing destruction hooks adds complexity</li> <li><code>__format__</code>: <code>Display</code> (<code>__str__</code>) + f-strings cover most needs</li> </ul>"},{"location":"language/explanation/how_derives_work/#resource-management-without-context-managers","title":"Resource management without context managers","text":"<p>Incan\u2019s default approach is: allocate the resource, use it, and let scope end handle cleanup.</p> <pre><code>def process_file() -&gt; Result[str, str]:\n    file = File.open(\"data.txt\")?\n    content = file.read_all()?\n    return Ok(content)\n</code></pre>"},{"location":"language/explanation/how_incan_works/","title":"How Incan works","text":"<p>This page is a user-level mental model of what happens when you run Incan.</p>"},{"location":"language/explanation/how_incan_works/#the-short-version","title":"The short version","text":"<p>Incan compiles <code>.incn</code> source code to Rust, then builds an executable.</p>"},{"location":"language/explanation/how_incan_works/#pipeline-conceptual","title":"Pipeline (conceptual)","text":"<pre><code>flowchart TD\n    incanSource[Incan_source_.incn] --&gt; parser[Parse_and_validate]\n    parser --&gt; typecheck[Typecheck_and_resolve]\n    typecheck --&gt; lower[Lower_to_Rust]\n    lower --&gt; cargo[Cargo_build]\n    cargo --&gt; binary[Executable]</code></pre>"},{"location":"language/explanation/how_incan_works/#what-this-means-in-practice","title":"What this means in practice","text":"<ul> <li>Incan programs are compiled (not interpreted).</li> <li>The \u201chappy path\u201d is: edit code \u2192 run <code>incan</code> \u2192 get an executable or an error.</li> <li>When things fail, you typically care about which stage failed (parse, typecheck, codegen, build).</li> </ul>"},{"location":"language/explanation/how_incan_works/#where-to-go-next","title":"Where to go next","text":"<ul> <li>Build/run commands: Install, build, and run</li> <li>CLI surface: CLI reference</li> <li>Deeper internals (contributors): Compiler architecture</li> </ul>"},{"location":"language/explanation/imports_and_modules/","title":"Imports and modules","text":"<p>This page explains the mental model behind Incan modules and imports.</p> <p>For details and tasks, use the split pages:</p> <ul> <li>How-to: Imports and modules (how-to)</li> <li>Reference: Imports and modules (reference)</li> </ul>"},{"location":"language/explanation/imports_and_modules/#key-ideas","title":"Key ideas","text":"<ul> <li>Incan supports two import styles (Python-style and Rust-style) that can be mixed freely.</li> <li>Modules are discovered from the filesystem \u2014 there is no explicit <code>mod</code> declaration step.</li> <li>Directories can act as modules; use <code>mod.incn</code> as the \u201cmain file\u201d for a directory module when needed.</li> <li>Common types and functions are available without imports via the prelude (see the reference page for the full list).</li> </ul> <p>Coming from Python?</p> <p>In Python, packages are driven by directory structure and <code>__init__.py</code>. In Incan, directories are recognized automatically; you can use <code>mod.incn</code> when you need a directory/module entrypoint.</p>"},{"location":"language/explanation/imports_and_modules/#how-module-discovery-works-conceptual","title":"How module discovery works (conceptual)","text":"<p>When you import a local module, the compiler:</p> <ol> <li>Resolves the path (handling <code>.</code>, <code>..</code>, <code>super</code>, <code>crate</code>)</li> <li>Finds the <code>.incn</code> file (or <code>mod.incn</code> for directories)</li> <li>Parses and type-checks that file</li> <li>Makes its types and functions available in the importing file</li> </ol>"},{"location":"language/explanation/imports_and_modules/#coming-from-rust","title":"Coming from Rust","text":"<p>In Rust, you typically need explicit module declarations before importing. In Incan, you generally \u201cjust import\u201d and the compiler discovers modules automatically.</p>"},{"location":"language/explanation/imports_and_modules/#coming-from-python","title":"Coming from Python","text":"<p>In Python, packages are driven by directory structure and <code>__init__.py</code>. In Incan, directories are recognized as modules without <code>__init__.py</code>; use <code>mod.incn</code> when you need a directory entrypoint.</p>"},{"location":"language/explanation/imports_and_modules/#where-to-go-next","title":"Where to go next","text":"<ul> <li>Practical multi-file project layouts: Imports and modules (how-to)</li> <li>Full import syntax, path rules, prelude contents: Imports and modules (reference)</li> </ul>"},{"location":"language/explanation/models_and_classes/","title":"Models and Classes in Incan","text":"<p>Incan provides two ways to define types with fields: <code>model</code> and <code>class</code>. Understanding when to use each is key to writing idiomatic Incan code.</p>"},{"location":"language/explanation/models_and_classes/#quick-comparison","title":"Quick Comparison","text":"Aspect <code>model</code> <code>class</code> Purpose Data containers Objects with behavior Focus Fields first Methods first Inheritance No (cannot inherit) Yes (single inheritance) Traits Yes (behavior via traits) Yes (behavior via traits) Use when \u201cThis is data\u201d \u201cThis is an object/service\u201d"},{"location":"language/explanation/models_and_classes/#when-to-use-which","title":"When to Use Which","text":"Use Case Choose Why Config, settings <code>model</code> Pure data, no behavior needed DTO, API payload <code>model</code> Data transfer, serialization focus Database record <code>model</code> Represents stored data Service with methods <code>class</code> Has operations/behavior Stateful controller <code>class</code> Methods that modify state Needs inheritance <code>class</code> Only <code>class</code> supports <code>extends</code> <p>Coming from Python or Rust?</p> <p>A rough mapping (just to orient yourself):</p> <p>Python -&gt; Incan</p> <ul> <li>Python <code>@dataclass</code> / \u201cplain data\u201d / \"pydantic BaseModel\" -&gt; <code>model</code></li> <li>Python \u201cclass with behavior\u201d -&gt; <code>class</code></li> </ul> <p>Rust -&gt; Incan Both <code>model</code> and <code>class</code> compile to Rust <code>struct</code>s + <code>impl</code>s. The difference is semantic:</p> <ul> <li><code>class</code> can add inheritance (<code>extends</code>) and trait composition (<code>with ...</code>)</li> <li>the compiler resolves this at compile time by generating fields/methods/trait impls</li> </ul> <p>In practice, this is still \u201czero-cost\u201d: choose <code>model</code> vs <code>class</code> for clarity and API design, not for performance.</p> <p>Why no <code>struct</code> keyword? If you're coming from Rust, you might wonder: \"Where's <code>struct</code>?\" Incan uses <code>model</code> instead because:</p> <ol> <li>Python familiarity \u2014 Python developers know <code>class</code>, not <code>struct</code></li> <li>Clearer semantics \u2014 <code>model</code> says \"this is data\", not \"this is a memory layout\"</li> <li>Tooling conventions \u2014 ORMs, validators, serializers all use \"model\" terminology</li> </ol> <p>Under the hood, both <code>model</code> and <code>class</code> compile to Rust <code>struct</code>s.</p>"},{"location":"language/explanation/models_and_classes/#visibility-pub","title":"Visibility (<code>pub</code>)","text":"<p>Control whether declarations are importable from other modules.</p> <ul> <li>Items are private by default (just like in Rust).</li> <li>Prefix a declaration with <code>pub</code> (publicly visible) to make it importable from other modules.</li> <li>For <code>model</code> and <code>class</code>, <code>pub</code> also makes fields public by default.</li> </ul> <pre><code>model User:           # private by default\n    name: str\n\npub model PublicUser: # public model, fields are now public by default\n    name: str\n\nclass Service:        # private by default\n    repo: Repo\n    def work(self) -&gt; None:\n        ...\n</code></pre> <p>Coming from Python?</p> <p>In Python, attribute visibility is a convention. In Incan, item visibility is part of the language surface: items are private by default unless you mark them <code>pub</code>. You have to specifically opt-in to make items public.</p>"},{"location":"language/explanation/models_and_classes/#model-data-first","title":"Model: Data-First","text":"<p>Models are for data containers \u2014 types where the fields are the primary concern.</p> <pre><code># Simple data model\nmodel Point:\n    x: int\n    y: int\n\n# With derives for common behaviors\n@derive(Eq, Hash, Serialize)\nmodel User:\n    id: int\n    name: str\n    email: str\n\n# With default values\nmodel Config:\n    host: str = \"localhost\"\n    port: int = 8080\n    debug: bool = false\n</code></pre> <p>Coming from Python?</p> <p>An Incan <code>model</code> can be compared to a Python <code>dataclass</code> or Pydantic <code>BaseModel</code> in spirit.  </p>"},{"location":"language/explanation/models_and_classes/#what-models-get-automatically","title":"What Models Get Automatically","text":"<p>By default, models (and classes) get <code>Debug</code> and <code>Clone</code>. Use <code>@derive(...)</code> to add additional behavior.</p> <pre><code># Debug + Clone are implicit:\nmodel User:\n    name: str\n\n# You only need @derive(...) when you want extra traits:\n@derive(Eq, Hash, Serialize)\nmodel User:\n    name: str\n</code></pre>"},{"location":"language/explanation/models_and_classes/#models-cannot-inherit","title":"Models Cannot Inherit","text":"<p>Models intentionally do not support inheritance. Incan keeps <code>model</code> as a data-first construct: </p> <ul> <li>inheritance makes the data shape implicit (fields come from \u201csomewhere else\u201d), </li> <li>complicates defaults/constructors and derives/serialization, and</li> <li>introduces override-style complexity that belongs in <code>class</code>.</li> </ul> <p>Prefer composition to keep the structure explicit and tooling predictable.</p> <pre><code>model Base:\n    id: int\n\n# \u274c Inheritance is NOT allowed\nmodel Child extends Base:  # Error!\n    name: str\n\nmodel Child:\n    base: Base  # \u2705 Use composition instead\n    name: str\n</code></pre>"},{"location":"language/explanation/models_and_classes/#class-behavior-first","title":"Class: Behavior-First","text":"<p>Classes are for objects with behavior \u2014 types where methods are the primary concern.</p> <pre><code>trait Loggable:\n    def log(self, msg: str) -&gt; None: ...\n\nclass UserService with Loggable:\n    repo: UserRepository\n    logger_name: str\n\n    def log(self, msg: str) -&gt; None:\n        println(f\"[{self.logger_name}] {msg}\")\n\n    def create_user(self, name: str, email: str) -&gt; Result[User, ServiceError]:\n        self.log(f\"Creating user: {name}\")\n        user = User(id=next_id(), name=name, email=email)\n        return self.repo.save(user)\n\n    def find_user(self, id: int) -&gt; Option[User]:\n        return self.repo.find_by_id(id)\n</code></pre>"},{"location":"language/explanation/models_and_classes/#classes-support-inheritance","title":"Classes Support Inheritance","text":"<pre><code>class Animal:\n    name: str\n\n    def speak(self) -&gt; str:\n        return \"...\"\n\nclass Dog extends Animal:\n    breed: str\n\n    def speak(self) -&gt; str:\n        return \"Woof!\"\n\nclass Cat extends Animal:\n    indoor: bool\n\n    def speak(self) -&gt; str:\n        return \"Meow!\"\n</code></pre>"},{"location":"language/explanation/models_and_classes/#mutable-methods","title":"Mutable Methods","text":"<p>Use <code>mut self</code> when a method modifies the object:</p> <pre><code>class Counter:\n    value: int\n\n    def get(self) -&gt; int:\n        return self.value\n\n    def increment(mut self) -&gt; None:\n        self.value = self.value + 1\n\n    def add(mut self, n: int) -&gt; None:\n        self.value = self.value + n\n</code></pre>"},{"location":"language/explanation/models_and_classes/#both-can-implement-traits","title":"Both Can Implement Traits","text":"<pre><code>trait Describable:\n    def describe(self) -&gt; str: ...\n\n# Model implementing a trait\nmodel Product with Describable:\n    name: str\n    price: float\n\n    def describe(self) -&gt; str:\n        return f\"{self.name}: ${self.price}\"\n\n# Class implementing a trait\nclass Employee with Describable:\n    name: str\n    title: str\n\n    def describe(self) -&gt; str:\n        return f\"{self.name}, {self.title}\"\n</code></pre>"},{"location":"language/explanation/models_and_classes/#design-philosophy","title":"Design Philosophy","text":"<p>Incan's type system follows the principle: Python's vocabulary, Rust's guarantees.</p> <pre><code>flowchart LR\n  subgraph Python\n    py_dataclass[\"@dataclass\"]\n    py_class[\"class\"]\n    py_protocol[\"ABC / Protocol\"]\n  end\n\n  subgraph Incan\n    in_model[\"model\"]\n    in_class[\"class\"]\n    in_trait[\"trait\"]\n  end\n\n  subgraph Rust\n    rs_struct[\"struct\"]\n    rs_struct_impl[\"struct + impl\"]\n    rs_trait[\"trait\"]\n  end\n\n  py_dataclass --&gt; in_model --&gt; rs_struct\n  py_class --&gt; in_class --&gt; rs_struct_impl\n  py_protocol --&gt; in_trait --&gt; rs_trait</code></pre> <p>You think in Python terms, but get Rust's:</p> <ul> <li>Zero-cost abstractions</li> <li>Memory safety without GC (Garbage Collection)</li> <li>Compile-time guarantees</li> </ul>"},{"location":"language/explanation/models_and_classes/#see-also","title":"See Also","text":"<ul> <li>Derives and Traits \u2014 Adding behaviors with <code>@derive</code></li> <li>Error Handling \u2014 Using <code>Result</code> and <code>Option</code></li> <li>Example: models_vs_classes.incn</li> </ul>"},{"location":"language/explanation/scopes_and_name_resolution/","title":"Scopes &amp; Name Resolution","text":"<p>Incan is lexically scoped: a name refers to the nearest binding in the surrounding source structure.</p> <p>Two rules matter most in day-to-day code:</p> <ul> <li>Incan has block scope: most indented blocks introduce a new scope.</li> <li>Incan\u2019s \u201cplain assignment\u201d (<code>x = ...</code> without <code>let</code>/<code>mut</code>) is inferred:<ul> <li>If <code>x</code> already exists in an enclosing scope, <code>x = ...</code> is a reassignment (so it requires <code>x</code> to be <code>mut</code>).</li> <li>If <code>x</code> does not exist yet, <code>x = ...</code> creates a new binding in the current scope.</li> </ul> </li> </ul> <p>This page explains how those rules interact, and how to write clear, predictable code.</p>"},{"location":"language/explanation/scopes_and_name_resolution/#mental-model","title":"Mental model","text":"<p>Think of the compiler keeping a stack of scopes. When you enter a new syntactic region (module, function, block, \u2026) it pushes a scope; when you leave it pops the scope. Name lookup walks from the top of the stack outward until it finds a match.</p> <p>This diagram shows how the compiler resolves a name:</p> <pre><code>flowchart TB\n    Enter[\"Enter region (module / function / block)\"] --&gt; Push[\"Push new scope on the stack\"]\n    Push --&gt; Lookup[\"Resolve a name: start at top scope\"]\n    Lookup --&gt; Found{Found binding?}\n    Found -- \"yes\" --&gt; Use[\"Use nearest binding\"]\n    Found -- \"no\" --&gt; Outer[\"Check next outer scope\"]\n    Outer --&gt; Found\n    Use --&gt; Exit[\"Exit region\"]\n    Exit --&gt; Pop[\"Pop scope from the stack\"]</code></pre> <p>Internally this is implemented by the compiler\u2019s symbol table (<code>lookup()</code> searches outward; <code>lookup_local()</code> checks only the current scope).</p> <p>Coming from Python?</p> <p>Two differences tend to surprise people:</p> <ul> <li>In Python, <code>if</code>/<code>for</code>/<code>while</code> blocks don\u2019t create a new scope (so names can \u201cleak\u201d out of blocks).</li> <li>Python resolves names with LEGB (Local \u2192 Enclosing \u2192 Global \u2192 Builtins), and has a key rule:   any assignment in a function makes that name local to the entire function, unless you declare it   <code>global</code>/<code>nonlocal</code>. In Incan, blocks are scopes and <code>x = ...</code> is inferred as \u201cnew vs reassign\u201d by looking   outward for an existing binding.</li> </ul> <p>Coming from Rust?</p> <p>The spirit is similar (lexical scopes, <code>mut</code> for reassignment), but the surface syntax differs:</p> <ul> <li>Incan\u2019s <code>let x = ...</code> is the explicit way to introduce a new binding in the current scope (often used for   shadowing).</li> <li>Plain <code>x = ...</code> is context-sensitive: it either reassigns an existing <code>mut</code> binding, or introduces a new   immutable binding if <code>x</code> doesn\u2019t exist yet.</li> </ul>"},{"location":"language/explanation/scopes_and_name_resolution/#what-counts-as-a-scope-in-incan","title":"What counts as a scope in Incan?","text":"<p>Here are the scopes Incan uses when resolving names.</p>"},{"location":"language/explanation/scopes_and_name_resolution/#module-scope-file-scope","title":"Module scope (file scope)","text":"<p>Everything at top level in a file lives in the module scope:</p> <ul> <li><code>import</code> / <code>from ... import ...</code> bindings</li> <li><code>const</code> bindings</li> <li>top-level function definitions, models/classes/enums, etc.</li> </ul> <p>For example:</p> <pre><code>from math import sqrt            # module-scope binding\nconst PI: float = 3.14159        # module-scope binding\n\ndef area(r: float) -&gt; float:     # module-scope binding (function)\n    return PI * r * r            # uses module-scope name\n\nmodel Circle:                    # module-scope binding (type)\n    radius: float\n\ndef demo() -&gt; float:\n    c = Circle(radius=2.0)\n    return sqrt(area(c.radius))  # `Circle`, `sqrt`, `area` resolved from module scope\n</code></pre> <p>In this example, the names <code>sqrt</code>, <code>PI</code>, <code>area</code>, and <code>Circle</code> are all resolved from the module scope.</p>"},{"location":"language/explanation/scopes_and_name_resolution/#function-method-scope","title":"Function / method scope","text":"<p>Each <code>def ...:</code> body is a function scope.</p> <p>Methods also have a function-like scope and define <code>self</code> (and <code>mut self</code>) for the method body.</p> <p>For example:</p> <pre><code>const PI: float = 3.14159  # module scope\n\ndef area_scaled(r: float, scale: float) -&gt; float:\n    let base = PI * r * r        # PI: module, r: parameter, base: local\n    return base * scale          # scale: parameter\n\nmodel Circle:\n    radius: float\n\n    def area(self) -&gt; float:\n        return PI * self.radius * self.radius  # self: method scope, PI: module scope\n</code></pre> <p>In these examples:</p> <ul> <li>Module-scope names: <code>PI</code>, <code>Circle</code>, <code>area_scaled</code></li> <li>Function-scope names: parameters like <code>r</code> and <code>scale</code>, plus locals like <code>base</code></li> <li>Method-scope names: <code>self</code> (and anything you bind inside the method body)</li> </ul>"},{"location":"language/explanation/scopes_and_name_resolution/#block-scope","title":"Block scope","text":"<p>Bodies of these constructs are checked in a block scope:</p> <ul> <li><code>if</code> / <code>else</code></li> <li><code>while</code></li> <li><code>for</code></li> <li><code>if</code> expressions (treated as statement-like blocks in the current checker)</li> <li>list/dict comprehensions (the loop variable is local to the comprehension)</li> </ul> <p>So variables defined in such blocks do not \u201cleak out\u201d to the surrounding scope.</p>"},{"location":"language/explanation/scopes_and_name_resolution/#bindings-vs-reassignment","title":"Bindings vs reassignment","text":"<p>Incan uses the same syntax <code>x = value</code> for both:</p> <ul> <li>creating a new binding, and</li> <li>reassigning an existing one.</li> </ul> <p>The current rule is:</p> <ul> <li><code>let x = ...</code> always creates a new immutable binding in the current scope (this is how you intentionally shadow).</li> <li><code>mut x = ...</code> always creates a new mutable binding in the current scope (a fresh binding, but mutable).</li> <li>Plain <code>x = ...</code> is inferred:<ul> <li>if <code>x</code> already exists in any enclosing scope, it is a reassignment (so <code>x</code> must be mutable)</li> <li>otherwise it creates a new immutable binding in the current scope</li> </ul> </li> </ul>"},{"location":"language/explanation/scopes_and_name_resolution/#mut-controls-reassignment","title":"<code>mut</code> controls reassignment","text":"<ul> <li>A binding is immutable by default.</li> <li>You can only reassign a binding if it was declared <code>mut</code>.</li> <li>Shadowing an outer name is done with <code>let</code> (a new binding in the inner scope).</li> </ul> <p>Example:</p> <pre><code>def reassigns_outer() -&gt; int:\n    mut x = 1\n\n    if true:\n        x = 2\n\n    return x  # 2\n</code></pre> <p>Shadowing example (block-local):</p> <pre><code>def shadows_in_block() -&gt; int:\n    let x = 1\n\n    if true:\n        let x = 2  # new binding in the block scope (shadows outer x)\n\n    return x  # still 1\n</code></pre> <p>Notes on <code>let</code>:</p> <ul> <li><code>let x = ...</code> is the explicit form for \u201cintroduce a new binding in the current scope\u201d.</li> <li>It\u2019s optional when introducing a name for the first time (plain <code>x = ...</code> will do that if <code>x</code> doesn\u2019t exist yet),   but <code>let</code> is how you make shadowing unambiguous and readable in nested scopes.</li> <li><code>mut x = ...</code> introduces a new mutable binding. Reassigning later uses plain <code>x = ...</code> (and requires that <code>x</code> was   introduced with <code>mut</code>).</li> </ul> <p>You get an error if you write this:</p> <pre><code>def errors_without_mut() -&gt; Unit:\n    let x = 1\n    if true:\n        x = 2  # error: cannot reassign immutable variable 'x'\n</code></pre> <p>That\u2019s because plain <code>x = 2</code> is treated as a reassignment (since <code>x</code> already exists), and the outer <code>x</code> is immutable.</p>"},{"location":"language/explanation/scopes_and_name_resolution/#prefer-explicit-let-mut","title":"Prefer explicit <code>let</code> / <code>mut</code>","text":"<p>Use <code>let</code>/<code>mut</code> when you care about whether you\u2019re shadowing or reassigning; it avoids surprises and matches what you intended.</p> <p>Example:</p> <pre><code>def shadow_vs_reassign() -&gt; int:\n    mut x = 10\n\n    if true:\n        x = 11      # reassigns the *outer* x (because x already exists)\n        mut x = 12  # creates a new mutable block-local x (shadows outer x in this block)\n        x = 13      # reassigns the *inner* x (still in the block scope)\n\n    return x  # still returns 11, as the x = 13 was assigned to a new x local to the if-block\n</code></pre>"},{"location":"language/explanation/scopes_and_name_resolution/#closures-and-capturing","title":"Closures and capturing","text":"<p>Incan closures use arrow syntax:</p> <pre><code>add1 = (x) =&gt; x + 1\n</code></pre> <p>Closures introduce their own function scope (parameters are local to the closure body). Names from outer scopes can be read by normal lexical lookup.</p> <p>Plain assignment inside a closure behaves the same as elsewhere: if the name exists already, it\u2019s treated as a reassignment (so it requires the outer binding to be <code>mut</code>). Shadow with <code>let</code> if you want a closure-local name.</p> <p>Example:</p> <pre><code>def closure_capture() -&gt; int:\n    mut x = 1\n    inc = () =&gt; x = x + 1  # reassigns outer x (so outer x must be mut)\n    inc()\n    return x  # 2\n</code></pre> <p>Note: Incan does not expose Python-style <code>global</code> / <code>nonlocal</code> declarations.</p>"},{"location":"language/explanation/scopes_and_name_resolution/#common-gotchas-and-how-to-think-about-them","title":"Common gotchas (and how to think about them)","text":"<ul> <li> <p>\u201cWhy did <code>x = ...</code> inside an <code>if</code> error?\u201d</p> <ul> <li>If <code>x</code> already exists, plain <code>x = ...</code> is treated as a reassignment, so <code>x</code> must be <code>mut</code>.</li> <li>If you intended a new block-local <code>x</code>, use <code>let x = ...</code> in the block.</li> </ul> </li> <li> <p>\u201cWhy does <code>x = ...</code> sometimes require <code>mut</code>?\u201d</p> <ul> <li>Only reassignment requires <code>mut</code>. Plain assignment is inferred: it reassigns if <code>x</code> already exists; otherwise it creates a new immutable binding.</li> </ul> </li> <li> <p>\u201cWhere do imported names live?\u201d</p> <ul> <li>Imports add names to the module scope (file scope). Inside functions, you can refer to them like any other outer binding.</li> </ul> </li> </ul>"},{"location":"language/explanation/scopes_and_name_resolution/#see-also","title":"See also","text":"<ul> <li>Imports &amp; Modules \u2014 module boundaries, exports (<code>pub</code>), and importing names</li> <li>Closures \u2014 arrow syntax and when to use closures</li> </ul>"},{"location":"language/explanation/traits_as_language_hooks/","title":"Traits as language hooks (and overloading)","text":"<p>Traits let you describe behavior contracts: \u201ca type supports X\u201d.</p> <p>Some common language features are easiest to understand as desugaring into trait methods. This is similar in spirit to Rust using traits like <code>IntoIterator</code>, <code>Index</code>, and <code>Add</code> to power <code>for</code>, indexing, and operators.</p> <p>This page explains the idea with one concrete example. For the authoritative reference pages, see:</p> <ul> <li>Derives &amp; traits (Reference)</li> <li>Stdlib traits: collection protocols</li> <li>Stdlib traits: indexing and slicing</li> <li>Stdlib traits: callable objects</li> <li>Stdlib traits: operators</li> <li>Stdlib traits: conversions</li> </ul>"},{"location":"language/explanation/traits_as_language_hooks/#why-this-matters","title":"Why this matters","text":"<p>This is the mental model behind \u201cergonomic syntax without magic\u201d:</p> <ul> <li>You can use pleasant syntax (<code>x[i]</code>, <code>for x in y</code>, <code>a + b</code>) without baking special cases into the language.</li> <li>User-defined types can become \u201cfirst-class citizens\u201d by implementing the same hooks as built-in types.</li> <li>The compiler can typecheck these capabilities explicitly (Rust-like), instead of relying on runtime duck typing.</li> </ul>"},{"location":"language/explanation/traits_as_language_hooks/#what-language-hooks-means","title":"What \u201clanguage hooks\u201d means","text":"<p>A language hook is a method name that the compiler can call implicitly when you use a piece of syntax.</p> <p>Examples:</p> <ul> <li><code>len(x)</code> can desugar to something like <code>x.__len__()</code></li> <li><code>xs[i]</code> can desugar to <code>xs.__getitem__(i)</code></li> <li><code>obj()</code> can desugar to <code>obj.__call__(...)</code></li> <li><code>a + b</code> can desugar to <code>a.__add__(b)</code></li> </ul> <p>The important idea is that the syntax stays simple, while the behavior is defined by traits.</p>"},{"location":"language/explanation/traits_as_language_hooks/#example-indexing-is-a-hook","title":"Example: indexing is a hook","text":"<p>When you write:</p> <pre><code>value = xs[i]\n</code></pre> <p>Think:</p> <pre><code>value = xs.__getitem__(i)\n</code></pre> <p>So if you want a custom type to support <code>[]</code>, you implement the indexing hook method (and the corresponding trait requirements as defined in the stdlib trait docs):</p> <pre><code>model Grid:\n    data: list[int]\n\n    def __getitem__(self, idx: int) -&gt; int:\n        return self.data[idx]\n</code></pre> <p>Rust analogy: <code>xs[i]</code> is powered by <code>std::ops::Index</code>, but the idea is the same: syntax \u2192 a trait-defined hook.</p>"},{"location":"language/explanation/traits_as_language_hooks/#how-this-is-rust-like-not-python-magic","title":"How this is Rust-like (not Python-magic)","text":"<p>In Python, \u201cprotocols\u201d are often structural and dynamic (\u201cif it quacks, it\u2019s a duck\u201d), and operator behavior is resolved at runtime via dunder lookup.</p> <p>In Incan, the intent is closer to Rust:</p> <ul> <li>Static typing: whether a type supports a hook is part of the type system.</li> <li>Deterministic dispatch: behavior is resolved at compile time (no dynamic MRO).</li> <li>No runtime patching: you can\u2019t add behavior to types at runtime.</li> </ul> <p>This is what keeps hook-based ergonomics predictable in large codebases.</p>"},{"location":"language/explanation/traits_as_language_hooks/#overloading-what-we-mean-and-what-we-dont","title":"Overloading: what we mean (and what we don\u2019t)","text":"<p>\u201cOverloading\u201d can mean different things:</p> <ul> <li>Operator overloading: <code>a + b</code> uses a hook like <code>__add__</code>.</li> <li>Trait-based polymorphism: generic code can accept \u201canything that implements Trait X\u201d.</li> </ul> <p>It does not necessarily mean \u201cmultiple functions with the same name and different signatures\u201d (traditional overload sets).</p> <p>In Incan, most extensibility is intended to flow through traits and explicit, checkable contracts.</p>"},{"location":"language/explanation/traits_as_language_hooks/#a-concrete-mental-model","title":"A concrete mental model","text":"<p>You can think of hook traits as giving user-defined types the same \u201csurface ergonomics\u201d that built-in types have.</p> <p>For example, if a type can be indexed, you should be able to write <code>x[i]</code> without caring whether <code>x</code> is a built-in list or a custom collection type.</p> <p>That\u2019s why the stdlib defines traits for:</p> <ul> <li>collection protocols (<code>len</code>, iteration, membership, truthiness)</li> <li>indexing and slicing (<code>[]</code>, <code>a:b:c</code>)</li> <li>callability (<code>obj()</code>)</li> <li>operators (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, etc.)</li> <li>conversions (<code>from</code>, <code>into</code>, <code>try_from</code>, <code>try_into</code>)</li> </ul>"},{"location":"language/explanation/traits_as_language_hooks/#see-also","title":"See also","text":"<ul> <li>Stdlib traits overview</li> <li>Derives &amp; traits (Reference)</li> </ul>"},{"location":"language/explanation/why_incan/","title":"Why Incan?","text":"<p>Incan is a Python-like language that compiles to Rust.</p> <p>It exists because many developers love Python\u2019s readability and speed of iteration, but repeatedly run into the same problems when projects grow:</p> <ul> <li>performance becomes a bottleneck in the \u201chot\u201d parts</li> <li>packaging and deployment often become a separate engineering project</li> <li>the ecosystem increasingly pushes performance-critical code into Rust/C backends anyway</li> </ul> <p>Incan is the \u201cstep-in\u201d language that makes that path explicit: write clear, Python-shaped code, keep strong typing and tooling, and compile to Rust so you can ship fast, predictable programs.</p>"},{"location":"language/explanation/why_incan/#the-core-idea","title":"The core idea","text":"<p>Incan is built around a simple promise:</p> <ul> <li>Author in a Python-shaped syntax</li> <li>Compile to Rust</li> <li>Use Rust crates when you need them</li> </ul> <p>That means you can keep a high-level surface for most of your code, while still having a real escape hatch into the Rust ecosystem for performance, libraries, and integration.</p>"},{"location":"language/explanation/why_incan/#who-its-for","title":"Who it\u2019s for","text":"<p>Incan is useful when you want:</p> <ul> <li>Python-like ergonomics, but with stronger structure and performance characteristics</li> <li>\u201cscripts that grew up\u201d (small programs that become real projects)</li> <li>a gradual path for Python-heavy teams to adopt Rust where it matters</li> <li>a simpler way (than writing Rust everywhere) to express everyday application code, while still landing on Rust</li> </ul>"},{"location":"language/explanation/why_incan/#what-it-focuses-on-today","title":"What it focuses on (today)","text":"<p>Incan aims for a strong baseline contributor and user experience:</p> <ul> <li>strong, explicit types (to catch mistakes earlier)</li> <li>predictable behavior (fewer \u201cworks on my machine\u201d surprises)</li> <li>a clear tooling story (formatter, tests, LSP)</li> <li>Rust interop with a strict dependency policy (reproducible builds)</li> </ul>"},{"location":"language/explanation/why_incan/#what-it-is-not","title":"What it is not","text":"<ul> <li>A replacement for Rust when you need low-level control and maximal explicitness.</li> <li>A \u201cmarketing layer\u201d over Rust: boundaries, tradeoffs, and current limitations should be clear in the docs.</li> </ul>"},{"location":"language/explanation/why_incan/#next-pages","title":"Next pages","text":"<ul> <li>Why not just Rust: Why not just Rust?</li> <li>How it works: How Incan works</li> <li>If you\u2019re deciding between Incan and Rust: Why not just Rust?</li> <li>Roadmap and status: Roadmap</li> </ul>"},{"location":"language/explanation/why_not_just_rust/","title":"Why not just Rust?","text":"<p>Rust is an excellent systems language. Many projects should use Rust directly.</p> <p>Incan is a different tradeoff: it lets you write Python-shaped application code while still producing a typed, compiled result. Rust is the target and escape hatch, not the primary authoring experience.</p> <p>A practical observation behind Incan is that many \u201cPython projects\u201d already depend on Rust/C backends for performance (especially in AI/data tooling). Incan makes that bridge a first-class experience instead of an ad-hoc stack of bindings, glue code, and deployment workarounds.</p>"},{"location":"language/explanation/why_not_just_rust/#when-rust-is-the-better-choice","title":"When Rust is the better choice","text":"<p>Choose Rust when you want:</p> <ul> <li>maximal explicitness and control (ownership, lifetimes, low-level layout)</li> <li>direct access to the ecosystem without translation layers or mapping constraints</li> <li>mature stability guarantees and broad community conventions</li> <li>to design APIs that are trait-heavy or lifetime-heavy (these can be awkward to express across language boundaries)</li> </ul>"},{"location":"language/explanation/why_not_just_rust/#when-incan-can-be-the-better-choice","title":"When Incan can be the better choice","text":"<p>Choose Incan when you want:</p> <ul> <li>a simpler authoring experience (Python-like syntax) with strong, explicit types</li> <li>strong structure for \u201capplication code\u201d without writing Rust everywhere</li> <li>Cargo + Rust crates as the implementation target and escape hatch, not the primary authoring language</li> <li>less time spent on ownership/lifetime \u201cplumbing\u201d for everyday app code   (Incan uses safe ownership defaults and emits Rust that satisfies the borrow checker)</li> </ul>"},{"location":"language/explanation/why_not_just_rust/#tradeoffs-and-boundaries-to-keep-in-mind","title":"Tradeoffs and boundaries to keep in mind","text":"<ul> <li>Incan is in Beta; expect evolution, especially in tooling and ecosystem interop.</li> <li>The compiler pipeline is effectively \u201ctwo-step\u201d (Incan \u2192 Rust \u2192 machine code).   In practice, that usually means seconds, not minutes, but it is still a tradeoff.</li> <li>Rust interop is powerful but comes with contracts (dependency policy, type mapping).   Today, interop prefers owned types; borrowing/lifetime-heavy Rust APIs may not map cleanly yet.</li> </ul> <p>See also:</p> <ul> <li>Why Incan?</li> <li>Rust Interop</li> <li>RFC 013: Rust crate dependencies</li> </ul>"},{"location":"language/how-to/async_programming/","title":"Async Programming in Incan","text":"<p>Incan provides full async/await support powered by the Tokio runtime. This guide covers all async features available in Incan.</p> <p>Coming from Python?</p> <p>Incan's async model mirrors Python's <code>asyncio</code> \u2014 you'll find <code>async def</code>, <code>await</code>, task spawning, and timeouts all work the same way.</p> <p>The key difference is under the hood: Incan compiles to Rust and uses Tokio, giving you the familiar Python syntax with Rust-level async performance.</p>"},{"location":"language/how-to/async_programming/#quick-start","title":"Quick Start","text":"<pre><code>async def fetch_data() -&gt; str:\n    await sleep(1.0)  # Wait 1 second\n    return \"data\"\n\ndef main() -&gt; None:\n    # When async is used, main automatically gets #[tokio::main]\n    println(\"Starting...\")\n</code></pre>"},{"location":"language/how-to/async_programming/#core-concepts","title":"Core Concepts","text":""},{"location":"language/how-to/async_programming/#async-functions","title":"Async Functions","text":"<p>Declare async functions with <code>async def</code>:</p> <pre><code>async def do_work() -&gt; int:\n    await sleep(0.5)\n    return 42\n</code></pre>"},{"location":"language/how-to/async_programming/#await","title":"Await","text":"<p>Use <code>await</code> to wait for an async operation:</p> <pre><code>async def process() -&gt; str:\n    data = await fetch_data()\n    result = await transform(data)\n    return result\n</code></pre>"},{"location":"language/how-to/async_programming/#time-primitives","title":"Time Primitives","text":""},{"location":"language/how-to/async_programming/#sleep","title":"sleep","text":"<p>Pause execution for a duration:</p> <pre><code>await sleep(1.5)      # Sleep 1.5 seconds\nawait sleep_ms(500)   # Sleep 500 milliseconds\n</code></pre>"},{"location":"language/how-to/async_programming/#timeout","title":"timeout","text":"<p>Run an operation with a time limit:</p> <pre><code>result = await timeout(5.0, slow_operation)\nmatch result:\n    case Ok(value): println(f\"Success: {value}\")\n    case Err(e): println(\"Operation timed out\")\n</code></pre>"},{"location":"language/how-to/async_programming/#task-spawning","title":"Task Spawning","text":""},{"location":"language/how-to/async_programming/#spawn","title":"spawn","text":"<p>Run a task concurrently:</p> <pre><code>async def background_work() -&gt; int:\n    await sleep(2.0)\n    return 42\n\n# Spawn returns immediately\nhandle = spawn(background_work)\n\n# Do other work...\nprintln(\"Working on other things...\")\n\n# Wait for the spawned task\nresult = await handle\nprintln(f\"Background task returned: {result}\")\n</code></pre>"},{"location":"language/how-to/async_programming/#spawn_blocking","title":"spawn_blocking","text":"<p>Run CPU-intensive or blocking code on a dedicated thread:</p> <pre><code>def heavy_computation() -&gt; int:\n    result = 0\n    for i in range(1_000_000):\n        result = result + i\n    return result\n\n# Won't block the async runtime\nresult = await spawn_blocking(heavy_computation)\n</code></pre>"},{"location":"language/how-to/async_programming/#yield_now","title":"yield_now","text":"<p>Cooperatively yield to let other tasks run:</p> <pre><code>async def cooperative_loop() -&gt; None:\n    for i in range(10000):\n        # Do some work...\n        if i % 100 == 0:\n            await yield_now()  # Let other tasks run\n</code></pre>"},{"location":"language/how-to/async_programming/#channels","title":"Channels","text":"<p>Channels enable safe message passing between concurrent tasks. They're the primary way to communicate between async tasks without shared mutable state.</p>"},{"location":"language/how-to/async_programming/#mpsc-channel-multi-producer-single-consumer","title":"MPSC Channel (Multi-Producer, Single-Consumer)","text":"<p>MPSC stands for Multi-Producer, Single-Consumer:</p> <ul> <li>Multiple senders can send messages (clone the sender to share it)</li> <li>One receiver processes all messages</li> <li>Messages arrive in order (FIFO)</li> </ul>"},{"location":"language/how-to/async_programming/#when-to-use-mpsc","title":"When to use MPSC","text":"Use Case Why MPSC Worker pool \u2192 result collector Many workers, one aggregator Event bus Multiple event sources, one handler Logging Multiple tasks \u2192 single log writer Request queue Multiple clients \u2192 one server <p>Bounded channel (recommended):</p> <pre><code># Create channel with buffer size 32\ntx, rx = channel[str](32)\n\n# Sender - blocks if buffer is full (backpressure)\nasync def producer() -&gt; None:\n    await tx.send(\"hello\")  # Waits if buffer full\n    await tx.send(\"world\")\n\n# Receiver - blocks until message available\nasync def consumer() -&gt; None:\n    while True:\n        match await rx.recv():\n            case Some(msg): println(f\"Got: {msg}\")\n            case None: break  # All senders dropped, channel closed\n</code></pre> <p>Multiple producers (clone the sender):</p> <pre><code>tx, rx = channel[int](100)\n\n# Clone sender for each producer\ntx1 = tx.clone()\ntx2 = tx.clone()\n\nspawn(async () -&gt; None:\n    await tx1.send(1)\n    await tx1.send(2)\n)\n\nspawn(async () -&gt; None:\n    await tx2.send(100)\n    await tx2.send(200)\n)\n\n# Single consumer receives from all producers\nasync def consume() -&gt; None:\n    while True:\n        match await rx.recv():\n            case Some(n): println(f\"Received: {n}\")\n            case None: break\n</code></pre> <p>Coming from Python?</p> <p>Incan channels are inspired by Rust's <code>tokio::sync::mpsc</code>, not Python's <code>asyncio.Queue</code>. Key differences:</p> <ul> <li>Sender/Receiver split: You get a <code>(tx, rx)</code> pair \u2014 clone <code>tx</code> for multiple producers</li> <li>Ownership semantics: When all senders are dropped, the channel closes and <code>recv()</code> returns <code>None</code></li> <li>No shared queue: Unlike <code>asyncio.Queue</code>, you can't just pass the queue around \u2014 you pass senders or the receiver</li> </ul> <p>The Python equivalent would use <code>asyncio.Queue</code> with <code>put()</code>/<code>get()</code>, but lacks the automatic \"channel closed\" signal when producers finish.</p> <p>Bounded vs Unbounded:</p> Type Backpressure Memory Safety Use When <code>channel[T](n)</code> Yes - send blocks when full Bounded memory Production code <code>unbounded_channel[T]()</code> No - send never blocks Can grow forever Prototyping, low-volume"},{"location":"language/how-to/async_programming/#unbounded-channel","title":"Unbounded Channel","text":"<p><code>send</code> never blocks, but use with caution \u2014 if producers outpace consumers, memory grows without limit:</p> <pre><code># No capacity limit - send always succeeds immediately\ntx, rx = unbounded_channel[int]()\n\n# These never block\ntx.send(1)\ntx.send(2)\ntx.send(3)\n\n# Consumer still blocks waiting for messages\nmatch await rx.recv():\n    case Some(n): println(f\"Got: {n}\")\n    case None: println(\"Channel closed\")\n</code></pre> <p>When unbounded is OK:</p> <ul> <li>Low message volume</li> <li>Consumers always faster than producers</li> <li>Prototyping (switch to bounded before production)</li> </ul>"},{"location":"language/how-to/async_programming/#one-shot-channel","title":"One-Shot Channel","text":"<p>A oneshot channel sends exactly one value. After sending, the sender is consumed and can't be used again. This is perfect for \"request-response\" patterns where you spawn a task and wait for its result.</p> <p>When to use oneshot vs regular channel:</p> Use Case Channel Type Stream of messages <code>channel[T]</code> Single result from spawned task <code>oneshot[T]</code> Producer-consumer queue <code>channel[T]</code> Async function return value <code>oneshot[T]</code> <p>Basic usage:</p> <pre><code>tx, rx = oneshot[int]()\n\nspawn(async () -&gt; None:\n    result = expensive_computation()\n    tx.send(result)  # Consumes sender - can only send once\n)\n\n# Wait for the result\nmatch await rx.recv():\n    case Ok(value): println(f\"Got result: {value}\")\n    case Err(e): println(\"Sender dropped without sending\")\n</code></pre> <p>Common pattern - returning results from spawned tasks:</p> <pre><code>async def compute_in_background(input: Data) -&gt; Result[Output, ComputeError]:\n    # Create oneshot for the result\n    tx, rx = oneshot[Result[Output, ComputeError]]()\n\n    # Spawn the computation\n    spawn(async () -&gt; None:\n        result = heavy_computation(input)\n        tx.send(result)\n    )\n\n    # Do other work while computation runs...\n    do_other_stuff()\n\n    # Wait for result\n    match await rx.recv():\n        case Ok(result): return result\n        case Err(_): return Err(ComputeError.TaskFailed)\n</code></pre> <p>Key differences from regular channels:</p> <ul> <li><code>send()</code> consumes the sender (can only call once)</li> <li>No buffering - it's either empty or has exactly one value</li> <li>Lighter weight than MPSC channels</li> <li><code>recv()</code> returns <code>Err</code> if sender was dropped without sending</li> </ul>"},{"location":"language/how-to/async_programming/#synchronization-primitives","title":"Synchronization Primitives","text":"<p>Incan provides low-level synchronization primitives inspired by Rust's tokio runtime. These give you fine-grained control over shared state and task coordination.</p> <p>Coming from Python?</p> <p>Python's <code>asyncio</code> has some equivalents, but Incan's primitives work differently.</p> Incan Python asyncio Key Difference <code>Mutex[T]</code> <code>asyncio.Lock</code> Incan wraps the value; Python protects external data <code>RwLock[T]</code> (no equivalent) Allows multiple readers OR single writer <code>Semaphore</code> <code>asyncio.Semaphore</code> Similar behavior <code>Barrier</code> <code>asyncio.Barrier</code> (3.11+) Similar behavior <p>The key difference: Incan's <code>Mutex[T]</code> and <code>RwLock[T]</code> wrap a value (like Rust), while Python's Lock is just a lock you use alongside your data.</p>"},{"location":"language/how-to/async_programming/#mutex","title":"Mutex","text":"<p>Mutual exclusion \u2014 ensures only one task can access the wrapped value at a time.</p> <p>When to use: Multiple tasks need to both read AND write shared state.</p> <p>API:</p> <ul> <li><code>Mutex(value)</code> \u2014 Create a mutex wrapping a value</li> <li><code>await mutex.lock()</code> \u2014 Acquire lock, returns a guard</li> <li><code>guard.get()</code> \u2014 Read the value</li> <li><code>guard.set(new_value)</code> \u2014 Write a new value</li> <li>Guard auto-releases when it goes out of scope</li> </ul> <pre><code>shared_counter = Mutex(0)\n\nasync def increment() -&gt; None:\n    guard = await shared_counter.lock()  # Blocks until lock acquired\n    current = guard.get()\n    guard.set(current + 1)\n    # Lock released when guard goes out of scope\n</code></pre> <p>Python comparison</p> <p>Python uses a lock separate from the data. Incan wraps the data (<code>Mutex[T]</code>), so the lock and value are kept together.</p> <pre><code># Python - lock is separate from data\nlock = asyncio.Lock()\ncounter = 0\n\nasync def increment():\n    async with lock:\n        counter += 1\n</code></pre> <pre><code># Incan - lock wraps the data\ncounter = Mutex(0)\n\nasync def increment() -&gt; None:\n    guard = await counter.lock()\n    guard.set(guard.get() + 1)\n</code></pre>"},{"location":"language/how-to/async_programming/#rwlock","title":"RwLock","text":"<p>Reader-writer lock \u2014 allows multiple readers OR a single writer, but not both simultaneously. More efficient than Mutex when reads are frequent.</p> <p>When to use: Many tasks read, few tasks write (e.g., configuration, caches).</p> <p>API:</p> <ul> <li><code>RwLock(value)</code> \u2014 Create an RwLock wrapping a value</li> <li><code>await rwlock.read()</code> \u2014 Acquire read lock (shared with other readers)</li> <li><code>await rwlock.write()</code> \u2014 Acquire write lock (exclusive)</li> <li><code>guard.get()</code> \u2014 Read the value</li> <li><code>guard.set(new_value)</code> \u2014 Write (only on write guard)</li> </ul> <pre><code>config = RwLock(Config(debug=False))\n\nasync def read_config() -&gt; bool:\n    guard = await config.read()  # Multiple readers allowed simultaneously\n    return guard.get().debug\n\nasync def update_config(debug: bool) -&gt; None:\n    guard = await config.write()  # Waits for all readers, then exclusive\n    guard.set(Config(debug=debug))\n</code></pre> <p>Coming from Python?</p> <p>Python's <code>asyncio</code> doesn't have <code>RwLock</code>. This is a Rust/systems programming concept.</p> <p>If you need read-heavy access patterns in Python, you typically just use a <code>Lock</code> for everything.</p>"},{"location":"language/how-to/async_programming/#semaphore","title":"Semaphore","text":"<p>Counting semaphore \u2014 limits how many tasks can access a resource concurrently by managing a pool of \"permits.\"</p> <p>When to use: Connection pools, rate limiting, bounding concurrent operations.</p> <p>API:</p> <ul> <li><code>Semaphore(n)</code> \u2014 Create with n permits</li> <li><code>await sem.acquire()</code> \u2014 Wait for and acquire a permit</li> <li>Permit auto-releases when it goes out of scope</li> </ul> <pre><code># Allow max 3 concurrent connections\nconnection_limit = Semaphore(3)\n\nasync def make_request() -&gt; Response:\n    permit = await connection_limit.acquire()  # Blocks if no permits\n    response = await http_get(url)\n    # Permit released automatically when permit goes out of scope\n    return response\n</code></pre> <p>Python equivalent</p> <p><code>asyncio.Semaphore(n)</code> works the same way.</p>"},{"location":"language/how-to/async_programming/#barrier","title":"Barrier","text":"<p>Synchronization point \u2014 makes N tasks wait until all of them reach the barrier before any can proceed.</p> <p>When to use: Phased algorithms, coordinating startup, map-reduce patterns.</p> <p>API:</p> <ul> <li><code>Barrier(n)</code> \u2014 Create barrier for n tasks</li> <li><code>await barrier.wait()</code> \u2014 Wait until all n tasks reach this point</li> </ul> <pre><code>barrier = Barrier(3)  # Wait for 3 tasks\n\nasync def worker(id: int) -&gt; None:\n    println(f\"Worker {id} starting phase 1\")\n    # ... do phase 1 work ...\n\n    await barrier.wait()  # All 3 must reach here before anyone continues\n\n    println(f\"Worker {id} starting phase 2\")  # All start phase 2 together\n</code></pre> <p>Python equivalent</p> <p><code>asyncio.Barrier(n)</code> (added in Python 3.11) works the same way.</p>"},{"location":"language/how-to/async_programming/#complete-example","title":"Complete Example","text":"<p>See examples/advanced/async_sync.incn for a runnable demo of all four primitives.</p>"},{"location":"language/how-to/async_programming/#select-racing-futures","title":"Select (Racing Futures)","text":""},{"location":"language/how-to/async_programming/#select2","title":"select2","text":"<p>Race two futures, get whichever completes first:</p> <pre><code>async def fast() -&gt; str:\n    await sleep(0.1)\n    return \"fast\"\n\nasync def slow() -&gt; str:\n    await sleep(1.0)\n    return \"slow\"\n\nmatch await select2(fast, slow):\n    case Either.Left(result): println(f\"Fast won: {result}\")\n    case Either.Right(result): println(f\"Slow won: {result}\")\n</code></pre>"},{"location":"language/how-to/async_programming/#select3","title":"select3","text":"<p>Race three futures:</p> <pre><code>result = await select3(op1, op2, op3)\nmatch result:\n    case Either3.First(v): println(\"op1 won\")\n    case Either3.Second(v): println(\"op2 won\")  \n    case Either3.Third(v): println(\"op3 won\")\n</code></pre>"},{"location":"language/how-to/async_programming/#select_timeout","title":"select_timeout","text":"<p>Simplified timeout returning Option:</p> <pre><code>match await select_timeout(2.0, slow_operation):\n    case Some(result): println(f\"Got: {result}\")\n    case None: println(\"Timed out, using default\")\n</code></pre>"},{"location":"language/how-to/async_programming/#runtime-integration","title":"Runtime Integration","text":""},{"location":"language/how-to/async_programming/#automatic-tokio-main","title":"Automatic Tokio Main","text":"<p>When your program uses async features, the <code>main()</code> function is automatically wrapped with <code>#[tokio::main]</code>:</p> <p>Tokio is Rust's async runtime: see the Tokio project for a high-level overview.</p> <pre><code>def main() -&gt; None:\n    # This becomes async main() under the hood\n    # when async primitives are used\n    result = await fetch_data()\n    println(f\"Result: {result}\")\n</code></pre>"},{"location":"language/how-to/async_programming/#generated-dependencies","title":"Generated Dependencies","text":"<p>The compiler automatically adds tokio to your Cargo.toml:</p> <pre><code>[dependencies]\ntokio = { version = \"1\", features = [\"rt-multi-thread\", \"macros\", \"time\", \"sync\"] }\n</code></pre>"},{"location":"language/how-to/async_programming/#best-practices","title":"Best Practices","text":""},{"location":"language/how-to/async_programming/#1-dont-block-the-runtime","title":"1. Don't Block the Runtime","text":"<p>Avoid blocking operations in async code:</p> <pre><code># BAD: Blocks the async runtime\nasync def bad() -&gt; None:\n    std_thread_sleep(1.0)  # Don't do this!\n\n# GOOD: Use async sleep\nasync def good() -&gt; None:\n    await sleep(1.0)\n</code></pre>"},{"location":"language/how-to/async_programming/#2-use-spawn_blocking-for-cpu-work","title":"2. Use spawn_blocking for CPU Work","text":"<pre><code># BAD: CPU work on async runtime\nasync def bad() -&gt; int:\n    return heavy_computation()\n\n# GOOD: Offload to blocking pool\nasync def good() -&gt; int:\n    return await spawn_blocking(heavy_computation)\n</code></pre>"},{"location":"language/how-to/async_programming/#3-use-bounded-channels","title":"3. Use Bounded Channels","text":"<p>Prefer bounded channels to prevent memory issues:</p> <pre><code># Prefer this:\ntx, rx = channel[Data](100)\n\n# Over this (unbounded can grow forever):\ntx, rx = unbounded_channel[Data]()\n</code></pre>"},{"location":"language/how-to/async_programming/#4-handle-cancellation","title":"4. Handle Cancellation","text":"<p>Tasks can be cancelled when their handles are dropped:</p> <pre><code>async def cancellable_work() -&gt; str:\n    await sleep(10.0)\n    return \"done\"\n\nhandle = spawn(cancellable_work)\n# If we don't await handle, the task is cancelled!\n# Always await or explicitly ignore:\n_ = handle  # Explicit ignore (task continues)\n</code></pre>"},{"location":"language/how-to/async_programming/#error-handling","title":"Error Handling","text":""},{"location":"language/how-to/async_programming/#timeout-errors","title":"Timeout Errors","text":"<pre><code>result = await timeout(1.0, slow_task)\nmatch result:\n    case Ok(value): process(value)\n    case Err(e): println(f\"Timed out: {e}\")\n</code></pre>"},{"location":"language/how-to/async_programming/#channel-closed","title":"Channel Closed","text":"<p>When sending fails because the receiver was dropped, <code>SendError[T]</code> contains the value that couldn't be sent in its <code>.value</code> field:</p> <pre><code>async def sender(tx: Sender[Message]) -&gt; None:\n    msg = Message(id=1, content=\"important data\")\n\n    match await tx.send(msg):\n        case Ok(_): println(\"Sent successfully\")\n        case Err(e):\n            # Recover the unsent value - it's not lost!\n            println(f\"Channel closed, saving for retry: {e.value:?}\")\n            save_for_later(e.value)\n</code></pre> <p>This pattern is important for reliability. If a channel closes unexpectedly, you can recover and handle the data that failed to send.</p>"},{"location":"language/how-to/async_programming/#see-also","title":"See Also","text":"<ul> <li>Error handling - Concepts: <code>Result</code>, <code>Option</code>, <code>?</code>, <code>match</code></li> <li>Error handling recipes - Patterns and best practices</li> <li>Error trait - Stdlib trait reference</li> <li>Examples: Async Tasks</li> <li>Examples: Channels</li> <li>Examples: Synchronization</li> </ul>"},{"location":"language/how-to/customize_derived_behavior/","title":"Customize derived behavior (How-to)","text":"<p>This page is task-focused: how to get the behavior you want when the default derive behavior doesn\u2019t fit.</p> <p>For the authoritative catalog of derives/dunders, see:</p> <ul> <li>Derives &amp; traits (Reference)</li> </ul>"},{"location":"language/how-to/customize_derived_behavior/#custom-string-output-for-your-type","title":"Custom string output for your type","text":""},{"location":"language/how-to/customize_derived_behavior/#goal-custom-string-output","title":"Goal (custom string output)","text":"<p>Make <code>println(f\"{x}\")</code> show a friendly string.</p>"},{"location":"language/how-to/customize_derived_behavior/#steps-custom-string-output","title":"Steps (custom string output)","text":"<ol> <li>Define <code>__str__(self) -&gt; str</code> on your <code>model</code>/<code>class</code>.</li> <li>Do not also <code>@derive(Display)</code> (that\u2019s a conflict).</li> </ol> <pre><code>model User:\n    name: str\n    email: str\n\n    def __str__(self) -&gt; str:\n        return f\"{self.name} &lt;{self.email}&gt;\"\n</code></pre>"},{"location":"language/how-to/customize_derived_behavior/#custom-equality","title":"Custom equality (<code>==</code>)","text":""},{"location":"language/how-to/customize_derived_behavior/#goal-custom-equality","title":"Goal (custom equality)","text":"<p>Compare values by a subset of fields (for example, compare by <code>id</code> only).</p>"},{"location":"language/how-to/customize_derived_behavior/#steps-custom-equality","title":"Steps (custom equality)","text":"<ol> <li>Define <code>__eq__(self, other: Self) -&gt; bool</code>.</li> <li>Do not also <code>@derive(Eq)</code>.</li> </ol> <pre><code>model User:\n    id: int\n    name: str\n\n    def __eq__(self, other: User) -&gt; bool:\n        return self.id == other.id\n</code></pre>"},{"location":"language/how-to/customize_derived_behavior/#custom-ordering-sorted","title":"Custom ordering (<code>sorted(...)</code>)","text":""},{"location":"language/how-to/customize_derived_behavior/#goal-custom-ordering","title":"Goal (custom ordering)","text":"<p>Sort values using a domain-specific rule.</p>"},{"location":"language/how-to/customize_derived_behavior/#steps-custom-ordering","title":"Steps (custom ordering)","text":"<ol> <li>Define <code>__lt__(self, other: Self) -&gt; bool</code>.</li> <li>Do not also <code>@derive(Ord)</code>.</li> </ol> <pre><code>model Task:\n    priority: int\n    title: str\n\n    def __lt__(self, other: Task) -&gt; bool:\n        return self.priority &lt; other.priority\n</code></pre> <p>Why <code>__lt__</code>?</p> <p><code>sorted(...)</code> needs an ordering rule. Incan uses the <code>&lt;</code> hook (<code>__lt__</code>) as the basis for ordering, so implementing <code>__lt__</code> gives the runtime a way to compare two values and sort a list.</p> <p>See Derives: Comparison \u2192 Ord for the canonical ordering rules.</p>"},{"location":"language/how-to/customize_derived_behavior/#custom-hashing-set-dict-keys","title":"Custom hashing (<code>Set</code> / <code>Dict</code> keys)","text":""},{"location":"language/how-to/customize_derived_behavior/#goal-custom-hashing","title":"Goal (custom hashing)","text":"<p>Use a type as a <code>Set</code> member / <code>Dict</code> key based on a custom identity.</p>"},{"location":"language/how-to/customize_derived_behavior/#steps-custom-hashing","title":"Steps (custom hashing)","text":"<ol> <li>Define <code>__hash__(self) -&gt; int</code>.</li> <li>Ensure it matches equality: if <code>a == b</code>, their hashes must match.</li> <li>Do not also <code>@derive(Hash)</code>.</li> </ol> <pre><code>model User:\n    id: int\n    name: str\n\n    def __eq__(self, other: User) -&gt; bool:\n        return self.id == other.id\n\n    def __hash__(self) -&gt; int:\n        return self.id.__hash__()\n</code></pre>"},{"location":"language/how-to/customize_derived_behavior/#field-defaults-make-construction-ergonomic","title":"Field defaults: make construction ergonomic","text":""},{"location":"language/how-to/customize_derived_behavior/#goal-field-defaults","title":"Goal (field defaults)","text":"<p>Make <code>Type()</code> work when fields have defaults.</p>"},{"location":"language/how-to/customize_derived_behavior/#steps-field-defaults","title":"Steps (field defaults)","text":"<ol> <li>Put defaults on the fields (<code>field: T = expr</code>).</li> <li>Any field with no default must still be provided.</li> </ol> <pre><code>model Settings:\n    theme: str = \"dark\"\n    font_size: int = 14\n</code></pre>"},{"location":"language/how-to/error_handling_recipes/","title":"Error handling recipes","text":"<p>This page is a practical companion to Error handling. It focuses on common patterns and \u201cwhat to do when\u2026\u201d.</p> <p>Coming from Python?</p> <p>In Python, many failures surface as exceptions (<code>try</code>/<code>except</code>) and \u201cpropagation\u201d is implicit.</p> <p>In Incan, common failures are modeled explicitly with <code>Result[T, E]</code>:</p> <ul> <li>Use <code>?</code> to propagate an <code>Err(...)</code> to your caller (similar to \u201clet it raise\u201d, but typed).</li> <li>Use <code>match</code> to handle/recover locally (similar to <code>try</code>/<code>except</code>, but without hidden control flow).</li> <li>Avoid <code>unwrap()</code> on user/config/network inputs; it\u2019s closer to <code>assert False</code> than \u201cnormal error handling\u201d.</li> </ul>"},{"location":"language/how-to/error_handling_recipes/#pattern-handle-vs-propagate","title":"Pattern: Handle vs propagate","text":"<p>Use <code>?</code> when you want to propagate failures to the caller.</p> <p>Use <code>match</code> when you want to recover, retry, branch, or attach context.</p> <pre><code>def load_user(id: int) -&gt; Result[User, AppError]:\n    # Propagate: caller decides what to do.\n    user = fetch_user(id).map_err(AppError.Network)?\n    return Ok(user)\n\ndef load_user_or_guest(id: int) -&gt; User:\n    # Recover: we decide locally.\n    match load_user(id):\n        Ok(user) =&gt; return user\n        Err(_) =&gt; return User.guest()\n</code></pre>"},{"location":"language/how-to/error_handling_recipes/#pattern-convert-errors-at-module-boundaries-map_err","title":"Pattern: Convert errors at module boundaries (<code>map_err</code>)","text":"<p>Convert low-level errors into a stable, module-level error type.</p> <pre><code>enum ConfigError:\n    Io(IoError)\n    Parse(str)\n\ndef load_config(path: Path) -&gt; Result[Config, ConfigError]:\n    content = path.read_text().map_err(ConfigError.Io)?\n    cfg = parse_toml[Config](content).map_err(|e| ConfigError.Parse(e))?\n    return Ok(cfg)\n</code></pre> <p>Tip: do this once at the boundary, not at every call site.</p>"},{"location":"language/how-to/error_handling_recipes/#pattern-turn-optiont-into-resultt-e-ok_or","title":"Pattern: Turn <code>Option[T]</code> into <code>Result[T, E]</code> (<code>ok_or</code>)","text":"<p>Use this when \u201cmissing\u201d should become a recoverable error.</p> <pre><code>def require_user(id: int) -&gt; Result[User, AppError]:\n    return users.get(id).ok_or(AppError.NotFound(f\"user {id}\"))\n</code></pre>"},{"location":"language/how-to/error_handling_recipes/#pattern-defaults-unwrap_or-unwrap_or_else","title":"Pattern: Defaults (<code>unwrap_or</code> / <code>unwrap_or_else</code>)","text":"<p>Use defaults only when there is a genuinely safe fallback.</p> <pre><code>timeout = settings.get(\"timeout_secs\").unwrap_or(\"2.0\")\n</code></pre> <p>If computing the default is expensive, prefer <code>unwrap_or_else(...)</code> when available.</p>"},{"location":"language/how-to/error_handling_recipes/#pattern-retry-a-fallible-operation","title":"Pattern: Retry a fallible operation","text":"<p>Keep retries local and explicit.</p> <pre><code>def fetch_with_retry(url: str, attempts: int) -&gt; Result[str, NetworkError]:\n    mut last_err: Option[NetworkError] = None\n\n    for _ in range(attempts):\n        match fetch(url):\n            Ok(body) =&gt; return Ok(body)\n            Err(e) =&gt;\n                last_err = Some(e)\n                continue\n\n    return Err(last_err.unwrap_or(NetworkError(\"unreachable\")))\n</code></pre>"},{"location":"language/how-to/error_handling_recipes/#pattern-errors-with-recoverable-payloads","title":"Pattern: Errors with recoverable payloads","text":"<p>Sometimes the error should carry a value that would otherwise be lost (e.g. sending on a closed channel).</p> <pre><code>match await tx.send(msg):\n    Ok(_) =&gt; println(\"Sent!\")\n    Err(e) =&gt;\n        save_for_retry(e.value)\n</code></pre>"},{"location":"language/how-to/error_handling_recipes/#dont-do-this-unwrap-on-user-input","title":"\u201cDon\u2019t do this\u201d: <code>unwrap()</code> on user input","text":"<p><code>unwrap()</code> and <code>panic()</code> are for \u201cshould never happen\u201d paths (tests, invariants, internal compiler bugs), not expected failures.</p> <p>Prefer <code>Result</code> and handle the error where you can recover.</p>"},{"location":"language/how-to/error_handling_recipes/#see-also","title":"See also","text":"<ul> <li>Error handling (concepts)</li> <li>The Error trait (stdlib)</li> </ul>"},{"location":"language/how-to/error_messages/","title":"Understanding Incan Error Messages","text":"<p>Incan\u2019s compiler errors are designed to be actionable: they show you what went wrong, where it happened, and what to do next.</p>"},{"location":"language/how-to/error_messages/#reading-error-output","title":"Reading Error Output","text":"<pre><code>type error: Type mismatch: expected 'Result[str, str]', found 'str'\n  --&gt; examples/demo.incn:8:5\n    |\n  8 |     return \"Alice\"\n    |     ^^^^^^^^^^^^^^\n  = note: In Incan, functions that can fail return Result[T, E]\n  = hint: Wrap the value with Ok(...) to return success\n  = hint: Or use Err(...) to return an error\n</code></pre> <p>Components:</p> <ul> <li>Error type: <code>type error</code>, <code>syntax error</code>, <code>warning</code>, <code>lint</code></li> <li>Message: What went wrong</li> <li>Location: File, line, and column</li> <li>Source: The problematic code with underline</li> <li>Notes: Background explanation (why this matters)</li> <li>Hints: How to fix it</li> </ul>"},{"location":"language/how-to/error_messages/#common-errors-and-solutions","title":"Common Errors and Solutions","text":""},{"location":"language/how-to/error_messages/#result-type-mismatches","title":"Result Type Mismatches","text":"<p>Error:</p> <pre><code>Type mismatch: expected 'Result[User, Error]', found 'User'\n</code></pre> <p>Problem: Function returns <code>Result</code> but you're returning a plain value.</p> <p>Solution:</p> <pre><code># Wrong\ndef get_user(id: int) -&gt; Result[User, Error]:\n    return User(name=\"Alice\")  # \u274c Missing Ok()\n\n# Right\ndef get_user(id: int) -&gt; Result[User, Error]:\n    return Ok(User(name=\"Alice\"))  # \u2705\n</code></pre> <p>Error:</p> <pre><code>Type mismatch: expected 'str', found 'Result[str, Error]'\n</code></pre> <p>Problem: Using a <code>Result</code> where a plain value is expected.</p> <p>Solution:</p> <pre><code># Wrong\ndef greet() -&gt; str:\n    name = get_name()  # Returns Result[str, Error]\n    return name  # \u274c name is still Result\n\n# Right - use ? to unwrap\ndef greet() -&gt; Result[str, Error]:\n    name = get_name()?  # \u2705 Unwraps Ok, returns Err early\n    return Ok(f\"Hello, {name}\")\n\n# Or handle explicitly\ndef greet_safe() -&gt; str:\n    match get_name():\n        case Ok(name): return f\"Hello, {name}\"\n        case Err(_): return \"Hello, stranger\"\n</code></pre>"},{"location":"language/how-to/error_messages/#the-operator","title":"The <code>?</code> Operator","text":"<p>Error:</p> <pre><code>Cannot use '?' on type 'int' - expected Result[T, E]\n</code></pre> <p>Problem: The <code>?</code> operator only works on <code>Result</code> types.</p> <p>Solution:</p> <pre><code># Wrong\ndef double(x: int) -&gt; int:\n    return x?  # \u274c x is not a Result\n\n# Right\ndef double(x: int) -&gt; int:\n    return x * 2  # \u2705 No ? needed\n</code></pre>"},{"location":"language/how-to/error_messages/#mutability-errors","title":"Mutability Errors","text":"<p>Error:</p> <pre><code>Cannot mutate 'count' - variable is immutable\n</code></pre> <p>Problem: Trying to change a variable declared without <code>mut</code>.</p> <p>Why: Incan variables are immutable by default for safety and clarity.</p> <p>Solution:</p> <pre><code># Wrong\ndef counter() -&gt; int:\n    let count = 0\n    count = count + 1  # \u274c count is immutable\n    return count\n\n# Right\ndef counter() -&gt; int:\n    mut count = 0      # \u2705 Declare as mutable\n    count = count + 1\n    return count\n</code></pre>"},{"location":"language/how-to/error_messages/#self-mutation","title":"Self Mutation","text":"<p>Error:</p> <pre><code>Cannot mutate self - method takes immutable self\n</code></pre> <p>Problem: Method modifies <code>self</code> but doesn't declare <code>mut self</code>.</p> <p>Solution:</p> <pre><code>model Counter:\n    value: int\n\n    # Wrong\n    def increment(self) -&gt; None:\n        self.value += 1  # \u274c self is immutable\n\n    # Right\n    def increment(mut self) -&gt; None:  # \u2705 mut self\n        self.value += 1\n</code></pre>"},{"location":"language/how-to/error_messages/#missing-traits","title":"Missing Traits","text":"<p>Error:</p> <pre><code>Type 'Point' does not implement trait 'Eq'\n</code></pre> <p>Problem: Using <code>==</code> on a type without equality support.</p> <p>Solution:</p> <pre><code># Add @derive(Eq) to enable ==\n@derive(Eq)\nmodel Point:\n    x: int\n    y: int\n\n# Now this works\nif p1 == p2:\n    println(\"Same point!\")\n</code></pre> <p>Common derives:</p> Need Derive <code>==</code>, <code>!=</code> <code>@derive(Eq)</code> <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code> <code>@derive(Ord)</code> Use in <code>Set</code> or as <code>Dict</code> key <code>@derive(Hash, Eq)</code> <code>.clone()</code> method <code>@derive(Clone)</code> <code>{:?}</code> debug format <code>@derive(Debug)</code> <p>See Derives &amp; Traits for more information on Derives and Traits</p>"},{"location":"language/how-to/error_messages/#option-handling","title":"Option Handling","text":"<p>Error:</p> <pre><code>Type mismatch: expected 'bool', found 'Option[User]'\n</code></pre> <p>Problem: Using <code>Option</code> directly in a condition.</p> <p>Solution:</p> <pre><code># Wrong\nlet user = find_user(id)\nif user:  # \u274c Can't use Option as bool\n    ...\n\n# Right - use pattern matching\nif user is Some(u):  # \u2705\n    println(u.name)\n\n# Or check explicitly\nif user.is_some():\n    let u = user.unwrap()\n    println(u.name)\n</code></pre>"},{"location":"language/how-to/error_messages/#philosophy-explicit-is-better","title":"Philosophy: Explicit is Better","text":"<p>Incan intentionally requires explicit handling of:</p> <ol> <li>Errors - No silent failures; use <code>Result</code> and <code>?</code></li> <li>Nullability - No <code>None</code> surprises; use <code>Option</code></li> <li>Mutation - Immutable by default; explicit <code>mut</code></li> </ol> <p>This catches bugs at compile time rather than runtime.</p>"},{"location":"language/how-to/error_messages/#getting-help","title":"Getting Help","text":"<p>If an error message is unclear:</p> <ol> <li>Read the hints - they often show the exact fix</li> <li>Check the notes - they explain the underlying concept</li> <li>Look at Error Handling for <code>Result</code>/<code>Option</code> patterns</li> <li>See Derives &amp; Traits for trait requirements</li> </ol>"},{"location":"language/how-to/error_messages/#next-steps","title":"Next Steps","text":"<ul> <li>Error Handling - Working with <code>Result</code> types</li> <li>Derives &amp; Traits - Drop trait for custom cleanup</li> <li>File I/O - Reading, writing, and path handling</li> <li>Async Programming - Async/await with Tokio</li> <li>Imports &amp; Modules - Module system, imports, and built-in functions</li> <li>Rust Interop - Using Rust crates directly from Incan</li> <li>Web Framework - Building web apps with Axum</li> </ul>"},{"location":"language/how-to/file_io/","title":"File I/O in Incan","text":"<p>This page is a practical guide to common file and path tasks.</p> <p>File operations return <code>Result</code>, so failures are explicit and easy to handle.</p> Coming from Python? <p>Incan\u2019s <code>Path</code> is similar in spirit to <code>pathlib.Path</code>, but file operations return <code>Result</code> instead of raising exceptions.</p> Coming from Rust? <p>Incan\u2019s <code>Path</code> is closest to a <code>std::path::PathBuf</code>-style API, and file I/O mirrors <code>std::fs</code>. Errors are explicit via <code>Result</code>, so you\u2019ll typically use <code>?</code> to propagate failures.</p> Coming from JavaScript / TypeScript? <p>Think of <code>Path</code> as a typed, composable alternative to Node\u2019s <code>path</code> utilities, and file I/O as <code>fs/promises</code>-style operations\u2014except errors come back as <code>Result</code> instead of throwing (so you use <code>match</code> / <code>?</code> instead of <code>try/catch</code>).</p>"},{"location":"language/how-to/file_io/#recipe-read-a-file-text-or-bytes","title":"Recipe: Read a file (text or bytes)","text":"<pre><code>def read_config_text() -&gt; Result[str, IoError]:\n    return Path(\"config.toml\").read_text()\n\ndef read_image_bytes() -&gt; Result[bytes, IoError]:\n    return Path(\"image.png\").read_bytes()\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-handle-vs-propagate-io-errors","title":"Recipe: Handle vs propagate I/O errors","text":"<p>Use <code>?</code> to propagate errors:</p> <pre><code>def read_config_text() -&gt; Result[str, IoError]:\n    content = Path(\"config.toml\").read_text()?\n    return Ok(content)\n</code></pre> <p>Use <code>match</code> when you want to recover:</p> <pre><code>def safe_read_text(path: Path) -&gt; str:\n    match path.read_text():\n        case Ok(content): return content\n        case Err(IoError.NotFound(_)): return \"\"\n        case Err(e):\n            println(f\"Failed to read {path}: {e.message()}\")\n            return \"\"\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-print-a-file-line-by-line","title":"Recipe: Print a file line-by-line","text":"<pre><code>def print_file(path: Path) -&gt; Result[None, IoError]:\n    # `read_lines()` returns Result[list[str], IoError]\n    # `?` propagates Err(...) to the caller, otherwise unwraps Ok(lines).\n    for line in path.read_lines()?:\n        println(line)\n    return Ok(None)\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-stream-a-large-file-use-file","title":"Recipe: Stream a large file (use <code>File</code>)","text":"<p>For large files or when you need more control, use <code>File.open()</code> and iterate:</p> <pre><code>def count_lines(path: Path) -&gt; Result[int, IoError]:\n    file = File.open(path)?\n\n    mut count = 0\n    for _ in file.lines():\n        count += 1\n\n    return Ok(count)\n    # file is closed automatically when it goes out of scope (RAII)\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-write-a-file-text-or-bytes","title":"Recipe: Write a file (text or bytes)","text":"<pre><code>def save_config(content: str) -&gt; Result[None, IoError]:\n    Path(\"config.toml\").write_text(content)?\n    return Ok(None)\n\ndef save_image(data: bytes) -&gt; Result[None, IoError]:\n    Path(\"output.png\").write_bytes(data)?\n    return Ok(None)\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-append-to-a-file","title":"Recipe: Append to a file","text":"<pre><code>def append_log(message: str) -&gt; Result[None, IoError]:\n    mut file = File.open_append(\"app.log\")?\n    file.write_line(f\"[{timestamp()}] {message}\")?\n    return Ok(None)\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-safe-update-write-temp-then-rename","title":"Recipe: Safe update (write temp, then rename)","text":"<pre><code>def safe_update(path: Path, content: str) -&gt; Result[None, IoError]:\n    temp_path = path.with_suffix(\".tmp\")\n\n    temp_path.write_text(content)?\n    temp_path.rename(path)?\n\n    return Ok(None)\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-walk-a-directory-and-filter-files","title":"Recipe: Walk a directory and filter files","text":"<pre><code>def list_toml_configs() -&gt; Result[list[Path], IoError]:\n    mut configs = []\n    for entry in Path(\"config\").read_dir()?:\n        if entry.suffix == \".toml\":\n            configs.append(entry)\n    return Ok(configs)\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-find-files-with-glob-patterns","title":"Recipe: Find files with glob patterns","text":"<pre><code>def find_python_files() -&gt; Result[list[Path], IoError]:\n    return Ok(Path(\".\").glob(\"**/*.py\")?)\n\ndef find_configs() -&gt; Result[list[Path], IoError]:\n    return Ok(Path(\"config\").glob(\"*.toml\")?)\n</code></pre>"},{"location":"language/how-to/file_io/#recipe-ensure-a-config-file-exists-create-default-if-missing","title":"Recipe: Ensure a config file exists (create default if missing)","text":"<pre><code>const DEFAULT_CONFIG: str = \"debug = true\\n\"\n\ndef ensure_config() -&gt; Result[str, IoError]:\n    path = Path(\"config.toml\")\n\n    if not path.exists():\n        path.write_text(DEFAULT_CONFIG)?\n\n    return path.read_text()\n</code></pre>"},{"location":"language/how-to/file_io/#see-also","title":"See also","text":"<ul> <li>Error handling (concepts)</li> <li>File I/O reference (Path/File APIs)</li> </ul>"},{"location":"language/how-to/imports_and_modules/","title":"Imports and modules (how-to)","text":"<p>This page shows how to structure multi-file projects and use imports in practice.</p> <p>Prerequisite: follow Install, build, and run so you can run <code>incan</code>.</p> <p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre>"},{"location":"language/how-to/imports_and_modules/#simple-multi-file-project","title":"Simple multi-file project","text":"<p>Recommended structure:</p> <pre><code>myproject/\n\u251c\u2500\u2500 main.incn\n\u251c\u2500\u2500 models.incn\n\u2514\u2500\u2500 utils.incn\n</code></pre> <p>Example imports:</p> <pre><code>from models import User\nimport utils::format_currency\n</code></pre>"},{"location":"language/how-to/imports_and_modules/#nested-projects","title":"Nested projects","text":"<p>Recommended structure:</p> <pre><code>myproject/\n\u2514\u2500\u2500 src/\n    \u251c\u2500\u2500 main.incn\n    \u251c\u2500\u2500 db/\n    \u2502   \u2514\u2500\u2500 models.incn\n    \u2514\u2500\u2500 shared/\n        \u2514\u2500\u2500 utils.incn\n</code></pre> <p>Example imports:</p> <pre><code>from db.models import User\nimport shared::utils::format_date\n</code></pre>"},{"location":"language/how-to/imports_and_modules/#how-module-discovery-works-practical-view","title":"How module discovery works (practical view)","text":"<p>When you import a local module, the compiler:</p> <ol> <li>Resolves the path (handling <code>.</code>, <code>..</code>, <code>super</code>, <code>crate</code>)</li> <li>Looks for the <code>.incn</code> file (or <code>mod.incn</code> for directories)</li> <li>Parses and type-checks that file</li> <li>Makes its types and functions available in your importing file</li> </ol>"},{"location":"language/how-to/imports_and_modules/#examples-from-the-repo","title":"Examples from the repo","text":"<ul> <li>Multi-file example: <code>examples/advanced/multifile/</code></li> </ul> <p>Run:</p> <pre><code>incan run examples/advanced/multifile/main.incn\n</code></pre> <ul> <li>Nested project example: <code>examples/advanced/nested_project/</code></li> </ul> <p>Run:</p> <pre><code>incan run examples/advanced/nested_project/src/main.incn\n</code></pre> <p>If you prefer browsing first, see the examples directory on GitHub: <code>https://github.com/dannys-code-corner/incan/tree/main/examples</code>.</p>"},{"location":"language/how-to/modeling_with_enums/","title":"Modeling with enums","text":"<p>This guide shows practical ways to use enums to model real program structure: state machines, commands, error types, and expression trees.</p> <p>If you haven\u2019t read it yet, start with: Enums.</p> Coming from TS/JS? <p>If you\u2019re used to discriminated unions (<code>{ kind: \"A\", ... } | { kind: \"B\", ... }</code>), Incan enums play the same role: a closed set of variants with typed payloads, and <code>match</code> for case handling.</p> <p>Example:</p> <p>=== Typescript</p> <pre><code>```typescript\ntype Event =\n| { kind: \"click\"; x: number; y: number }\n| { kind: \"key\"; key: string };\n\nfunction handle(e: Event) {\n    switch (e.kind) {\n        case \"click\": return `${e.x},${e.y}`;\n        case \"key\": return e.key;\n    }\n}\n```\n</code></pre> <p>===Incan</p> <pre><code>```incan\nenum Event:\n    Click(x: int, y: int)\n    Key(key: str)\n\ndef handle(e: Event) -&gt; str:\n    match e:\n        Click(x, y) =&gt; return f\"{x},{y}\"\n        Key(key) =&gt; return key\n```\n</code></pre>"},{"location":"language/how-to/modeling_with_enums/#pattern-1-state-machines","title":"Pattern 1: State machines","text":"<p>Use this when a value progresses through a closed set of states and you want transitions to be explicit and checked.</p> <pre><code>enum ConnectionState:\n    Disconnected\n    Connecting(str)          # URL being connected to\n    Connected(Connection)\n    Error(str)\n\ndef handle_state(state: ConnectionState) -&gt; ConnectionState:\n    match state:\n        Disconnected =&gt;\n            return ConnectionState.Connecting(\"https://api.example.com\")\n        Connecting(url) =&gt;\n            match try_connect(url):\n                Ok(conn) =&gt; return ConnectionState.Connected(conn)\n                Err(e) =&gt; return ConnectionState.Error(e)\n        Connected(_) =&gt;\n            # Stay connected\n            return state\n        Error(msg) =&gt;\n            println(f\"Error: {msg}\")\n            return ConnectionState.Disconnected\n</code></pre> <p>Tips:</p> <ul> <li>Prefer representing transitions as <code>state -&gt; state</code> functions (like above).</li> <li>Avoid \u201cboolean soup\u201d (<code>is_connected</code>, <code>is_connecting</code>, <code>last_error</code>, \u2026) when the states are mutually exclusive.</li> </ul>"},{"location":"language/how-to/modeling_with_enums/#pattern-2-commands-actions","title":"Pattern 2: Commands / actions","text":"<p>Use this when your program receives a finite set of commands and each command has its own payload.</p> <pre><code>enum Command:\n    Create(str, str)         # (name, content)\n    Update(int, str)         # (id, new_content)\n    Delete(int)              # id\n    List\n\ndef execute(cmd: Command) -&gt; Result[str, str]:\n    match cmd:\n        Create(name, content) =&gt;\n            return create_item(name, content)\n        Update(id, content) =&gt;\n            return update_item(id, content)\n        Delete(id) =&gt;\n            return delete_item(id)\n        List =&gt;\n            return Ok(list_items())\n</code></pre> <p>Tips:</p> <ul> <li>Keep the payload minimal; prefer IDs over large embedded objects if you can look them up.</li> <li>If the set of commands is open-ended (plugins), consider a trait-based approach instead.   See: Traits as language hooks (open-ended \u201cinterfaces\u201d via <code>trait</code>).</li> </ul>"},{"location":"language/how-to/modeling_with_enums/#pattern-3-error-hierarchies","title":"Pattern 3: Error hierarchies","text":"<p>Use this when you want rich, typed errors but still keep exhaustiveness and structure.</p> <pre><code>enum DatabaseError:\n    ConnectionFailed(str)\n    QueryFailed(str, int)    # (query, error_code)\n    NotFound(str)            # table/record name\n    PermissionDenied\n\nenum AppError:\n    Database(DatabaseError)  # Nested enum\n    Validation(str)\n    NotAuthenticated\n\ndef handle_error(err: AppError) -&gt; str:\n    match err:\n        Database(db_err) =&gt;\n            match db_err:\n                ConnectionFailed(host) =&gt; return f\"Can't reach {host}\"\n                QueryFailed(q, code) =&gt; return f\"Query error {code}: {q}\"\n                NotFound(name) =&gt; return f\"Not found: {name}\"\n                PermissionDenied =&gt; return \"Access denied\"\n        Validation(msg) =&gt; return f\"Invalid: {msg}\"\n        NotAuthenticated =&gt; return \"Please log in\"\n</code></pre> <p>Tips:</p> <ul> <li>Keep \u201cleaf\u201d errors close to the layer that produces them (e.g. database layer).</li> <li>Wrap/translate into an app-level enum at boundaries so the rest of the app doesn\u2019t depend on lower-level details.</li> </ul>"},{"location":"language/how-to/modeling_with_enums/#pattern-4-expression-trees-asts","title":"Pattern 4: Expression trees (ASTs)","text":"<p>Use this when you want to represent recursive structure (expressions, queries, filters) and interpret/transform it.</p> <pre><code>enum Expr:\n    Number(int)\n    Add(Expr, Expr)\n    Mul(Expr, Expr)\n    Neg(Expr)\n\ndef eval(expr: Expr) -&gt; int:\n    match expr:\n        Number(n) =&gt; return n\n        Add(a, b) =&gt; return eval(a) + eval(b)\n        Mul(a, b) =&gt; return eval(a) * eval(b)\n        Neg(e) =&gt; return -eval(e)\n\n# (3 + 4) * -2 = -14\nexpr = Expr.Mul(\n    Expr.Add(Expr.Number(3), Expr.Number(4)),\n    Expr.Neg(Expr.Number(2)),\n)\nresult = eval(expr)  # -14\n</code></pre> <p>Tips:</p> <ul> <li>Prefer small, composable constructors.</li> <li>Use helper functions to build trees if you want a cleaner \u201cbuilder\u201d API.</li> </ul>"},{"location":"language/how-to/modeling_with_enums/#see-also","title":"See also","text":"<ul> <li>Enums (concepts)</li> <li>Error handling</li> </ul>"},{"location":"language/how-to/performance/","title":"Performance","text":"<p>This page is a practical guide to profiling and improving the performance of your Incan programs.</p> <p>Repository benchmark suite details (and profiling the compiler) live in Benchmarks &amp; profiling (repository).</p>"},{"location":"language/how-to/performance/#what-to-expect","title":"What to expect","text":"<p>Incan compiles to Rust and then to a native binary. Runtime performance can be close to Rust for many workloads, but it depends on current codegen and library behavior.</p> <p>Two implications:</p> <ul> <li>Builds can be slower than a single-step native compiler (Incan \u2192 Rust \u2192 binary).</li> <li>Performance is explainable: when in doubt, inspect the generated Rust and profile the produced binary.</li> </ul>"},{"location":"language/how-to/performance/#profile-your-program","title":"Profile your program","text":""},{"location":"language/how-to/performance/#build-a-release-binary-generated-project","title":"Build a release binary (generated project)","text":"<pre><code>incan build myprogram.incn\n</code></pre>"},{"location":"language/how-to/performance/#profile-on-macos-instruments","title":"Profile on macOS (Instruments)","text":"<pre><code>xcrun xctrace record --template \"Time Profiler\" \\\n  --launch ./target/incan/myprogram/target/release/myprogram\n</code></pre>"},{"location":"language/how-to/performance/#profile-on-linux-perf","title":"Profile on Linux (perf)","text":"<pre><code>perf record ./target/incan/myprogram/target/release/myprogram\nperf report\n</code></pre>"},{"location":"language/how-to/performance/#optimization-tips-practical","title":"Optimization tips (practical)","text":"<ul> <li>Prefer the canonical build: <code>incan build file.incn</code> (builds the generated Rust project in release mode today).</li> <li>Avoid unnecessary clones: the code generator tries to avoid extra copying, but explicit <code>.clone()</code> in source   will be preserved.</li> <li>Prefer iterator-style code: list comprehensions compile to iterator chains.</li> <li>Inspect generated Rust: use <code>incan --emit-rust file.incn</code> when you\u2019re not sure what the compiler is emitting.</li> </ul>"},{"location":"language/how-to/rust_interop/","title":"Rust Interoperability","text":"<p>Incan compiles to Rust, which means you can import from Rust crates and interoperate with Rust types.</p>"},{"location":"language/how-to/rust_interop/#importing-rust-crates","title":"Importing Rust Crates","text":"<p>Use the <code>rust::</code> prefix to import from Rust crates:</p> <pre><code># Import entire crate\nimport rust::serde_json as json\n\n# Import specific items\nfrom rust::time import Instant, Duration\nfrom rust::std::collections import HashMap, HashSet\n\n# Import nested items\nimport rust::serde_json::Value\n</code></pre>"},{"location":"language/how-to/rust_interop/#automatic-dependency-management","title":"Automatic Dependency Management","text":"<p>When you use <code>import rust::crate_name</code>, Incan automatically adds the dependency to your generated <code>Cargo.toml</code>.</p> <p>For the bigger picture, see: Projects today.</p>"},{"location":"language/how-to/rust_interop/#strict-dependency-policy","title":"Strict Dependency Policy","text":"<p>Incan uses a strict dependency policy to reduce dependency drift and keep builds predictable:</p> <ul> <li>Known-good crates: Curated crates have tested version/feature combinations (see table below)</li> <li>Unknown crates: Currently produce a compiler error (planned: explicit versions and project config)</li> </ul> <p>This policy prevents \"works on my machine\" issues caused by wildcard (<code>*</code>) dependencies that resolve to different versions at different times.</p>"},{"location":"language/how-to/rust_interop/#known-good-crates","title":"Known-Good Crates","text":"<p>The following crates have pre-configured versions with appropriate features:</p> Crate Version Features serde 1.0 derive serde_json 1.0 - tokio 1 rt-multi-thread, macros, time, sync time 0.3 formatting, macros chrono 0.4 serde reqwest 0.11 json uuid 1.0 v4, serde rand 0.8 - regex 1.0 - anyhow 1.0 - thiserror 1.0 - tracing 0.1 - clap 4.0 derive log 0.4 - env_logger 0.10 - sqlx 0.7 runtime-tokio-native-tls, postgres futures 0.3 - bytes 1.0 - itertools 0.12 -"},{"location":"language/how-to/rust_interop/#using-unknown-crates","title":"Using Unknown Crates","text":"<p>Current behavior: If you try to import a crate not in the known-good list, you'll see an error:</p> <pre><code>Error: unknown Rust crate `my_crate`: no known-good version mapping exists.\n\nTo use this crate today, request that `my_crate` be added to the known-good list by opening an issue/PR.\n</code></pre> <p>Why so strict? Implicit wildcard (<code>*</code>) dependencies can cause \u201cworks on my machine\u201d failures when crate versions change. This policy will evolve\u2014RFC 013 proposes inline version annotations, <code>incan.toml</code> project configuration, and lock files for full flexibility.</p> <p>Current workarounds:</p> <ol> <li>Open an issue/PR to add the crate to the known-good list</li> <li>(Temporary) Manually edit the generated <code>Cargo.toml</code> to add your dependency</li> </ol>"},{"location":"language/how-to/rust_interop/#adding-to-the-known-good-list","title":"Adding to the Known-Good List","text":"<p>If you'd like a crate added to the known-good list:</p> <ol> <li>Open an issue or PR on the Incan repository</li> <li>Include the crate name, recommended version, and any required features</li> <li>Explain why this crate is commonly useful</li> </ol> <p>The maintainers will test the crate and add it to <code>src/backend/project.rs</code>.</p>"},{"location":"language/how-to/rust_interop/#coming-soon-version-annotations-and-incantoml","title":"Coming Soon: Version Annotations and <code>incan.toml</code>","text":"<p>RFC 013 defines a comprehensive dependency system that will allow:</p> <pre><code># Inline version annotations (planned)\nimport rust::my_crate @ \"1.0\"\nimport rust::tokio @ \"1.35\" with [\"full\"]\n</code></pre> <pre><code># incan.toml project configuration (planned)\n[project]\nname = \"my_app\"\nversion = \"0.1.0\"\n\n[rust.dependencies]\nmy_crate = \"1.0\"\ntokio = { version = \"1.35\", features = [\"full\"] }\n</code></pre> <p>This will enable any Rust crate while maintaining reproducibility.</p>"},{"location":"language/how-to/rust_interop/#examples","title":"Examples","text":""},{"location":"language/how-to/rust_interop/#working-with-json-serde_json","title":"Working with JSON (serde_json)","text":"<pre><code>import rust::serde_json as json\nfrom rust::serde_json import Value\n\ndef parse_json(data: str) -&gt; Value:\n    return json.from_str(data).unwrap()\n\ndef main() -&gt; None:\n    data = '{\"name\": \"Alice\", \"age\": 30}'\n    parsed = parse_json(data)\n    println(f\"Name: {parsed['name']}\")\n</code></pre>"},{"location":"language/how-to/rust_interop/#working-with-time","title":"Working with Time","text":"<pre><code>from rust::time import Instant, Duration\n\ndef measure_operation() -&gt; None:\n    start = Instant.now()\n\n    # Do some work\n    for i in range(1000000):\n        pass\n\n    elapsed = start.elapsed()\n    println(f\"Operation took: {elapsed}\")\n</code></pre>"},{"location":"language/how-to/rust_interop/#http-requests-reqwest","title":"HTTP Requests (reqwest)","text":"<pre><code>import rust::reqwest\n\nasync def fetch_data(url: str) -&gt; str:\n    response = await reqwest.get(url)\n    return await response.text()\n\nasync def main() -&gt; None:\n    data = await fetch_data(\"https://api.example.com/data\")\n    println(data)\n</code></pre>"},{"location":"language/how-to/rust_interop/#using-collections","title":"Using Collections","text":"<pre><code>from rust::std::collections import HashMap, HashSet\n\ndef count_words(text: str) -&gt; HashMap[str, int]:\n    counts = HashMap.new()\n    for word in text.split():\n        count = counts.get(word).unwrap_or(0)\n        counts.insert(word, count + 1)\n    return counts\n</code></pre>"},{"location":"language/how-to/rust_interop/#random-numbers","title":"Random Numbers","text":"<pre><code>from rust::rand import Rng, thread_rng\n\ndef random_int(min: int, max: int) -&gt; int:\n    rng = thread_rng()\n    return rng.gen_range(min..max)\n\ndef main() -&gt; None:\n    for _ in range(5):\n        println(f\"Random: {random_int(1, 100)}\")\n</code></pre>"},{"location":"language/how-to/rust_interop/#uuids","title":"UUIDs","text":"<pre><code>from rust::uuid import Uuid\n\ndef generate_id() -&gt; str:\n    return Uuid.new_v4().to_string()\n\ndef main() -&gt; None:\n    id = generate_id()\n    println(f\"Generated ID: {id}\")\n</code></pre>"},{"location":"language/how-to/rust_interop/#type-mapping","title":"Type Mapping","text":"<p>Incan types map to Rust types:</p> Incan Rust <code>int</code> <code>i64</code> <code>float</code> <code>f64</code> <code>str</code> <code>String</code> <code>bool</code> <code>bool</code> <code>List[T]</code> <code>Vec&lt;T&gt;</code> <code>Dict[K, V]</code> <code>HashMap&lt;K, V&gt;</code> <code>Set[T]</code> <code>HashSet&lt;T&gt;</code> <code>Option[T]</code> <code>Option&lt;T&gt;</code> <code>Result[T, E]</code> <code>Result&lt;T, E&gt;</code>"},{"location":"language/how-to/rust_interop/#understanding-rust-types-optional","title":"Understanding Rust types (optional)","text":"Coming from Python? <p>If you\u2019re new to Rust types like <code>Vec</code>, <code>HashMap</code>, <code>String</code>, <code>Option</code>, and <code>Result</code>, see Understanding Rust types (coming from Python).</p>"},{"location":"language/how-to/rust_interop/#limitations","title":"Limitations","text":"<ol> <li> <p>Lifetime annotations: Rust's borrow checker and lifetime annotations are not exposed in Incan.     Types that require explicit lifetime management may not work directly.</p> </li> <li> <p>Generic bounds: Complex trait bounds on generic types are simplified.     Some advanced generic patterns may need wrapper functions.</p> </li> <li> <p>Unsafe code: Incan cannot call unsafe Rust functions directly.     If you need unsafe operations, create a safe wrapper in Rust first.</p> </li> <li> <p>Macros: Rust macros are not directly callable. Use the expanded form or a wrapper function.</p> </li> <li> <p>Feature flags: Default features are used for common crates.     For custom feature combinations, edit the generated <code>Cargo.toml</code> manually.</p> </li> </ol>"},{"location":"language/how-to/rust_interop/#best-practices","title":"Best Practices","text":"<ol> <li> <p>Prefer Incan types: Use Incan's built-in types when possible. Use Rust types only when you need specific functionality.</p> </li> <li> <p>Handle Results: Rust crate functions often return <code>Result</code>. Use <code>?</code> or explicit matching:</p> <pre><code>def safe_parse(s: str) -&gt; Result[int, str]:\n    return s.parse()  # Returns Result\n\ndef main() -&gt; None:\n    match safe_parse(\"42\"):\n        case Ok(n):\n            println(f\"Parsed: {n}\")\n        case Err(e):\n            println(f\"Error: {e}\")\n</code></pre> </li> <li> <p>Async compatibility: If using async Rust crates, make sure your Incan functions are also async.</p> </li> <li> <p>Error types: Rust's error types can be complex. Consider using <code>anyhow</code> for simple error handling:</p> <pre><code>from rust::anyhow import Result, Context\n\ndef read_config(path: str) -&gt; Result[Config]:\n    content = fs.read_to_string(path).context(\"Failed to read config\")?\n    return parse_config(content)\n</code></pre> </li> </ol>"},{"location":"language/how-to/rust_interop/#see-also","title":"See Also","text":"<ul> <li>Error Handling - Working with <code>Result</code> types</li> <li>Derives &amp; Traits - Drop trait for custom cleanup</li> <li>File I/O - Reading, writing, and path handling</li> <li>Async Programming - Async/await with Tokio</li> <li>Imports &amp; Modules - Module system, imports, and built-in functions</li> <li>Rust Interop - Using Rust crates directly from Incan</li> <li>Web Framework - Building web apps with Axum</li> </ul>"},{"location":"language/how-to/rust_types_for_python_devs/","title":"Understanding Rust types (coming from Python)","text":"<p>When you use Rust interop (<code>rust::...</code> imports), you\u2019ll sometimes see Rust types in signatures and docs. This page explains the common ones and how they map to Incan.</p>"},{"location":"language/how-to/rust_types_for_python_devs/#quick-mapping","title":"Quick mapping","text":"Rust type Incan mental model Notes <code>Vec[T]</code> <code>List[T]</code> Growable list <code>HashMap[K, V]</code> <code>Dict[K, V]</code> Key/value map <code>HashSet[T]</code> <code>Set[T]</code> Unordered unique items <code>String</code> <code>str</code> Owned string <code>&amp;str</code> <code>str</code> Borrowed string slice \u2014 avoid as an API type in Incan when you can <code>Option[T]</code> <code>Option[T]</code> <code>Some(x)</code> or <code>None</code> <code>Result[T, E]</code> <code>Result[T, E]</code> <code>Ok(x)</code> or <code>Err(e)</code> <code>Instant</code> \u201ctime point\u201d For measuring elapsed time <code>Duration</code> \u201ctime span\u201d Length of time"},{"location":"language/how-to/rust_types_for_python_devs/#dict-vs-hashmap","title":"Dict vs HashMap","text":"<p>In normal Incan code, prefer <code>Dict</code> (and literals like <code>{}</code>).</p> <p>When interoperating with Rust crates, you may encounter <code>HashMap</code> because that\u2019s what Rust APIs return.</p> <pre><code># These are equivalent:\ncounts: Dict[str, int] = {}\ncounts: HashMap[str, int] = HashMap.new()\n</code></pre>"},{"location":"language/how-to/rust_types_for_python_devs/#method-naming-conventions-you-may-see","title":"Method naming conventions you may see","text":"Python habit Rust / interop pattern Notes <code>dict.get(key)</code> <code>map.get(&amp;key)</code> Returns <code>Option</code> <code>dict[key]</code> <code>map[&amp;key]</code> Panics if missing <code>dict.get(key, default)</code> <code>map.get(&amp;key).unwrap_or(default)</code> Default if missing <code>str(x)</code> <code>x.to_string()</code> Convert to string <code>len(x)</code> <code>x.len()</code> Length"},{"location":"language/how-to/rust_types_for_python_devs/#option-and-result-unwrap-like-patterns","title":"Option and Result: unwrap-like patterns","text":"<p>Rust APIs often return <code>Option</code>/<code>Result</code> instead of raising exceptions.</p> <p><code>unwrap()</code> is a \u201cthis must exist\u201d assertion (it panics if missing), so prefer <code>unwrap_or(...)</code> or <code>match</code> when the value can be absent.</p> <pre><code>value = my_dict.get(\"key\").unwrap_or(0)\n\nmatch my_dict.get(\"key\"):\n    case Some(v): println(v)\n    case None: println(\"missing\")\n</code></pre>"},{"location":"language/how-to/rust_types_for_python_devs/#see-also","title":"See also","text":"<ul> <li>Rust interop (how-to)</li> <li>Error handling (concepts)</li> </ul>"},{"location":"language/how-to/string_processing/","title":"String processing","text":"<p>This page collects practical recipes for working with <code>str</code> and <code>bytes</code>.</p>"},{"location":"language/how-to/string_processing/#split-and-index-safely","title":"Split and index safely","text":"<pre><code>line = \"alice,30,engineer\"\nparts = line.split(\",\")\n\nname = parts[0]\nage = parts[1]\nrole = parts[2]\n</code></pre> <p>Note: Indexing panics if out of range. If you need fallible parsing, validate the length before indexing (or use a <code>Result</code>-returning helper function).</p>"},{"location":"language/how-to/string_processing/#build-strings","title":"Build strings","text":"<pre><code>words = [\"hello\", \"world\"]\nsentence = \" \".join(words)\nprintln(sentence.upper())  # HELLO WORLD\n</code></pre>"},{"location":"language/how-to/string_processing/#clean-input","title":"Clean input","text":"<pre><code>raw_input = \"  user@example.com  \"\nemail = raw_input.strip().lower()\nprintln(email)  # user@example.com\n</code></pre>"},{"location":"language/how-to/string_processing/#see-also","title":"See also","text":"<ul> <li>Strings and bytes (Reference)</li> <li>Strings and formatting (Tutorial)</li> <li>File I/O (How-to)</li> </ul>"},{"location":"language/reference/","title":"Reference","text":"<p>The Reference section is the canonical, stable specification of the Incan Programming Language. It provides precise definitions for grammar, types, semantics, standard library APIs, and runtime behavior.</p> <p>Use this section when:</p> <ul> <li>You need exact syntax or signature details</li> <li>You want behavior clarified without examples</li> <li>You\u2019re verifying compatibility across versions</li> </ul> <p>For step-by-step learning and patterns, see Tutorials and the How-to guides. For practical examples, see the repo\u2019s <code>examples/</code> directory.</p>"},{"location":"language/reference/#table-of-contents","title":"Table of contents","text":"<ul> <li>Language reference (generated): compiler-generated tables (keywords, operators, builtins, etc.)</li> <li>Glossary: canonical terminology used across the docs</li> <li>Imports and modules: import syntax, module paths, and module resolution rules</li> <li>Numeric semantics: numeric operators, promotion rules, and edge cases</li> <li>Strings: string types, formatting, and string operations</li> <li>Derives &amp; traits: how derives and traits fit together</li> <li>Derives:<ul> <li>String representation: <code>Debug</code>, <code>Display</code></li> <li>Comparison: <code>Eq</code>, <code>Ord</code>, <code>Hash</code></li> <li>Copying/default: <code>Clone</code>, <code>Copy</code>, <code>Default</code></li> <li>Serialization: <code>Serialize</code>, <code>Deserialize</code></li> <li>Custom behavior: overriding derived behavior</li> </ul> </li> </ul>"},{"location":"language/reference/derives_and_traits/","title":"Derives and Traits","text":"<p>This page is a Reference for Incan derives, dunder overrides, and trait authoring. For guided learning, use:</p> <ul> <li>The Incan Book: Traits and derives</li> <li>Error Handling Guide</li> </ul>"},{"location":"language/reference/derives_and_traits/#conflicts-precedence","title":"Conflicts &amp; precedence","text":"<p>Rules that resolve \u201cderive vs dunder\u201d (these are intentional and strict):</p> <ul> <li>Dunder overrides are explicit behavior: if you write a dunder (<code>__str__</code>, <code>__eq__</code>, <code>__lt__</code>, <code>__hash__</code>), that is   the behavior for that capability.</li> <li>Conflicts are errors: you must not combine a dunder with the corresponding <code>@derive(...)</code>.</li> <li>Auto-added traits are the exception: some traits are automatically added to <code>model</code> / <code>class</code> / <code>enum</code> / <code>newtype</code>   (see Automatic derives). You don\u2019t need to spell them out.</li> </ul>"},{"location":"language/reference/derives_and_traits/#automatic-derives","title":"Automatic derives","text":"<p>The compiler automatically adds these derives:</p> Construct Auto-added derives <code>model</code> <code>Debug</code>, <code>Display</code>, <code>Clone</code> <code>class</code> <code>Debug</code>, <code>Display</code>, <code>Clone</code> <code>enum</code> <code>Debug</code>, <code>Display</code>, <code>Clone</code>, <code>Eq</code> <code>newtype</code> <code>Debug</code>, <code>Display</code>, <code>Clone</code> (and <code>Copy</code> if underlying is Copy) <p>Notes:</p> <ul> <li><code>Debug</code> and <code>Display</code> are always available for these constructs.</li> <li><code>Display</code> has a default representation (like Python\u2019s default <code>__str__</code>) unless you define <code>__str__</code>.</li> </ul>"},{"location":"language/reference/derives_and_traits/#derive-catalog-quick-index","title":"Derive catalog (quick index)","text":"<p>Only the items usable in <code>@derive(...)</code> are derives:</p> Derive Capability Override Notes Debug Debug formatting (<code>{:?}</code>) \u2014 Auto-added Display Display formatting (<code>{}</code>) <code>__str__</code> Auto-added Eq <code>==</code> / <code>!=</code> <code>__eq__</code> Conflicts are errors Ord Ordering + <code>sorted(...)</code> <code>__lt__</code> Conflicts are errors Hash <code>Set</code> / <code>Dict</code> keys <code>__hash__</code> Conflicts are errors Clone <code>.clone()</code> \u2014 Auto-added Copy Implicit copy \u2014 Marker trait Default <code>Type.default()</code> \u2014 Baseline constructor Serialize JSON stringify \u2014 <code>json_stringify(value)</code> Deserialize JSON parse \u2014 <code>T.from_json(str)</code> <p>Detailed pages:</p> <p>Derives:</p> <ul> <li>String representation</li> <li>Comparison</li> <li>Copying/default</li> <li>Serialization</li> <li>Custom behavior</li> </ul> <p>Stdlib traits:</p> <ul> <li>Overview</li> <li>Collection protocols</li> <li>Indexing and slicing</li> <li>Callable objects</li> <li>Operator traits</li> <li>Conversion traits</li> </ul>"},{"location":"language/reference/derives_and_traits/#derive-dependencies-and-requirements","title":"Derive dependencies and requirements","text":"<p>Some derives imply prerequisite derives (the compiler adds them automatically):</p> If you request Compiler also adds <code>Eq</code> <code>PartialEq</code> <code>Ord</code> <code>Eq</code>, <code>PartialEq</code>, <code>PartialOrd</code> <p>Semantic requirements (not \u201cauto-added\u201d):</p> <ul> <li>If you derive <code>Hash</code>, you almost always also want <code>Eq</code>. Prefer <code>@derive(Eq, Hash)</code>.</li> <li>If you provide custom equality via <code>__eq__</code>, your hashing (derived or custom) must remain consistent.</li> </ul>"},{"location":"language/reference/derives_and_traits/#common-compiler-diagnostics","title":"Common compiler diagnostics","text":""},{"location":"language/reference/derives_and_traits/#unknown-derive","title":"Unknown derive","text":"<pre><code>@derive(Debg)  # Typo\nmodel User:\n    name: str\n</code></pre> <p>Expected: \u201cunknown derive\u201d with a list of valid derive names.</p>"},{"location":"language/reference/derives_and_traits/#deriving-a-non-trait","title":"Deriving a non-trait","text":"<pre><code>model User:\n    name: str\n\n@derive(User)  # wrong: User is a model, not a derive/trait\nmodel Admin:\n    level: int\n</code></pre> <p>Expected: \u201ccannot derive a model/class\u201d with a hint to use <code>with TraitName</code> for trait implementations.</p>"},{"location":"language/reference/derives_and_traits/#traits-authoring","title":"Traits (authoring)","text":"<p>Traits define reusable capabilities. You opt in with <code>with TraitName</code>. Methods can be required (<code>...</code>) or have defaults.</p> <pre><code>trait Describable:\n    def describe(self) -&gt; str:\n        return \"An object\"\n\nclass Product with Describable:\n    name: str\n\ndef main() -&gt; None:\n    p = Product(name=\"Laptop\")\n    println(p.describe())\n</code></pre> <p>See also: Traits (authoring).</p>"},{"location":"language/reference/derives_and_traits/#debug-automatic","title":"Debug (Automatic)","text":"<p>Format: <code>{value:?}</code> (Debug)</p> <p>Override: not supported (Debug is compiler-generated).</p> <pre><code>model Point:\n    x: int\n    y: int\n\ndef main() -&gt; None:\n    p = Point(x=10, y=20)\n    println(f\"{p:?}\")  # Point { x: 10, y: 20 }\n</code></pre>"},{"location":"language/reference/derives_and_traits/#display-custom-with-__str__","title":"Display (Custom with <code>__str__</code>)","text":"<p>Format: <code>{value}</code> (Display)</p> <p>Default behavior: custom types have a default Display representation.</p> <p>Custom behavior: define <code>__str__(self) -&gt; str</code>.</p> <p>Conflict rule: if you define <code>__str__</code>, you must not also <code>@derive(Display)</code>.</p> <pre><code>model User:\n    name: str\n    email: str\n\n    def __str__(self) -&gt; str:\n        return f\"{self.name} &lt;{self.email}&gt;\"\n\ndef main() -&gt; None:\n    u = User(name=\"Alice\", email=\"alice@example.com\")\n    println(f\"{u}\")    # Alice &lt;alice@example.com&gt;\n    println(f\"{u:?}\")  # User { name: \"Alice\", email: \"alice@example.com\" }\n</code></pre>"},{"location":"language/reference/derives_and_traits/#eq-equality","title":"Eq (Equality)","text":"<p>What it does: enables <code>==</code> / <code>!=</code>.</p> <p>Custom behavior: define <code>__eq__(self, other: Self) -&gt; bool</code>.</p> <p>Conflict rule: if you define <code>__eq__</code>, you must not also <code>@derive(Eq)</code>.</p> <pre><code>model User:\n    id: int\n    name: str\n\n    def __eq__(self, other: User) -&gt; bool:\n        return self.id == other.id\n</code></pre>"},{"location":"language/reference/derives_and_traits/#ord-ordering","title":"Ord (ordering)","text":"<p>What it does: enables ordering operators and <code>sorted(...)</code>.</p> <p>Custom behavior: define <code>__lt__(self, other: Self) -&gt; bool</code>.</p> <p>Conflict rule: if you define <code>__lt__</code>, you must not also <code>@derive(Ord)</code>.</p> <pre><code>model Task:\n    priority: int\n    name: str\n\n    def __lt__(self, other: Task) -&gt; bool:\n        return self.priority &lt; other.priority\n</code></pre>"},{"location":"language/reference/derives_and_traits/#hash","title":"Hash","text":"<p>What it does: enables use as <code>Set</code> members and <code>Dict</code> keys.</p> <p>Custom behavior: define <code>__hash__(self) -&gt; int</code>.</p> <p>Conflict rule: if you define <code>__hash__</code>, you must not also <code>@derive(Hash)</code>.</p> <p>Consistency rule: if <code>a == b</code>, then <code>a.__hash__() == b.__hash__()</code>.</p> <pre><code>@derive(Eq, Hash)\nmodel UserId:\n    id: int\n</code></pre>"},{"location":"language/reference/derives_and_traits/#clone","title":"Clone","text":"<p>What it does: enables <code>.clone()</code> (deep copy).</p> <p>Auto-added for <code>model</code>/<code>class</code>/<code>enum</code>/<code>newtype</code>.</p>"},{"location":"language/reference/derives_and_traits/#copy","title":"Copy","text":"<p>What it does: enables implicit copying (marker trait).</p> <p>Use only for small value types; all fields must be Copy.</p>"},{"location":"language/reference/derives_and_traits/#default","title":"Default","text":"<p>What it does: provides <code>Type.default()</code> baseline construction.</p> <p>Field defaults vs <code>Default</code>:</p> <ul> <li>Field defaults (<code>field: T = expr</code>) are used by normal constructors when omitted.</li> <li><code>@derive(Default)</code> adds <code>Type.default()</code>; it uses field defaults when present, otherwise type defaults.</li> </ul> <p>Constructor rule:</p> <ul> <li>If a field has no default, it must be provided when constructing the type.</li> </ul> <pre><code>@derive(Default)\nmodel Settings:\n    theme: str = \"dark\"\n    font_size: int = 14\n\ndef main() -&gt; None:\n    a = Settings()               # OK: all omitted fields have defaults\n    b = Settings(font_size=16)   # OK\n    c = Settings.default()       # OK\n</code></pre>"},{"location":"language/reference/derives_and_traits/#serialize","title":"Serialize","text":"<p>What it does: enables JSON serialization.</p> <p>API:</p> <ul> <li><code>json_stringify(value)</code> \u2192 <code>str</code></li> </ul> <pre><code>@derive(Serialize)\nmodel User:\n    name: str\n    age: int\n\ndef main() -&gt; None:\n    u = User(name=\"Alice\", age=30)\n    println(json_stringify(u))\n</code></pre>"},{"location":"language/reference/derives_and_traits/#deserialize","title":"Deserialize","text":"<p>What it does: enables JSON parsing into a type.</p> <p>API:</p> <ul> <li><code>T.from_json(input: str)</code> \u2192 <code>Result[T, str]</code></li> </ul> <pre><code>@derive(Deserialize)\nmodel User:\n    name: str\n    age: int\n\ndef main() -&gt; None:\n    result: Result[User, str] = User.from_json(\"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\")\n</code></pre>"},{"location":"language/reference/derives_and_traits/#compiler-errors-reference","title":"Compiler errors (reference)","text":""},{"location":"language/reference/derives_and_traits/#unknown-derive-example","title":"Unknown derive (example)","text":"<pre><code>@derive(Debg)\nmodel User:\n    name: str\n</code></pre> <pre><code>type error: Unknown derive 'Debg'\n</code></pre>"},{"location":"language/reference/derives_and_traits/#deriving-a-non-trait-example","title":"Deriving a non-trait (example)","text":"<pre><code>model User:\n    name: str\n\n@derive(User)\nmodel Admin:\n    email: str\n</code></pre> <pre><code>type error: Cannot derive 'User' - it is a model, not a trait\n</code></pre>"},{"location":"language/reference/derives_and_traits/#reflection-automatic","title":"Reflection (automatic)","text":"<p>Models and classes provide:</p> <ul> <li><code>__fields__() -&gt; List[str]</code></li> <li><code>__class_name__() -&gt; str</code></li> </ul> <pre><code>model User:\n    name: str\n\ndef main() -&gt; None:\n    u = User(name=\"Alice\")\n    println(u.__class_name__())\n    println(u.__fields__())\n</code></pre>"},{"location":"language/reference/file_io/","title":"File I/O reference (Path, File, and IoError)","text":"<p>This page is a reference for the <code>Path</code> and <code>File</code> APIs and the common <code>IoError</code> variants.</p> <p>For task-oriented examples, see File I/O (how-to).</p>"},{"location":"language/reference/file_io/#path-methods-and-properties","title":"Path methods and properties","text":"<pre><code># Create from string\np = Path(\"data/config.toml\")\n\n# Join paths with /\ncfg = Path(\"config\") / \"app.toml\"\n\n# Queries\np.exists()\np.is_file()\np.is_dir()\np.is_absolute()\n\n# Components\np.name\np.stem\np.suffix\np.parent\np.parts\n\n# Derive new paths\np.with_suffix(\".tmp\")\np.with_name(\"summary.txt\")\n</code></pre>"},{"location":"language/reference/file_io/#path-constructors-joins-queries-and-components","title":"Path constructors, joins, queries, and components","text":"API Returns Description <code>Path(s)</code> <code>Path</code> Create a path from a string <code>p / \"child\"</code> <code>Path</code> Join paths <code>p.exists()</code> <code>bool</code> Does this path exist? <code>p.is_file()</code> <code>bool</code> Is this path a file? <code>p.is_dir()</code> <code>bool</code> Is this path a directory? <code>p.is_absolute()</code> <code>bool</code> Is this an absolute path? <code>p.name</code> <code>str</code> Filename with extension <code>p.stem</code> <code>str</code> Filename without extension <code>p.suffix</code> <code>str</code> File extension (including the dot) <code>p.parent</code> <code>Path</code> Parent directory <code>p.parts</code> <code>list[str]</code> Path components <code>p.with_suffix(s)</code> <code>Path</code> Return a new path with a different suffix <code>p.with_name(name)</code> <code>Path</code> Return a new path with a different filename"},{"location":"language/reference/file_io/#path-io-methods","title":"Path I/O methods","text":"Method Returns Description <code>p.read_text()</code> <code>Result[str, IoError]</code> Read file as string <code>p.read_bytes()</code> <code>Result[bytes, IoError]</code> Read file as bytes <code>p.read_lines()</code> <code>Result[list[str], IoError]</code> Read file as lines <code>p.write_text(s)</code> <code>Result[None, IoError]</code> Write string to file <code>p.write_bytes(b)</code> <code>Result[None, IoError]</code> Write bytes to file <code>p.read_dir()</code> <code>Result[list[Path], IoError]</code> List directory <code>p.glob(pattern)</code> <code>Result[list[Path], IoError]</code> Find matching paths <code>p.mkdir()</code> <code>Result[None, IoError]</code> Create directory <code>p.mkdir_all()</code> <code>Result[None, IoError]</code> Create directories recursively <code>p.remove()</code> <code>Result[None, IoError]</code> Delete file <code>p.rmdir()</code> <code>Result[None, IoError]</code> Delete empty directory <code>p.remove_all()</code> <code>Result[None, IoError]</code> Delete directory tree <code>p.rename(new)</code> <code>Result[None, IoError]</code> Rename/move"},{"location":"language/reference/file_io/#file-methods","title":"File methods","text":"Method Returns Description <code>File.open(p)</code> <code>Result[File, IoError]</code> Open for reading <code>File.create(p)</code> <code>Result[File, IoError]</code> Create/truncate for writing <code>File.open_append(p)</code> <code>Result[File, IoError]</code> Open for appending <code>f.read_all()</code> <code>Result[str, IoError]</code> Read entire file <code>f.lines()</code> <code>Iterator[str]</code> Iterate lines <code>f.write(s)</code> <code>Result[None, IoError]</code> Write string <code>f.write_line(s)</code> <code>Result[None, IoError]</code> Write line with newline"},{"location":"language/reference/file_io/#ioerror","title":"IoError","text":"<p>File operations return <code>Result[T, IoError]</code>. Common error variants:</p> <pre><code>enum IoError:\n    NotFound(path: Path)\n    PermissionDenied(path: Path)\n    AlreadyExists(path: Path)\n    IsDirectory(path: Path)\n    NotDirectory(path: Path)\n    Other(message: str)\n</code></pre>"},{"location":"language/reference/file_io/#raii-automatic-resource-cleanup","title":"RAII: Automatic resource cleanup","text":"<p>Incan uses RAII (Resource Acquisition Is Initialization) for file handles. When a <code>File</code> goes out of scope, it\u2019s automatically closed and flushed.</p>"},{"location":"language/reference/glossary/","title":"Glossary","text":"<p>This page defines common terms used throughout the docs.</p>"},{"location":"language/reference/glossary/#type","title":"Type","text":"<p>A type describes what a value is (for example: <code>int</code>, <code>str</code>, <code>bool</code>) and what operations are valid on it.</p> <p>See also: Language reference (generated).</p>"},{"location":"language/reference/glossary/#function","title":"Function","text":"<p>A function is a named block of code you can call. In Incan:</p> <pre><code>def add(a: int, b: int) -&gt; int:\n    return a + b\n</code></pre>"},{"location":"language/reference/glossary/#module","title":"Module","text":"<p>A module is a <code>.incn</code> file that contains code and definitions (functions, models, constants, etc.).</p>"},{"location":"language/reference/glossary/#import","title":"Import","text":"<p>An import brings definitions from another module into the current file.</p> <p>See:</p> <ul> <li>Explanation: Imports and modules</li> <li>How-to: Imports and modules (how-to)</li> <li>Reference: Imports and modules (reference)</li> </ul>"},{"location":"language/reference/glossary/#result","title":"Result","text":"<p><code>Result[T, E]</code> represents either success (<code>Ok(T)</code>) or failure (<code>Err(E)</code>), and is commonly used for typed error handling.</p> <p>See: Error Handling.</p>"},{"location":"language/reference/glossary/#option","title":"Option","text":"<p><code>Option[T]</code> represents either \u201csome value\u201d (<code>Some(T)</code>) or \u201cno value\u201d (<code>None</code>).</p> <p>See: Error Handling.</p>"},{"location":"language/reference/glossary/#async","title":"Async","text":"<p>Async code lets a program do other work while waiting on I/O (network, disk, timers).</p> <p>See: Async Programming.</p>"},{"location":"language/reference/glossary/#rustup","title":"rustup","text":"<p><code>rustup</code> is the Rust toolchain installer and version manager. It installs <code>rustc</code> and <code>cargo</code>.</p>"},{"location":"language/reference/glossary/#cargo","title":"cargo","text":"<p><code>cargo</code> is Rust\u2019s build tool and package manager. Incan uses Cargo under the hood when building generated Rust projects.</p>"},{"location":"language/reference/glossary/#path","title":"PATH","text":"<p><code>PATH</code> is an environment variable that controls which directories your shell searches for executable commands (like <code>incan</code>).</p>"},{"location":"language/reference/glossary/#make","title":"make","text":"<p><code>make</code> runs Makefile targets. This repository provides canonical commands like <code>make install</code>, <code>make release</code>, and <code>make smoke-test</code>.</p>"},{"location":"language/reference/glossary/#crate","title":"crate","text":"<p>In these docs, \u201ccrate\u201d is used in the Rust sense (\u201ca compiled unit/package\u201d) and sometimes as shorthand for \u201cthe project/module root\u201d. See: Imports and modules.</p>"},{"location":"language/reference/imports_and_modules/","title":"Imports and modules (reference)","text":"<p>This page is the reference for import syntax, path rules, and prelude contents.</p> <p>If you want the conceptual overview, see: Imports and modules.</p>"},{"location":"language/reference/imports_and_modules/#import-syntax","title":"Import syntax","text":"<p>Incan supports two styles that can be mixed freely.</p>"},{"location":"language/reference/imports_and_modules/#python-style-from-module-import","title":"Python-style: <code>from module import ...</code>","text":"<pre><code># Import multiple items at once\nfrom models import User, Product, Order\n\n# Import with aliases\nfrom utils import format_currency as fmt, validate_email as check_email\n</code></pre>"},{"location":"language/reference/imports_and_modules/#rust-style-import-moduleitem","title":"Rust-style: <code>import module::item</code>","text":"<pre><code># Import a specific item\nimport models::User\n\n# Import with an alias\nimport utils::format_currency as fmt\n</code></pre>"},{"location":"language/reference/imports_and_modules/#import-path-rules","title":"Import path rules","text":""},{"location":"language/reference/imports_and_modules/#child-directory-imports","title":"Child directory imports","text":"<p>You can use dots (Python-style) or <code>::</code> (Rust-style):</p> <pre><code># Python-style: dots for nested paths\nfrom db.models import User, Product\n\n# Rust-style: :: for nested paths\nimport db::models::User\n</code></pre>"},{"location":"language/reference/imports_and_modules/#parent-directory-imports","title":"Parent directory imports","text":"<p>Navigate to parent directories using <code>..</code> (Python-style) or <code>super</code> (Rust-style):</p> <pre><code># Python-style: .. for parent\nfrom ..common import Logger\nfrom ...shared.utils import format_date\n\n# Rust-style: super keyword\nimport super::common::Logger\nimport super::super::shared::utils::format_date\n</code></pre> Prefix Meaning <code>..</code> or <code>super::</code> Parent directory (one level up) <code>...</code> or <code>super::super::</code> Grandparent directory (two levels up)"},{"location":"language/reference/imports_and_modules/#absolute-imports-project-root","title":"Absolute imports (project root)","text":"<p>Import from the project root using <code>crate</code>:</p> <pre><code>from crate.config import Settings\nimport crate::lib::database::Connection\n</code></pre> <p>The compiler finds the project root by looking for <code>Cargo.toml</code> or a <code>src/</code> directory.</p>"},{"location":"language/reference/imports_and_modules/#path-summary","title":"Path summary","text":"Incan path Meaning Rust equivalent <code>models</code> Same directory <code>models</code> <code>db.models</code> Child <code>db/models.incn</code> <code>db::models</code> <code>..common</code> Parent\u2019s <code>common.incn</code> <code>super::common</code> <code>super::utils</code> Parent\u2019s <code>utils.incn</code> <code>super::utils</code> <code>crate.config</code> Root\u2019s <code>config.incn</code> <code>crate::config</code>"},{"location":"language/reference/imports_and_modules/#the-prelude","title":"The prelude","text":"<p>The prelude is a set of types and traits automatically available in every Incan file without explicit imports.</p>"},{"location":"language/reference/imports_and_modules/#types-always-available","title":"Types always available","text":"Incan type Rust type Description <code>int</code> <code>i64</code> 64-bit signed integer <code>float</code> <code>f64</code> 64-bit floating point <code>bool</code> <code>bool</code> Boolean <code>str</code> <code>String</code> UTF-8 string <code>bytes</code> <code>Vec&lt;u8&gt;</code> Byte array <code>List[T]</code> <code>Vec&lt;T&gt;</code> Dynamic array <code>Dict[K, V]</code> <code>HashMap&lt;K, V&gt;</code> Hash map <code>Set[T]</code> <code>HashSet&lt;T&gt;</code> Hash set <code>Option[T]</code> <code>Option&lt;T&gt;</code> Optional value (Some/None) <code>Result[T, E]</code> <code>Result&lt;T, E&gt;</code> Success or error (Ok/Err)"},{"location":"language/reference/imports_and_modules/#type-aliases-and-naming-conventions","title":"Type aliases and naming conventions","text":"<p>Many types have a canonical (generated-reference) name and a lowercase alias used in examples:</p> <ul> <li>Canonical: <code>List[T]</code>, <code>Dict[K, V]</code>, <code>Set[T]</code></li> <li>Aliases: <code>list[T]</code>, <code>dict[K, V]</code>, <code>set[T]</code></li> </ul> <p>The generated language reference shows the canonical name and aliases in one place: Language reference (generated).</p>"},{"location":"language/reference/imports_and_modules/#built-in-functions-always-available","title":"Built-in functions (always available)","text":"<pre><code># Output\nprintln(value)      # Print with newline\nprint(value)        # Print without newline\n\n# Collections\nlen(collection)     # Get length\n\n# Iteration\nrange(n)            # Iterator 0..n\nrange(start, end)   # Iterator start..end\nrange(start, end, step)  # Iterator start..end with a custom step (Python-like)\nrange(start..end)   # Iterator start..end (Rust-style range literal)\nrange(start..=end)  # Iterator start..=end (inclusive end)\nenumerate(iter)     # Iterator with indices\nzip(iter1, iter2)   # Pair up two iterators\n\n# Type conversion (Python-like)\ndict()              # Empty Dict\ndict(mapping)       # Convert to Dict\nlist()              # Empty List\nlist(iterable)      # Convert to List\nset()               # Empty Set\nset(iterable)       # Convert to Set\n</code></pre>"},{"location":"language/reference/imports_and_modules/#special-import-import-this","title":"Special import: <code>import this</code>","text":"<p><code>import this</code> is always available and prints the Incan \u201cZen\u201d design principles when imported:</p> <pre><code>incan run -c \"import this\"\n</code></pre>"},{"location":"language/reference/imports_and_modules/#standard-library-math","title":"Standard library: <code>math</code>","text":"<p>You must import <code>math</code> before use:</p> <pre><code>import math\n\ndef main() -&gt; None:\n    println(f\"pi={math.pi}\")\n</code></pre>"},{"location":"language/reference/imports_and_modules/#available-constants","title":"Available constants","text":"Constant Description <code>math.pi</code> \u03c0 (3.14159...) <code>math.e</code> Euler\u2019s number (2.71828...) <code>math.tau</code> \u03c4 = 2\u03c0 (6.28318...) <code>math.inf</code> Positive infinity <code>math.nan</code> Not a Number"},{"location":"language/reference/imports_and_modules/#available-functions","title":"Available functions","text":"Function Description <code>math.sqrt(x)</code> Square root <code>math.abs(x)</code> Absolute value <code>math.floor(x)</code> Largest integer \u2264 x <code>math.ceil(x)</code> Smallest integer \u2265 x <code>math.round(x)</code> Round to nearest integer <code>math.pow(x, y)</code> x raised to power y <code>math.exp(x)</code> e^x <code>math.log(x)</code> Natural logarithm (ln) <code>math.log10(x)</code> Base-10 logarithm <code>math.log2(x)</code> Base-2 logarithm <code>math.sin(x)</code>, <code>math.cos(x)</code>, <code>math.tan(x)</code> Trig (radians) <code>math.asin(x)</code>, <code>math.acos(x)</code>, <code>math.atan(x)</code> Inverse trig <code>math.sinh(x)</code>, <code>math.cosh(x)</code>, <code>math.tanh(x)</code> Hyperbolic <code>math.atan2(y, x)</code> Two-argument arctangent <code>math.hypot(x, y)</code> Euclidean distance \u221a(x\u00b2 + y\u00b2)"},{"location":"language/reference/imports_and_modules/#rust-standard-library-access","title":"Rust standard library access","text":"<p>Incan can import from Rust\u2019s standard library:</p> <pre><code>import std::fs\nimport std::env\nimport std::path::Path\nimport std::time\n</code></pre> <p>Note: using these requires understanding the underlying Rust types. Prefer Incan built-ins (<code>read_file</code>, <code>write_file</code>, etc.) where available.</p>"},{"location":"language/reference/imports_and_modules/#current-status-and-limitations","title":"Current status and limitations","text":"<p>Supported:</p> <ul> <li>Python-style imports: <code>from module import item1, item2</code></li> <li>Rust-style imports: <code>import module::item</code></li> <li>Nested paths</li> <li>Parent navigation (<code>..</code> / <code>super</code>)</li> <li>Root imports (<code>crate</code>)</li> <li>Aliases (<code>as</code>)</li> </ul> <p>Limitations (current):</p> <ol> <li>No wildcard imports (<code>from module import *</code>)</li> <li>No re-exports (cannot re-export imported items)</li> <li>No circular imports</li> </ol>"},{"location":"language/reference/language/","title":"Incan language reference","text":"<p>Generated file</p> <p>Do not edit this page by hand. If it looks wrong/outdated, regenerate it from source and commit the result.</p> <p>Regenerate with: <code>cargo run -p incan_core --bin generate_lang_reference</code></p>"},{"location":"language/reference/language/#contents","title":"Contents","text":"<ul> <li>Keywords</li> <li>Builtin exceptions</li> <li>Builtin functions</li> <li>Derives</li> <li>Operators</li> <li>Punctuation</li> <li>Builtin types</li> <li>Surface constructors</li> <li>Surface functions</li> <li>Surface math</li> <li>Surface string methods</li> <li>Surface types</li> <li>Surface methods</li> </ul>"},{"location":"language/reference/language/#keywords","title":"Keywords","text":"Id Canonical Aliases Category Usage RFC Since Stability If <code>if</code> ControlFlow Statement, Expression RFC 000 Stable Else <code>else</code> ControlFlow Statement RFC 000 Stable Elif <code>elif</code> ControlFlow Statement RFC 000 Stable Match <code>match</code> ControlFlow Statement, Expression RFC 000 Stable Case <code>case</code> ControlFlow Statement RFC 000 Stable While <code>while</code> ControlFlow Statement RFC 000 Stable For <code>for</code> ControlFlow Statement RFC 000 Stable Break <code>break</code> ControlFlow Statement RFC 000 Stable Continue <code>continue</code> ControlFlow Statement RFC 000 Stable Return <code>return</code> ControlFlow Statement RFC 000 Stable Yield <code>yield</code> ControlFlow Statement, Expression RFC 001 Stable Pass <code>pass</code> ControlFlow Statement RFC 000 Stable Def <code>def</code> <code>fn</code> Definition Statement RFC 000 Stable Async <code>async</code> Definition Modifier RFC 000 Stable Await <code>await</code> Definition Expression RFC 000 Stable Class <code>class</code> Definition Statement RFC 000 Stable Model <code>model</code> Definition Statement RFC 000 Stable Trait <code>trait</code> Definition Statement RFC 000 Stable Enum <code>enum</code> Definition Statement RFC 000 Stable Type <code>type</code> Definition Statement RFC 000 Stable Newtype <code>newtype</code> Definition Statement RFC 000 Stable With <code>with</code> Definition Modifier RFC 000 Stable Extends <code>extends</code> Definition Modifier RFC 000 Stable Pub <code>pub</code> Definition Modifier RFC 000 Stable Import <code>import</code> Import Statement RFC 000 Stable From <code>from</code> Import Statement RFC 000 Stable As <code>as</code> Import Modifier RFC 000 Stable Rust <code>rust</code> Import Modifier RFC 005 Stable Python <code>python</code> Import Modifier RFC 000 Stable Super <code>super</code> Import Expression RFC 000 Stable Crate <code>crate</code> Import Expression RFC 005 Stable Const <code>const</code> Binding Statement RFC 008 Stable Let <code>let</code> Binding Statement RFC 000 Stable Mut <code>mut</code> Binding Modifier RFC 000 Stable SelfKw <code>self</code> Binding ReceiverOnly RFC 000 Stable True <code>true</code> <code>True</code> Literal Expression RFC 000 Stable False <code>false</code> <code>False</code> Literal Expression RFC 000 Stable None <code>None</code> Literal Expression RFC 000 Stable And <code>and</code> Operator Operator RFC 000 Stable Or <code>or</code> Operator Operator RFC 000 Stable Not <code>not</code> Operator Operator RFC 000 Stable In <code>in</code> Operator Operator RFC 000 Stable Is <code>is</code> Operator Operator RFC 000 Stable"},{"location":"language/reference/language/#examples","title":"Examples","text":"<p>Only keywords with examples are listed here.</p>"},{"location":"language/reference/language/#builtin-exceptions","title":"Builtin exceptions","text":"Id Canonical Aliases Description RFC Since Stability ValueError <code>ValueError</code> Raised when an operation receives a value of the right type but an invalid value. RFC 000 Stable TypeError <code>TypeError</code> Raised when an operation receives a value of an inappropriate type. RFC 000 Stable ZeroDivisionError <code>ZeroDivisionError</code> Raised when dividing or taking modulo by zero (Python-like numeric semantics). RFC 000 Stable IndexError <code>IndexError</code> Raised when an index is out of bounds (e.g. string/list indexing). RFC 000 Stable KeyError <code>KeyError</code> Raised when a dict key is missing. RFC 000 Stable JsonDecodeError <code>JSONDecodeError</code> Raised when parsing JSON fails (Python-like). RFC 000 Stable"},{"location":"language/reference/language/#examples_1","title":"Examples","text":"<p>Only exceptions with examples are listed here.</p>"},{"location":"language/reference/language/#valueerror","title":"<code>ValueError</code>","text":"<pre><code>def main() -&gt; None:\n    print(\"abc\"[0:3:0])  # step 0\n</code></pre> <p>Panics at runtime with <code>ValueError: slice step cannot be zero</code>.</p> <pre><code>def main() -&gt; None:\n    _ = int(\"abc\")\n</code></pre> <p>Panics at runtime with <code>ValueError: cannot convert 'abc' to int</code>.</p> <pre><code>def main() -&gt; None:\n    _ = float(\"abc\")\n</code></pre> <p>Panics at runtime with <code>ValueError: cannot convert 'abc' to float</code>.</p> <pre><code>def main() -&gt; None:\n    # range step cannot be zero (Python-like)\n    for i in range(0, 5, 0):\n        print(i)\n</code></pre> <p>Panics at runtime with <code>ValueError: range() arg 3 must not be zero</code>.</p>"},{"location":"language/reference/language/#typeerror","title":"<code>TypeError</code>","text":"<pre><code>def main() -&gt; None:\n    # Example: JSON serialization failures (e.g. NaN/Inf) raise TypeError\n    _ = json_stringify(nan)\n</code></pre> <p>Panics at runtime with a <code>TypeError: ... is not JSON serializable</code> message.</p>"},{"location":"language/reference/language/#zerodivisionerror","title":"<code>ZeroDivisionError</code>","text":"<pre><code>def main() -&gt; None:\n    print(1 / 0)\n</code></pre> <p>Panics at runtime with <code>ZeroDivisionError: float division by zero</code>.</p>"},{"location":"language/reference/language/#indexerror","title":"<code>IndexError</code>","text":"<pre><code>def main() -&gt; None:\n    print(\"a\"[99])\n</code></pre> <p>Panics at runtime with <code>IndexError: ...</code>.</p> <pre><code>def main() -&gt; None:\n    xs: list[int] = [1, 2, 3]\n    print(xs[99])\n</code></pre> <p>Panics at runtime with <code>IndexError: index 99 out of range for list of length 3</code>.</p>"},{"location":"language/reference/language/#keyerror","title":"<code>KeyError</code>","text":"<pre><code>def main() -&gt; None:\n    d: Dict[str, int] = {\"a\": 1}\n    print(d[\"b\"])\n</code></pre> <p>Panics at runtime with <code>KeyError: 'b' not found in dict</code>.</p>"},{"location":"language/reference/language/#jsondecodeerror","title":"<code>JsonDecodeError</code>","text":"<pre><code>@derive(Deserialize)\nmodel User:\n    name: str\n\ndef main() -&gt; None:\n    bad: str = \"{\"\n    match User.from_json(bad):\n        case Ok(u): print(u.name)\n        case Err(e): print(e)\n</code></pre> <p><code>from_json</code> returns <code>Result[T, str]</code>; on failure the error string is prefixed with <code>JSONDecodeError: ...</code>.</p>"},{"location":"language/reference/language/#builtin-functions","title":"Builtin functions","text":"Id Canonical Aliases Description RFC Since Stability Print <code>print</code> <code>println</code> Print values to stdout. RFC 000 Stable Len <code>len</code> Return the length of a collection/string. RFC 000 Stable Sum <code>sum</code> Sum a numeric iterable/collection. RFC 000 Stable Str <code>str</code> Convert a value to a string. RFC 000 Stable Int <code>int</code> Convert a value to an integer. RFC 000 Stable Float <code>float</code> Convert a value to a float. RFC 000 Stable Abs <code>abs</code> Absolute value (numeric). RFC 000 Stable Range <code>range</code> Create a range of integers. RFC 000 Stable Enumerate <code>enumerate</code> Enumerate an iterable into (index, value) pairs. RFC 000 Stable Zip <code>zip</code> Zip iterables element-wise into tuples. RFC 000 Stable ReadFile <code>read_file</code> Read a file from disk into a string/bytes. RFC 000 Stable WriteFile <code>write_file</code> Write a string/bytes to a file on disk. RFC 000 Stable JsonStringify <code>json_stringify</code> Serialize a value to JSON. RFC 000 Stable Sleep <code>sleep</code> Sleep for a duration. RFC 000 Stable"},{"location":"language/reference/language/#derives","title":"Derives","text":"Id Canonical Aliases Description RFC Since Stability Debug <code>Debug</code> Derive Rust-style debug formatting. RFC 000 Stable Display <code>Display</code> Derive user-facing string formatting. RFC 000 Stable Eq <code>Eq</code> Derive equality comparisons. RFC 000 Stable Ord <code>Ord</code> Derive ordering comparisons. RFC 000 Stable Hash <code>Hash</code> Derive hashing support (for map/set keys). RFC 000 Stable Clone <code>Clone</code> Derive deep cloning. RFC 000 Stable Copy <code>Copy</code> Derive copy semantics for simple value types. RFC 000 Stable Default <code>Default</code> Derive a default value constructor. RFC 000 Stable Serialize <code>Serialize</code> Derive serialization support (e.g. JSON). RFC 000 Stable Deserialize <code>Deserialize</code> Derive deserialization support (e.g. JSON). RFC 000 Stable"},{"location":"language/reference/language/#operators","title":"Operators","text":""},{"location":"language/reference/language/#notes","title":"Notes","text":"<ul> <li>Precedence: Higher binds tighter (e.g. <code>*</code> &gt; <code>+</code>). Values are relative and must be consistent with the parser.</li> <li>Associativity: How operators of the same precedence group (left-to-right vs right-to-left).</li> <li>Fixity: Whether the operator is used as a prefix unary operator or an infix binary operator.</li> <li>KeywordSpelling: Whether the operator token is spelled as a reserved word (e.g. <code>and</code>, <code>not</code>).</li> </ul> Id Spellings Precedence Associativity Fixity KeywordSpelling RFC Since Stability Plus <code>+</code> 50 Left Infix false RFC 000 Stable Minus <code>-</code> 50 Left Infix false RFC 000 Stable Star <code>*</code> 60 Left Infix false RFC 000 Stable StarStar <code>**</code> 70 Right Infix false RFC 000 Stable Slash <code>/</code> 60 Left Infix false RFC 000 Stable SlashSlash <code>//</code> 60 Left Infix false RFC 000 Stable Percent <code>%</code> 60 Left Infix false RFC 000 Stable EqEq <code>==</code> 40 Left Infix false RFC 000 Stable NotEq <code>!=</code> 40 Left Infix false RFC 000 Stable Lt <code>&lt;</code> 40 Left Infix false RFC 000 Stable LtEq <code>&lt;=</code> 40 Left Infix false RFC 000 Stable Gt <code>&gt;</code> 40 Left Infix false RFC 000 Stable GtEq <code>&gt;=</code> 40 Left Infix false RFC 000 Stable Eq <code>=</code> 10 Left Infix false RFC 000 Stable PlusEq <code>+=</code> 10 Left Infix false RFC 000 Stable MinusEq <code>-=</code> 10 Left Infix false RFC 000 Stable StarEq <code>*=</code> 10 Left Infix false RFC 000 Stable SlashEq <code>/=</code> 10 Left Infix false RFC 000 Stable SlashSlashEq <code>//=</code> 10 Left Infix false RFC 000 Stable PercentEq <code>%=</code> 10 Left Infix false RFC 000 Stable DotDot <code>..</code> 30 Left Infix false RFC 000 Stable DotDotEq <code>..=</code> 30 Left Infix false RFC 000 Stable And <code>and</code> 35 Left Infix true RFC 000 Stable Or <code>or</code> 35 Left Infix true RFC 000 Stable Not <code>not</code> 45 Left Prefix true RFC 000 Stable In <code>in</code> 35 Left Infix true RFC 000 Stable Is <code>is</code> 35 Left Infix true RFC 000 Stable"},{"location":"language/reference/language/#punctuation","title":"Punctuation","text":"Id Canonical Aliases Category RFC Since Stability Comma <code>,</code> Separator RFC 000 Stable Colon <code>:</code> Separator RFC 000 Stable Question <code>?</code> Marker RFC 000 Stable At <code>@</code> Marker RFC 000 Stable Dot <code>.</code> Access RFC 000 Stable ColonColon <code>::</code> Access RFC 000 Stable Arrow <code>-&gt;</code> Arrow RFC 000 Stable FatArrow <code>=&gt;</code> Arrow RFC 000 Stable Ellipsis <code>...</code> Marker RFC 000 Stable LParen <code>(</code> Delimiter RFC 000 Stable RParen <code>)</code> Delimiter RFC 000 Stable LBracket <code>[</code> Delimiter RFC 000 Stable RBracket <code>]</code> Delimiter RFC 000 Stable LBrace <code>{</code> Delimiter RFC 000 Stable RBrace <code>}</code> Delimiter RFC 000 Stable"},{"location":"language/reference/language/#builtin-types","title":"Builtin types","text":""},{"location":"language/reference/language/#string-like","title":"String-like","text":"Id Canonical Aliases Description RFC Since Stability Str <code>str</code> Builtin UTF-8 string type. RFC 000 Stable Bytes <code>bytes</code> Builtin byte buffer type. RFC 000 Stable FrozenStr <code>frozenstr</code> <code>FrozenStr</code> Immutable/const-friendly string type. RFC 009 Stable FrozenBytes <code>frozenbytes</code> <code>FrozenBytes</code> Immutable/const-friendly bytes type. RFC 009 Stable FString <code>fstring</code> <code>FString</code> Formatted string result type. RFC 000 Stable"},{"location":"language/reference/language/#numerics","title":"Numerics","text":"Id Canonical Aliases Description RFC Since Stability Int <code>int</code> <code>i64</code>, <code>i32</code> Builtin signed integer type. RFC 000 Stable Float <code>float</code> <code>f64</code>, <code>f32</code> Builtin floating-point type. RFC 000 Stable Bool <code>bool</code> Builtin boolean type. RFC 000 Stable"},{"location":"language/reference/language/#collections-generic-bases","title":"Collections / generic bases","text":"Id Canonical Aliases Description RFC Since Stability List <code>List</code> <code>list</code> Growable list (generic sequence) type. RFC 000 Stable Dict <code>Dict</code> <code>dict</code>, <code>HashMap</code> Key/value map type. RFC 000 Stable Set <code>Set</code> <code>set</code> Unordered set type. RFC 000 Stable Tuple <code>Tuple</code> <code>tuple</code> Fixed-length heterogeneous tuple type. RFC 000 Stable Option <code>Option</code> <code>option</code> Optional value type (<code>Some</code>/<code>None</code>). RFC 000 Stable Result <code>Result</code> <code>result</code> Result type (<code>Ok</code>/<code>Err</code>). RFC 000 Stable FrozenList <code>FrozenList</code> <code>frozenlist</code> Immutable/const-friendly list type. RFC 009 Stable FrozenDict <code>FrozenDict</code> <code>frozendict</code> Immutable/const-friendly dict type. RFC 009 Stable FrozenSet <code>FrozenSet</code> <code>frozenset</code> Immutable/const-friendly set type. RFC 009 Stable"},{"location":"language/reference/language/#surface-constructors","title":"Surface constructors","text":"Id Canonical Aliases Description RFC Since Stability Ok <code>Ok</code> Construct an <code>Ok(T)</code> variant (Result success). RFC 000 Stable Err <code>Err</code> Construct an <code>Err(E)</code> variant (Result failure). RFC 000 Stable Some <code>Some</code> Construct a <code>Some(T)</code> variant (Option present). RFC 000 Stable None <code>None</code> Construct a <code>None</code> variant (Option absent). RFC 000 Stable"},{"location":"language/reference/language/#surface-functions","title":"Surface functions","text":"Id Canonical Aliases Description RFC Since Stability SleepMs <code>sleep_ms</code> Sleep for N milliseconds. RFC 000 Stable Timeout <code>timeout</code> Run an async operation with a timeout. RFC 000 Stable TimeoutMs <code>timeout_ms</code> Run an async operation with a timeout in milliseconds. RFC 000 Stable SelectTimeout <code>select_timeout</code> Select between futures with a timeout. RFC 000 Stable YieldNow <code>yield_now</code> Yield execution back to the async scheduler. RFC 000 Stable Spawn <code>spawn</code> Spawn an async task. RFC 000 Stable SpawnBlocking <code>spawn_blocking</code> Spawn a blocking task on a dedicated thread pool. RFC 004 Stable Channel <code>channel</code> Create a bounded channel (sender, receiver). RFC 000 Stable UnboundedChannel <code>unbounded_channel</code> Create an unbounded channel (sender, receiver). RFC 000 Stable Oneshot <code>oneshot</code> Create a oneshot channel (sender, receiver). RFC 000 Stable"},{"location":"language/reference/language/#surface-math","title":"Surface math","text":""},{"location":"language/reference/language/#functions","title":"Functions","text":"Id Canonical Aliases Description RFC Since Stability Sqrt <code>sqrt</code> Square root. RFC 000 Stable Abs <code>abs</code> Absolute value. RFC 000 Stable Floor <code>floor</code> Floor (round down). RFC 000 Stable Ceil <code>ceil</code> Ceil (round up). RFC 000 Stable Pow <code>pow</code> Power function. RFC 000 Stable Exp <code>exp</code> Exponentiation (e^x). RFC 000 Stable Log <code>log</code> Natural logarithm. RFC 000 Stable Log10 <code>log10</code> Base-10 logarithm. RFC 000 Stable Log2 <code>log2</code> Base-2 logarithm. RFC 000 Stable Sin <code>sin</code> Sine. RFC 000 Stable Cos <code>cos</code> Cosine. RFC 000 Stable Tan <code>tan</code> Tangent. RFC 000 Stable Asin <code>asin</code> Arcsine. RFC 000 Stable Acos <code>acos</code> Arccosine. RFC 000 Stable Atan <code>atan</code> Arctangent. RFC 000 Stable Sinh <code>sinh</code> Hyperbolic sine. RFC 000 Stable Cosh <code>cosh</code> Hyperbolic cosine. RFC 000 Stable Tanh <code>tanh</code> Hyperbolic tangent. RFC 000 Stable Atan2 <code>atan2</code> Two-argument arctangent. RFC 000 Stable"},{"location":"language/reference/language/#constants","title":"Constants","text":"Id Canonical Aliases Description RFC Since Stability Pi <code>pi</code> The constant \u03c0. RFC 000 Stable E <code>e</code> The constant e. RFC 000 Stable Tau <code>tau</code> The constant \u03c4 (2\u03c0). RFC 000 Stable Inf <code>inf</code> Positive infinity. RFC 000 Stable Nan <code>nan</code> Not a number (NaN). RFC 000 Stable"},{"location":"language/reference/language/#surface-string-methods","title":"Surface string methods","text":"Id Canonical Aliases Description RFC Since Stability Upper <code>upper</code> Convert to uppercase. RFC 009 Stable Lower <code>lower</code> Convert to lowercase. RFC 009 Stable Strip <code>strip</code> Strip leading and trailing whitespace. RFC 009 Stable Replace <code>replace</code> Replace occurrences of a substring. RFC 009 Stable Join <code>join</code> Join an iterable/list of strings with this separator. RFC 009 Stable ToString <code>to_string</code> Return a string representation (identity for strings). RFC 009 Stable SplitWhitespace <code>split_whitespace</code> Split on Unicode whitespace. RFC 009 Stable Split <code>split</code> Split on a separator substring. RFC 009 Stable Contains <code>contains</code> Return true if the substring occurs within the string. RFC 009 Stable StartsWith <code>startswith</code> <code>starts_with</code> Return true if the string starts with a prefix. RFC 009 Stable EndsWith <code>endswith</code> <code>ends_with</code> Return true if the string ends with a suffix. RFC 009 Stable Len <code>len</code> Return the length (in Unicode scalars). RFC 009 Stable IsEmpty <code>is_empty</code> Return true if the length is zero. RFC 009 Stable"},{"location":"language/reference/language/#surface-types","title":"Surface types","text":"Id Canonical Aliases Kind Description RFC Since Stability Mutex <code>Mutex</code> Generic Async/runtime mutex. RFC 000 Stable RwLock <code>RwLock</code> Generic Async/runtime read-write lock. RFC 000 Stable Semaphore <code>Semaphore</code> Named Async/runtime semaphore. RFC 000 Stable Barrier <code>Barrier</code> Named Async/runtime barrier. RFC 000 Stable JoinHandle <code>JoinHandle</code> Generic Handle to a spawned task. RFC 000 Stable Sender <code>Sender</code> Generic Bounded channel sender. RFC 000 Stable Receiver <code>Receiver</code> Generic Bounded channel receiver. RFC 000 Stable UnboundedSender <code>UnboundedSender</code> Generic Unbounded channel sender. RFC 000 Stable UnboundedReceiver <code>UnboundedReceiver</code> Generic Unbounded channel receiver. RFC 000 Stable OneshotSender <code>OneshotSender</code> Generic Oneshot channel sender. RFC 000 Stable OneshotReceiver <code>OneshotReceiver</code> Generic Oneshot channel receiver. RFC 000 Stable Vec <code>Vec</code> Generic Rust interop <code>Vec&lt;T&gt;</code>. RFC 005 Stable HashMap <code>HashMap</code> Generic Rust interop <code>HashMap&lt;K, V&gt;</code>. RFC 005 Stable"},{"location":"language/reference/language/#surface-methods","title":"Surface methods","text":""},{"location":"language/reference/language/#float-methods","title":"float methods","text":"Id Canonical Aliases Description RFC Since Stability Sqrt <code>sqrt</code> Square root. RFC 009 Stable Abs <code>abs</code> Absolute value. RFC 009 Stable Floor <code>floor</code> Round down to the nearest integer (as float). RFC 009 Stable Ceil <code>ceil</code> Round up to the nearest integer (as float). RFC 009 Stable Round <code>round</code> Round to the nearest integer (as float). RFC 009 Stable Sin <code>sin</code> Sine. RFC 009 Stable Cos <code>cos</code> Cosine. RFC 009 Stable Tan <code>tan</code> Tangent. RFC 009 Stable Exp <code>exp</code> Exponentiation (e^x). RFC 009 Stable Ln <code>ln</code> Natural logarithm. RFC 009 Stable Log2 <code>log2</code> Base-2 logarithm. RFC 009 Stable Log10 <code>log10</code> Base-10 logarithm. RFC 009 Stable IsNan <code>is_nan</code> Return true if this value is NaN. RFC 009 Stable IsInfinite <code>is_infinite</code> Return true if this value is \u00b1infinity. RFC 009 Stable IsFinite <code>is_finite</code> Return true if this value is finite. RFC 009 Stable Powi <code>powi</code> Raise to an integer power. RFC 009 Stable Powf <code>powf</code> Raise to a float power. RFC 009 Stable"},{"location":"language/reference/language/#list-methods","title":"List methods","text":"Id Canonical Aliases Description RFC Since Stability Append <code>append</code> Append an element to the end of the list. RFC 009 Stable Pop <code>pop</code> Remove and return the last element. RFC 009 Stable Contains <code>contains</code> Return true if the list contains a value. RFC 009 Stable Swap <code>swap</code> Swap two elements by index. RFC 009 Stable Reserve <code>reserve</code> Reserve capacity for at least N more elements. RFC 009 Stable ReserveExact <code>reserve_exact</code> Reserve capacity for exactly N more elements. RFC 009 Stable Remove <code>remove</code> Remove and return the element at the given index. RFC 009 Stable Count <code>count</code> Count occurrences of a value. RFC 009 Stable Index <code>index</code> Return the index of a value (or error if not found). RFC 009 Stable"},{"location":"language/reference/language/#dict-methods","title":"Dict methods","text":"Id Canonical Aliases Description RFC Since Stability Keys <code>keys</code> Return an iterable/list of keys. RFC 009 Stable Values <code>values</code> Return an iterable/list of values. RFC 009 Stable Get <code>get</code> Get a value by key, optionally with a default. RFC 009 Stable Insert <code>insert</code> Insert or overwrite a key/value pair. RFC 009 Stable"},{"location":"language/reference/language/#set-methods","title":"Set methods","text":"Id Canonical Aliases Description RFC Since Stability Contains <code>contains</code> Return true if the set contains a value. RFC 009 Stable"},{"location":"language/reference/language/#frozenlist-methods","title":"FrozenList methods","text":"Id Canonical Aliases Description RFC Since Stability Len <code>len</code> Return the number of elements. RFC 009 Stable IsEmpty <code>is_empty</code> Return true if the list is empty. RFC 009 Stable"},{"location":"language/reference/language/#frozendict-methods","title":"FrozenDict methods","text":"Id Canonical Aliases Description RFC Since Stability Len <code>len</code> Return the number of entries. RFC 009 Stable IsEmpty <code>is_empty</code> Return true if the dict is empty. RFC 009 Stable ContainsKey <code>contains_key</code> Return true if the dict contains a key. RFC 009 Stable"},{"location":"language/reference/language/#frozenset-methods","title":"FrozenSet methods","text":"Id Canonical Aliases Description RFC Since Stability Len <code>len</code> Return the number of elements. RFC 009 Stable IsEmpty <code>is_empty</code> Return true if the set is empty. RFC 009 Stable Contains <code>contains</code> Return true if the set contains a value. RFC 009 Stable"},{"location":"language/reference/language/#frozenbytes-methods","title":"FrozenBytes methods","text":"Id Canonical Aliases Description RFC Since Stability Len <code>len</code> Return the number of bytes. RFC 009 Stable IsEmpty <code>is_empty</code> Return true if the byte string is empty. RFC 009 Stable"},{"location":"language/reference/numeric_semantics/","title":"Numeric semantics","text":"<p>This page documents the numeric rules Incan implements today (typing + runtime behavior).</p> <p>Incan is statically typed, so numeric operations affect expression types and codegen, not \u201cthe type of a variable over time\u201d.</p> <p>Notes if you\u2019re coming from Python</p> <p>Incan\u2019s numeric intent is often Python-like, but some behavior differs because:</p> <ul> <li>Incan is statically typed (no implicit \u201cvariable becomes float later\u201d).</li> <li>Runtime behavior is produced by generated Rust + <code>incan_stdlib</code> (so IEEE float edge cases apply).</li> </ul> <p>Notes if you\u2019re coming from Rust</p> <p>Some operators intentionally follow Python-style semantics (not Rust\u2019s), notably floor division (<code>//</code>) and modulo (<code>%</code>) for negative numbers.</p>"},{"location":"language/reference/numeric_semantics/#table-of-contents","title":"Table of contents","text":"Section What it covers Supported numeric types <code>int</code>/<code>float</code> and their current Rust representations Numeric promotion rules When expressions promote to <code>float</code> Operator semantics <code>/</code>, <code>//</code>, <code>%</code>, <code>**</code>, comparisons Compound assignments <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, <code>//=</code>, <code>%=</code> typing rules NaN / Infinity IEEE behavior and current limitations"},{"location":"language/reference/numeric_semantics/#supported-numeric-types","title":"Supported numeric types","text":"<p>Today, the compiler uses these Rust representations:</p> <ul> <li><code>int</code>: currently compiled as Rust <code>i64</code>.</li> <li><code>float</code>: currently compiled as Rust <code>f64</code>.</li> </ul>"},{"location":"language/reference/numeric_semantics/#numeric-promotion-rules","title":"Numeric promotion rules","text":"<p>In expressions, operands may be promoted to <code>float</code>:</p> <ul> <li>For arithmetic ops, if either operand is <code>float</code>, the operation is performed in <code>float</code>   (with some operator-specific rules below).</li> <li>For mixed comparisons (<code>int</code> vs <code>float</code>), operands are promoted to <code>float</code> for   comparison.</li> </ul> <p>Promotion affects expression typing and generated code, not variable types.</p>"},{"location":"language/reference/numeric_semantics/#operator-semantics","title":"Operator semantics","text":""},{"location":"language/reference/numeric_semantics/#true-division","title":"<code>/</code> (true division)","text":"<p>Division is always <code>float</code>, even for <code>int / int</code>.</p>"},{"location":"language/reference/numeric_semantics/#returns","title":"Returns (<code>/</code>)","text":"<ul> <li><code>float</code></li> </ul>"},{"location":"language/reference/numeric_semantics/#examples","title":"Examples (<code>/</code>)","text":"<pre><code>1 / 2      # 0.5\n4 / 2      # 2.0\n7.0 / 2    # 3.5\n7 / 2.0    # 3.5\n</code></pre> <p>Python comparison</p> <p>Python raises <code>ZeroDivisionError</code> for division by zero. Incan currently panics at runtime with a <code>ZeroDivisionError: float division by zero</code>-style message.</p>"},{"location":"language/reference/numeric_semantics/#floor-division","title":"<code>//</code> (floor division)","text":"<p>Floor division rounds toward negative infinity.</p>"},{"location":"language/reference/numeric_semantics/#returns_1","title":"Returns (<code>//</code>)","text":"<ul> <li><code>int</code> if both operands are <code>int</code></li> <li>otherwise <code>float</code></li> </ul>"},{"location":"language/reference/numeric_semantics/#examples_1","title":"Examples (<code>//</code>)","text":"<pre><code>7 // 3        # 2\n-7 // 3       # -3\n7 // -3       # -3\n-7 // -3      # 2\n\n7.0 // 3      # 2.0\n-7.0 // 3     # -3.0\n7 // 3.0      # 2.0\n</code></pre> <p>Rust comparison</p> <p>Rust integer division (<code>/</code>) truncates toward zero. Incan <code>//</code> is floor division (toward \\( -\\infty \\)).</p>"},{"location":"language/reference/numeric_semantics/#panics","title":"Panics (<code>//</code>)","text":"<ul> <li>Panics on zero divisor with <code>ZeroDivisionError: float division by zero</code>.</li> </ul>"},{"location":"language/reference/numeric_semantics/#modulo-remainder","title":"<code>%</code> (modulo / remainder)","text":"<p>Modulo uses Python remainder semantics. The remainder has the sign of the divisor and satisfies the following equation:</p> \\[ a = \\left\\lfloor \\frac{a}{b} \\right\\rfloor b + (a \\bmod b) \\] <p>In Incan operator notation: <code>a == (a // b) * b + (a % b)</code></p>"},{"location":"language/reference/numeric_semantics/#returns_2","title":"Returns (<code>%</code>)","text":"<ul> <li><code>int</code> if both operands are <code>int</code></li> <li>otherwise <code>float</code></li> </ul>"},{"location":"language/reference/numeric_semantics/#examples_2","title":"Examples (<code>%</code>)","text":"<pre><code>7 % 3         # 1\n-7 % 3        # 2      (Rust would give -1)\n7 % -3        # -2     (Rust would give 1)\n-7 % -3       # -1\n\n7.0 % 3.0     # 1.0\n-7.0 % 3.0    # 2.0\n7.0 % -3.0    # -2.0\n</code></pre> <p>Rust comparison</p> <p>Rust\u2019s <code>%</code> is a remainder operator with truncating division, so negative cases differ from Incan.</p>"},{"location":"language/reference/numeric_semantics/#panics_1","title":"Panics (<code>%</code>)","text":"<ul> <li>Panics on zero divisor with <code>ZeroDivisionError: float division by zero</code>.</li> </ul>"},{"location":"language/reference/numeric_semantics/#power","title":"<code>**</code> (power)","text":"<p>Power is mostly Python-like, with one deliberate typing rule to keep codegen efficient:</p> <ul> <li><code>int ** int</code> returns <code>int</code> only when the exponent is a non-negative <code>int</code>   literal.</li> <li>In all other cases, the result is <code>float</code>.</li> </ul>"},{"location":"language/reference/numeric_semantics/#returns_3","title":"Returns (<code>**</code>)","text":"<ul> <li><code>int</code> only for <code>int ** &lt;non-negative int literal&gt;</code></li> <li>otherwise <code>float</code></li> </ul>"},{"location":"language/reference/numeric_semantics/#examples_3","title":"Examples (<code>**</code>)","text":"<pre><code>2 ** 3        # 8        (int)\n2 ** 0        # 1        (int)\n2 ** -1       # 0.5      (float)\n\nexp = 3\n2 ** exp      # float (even if exp is int at runtime)\n\n2.0 ** 3      # float\n2 ** 3.0      # float\n</code></pre>"},{"location":"language/reference/numeric_semantics/#notes","title":"Notes","text":"<ul> <li>This is a compile-time rule: we only choose integer exponentiation when we can prove   the exponent is a non-negative integer literal.</li> </ul>"},{"location":"language/reference/numeric_semantics/#comparisons","title":"Comparisons (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>)","text":"<p>Mixed numeric comparisons are allowed:</p> <ul> <li><code>int</code> and <code>float</code> can be compared.</li> <li>Operands are promoted to <code>float</code> for comparison.</li> <li>The result type is <code>bool</code>.</li> </ul>"},{"location":"language/reference/numeric_semantics/#examples-comparisons","title":"Examples (comparisons)","text":"<pre><code>1 == 1.0      # true\n1 &lt; 1.5       # true\n2 &gt;= 2.0      # true\n</code></pre>"},{"location":"language/reference/numeric_semantics/#compound-assignments","title":"Compound assignments","text":"<p>This section covers: <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, <code>//=</code>, <code>%=</code></p> <p>Compound assignment is typechecked as if it were:</p> <pre><code>x &lt;op&gt;= y   \u2248   x = (x &lt;op&gt; y)\n</code></pre> <p>Because variables are statically typed, the result type of <code>(x &lt;op&gt; y)</code> must be assignable back to <code>x</code>.</p>"},{"location":"language/reference/numeric_semantics/#examples-compound-assignments","title":"Examples (compound assignments)","text":"<pre><code>mut x: int = 10\nx += 2        # ok (int)\nx *= 3        # ok (int)\n# x /= 2      # error: (int / int) is float, cannot assign to int\n\nmut y: float = 10.0\ny /= 2        # ok (float)\ny %= 7        # ok (float)\n</code></pre>"},{"location":"language/reference/numeric_semantics/#nan-infinity","title":"NaN / Infinity","text":"<p>This section documents how <code>float</code> behaves today.</p> <p>For <code>float</code>, NaN/Inf behavior follows IEEE/Rust behavior from the generated code and <code>incan_stdlib</code>.</p>"},{"location":"language/reference/numeric_semantics/#examples-naninf","title":"Examples (NaN/Inf)","text":"<pre><code># Conceptual examples; exact behavior depends on IEEE rules.\n#\n# Note: Incan currently panics on division by zero, so these *do not* produce\n# NaN/Inf today:\n# nan = 0.0 / 0.0\n# inf = 1.0 / 0.0\n#\n# NaN/Inf can still appear via Rust interop or other IEEE-producing operations.\npass\n</code></pre> <p>Python comparison</p> <p>Python\u2019s float behavior differs in some edge cases and error behavior (exceptions vs panics).</p>"},{"location":"language/reference/strings/","title":"Strings and bytes","text":"<p>Incan has two core \u201cstring-like\u201d types:</p> <ul> <li><code>str</code>: text (Unicode). The current backend compiles this to Rust <code>String</code>.</li> <li><code>bytes</code>: binary data. The current backend compiles this to Rust <code>Vec&lt;u8&gt;</code>.</li> </ul> <p><code>str</code> is for user-facing text. <code>bytes</code> is for file/network/crypto data where you want raw bytes.</p> <p>Coming from Python?</p> <p>Method names are intentionally familiar (<code>upper</code>, <code>lower</code>, <code>strip</code>, <code>split</code>, <code>replace</code>, \u2026), but Incan is statically typed and <code>contains()</code> is a method (rather than Python\u2019s <code>in</code> operator).</p> <p>Coming from Rust?</p> <p>Incan hides most ownership/borrowing details. You write <code>str</code> and the compiler handles Rust interop details in generated code.</p>"},{"location":"language/reference/strings/#quick-reference","title":"Quick reference","text":"Incan Notes <code>s.upper()</code> Uppercase string <code>s.lower()</code> Lowercase string <code>s.strip()</code> Trim whitespace on both sides <code>s.split(\",\")</code> Split into <code>list[str]</code> <code>\", \".join(xs)</code> Join <code>list[str]</code> with a separator <code>s.contains(\"x\")</code> Substring check (<code>bool</code>) <code>s.replace(\"a\", \"b\")</code> Replace all occurrences"},{"location":"language/reference/strings/#indexing-and-slicing","title":"Indexing and slicing","text":"<p>Incan supports Python-style indexing and slicing for strings and lists.</p> <ul> <li>Indexing: <code>s[i]</code><ul> <li>Supports negative indices (e.g. <code>s[-1]</code> is the last character).</li> <li>Indexing is based on Unicode scalars (Rust <code>char</code>), not bytes.</li> <li>Out-of-range panics with <code>IndexError: string index out of range</code>.</li> </ul> </li> <li>Slicing: <code>s[start:end:step]</code><ul> <li>Each component is optional (e.g. <code>s[:3]</code>, <code>s[1:]</code>, <code>s[::2]</code>, <code>s[::-1]</code>).</li> <li><code>step</code> defaults to <code>1</code>.</li> <li><code>step == 0</code> panics with <code>ValueError: slice step cannot be zero</code>.</li> <li>Negative <code>step</code> is supported (e.g. <code>s[::-1]</code> reverses a string).</li> </ul> </li> </ul> <pre><code>def main() -&gt; None:\n    s = \"h\u00e9llo\"\n    print(s[1])     # \"\u00e9\"\n    print(s[-1])    # \"o\"\n    print(s[1:4])   # \"\u00e9ll\"\n    print(s[::2])   # \"hlo\"\n    print(s[::-1])  # \"oll\u00e9h\"\n</code></pre> <p>The same slicing rules apply to <code>list[T]</code>:</p> <pre><code>def main() -&gt; None:\n    xs: list[int] = [1, 2, 3]\n    for x in xs[::-1]:\n        print(x)\n</code></pre>"},{"location":"language/reference/strings/#common-string-methods","title":"Common string methods","text":""},{"location":"language/reference/strings/#case-conversion","title":"Case conversion","text":"<pre><code>text = \"Hello World\"\nprintln(text.upper())  # HELLO WORLD\nprintln(text.lower())  # hello world\n</code></pre>"},{"location":"language/reference/strings/#whitespace-trimming","title":"Whitespace trimming","text":"<pre><code>padded = \"  hello  \"\nprintln(padded.strip())  # \"hello\"\n</code></pre> <p>Note: Incan currently only has <code>strip()</code> (both sides). Python\u2019s <code>lstrip()</code> / <code>rstrip()</code> are not yet implemented.</p>"},{"location":"language/reference/strings/#splitting-strings","title":"Splitting strings","text":"<pre><code>csv = \"alice,bob,carol\"\nnames = csv.split(\",\")  # [\"alice\", \"bob\", \"carol\"]\n\nfirst = names[0]  # \"alice\"\n</code></pre>"},{"location":"language/reference/strings/#joining-strings","title":"Joining strings","text":"<pre><code>names = [\"alice\", \"bob\", \"carol\"]\nresult = \", \".join(names)  # \"alice, bob, carol\"\n</code></pre> <p>Note: The separator is the receiver and the list is the argument: <code>\", \".join(names)</code>.</p>"},{"location":"language/reference/strings/#substring-check","title":"Substring check","text":"<pre><code>sentence = \"the quick brown fox\"\n\nif sentence.contains(\"quick\"):\n    println(\"Found it!\")\n</code></pre>"},{"location":"language/reference/strings/#string-replacement","title":"String replacement","text":"<pre><code>text = \"hello world\"\nresult = text.replace(\"world\", \"incan\")  # \"hello incan\"\n</code></pre>"},{"location":"language/reference/strings/#f-strings-formatted-strings","title":"F-strings (formatted strings)","text":"<p>Incan supports Python-style f-strings:</p> <pre><code>name = \"Alice\"\nage = 30\nprintln(f\"Name: {name}, Age: {age}\")\n</code></pre>"},{"location":"language/reference/strings/#debug-formatting","title":"Debug formatting","text":"<p>Use <code>:?</code> for debug output (shows type structure):</p> <pre><code>model Point:\n    x: int\n    y: int\n\np = Point(x=10, y=20)\nprintln(f\"Debug: {p:?}\")  # Point { x: 10, y: 20 }\n</code></pre> <p>See String Representation for details on Debug vs Display formatting.</p>"},{"location":"language/reference/strings/#string-literals","title":"String literals","text":"<pre><code># Single or double quotes\ns1 = \"hello\"\ns2 = 'hello'\n\n# Multiline strings (triple quotes)\nmulti = \"\"\"\nThis is a\nmultiline string\n\"\"\"\n\n# F-strings\nformatted = f\"Value: {x}\"\n</code></pre>"},{"location":"language/reference/strings/#bytes-binary-data","title":"Bytes (binary data)","text":"<p>The <code>bytes</code> type represents binary data as a sequence of bytes (current backend: Rust <code>Vec&lt;u8&gt;</code>).</p>"},{"location":"language/reference/strings/#byte-string-literals","title":"Byte string literals","text":"<p>Use the <code>b\"...\"</code> prefix for byte strings:</p> <pre><code># ASCII byte string\ndata = b\"Hello\"\n\n# Hex escapes for arbitrary bytes\nbinary = b\"\\x00\\x01\\x02\\xff\"\n\n# Common escapes\nnewline = b\"\\n\"\ntab = b\"\\t\"\nnull = b\"\\0\"\n</code></pre> <p>Supported escape sequences:</p> Escape Meaning <code>\\n</code> Newline <code>\\t</code> Tab <code>\\r</code> Carriage return <code>\\\\</code> Backslash <code>\\0</code> Null byte <code>\\xNN</code> Hex byte (e.g. <code>\\xff</code> = 255) <p>Note: Byte strings only accept ASCII characters. Non-ASCII characters produce an error.</p>"},{"location":"language/reference/strings/#type-annotation","title":"Type annotation","text":"<pre><code>def process_binary(data: bytes) -&gt; bytes:\n    return data\n</code></pre> <p>Coming from Python?</p> <p>Python\u2019s <code>bytes</code> is immutable. Incan\u2019s <code>bytes</code> currently compiles to Rust <code>Vec&lt;u8&gt;</code>, which is mutable.</p>"},{"location":"language/reference/strings/#when-to-use-bytes-vs-str","title":"When to use <code>bytes</code> vs <code>str</code>","text":"Use case Type Text, user-facing content <code>str</code> File contents (text) <code>str</code> Binary files (images, etc.) <code>bytes</code> Network protocols <code>bytes</code> Cryptographic operations <code>bytes</code> Raw file I/O <code>bytes</code>"},{"location":"language/reference/strings/#see-also","title":"See also","text":"<ul> <li>String Representation \u2014 Debug and Display formatting</li> <li>String processing (How-to) \u2014 practical recipes (split/join/cleaning)</li> <li>Strings and formatting (Tutorial)</li> <li>File I/O (How-to) \u2014 reading text vs bytes</li> <li>Examples: Strings \u2014 string method examples</li> <li>Examples: Bytes I/O \u2014 binary data examples</li> </ul>"},{"location":"language/reference/derives/comparison/","title":"Derives: Comparison (Reference)","text":"<p>This page documents <code>Eq</code>, <code>Ord</code>, and <code>Hash</code>.</p> <p>See also:</p> <ul> <li>Derives &amp; traits</li> <li>Customize derived behavior (How-to)</li> </ul>"},{"location":"language/reference/derives/comparison/#eq-equality","title":"Eq (equality)","text":"<ul> <li>Enables: <code>==</code>, <code>!=</code></li> <li>Default behavior: structural, field-based equality</li> <li>Custom behavior: define <code>__eq__(self, other: Self) -&gt; bool</code></li> <li>Conflict rule: if you define <code>__eq__</code>, do not also <code>@derive(Eq)</code></li> </ul>"},{"location":"language/reference/derives/comparison/#ord-ordering","title":"Ord (ordering)","text":"<ul> <li>Enables: <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>sorted(...)</code></li> <li>Default behavior: structural ordering by field order</li> <li>Custom behavior: define <code>__lt__(self, other: Self) -&gt; bool</code></li> <li>Conflict rule: if you define <code>__lt__</code>, do not also <code>@derive(Ord)</code></li> </ul>"},{"location":"language/reference/derives/comparison/#hash","title":"Hash","text":"<ul> <li>Enables: use as <code>Set</code> members and <code>Dict</code> keys</li> <li>Default behavior: structural, field-based hashing</li> <li>Custom behavior: define <code>__hash__(self) -&gt; int</code></li> <li>Conflict rule: if you define <code>__hash__</code>, do not also <code>@derive(Hash)</code></li> </ul> <p>Consistency rule:</p> <ul> <li>If <code>a == b</code>, then <code>a.__hash__() == b.__hash__()</code>.</li> </ul>"},{"location":"language/reference/derives/comparison/#tie-breakers-ordering","title":"Tie-breakers (ordering)","text":"<p>If you implement <code>__lt__</code>, avoid \u201caccidental ties\u201d by adding a deterministic tie-breaker:</p> <pre><code>model Task:\n    priority: int\n    name: str\n\n    def __lt__(self, other: Task) -&gt; bool:\n        if self.priority != other.priority:\n            return self.priority &lt; other.priority\n        return self.name &lt; other.name\n</code></pre>"},{"location":"language/reference/derives/copying_default/","title":"Derives: Copying and Default (Reference)","text":"<p>This page documents <code>Clone</code>, <code>Copy</code>, and <code>Default</code>, plus field defaults in constructors.</p> <p>See also:</p> <ul> <li>Derives &amp; traits</li> </ul>"},{"location":"language/reference/derives/copying_default/#clone","title":"Clone","text":"<ul> <li>Enables: <code>.clone()</code></li> <li>Meaning: explicit duplication</li> </ul>"},{"location":"language/reference/derives/copying_default/#copy","title":"Copy","text":"<ul> <li>Meaning: marker trait for implicit copying</li> <li>Intended use: small value types (no heap ownership)</li> </ul> <p>Copy vs Clone (rule of thumb):</p> Trait Copy happens when Use for <code>Clone</code> you call <code>.clone()</code> any type <code>Copy</code> assignment/pass-by-value small, simple value types"},{"location":"language/reference/derives/copying_default/#field-defaults-construction","title":"Field defaults (construction)","text":"<p>Field defaults are written on fields:</p> <pre><code>model Settings:\n    theme: str = \"dark\"\n    font_size: int = 14\n</code></pre> <p>Rules:</p> <ul> <li>If a field has a default, you may omit it in construction and the default is used.</li> <li>If a field has no default, it must be provided when constructing the type.</li> </ul>"},{"location":"language/reference/derives/copying_default/#default","title":"Default","text":"<ul> <li>Enables: <code>Type.default()</code></li> <li>Semantics:</li> <li>fields with explicit defaults use those defaults</li> <li>otherwise, the default of the field type is used</li> </ul> <p>Common type defaults:</p> Type Default <code>int</code> <code>0</code> <code>float</code> <code>0.0</code> <code>bool</code> <code>false</code> <code>str</code> <code>\"\"</code> <code>List[T]</code> <code>[]</code> <code>Dict[K, V]</code> <code>{}</code> <code>Set[T]</code> <code>set()</code> <code>Option[T]</code> <code>None</code>"},{"location":"language/reference/derives/custom_behavior/","title":"Derives: Custom behavior (Reference)","text":"<p>This page lists the dunder hooks used to customize derived behavior.</p> <p>See also:</p> <ul> <li>Derives &amp; traits</li> <li>Customize derived behavior (How-to)</li> <li>Stdlib traits</li> </ul>"},{"location":"language/reference/derives/custom_behavior/#dunder-hooks","title":"Dunder hooks","text":"Hook Purpose <code>__str__</code> Display formatting (<code>{value}</code>) <code>__eq__</code> Equality (<code>==</code>, <code>!=</code>) <code>__lt__</code> Ordering (<code>&lt;</code>, sorting) <code>__hash__</code> Hashing (<code>Set</code> / <code>Dict</code> keys) <p>Rule:</p> <ul> <li>You must not combine a hook with the corresponding <code>@derive(...)</code> (conflict).</li> </ul>"},{"location":"language/reference/derives/custom_behavior/#reflection-helpers","title":"Reflection helpers","text":"<p>Models and classes provide:</p> <ul> <li><code>__fields__() -&gt; List[str]</code></li> <li><code>__class_name__() -&gt; str</code></li> </ul> <p>Example:</p> <pre><code>model User:\n    name: str\n\ndef main() -&gt; None:\n    u = User(name=\"Alice\")\n    println(u.__class_name__())\n    println(u.__fields__())\n</code></pre>"},{"location":"language/reference/derives/serialization/","title":"Derives: Serialization (Reference)","text":"<p>This page documents <code>Serialize</code> and <code>Deserialize</code> for JSON.</p> <p>See also:</p> <ul> <li>Derives &amp; traits</li> <li>Error handling</li> </ul>"},{"location":"language/reference/derives/serialization/#serialize","title":"Serialize","text":"<ul> <li>Derive: <code>@derive(Serialize)</code></li> <li>API: <code>json_stringify(value) -&gt; str</code></li> </ul> <pre><code>@derive(Serialize)\nmodel User:\n    name: str\n    age: int\n\ndef main() -&gt; None:\n    u = User(name=\"Alice\", age=30)\n    println(json_stringify(u))\n</code></pre>"},{"location":"language/reference/derives/serialization/#deserialize","title":"Deserialize","text":"<ul> <li>Derive: <code>@derive(Deserialize)</code></li> <li>API: <code>T.from_json(input: str) -&gt; Result[T, str]</code></li> </ul> <pre><code>@derive(Deserialize)\nmodel User:\n    name: str\n    age: int\n\ndef main() -&gt; None:\n    result: Result[User, str] = User.from_json(\"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\")\n</code></pre>"},{"location":"language/reference/derives/serialization/#type-mappings-incan-json","title":"Type mappings (Incan \u2192 JSON)","text":"Incan JSON <code>str</code> string <code>int</code> number <code>float</code> number <code>bool</code> boolean <code>List[T]</code> array <code>Dict[str, T]</code> object <code>Option[T]</code> value or <code>null</code> <code>model</code> / <code>class</code> object"},{"location":"language/reference/derives/string_representation/","title":"Derives: String representation (Reference)","text":"<p>This page documents <code>Debug</code> and <code>Display</code> derives and their behavior.</p> <p>See also:</p> <ul> <li>Derives &amp; traits</li> </ul>"},{"location":"language/reference/derives/string_representation/#debug-automatic","title":"Debug (Automatic)","text":"<ul> <li>Format: <code>{value:?}</code></li> <li>User override: not supported</li> <li>Intended behavior: structured output (type name + fields)</li> </ul> <pre><code>model Point:\n    x: int\n    y: int\n\ndef main() -&gt; None:\n    p = Point(x=10, y=20)\n    println(f\"{p:?}\")  # Point { x: 10, y: 20 }\n</code></pre>"},{"location":"language/reference/derives/string_representation/#display-automatic-customizable-with-__str__","title":"Display (Automatic, customizable with <code>__str__</code>)","text":"<ul> <li>Format: <code>{value}</code></li> <li>Default behavior: types have a default Display representation (similar to Python\u2019s default <code>__str__</code>)</li> <li>Custom behavior: define <code>__str__(self) -&gt; str</code></li> <li>Conflict rule: if you define <code>__str__</code>, do not also <code>@derive(Display)</code></li> </ul> <pre><code>model User:\n    name: str\n    email: str\n\n    def __str__(self) -&gt; str:\n        return f\"{self.name} &lt;{self.email}&gt;\"\n\ndef main() -&gt; None:\n    u = User(name=\"Alice\", email=\"alice@example.com\")\n    println(f\"{u}\")    # Alice &lt;alice@example.com&gt;\n    println(f\"{u:?}\")  # User { name: \"Alice\", email: \"alice@example.com\" }\n</code></pre>"},{"location":"language/reference/derives/string_representation/#debug-vs-display-quick-guide","title":"Debug vs Display (quick guide)","text":"Aspect Debug (<code>{:?}</code>) Display (<code>{}</code>) Purpose developers/logs users/output Customizable no yes (<code>__str__</code>)"},{"location":"language/reference/stdlib_traits/","title":"Stdlib traits (Reference)","text":"<p>This section documents standard library traits: the stable contracts that describe protocol-like behavior (iteration, indexing, operators, conversions, etc.).</p> <p>If you\u2019re looking for derives and their dunder overrides, see:</p> <ul> <li>Derives &amp; traits</li> </ul> <p>Pages:</p> <ul> <li>Collection protocols</li> <li>Indexing and slicing</li> <li>Callable objects</li> <li>Operator traits</li> <li>Conversion traits</li> </ul>"},{"location":"language/reference/stdlib_traits/callable/","title":"Callable objects (Reference)","text":"<p>This page documents stdlib traits for callable objects.</p>"},{"location":"language/reference/stdlib_traits/callable/#callable0-callable1-callable2","title":"Callable0 / Callable1 / Callable2","text":"<p>These model \u201cobjects that can be called\u201d like <code>obj()</code>, <code>obj(x)</code>, <code>obj(x, y)</code>.</p> <ul> <li>Callable0[R]</li> <li>Hook: <code>__call__(self) -&gt; R</code></li> <li>Callable1[A, R]</li> <li>Hook: <code>__call__(self, arg: A) -&gt; R</code></li> <li>Callable2[A, B, R]</li> <li>Hook: <code>__call__(self, a: A, b: B) -&gt; R</code></li> </ul>"},{"location":"language/reference/stdlib_traits/collection_protocols/","title":"Collection protocols (Reference)","text":"<p>This page documents stdlib traits that model Python-like collection behavior.</p>"},{"location":"language/reference/stdlib_traits/collection_protocols/#contains-membership","title":"Contains (membership)","text":"<ul> <li>Syntax: <code>item in collection</code> / <code>item not in collection</code></li> <li>Hook: <code>__contains__(self, item: T) -&gt; bool</code></li> <li>Trait: <code>Contains[T]</code></li> </ul>"},{"location":"language/reference/stdlib_traits/collection_protocols/#len-length","title":"Len (length)","text":"<ul> <li>Syntax: <code>len(x)</code></li> <li>Hook: <code>__len__(self) -&gt; int</code></li> <li>Trait: <code>Len</code></li> </ul>"},{"location":"language/reference/stdlib_traits/collection_protocols/#iterable-iterator-iteration","title":"Iterable / Iterator (iteration)","text":"<ul> <li>Syntax: <code>for x in y:</code></li> <li>Hooks:<ul> <li><code>__iter__(self) -&gt; Iterator[T]</code></li> <li><code>__next__(self) -&gt; Option[T]</code></li> </ul> </li> <li>Traits:<ul> <li><code>Iterable[T]</code></li> <li><code>Iterator[T]</code></li> </ul> </li> </ul>"},{"location":"language/reference/stdlib_traits/collection_protocols/#bool-truthiness","title":"Bool (truthiness)","text":"<ul> <li>Syntax: <code>if x:</code> / <code>while x:</code></li> <li>Hook: <code>__bool__(self) -&gt; bool</code></li> <li>Trait: <code>Bool</code></li> </ul>"},{"location":"language/reference/stdlib_traits/conversions/","title":"Conversion traits (Reference)","text":"<p>This page documents stdlib traits for explicit conversions.</p>"},{"location":"language/reference/stdlib_traits/conversions/#from-into","title":"From / Into","text":"<ul> <li><code>From[T]</code><ul> <li>Hook: <code>@classmethod def from(cls, value: T) -&gt; Self</code></li> </ul> </li> <li><code>Into[T]</code><ul> <li>Hook: <code>def into(self) -&gt; T</code></li> </ul> </li> </ul>"},{"location":"language/reference/stdlib_traits/conversions/#tryfrom-tryinto","title":"TryFrom / TryInto","text":"<ul> <li><code>TryFrom[T]</code><ul> <li>Hook: <code>@classmethod def try_from(cls, value: T) -&gt; Result[Self, str]</code></li> </ul> </li> <li><code>TryInto[T]</code><ul> <li>Hook: <code>def try_into(self) -&gt; Result[T, str]</code></li> </ul> </li> </ul>"},{"location":"language/reference/stdlib_traits/error/","title":"Error trait","text":"<p>The <code>Error</code> trait is the standard interface for custom error types used with <code>Result[T, E]</code>.</p> <p>Implement it when you want:</p> <ul> <li>a human-readable message (<code>message()</code>)</li> <li>optional error chaining (<code>source()</code>)</li> </ul>"},{"location":"language/reference/stdlib_traits/error/#definition","title":"Definition","text":"<pre><code>trait Error:\n    def message(self) -&gt; str:\n        \"\"\"Return a human-readable error message\"\"\"\n        ...\n\n    def source(self) -&gt; Option[str]:\n        \"\"\"Optional: Return the underlying cause of this error\"\"\"\n        return None\n</code></pre>"},{"location":"language/reference/stdlib_traits/error/#example-simple-structured-error","title":"Example: simple structured error","text":"<pre><code>model ValidationError with Error:\n    field: str\n    msg: str\n\n    def message(self) -&gt; str:\n        return f\"Validation failed for '{self.field}': {self.msg}\"\n\ndef validate_age(age: int) -&gt; Result[int, ValidationError]:\n    if age &lt; 0:\n        return Err(ValidationError(field=\"age\", msg=\"cannot be negative\"))\n    return Ok(age)\n</code></pre>"},{"location":"language/reference/stdlib_traits/error/#example-chaining-with-source","title":"Example: chaining with <code>source()</code>","text":"<pre><code>model DatabaseError with Error:\n    query: str\n    cause: Option[str]\n\n    def message(self) -&gt; str:\n        return f\"Database query failed: {self.query}\"\n\n    def source(self) -&gt; Option[str]:\n        return self.cause\n</code></pre>"},{"location":"language/reference/stdlib_traits/indexing_and_slicing/","title":"Indexing and slicing (Reference)","text":"<p>This page documents stdlib traits for <code>obj[key]</code>, <code>obj[key] = value</code>, and slicing.</p>"},{"location":"language/reference/stdlib_traits/indexing_and_slicing/#index-read","title":"Index (read)","text":"<ul> <li>Syntax: <code>obj[key]</code></li> <li>Hook: <code>__getitem__(self, key: K) -&gt; V</code></li> <li>Trait: <code>Index[K, V]</code></li> </ul>"},{"location":"language/reference/stdlib_traits/indexing_and_slicing/#indexmut-write","title":"IndexMut (write)","text":"<ul> <li>Syntax: <code>obj[key] = value</code></li> <li>Hook: <code>__setitem__(self, key: K, value: V) -&gt; None</code></li> <li>Trait: <code>IndexMut[K, V]</code></li> </ul>"},{"location":"language/reference/stdlib_traits/indexing_and_slicing/#slicing","title":"Slicing","text":"<ul> <li>Syntax: <code>obj[start:end:step]</code></li> </ul> <p>Incan\u2019s long-term direction is slice-aware <code>__getitem__</code> (Python-style). The current stdlib vocabulary includes <code>Sliceable[T]</code> and <code>__getslice__</code>, which will be aligned with <code>__getitem__</code> as the feature is finalized.</p>"},{"location":"language/reference/stdlib_traits/operators/","title":"Operator traits (Reference)","text":"<p>This page documents stdlib traits that describe operator behavior for custom types.</p> <p>These traits define dunder-like hooks such as <code>__add__</code>, <code>__sub__</code>, etc.</p>"},{"location":"language/reference/stdlib_traits/operators/#add-sub-mul-div-neg-mod","title":"Add / Sub / Mul / Div / Neg / Mod","text":"<ul> <li><code>Add[Rhs, Output]</code>: <code>__add__(self, other: Rhs) -&gt; Output</code></li> <li><code>Sub[Rhs, Output]</code>: <code>__sub__(self, other: Rhs) -&gt; Output</code></li> <li><code>Mul[Rhs, Output]</code>: <code>__mul__(self, other: Rhs) -&gt; Output</code></li> <li><code>Div[Rhs, Output]</code>: <code>__div__(self, other: Rhs) -&gt; Output</code></li> <li><code>Neg[Output]</code>: <code>__neg__(self) -&gt; Output</code></li> <li><code>Mod[Rhs, Output]</code>: <code>__mod__(self, other: Rhs) -&gt; Output</code></li> </ul>"},{"location":"language/tutorials/build_your_first_api/","title":"Build your first API (tutorial)","text":"<p>This tutorial walks you through running the built-in web framework and serving a JSON endpoint.</p> <p>Prerequisite: Install, build, and run.</p> <p>If something fails</p> <p>If you hit errors while building/running, start with Troubleshooting. If it still looks like a bug, please file an issue on GitHub.</p>"},{"location":"language/tutorials/build_your_first_api/#step-1-run-the-hello-web-example","title":"Step 1: Run the hello web example","text":"<p>The repo includes a runnable example:</p> <ul> <li>Source: <code>examples/web/hello_web.incn</code></li> <li>GitHub: <code>https://github.com/dannys-code-corner/incan/blob/main/examples/web/hello_web.incn</code></li> </ul> <p>Build it:</p> <pre><code>incan build examples/web/hello_web.incn\n</code></pre> <p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre> <p>Note: the first build may download Rust crates via Cargo (can take minutes) and requires internet access.</p> <p>Run the compiled binary:</p> <pre><code>./target/incan/hello_web/target/release/hello_web\n</code></pre>"},{"location":"language/tutorials/build_your_first_api/#step-2-hit-the-endpoints","title":"Step 2: Hit the endpoints","text":"<p>In another terminal:</p> <pre><code>curl http://localhost:8080/\ncurl http://localhost:8080/api/greet/World\ncurl http://localhost:8080/api/user/42\ncurl http://localhost:8080/health\n</code></pre>"},{"location":"language/tutorials/build_your_first_api/#step-3-understand-what-youre-seeing","title":"Step 3: Understand what you\u2019re seeing","text":"<p>The example demonstrates:</p> <ul> <li><code>@route(\"/path\")</code> for routes</li> <li><code>Json[T]</code> for JSON responses</li> <li><code>@derive(Serialize)</code> for response models</li> <li><code>async def</code> handlers (async/await)</li> </ul> <p>Learn more:</p> <ul> <li>Web framework guide: Web Framework</li> <li>Models: Models &amp; Classes</li> <li>Errors: Error Handling</li> <li>Modules: Imports and modules (how-to)</li> </ul>"},{"location":"language/tutorials/web_framework/","title":"Web Framework","text":"<p>Incan includes a web framework that compiles to Axum, giving you Flask/FastAPI-like syntax with native Rust performance.</p>"},{"location":"language/tutorials/web_framework/#quick-start","title":"Quick Start","text":"<p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre> <pre><code>from web import App, route, Response, Json\n\n@derive(Serialize)\nmodel Greeting:\n    message: str\n\n@route(\"/\")\nasync def index() -&gt; Response:\n    return Response.html(\"&lt;h1&gt;Hello from Incan!&lt;/h1&gt;\")\n\n@route(\"/api/greet/{name}\")\nasync def greet(name: str) -&gt; Json[Greeting]:\n    return Json(Greeting(message=f\"Hello, {name}!\"))\n\ndef main() -&gt; None:\n    app = App()\n    app.run(port=8080)\n</code></pre> <p>Build and run:</p> <pre><code>incan build examples/web/hello_web.incn\n./target/incan/hello_web/target/release/hello_web\n</code></pre> <p>Note: the first build may download Rust crates via Cargo (can take minutes) and requires internet access.</p>"},{"location":"language/tutorials/web_framework/#routes","title":"Routes","text":"<p>Define routes using the <code>@route</code> decorator:</p> <pre><code>@route(\"/path\")\nasync def handler() -&gt; Response:\n    ...\n\n@route(\"/api/resource\", methods=[GET, POST])\nasync def resource_handler() -&gt; Response:\n    ...\n</code></pre>"},{"location":"language/tutorials/web_framework/#path-parameters","title":"Path Parameters","text":"<p>Use <code>{name}</code> syntax for path parameters:</p> <pre><code>@route(\"/users/{id}\")\nasync def get_user(id: int) -&gt; Json[User]:\n    user = find_user(id)?\n    return Json(user)\n\n@route(\"/posts/{year}/{month}\")\nasync def get_posts(year: int, month: int) -&gt; Json[list[Post]]:\n    return Json(fetch_posts(year, month))\n</code></pre>"},{"location":"language/tutorials/web_framework/#http-methods","title":"HTTP Methods","text":"<p>Specify allowed methods with the <code>methods</code> parameter:</p> <pre><code>from web import GET, POST, PUT, DELETE\n\n@route(\"/items\", methods=[GET])\nasync def list_items() -&gt; Json[list[Item]]:\n    ...\n\n@route(\"/items\", methods=[POST])\nasync def create_item(body: Json[CreateItem]) -&gt; Json[Item]:\n    ...\n\n@route(\"/items/{id}\", methods=[PUT, DELETE])\nasync def modify_item(id: int) -&gt; Response:\n    ...\n</code></pre>"},{"location":"language/tutorials/web_framework/#responses","title":"Responses","text":""},{"location":"language/tutorials/web_framework/#json-responses","title":"JSON Responses","text":"<p>Use <code>Json[T]</code> for JSON responses. The inner type must have <code>@derive(Serialize)</code>:</p> <pre><code>@derive(Serialize)\nmodel User:\n    id: int\n    name: str\n    email: str\n\n@route(\"/api/user/{id}\")\nasync def get_user(id: int) -&gt; Json[User]:\n    user = User(id=id, name=\"Alice\", email=\"alice@example.com\")\n    return Json(user)\n</code></pre>"},{"location":"language/tutorials/web_framework/#html-responses","title":"HTML Responses","text":"<p>Return HTML with <code>Response.html()</code>:</p> <pre><code>@route(\"/\")\nasync def index() -&gt; Response:\n    return Response.html(\"&lt;h1&gt;Welcome!&lt;/h1&gt;\")\n</code></pre>"},{"location":"language/tutorials/web_framework/#status-codes","title":"Status Codes","text":"<p>Use <code>Response</code> methods for different status codes:</p> <pre><code>@route(\"/health\")\nasync def health() -&gt; Response:\n    return Response.ok()  # 200\n\n@route(\"/created\")\nasync def created() -&gt; Response:\n    return Response.created()  # 201\n\n@route(\"/empty\")\nasync def empty() -&gt; Response:\n    return Response.no_content()  # 204\n\n@route(\"/error\")\nasync def error() -&gt; Response:\n    return Response.bad_request(\"Invalid input\")  # 400\n\n@route(\"/missing\")\nasync def missing() -&gt; Response:\n    return Response.not_found(\"Resource not found\")  # 404\n\n@route(\"/server-error\")\nasync def server_error() -&gt; Response:\n    return Response.internal_error(\"Something went wrong\")  # 500\n</code></pre>"},{"location":"language/tutorials/web_framework/#request-data","title":"Request Data","text":""},{"location":"language/tutorials/web_framework/#extracting-path-parameters","title":"Extracting Path Parameters","text":"<p>Path parameters are automatically extracted into function arguments:</p> <pre><code>@route(\"/users/{user_id}/posts/{post_id}\")\nasync def get_post(user_id: int, post_id: int) -&gt; Json[Post]:\n    ...\n</code></pre>"},{"location":"language/tutorials/web_framework/#query-parameters","title":"Query Parameters","text":"<p>Use <code>Query[T]</code> for query string parameters:</p> <pre><code>@derive(Deserialize)\nmodel SearchParams:\n    q: str\n    limit: int = 10\n\n@route(\"/search\")\nasync def search(params: Query[SearchParams]) -&gt; Json[list[Result]]:\n    results = do_search(params.q, params.limit)\n    return Json(results)\n</code></pre>"},{"location":"language/tutorials/web_framework/#json-body","title":"JSON Body","text":"<p>Use <code>Json[T]</code> as a parameter for JSON request bodies:</p> <pre><code>@derive(Deserialize)\nmodel CreateUser:\n    name: str\n    email: str\n\n@route(\"/users\", methods=[POST])\nasync def create_user(body: Json[CreateUser]) -&gt; Json[User]:\n    user = User(id=1, name=body.name, email=body.email)\n    return Json(user)\n</code></pre>"},{"location":"language/tutorials/web_framework/#application","title":"Application","text":""},{"location":"language/tutorials/web_framework/#starting-the-server","title":"Starting the Server","text":"<p>Create an <code>App</code> and call <code>run()</code>:</p> <pre><code>def main() -&gt; None:\n    app = App()\n    app.run(host=\"0.0.0.0\", port=3000)\n</code></pre> <p>Parameters:</p> <ul> <li><code>host</code>: Bind address (default: <code>\"127.0.0.1\"</code>)</li> <li><code>port</code>: Port number (default: <code>8080</code>)</li> </ul>"},{"location":"language/tutorials/web_framework/#how-it-works","title":"How It Works","text":"<p>When you compile an Incan web application:</p> <ol> <li>Routes are collected from <code>@route</code> decorators</li> <li>Handlers become async Rust functions with Axum extractors</li> <li>Models with <code>@derive(Serialize/Deserialize)</code> get serde derives</li> <li><code>app.run()</code> becomes Axum router setup + tokio server</li> </ol> <p>The generated Rust code uses:</p> <ul> <li><code>axum::Router</code> for routing</li> <li><code>axum::Json</code> for JSON request/response</li> <li><code>axum::extract::Path</code> for path parameters</li> <li><code>axum::extract::Query</code> for query parameters</li> <li><code>tokio</code> for async runtime</li> </ul>"},{"location":"language/tutorials/web_framework/#complete-example","title":"Complete Example","text":"<pre><code>\"\"\"\nA simple REST API for managing items.\n\"\"\"\n\nfrom web import App, route, Response, Json, GET, POST, DELETE\n\n\n@derive(Serialize, Deserialize)\nmodel Item:\n    id: int\n    name: str\n    price: float\n\n\n# In-memory storage (in a real app, use a database)\nitems: list[Item] = []\n\n\n@route(\"/api/items\", methods=[GET])\nasync def list_items() -&gt; Json[list[Item]]:\n    \"\"\"List all items.\"\"\"\n    return Json(items)\n\n\n@route(\"/api/items\", methods=[POST])\nasync def create_item(body: Json[Item]) -&gt; Json[Item]:\n    \"\"\"Create a new item.\"\"\"\n    items.append(body.value)\n    return Json(body.value)\n\n\n@route(\"/api/items/{id}\", methods=[GET])\nasync def get_item(id: int) -&gt; Response:\n    \"\"\"Get an item by ID.\"\"\"\n    for item in items:\n        if item.id == id:\n            return Json(item)\n    return Response.not_found(\"Item not found\")\n\n\n@route(\"/api/items/{id}\", methods=[DELETE])\nasync def delete_item(id: int) -&gt; Response:\n    \"\"\"Delete an item by ID.\"\"\"\n    for i, item in enumerate(items):\n        if item.id == id:\n            items.pop(i)\n            return Response.no_content()\n    return Response.not_found(\"Item not found\")\n\n\ndef main() -&gt; None:\n    println(\"Starting API server at http://localhost:8080\")\n    app = App()\n    app.run(port=8080)\n</code></pre>"},{"location":"language/tutorials/web_framework/#performance","title":"Performance","text":"<p>Since Incan compiles to Rust/Axum, your web application runs with:</p> <ul> <li>Native performance \u2014 no interpreter overhead</li> <li>Zero-cost async \u2014 Tokio's efficient async runtime</li> <li>No garbage collector \u2014 predictable latency</li> <li>Low memory usage \u2014 Rust's ownership model</li> </ul> <p>This makes Incan ideal for high-performance APIs and microservices.</p>"},{"location":"language/tutorials/web_framework/#see-also","title":"See Also","text":"<ul> <li>Error Handling - Working with <code>Result</code> types</li> <li>Derives &amp; Traits - Drop trait for custom cleanup</li> <li>File I/O - Reading, writing, and path handling</li> <li>Async Programming - Async/await with Tokio</li> <li>Imports &amp; Modules - Module system, imports, and built-in functions</li> <li>Rust Interop - Using Rust crates directly from Incan</li> </ul>"},{"location":"language/tutorials/book/","title":"The Incan Book (Basics)","text":"<p>This is a linear tutorial track intended for new readers.</p> <p>Goals:</p> <ul> <li>learn the core language fundamentals with runnable examples</li> <li>keep pages short and sequential (next/prev)</li> <li>avoid mixing \u201chow-to\u201d and \u201creference\u201d into the main learning flow</li> </ul>"},{"location":"language/tutorials/book/#chapters","title":"Chapters","text":"<ol> <li>Hello world</li> <li>Values, variables, and types</li> <li>Functions</li> <li>Control flow</li> <li>Modules and imports</li> <li>Errors (Result/Option and <code>?</code>)</li> <li>Strings and formatting</li> <li>Collections and iteration</li> <li>Enums and better <code>match</code></li> <li>Models vs classes</li> <li>Traits and derives</li> <li>Newtypes (stronger types)</li> </ol>"},{"location":"language/tutorials/book/#notes","title":"Notes","text":"<ul> <li>Canonical install/build/run guidance lives under Tooling: Install, build, and run.</li> <li>Canonical formatting/style guidance lives under Tooling: Code formatting.</li> <li>The generated language reference is discoverable under Language \u2192 Reference: Language reference (generated).</li> </ul>"},{"location":"language/tutorials/book/01_hello_world/","title":"1. Hello world","text":"<p>Prerequisite: follow Install, build, and run.</p>"},{"location":"language/tutorials/book/01_hello_world/#create-a-file","title":"Create a file","text":"<p>Create <code>hello.incn</code>:</p> <pre><code>def main() -&gt; None:\n    println(\"Hello, Incan!\")\n</code></pre> <p>Coming from Python?</p> <p>In Python you usually write <code>print(\"...\")</code>. In Incan you have both:</p> <ul> <li><code>println(\"...\")</code>: prints with a newline (used in most examples)</li> <li><code>print(\"...\")</code>: prints without a newline</li> </ul> <p>Tip: Incan uses indentation for blocks. The canonical style is 4 spaces per indent level; run <code>incan fmt</code> to normalize formatting (see: Code formatting).</p>"},{"location":"language/tutorials/book/01_hello_world/#run-it","title":"Run it","text":"<p>If you installed to PATH:</p> <pre><code>incan run hello.incn\n</code></pre> <p>If you used the no-install fallback:</p> <pre><code>./target/release/incan run hello.incn\n</code></pre>"},{"location":"language/tutorials/book/01_hello_world/#try-it","title":"Try it","text":"<ol> <li>Change the message you print.</li> <li>Print two lines (two calls to <code>println</code>).</li> <li>Use <code>print(\"...\")</code> once to see the \u201cno newline\u201d behavior.</li> </ol> One possible solution <pre><code>def main() -&gt; None:\n    print(\"Hello\")\n    println(\", Incan!\")\n    println(\"Second line\")\n</code></pre>"},{"location":"language/tutorials/book/01_hello_world/#next","title":"Next","text":"<p>Next chapter: 2. Values, variables, and types.</p>"},{"location":"language/tutorials/book/02_values_variables_and_types/","title":"2. Values, variables, and types","text":"<p>This chapter introduces basic values and types.</p> <p>If you get stuck on terminology, see: Glossary.</p>"},{"location":"language/tutorials/book/02_values_variables_and_types/#basic-values","title":"Basic values","text":"<p>Common built-in types:</p> <ul> <li><code>int</code> (integers)</li> <li><code>float</code> (floating point)</li> <li><code>bool</code> (<code>true</code> / <code>false</code>)</li> <li><code>str</code> (strings)</li> </ul>"},{"location":"language/tutorials/book/02_values_variables_and_types/#variables","title":"Variables","text":"<p>Assign a value to a name:</p> <p>Coming from Python?</p> <p>Incan supports Python-style f-strings for string interpolation:</p> <pre><code>name = \"Incan\"\nprintln(f\"hello, {name}\")\n</code></pre> <p>For more examples and formatting details, see: Strings.</p> <pre><code>def main() -&gt; None:\n    name = \"Incan\"\n    answer = 42\n    println(f\"{name}: {answer}\")\n</code></pre>"},{"location":"language/tutorials/book/02_values_variables_and_types/#function-arguments-and-return-types","title":"Function arguments and return types","text":"<p>Incan uses type annotations on function arguments and return types:</p> <pre><code>def add(a: int, b: int) -&gt; int:\n    return a + b\n</code></pre>"},{"location":"language/tutorials/book/02_values_variables_and_types/#try-it","title":"Try it","text":"<ol> <li>Create a <code>str</code>, <code>int</code>, <code>float</code>, and <code>bool</code> variable and print them.</li> <li>Use an f-string with multiple <code>{...}</code> interpolations.</li> <li>Call <code>add(10, 32)</code> and print the result.</li> </ol> One possible solution <pre><code>def add(a: int, b: int) -&gt; int:\n    return a + b\n\ndef main() -&gt; None:\n    name = \"Incan\"\n    count = 3\n    ratio = 0.5\n    enabled = true\n\n    println(f\"name={name} count={count} ratio={ratio} enabled={enabled}\")\n    println(f\"add={add(10, 32)}\")\n</code></pre>"},{"location":"language/tutorials/book/02_values_variables_and_types/#next","title":"Next","text":"<p>Back: 1. Hello world</p> <p>Next: 3. Functions</p>"},{"location":"language/tutorials/book/03_functions/","title":"3. Functions","text":"<p>Functions are named, reusable blocks of code.</p>"},{"location":"language/tutorials/book/03_functions/#defining-a-function","title":"Defining a function","text":"<p>Function parameters and return types are explicit:</p> <pre><code>def add(a: int, b: int) -&gt; int:\n    return a + b\n</code></pre> <ul> <li>Parameters use <code>name: Type</code>.</li> <li>Return type uses <code>-&gt; Type</code>.</li> <li>Use <code>-&gt; None</code> for \u201creturns nothing\u201d.</li> </ul>"},{"location":"language/tutorials/book/03_functions/#calling-a-function","title":"Calling a function","text":""},{"location":"language/tutorials/book/03_functions/#program-entry-point-main","title":"Program entry point: <code>main</code>","text":"<p>Most runnable programs define a <code>main</code> function. When you run a file with <code>incan run ...</code>, execution starts at:</p> <ul> <li><code>def main() -&gt; None:</code></li> <li><code>-&gt; None</code> means it doesn\u2019t return a value.</li> </ul> <p>In order to run an incan file, you must define a <code>main</code> function:</p> <pre><code>def main() -&gt; None:\n    total = add(2, 3)\n    println(f\"total={total}\")\n</code></pre> <p>Coming from Python?</p> <p>In Python, a common pattern is:</p> <pre><code>if __name__ == \"__main__\":\n    main()\n</code></pre> <p>In Incan, <code>main</code> is the program entry point when you run a file (e.g. <code>incan run ...</code>), so you don\u2019t need an <code>__name__</code> guard - it's implicit in Incan. It is, however, still good practice to keep \u201cdo work\u201d code inside <code>main</code>, and keep other files as imported helper modules.</p>"},{"location":"language/tutorials/book/03_functions/#docstrings","title":"Docstrings","text":"<p>Use docstrings to describe intent (especially for public helpers):</p> <pre><code>def normalize_name(name: str) -&gt; str:\n    \"\"\"\n    Normalize a user name for consistent comparisons.\n    \"\"\"\n    return name.strip().lower()\n</code></pre>"},{"location":"language/tutorials/book/03_functions/#multiple-returns-with-result","title":"Multiple returns (with <code>Result</code>)","text":"<p>Many \u201ccan fail\u201d functions return <code>Result[T, E]</code> instead of throwing exceptions:</p> <pre><code>def parse_port(s: str) -&gt; Result[int, str]:\n    if len(s.strip()) == 0:\n        return Err(\"port must not be empty\")\n    return Ok(int(s))\n</code></pre> <p>You\u2019ll learn the <code>Result</code> pattern in Chapter 6.</p>"},{"location":"language/tutorials/book/03_functions/#try-it","title":"Try it","text":"<ol> <li>Write <code>def is_even(n: int) -&gt; bool</code> and print the result for a few values.</li> <li>Write <code>def greet(name: str) -&gt; str</code> that trims whitespace and returns <code>\"Hello, &lt;name&gt;!\"</code>.</li> <li>(Stretch) Write <code>def safe_div(a: int, b: int) -&gt; Result[float, str]</code>.</li> </ol> One possible solution <pre><code>def is_even(n: int) -&gt; bool:\n    return n % 2 == 0\n\ndef greet(name: str) -&gt; str:\n    cleaned = name.strip()\n    return f\"Hello, {cleaned}!\"\n\ndef safe_div(a: float, b: float) -&gt; Result[float, str]:\n    if b == 0.0:\n        return Err(\"division by zero\")\n    return Ok(a / b)\n\ndef main() -&gt; None:\n    println(f\"is_even(2)={is_even(2)}\")\n    println(f\"is_even(3)={is_even(3)}\")\n    println(greet(\"  Alice  \"))\n</code></pre>"},{"location":"language/tutorials/book/03_functions/#what-to-learn-next","title":"What to learn next","text":"<ul> <li>Function definitions and signatures: Language reference (generated)</li> <li>Function scoping and name lookup: Scopes &amp; Name Resolution</li> <li>Closures and higher-order patterns: Closures</li> </ul>"},{"location":"language/tutorials/book/03_functions/#next","title":"Next","text":"<p>Back: 2. Values, variables, and types</p> <p>Next chapter: 4. Control flow</p>"},{"location":"language/tutorials/book/04_control_flow/","title":"4. Control flow","text":"<p>Control flow is how you branch and loop.</p>"},{"location":"language/tutorials/book/04_control_flow/#if-elif-else","title":"<code>if</code> / <code>elif</code> / <code>else</code>","text":"<pre><code>def describe(n: int) -&gt; str:\n    if n &lt; 0:\n        return \"negative\"\n    elif n == 0:\n        return \"zero\"\n    else:\n        return \"positive\"\n</code></pre>"},{"location":"language/tutorials/book/04_control_flow/#match-pattern-matching","title":"<code>match</code> (pattern matching)","text":"<p><code>match</code> is the main way to branch on enums like <code>Result</code> and <code>Option</code>:</p> <pre><code>def main() -&gt; None:\n    result = parse_port(\"8080\")\n\n    match result:\n        case Ok(port): println(f\"port={port}\")\n        case Err(e): println(f\"error: {e}\")\n</code></pre> <p>Coming from Rust?</p> <p>Incan also supports a more Rust-like match-arm style using <code>=&gt;</code>:</p> <pre><code>def main() -&gt; None:\n    match parse_port(\"8080\"):\n        Ok(port) =&gt; println(f\"port={port}\")\n        Err(e) =&gt; println(f\"error: {e}\")\n</code></pre> <p>This is equivalent to the <code>case ...:</code> form; pick whichever reads best to you.</p>"},{"location":"language/tutorials/book/04_control_flow/#for-loops","title":"<code>for</code> loops","text":"<p>Incan supports Python-like <code>for</code> loops:</p> <pre><code>def main() -&gt; None:\n    items = [\"Alice\", \"Bob\", \"Cara\"]\n    for name in items:\n        println(name)\n</code></pre> <p>You can break early:</p> <pre><code>for name in items:\n    if name == \"Bob\":\n        break\n</code></pre>"},{"location":"language/tutorials/book/04_control_flow/#try-it","title":"Try it","text":"<ol> <li>Write a function <code>classify(n: int) -&gt; str</code> using <code>if/elif/else</code>.</li> <li>Use <code>match</code> on a <code>Result</code> and print either the value or the error.</li> <li>Loop over a list and stop early with <code>break</code>.</li> </ol> One possible solution <pre><code># 1) classify function\ndef classify(n: int) -&gt; str:\n    if n &lt; 0:\n        return \"negative\"\n    elif n == 0:\n        return \"zero\"\n    else:\n        return \"positive\"\n\ndef main() -&gt; None:\n    println(classify(-1))  # negative\n    println(classify(0))   # zero\n    println(classify(2))   # positive\n\n    # 2) match on Result\n    match parse_port(\"8080\"):\n        Ok(port) =&gt; println(f\"port={port}\")\n        Err(e) =&gt; println(f\"error={e}\")\n\n    # 3) loop over a list and stop early with break\n    items = [\"Alice\", \"Bob\", \"Cara\"]\n    for name in items:\n        if name == \"Bob\":\n            break\n        println(name)\n</code></pre>"},{"location":"language/tutorials/book/04_control_flow/#where-to-learn-more","title":"Where to learn more","text":"<ul> <li>Control flow overview: Control flow</li> <li>Enums (often used with <code>match</code>): Enums</li> <li>Error handling (deep dive on <code>Result</code>/<code>Option</code>): Error Handling</li> </ul>"},{"location":"language/tutorials/book/04_control_flow/#next","title":"Next","text":"<p>Back: 3. Functions</p> <p>Next chapter: 5. Modules and imports</p>"},{"location":"language/tutorials/book/05_modules_and_imports/","title":"5. Modules and imports","text":"<p>Once your program is more than one file, you\u2019ll split it into modules and import what you need.</p>"},{"location":"language/tutorials/book/05_modules_and_imports/#a-tiny-multi-file-project","title":"A tiny multi-file project","text":"<p>Create a folder:</p> <pre><code>my_project/\n\u251c\u2500\u2500 main.incn\n\u2514\u2500\u2500 strings.incn\n</code></pre> <p><code>strings.incn</code>:</p> <pre><code>pub def shout(s: str) -&gt; str:\n    return s.strip().upper()\n</code></pre> <p><code>main.incn</code>:</p> <pre><code>from strings import shout\n\ndef main() -&gt; None:\n    println(shout(\"  hello  \"))\n</code></pre> <p>Run from <code>my_project/</code>:</p> <pre><code>incan run main.incn\n</code></pre>"},{"location":"language/tutorials/book/05_modules_and_imports/#visibility-exporting-with-pub","title":"Visibility: exporting with <code>pub</code>","text":"<p>By default, definitions are module-private (only usable inside the same <code>.incn</code> file). Prefix a declaration with <code>pub</code> to export it so other modules can import it.</p> <p>Coming from Python?</p> <p>In Python, most top-level definitions are effectively importable. In Incan, you typically make the intended \u201cpublic API\u201d of a module explicit with <code>pub</code>.</p> <p>For more detail on <code>pub</code> (including how it affects <code>model</code>/<code>class</code> fields), see: Models &amp; Classes.</p>"},{"location":"language/tutorials/book/05_modules_and_imports/#import-styles","title":"Import styles","text":"<p>Incan supports two styles you can mix:</p> <pre><code># Python-style\nfrom strings import shout\n\n# Rust-style\nimport strings::shout\n</code></pre>"},{"location":"language/tutorials/book/05_modules_and_imports/#navigating-folders-super-crate","title":"Navigating folders (<code>..</code>, <code>super</code>, <code>crate</code>)","text":"<p>The reference documents how parent/root paths work:</p> <ul> <li>Parent: <code>..</code> (Python-style) or <code>super::</code> (Rust-style)</li> <li>Project root: <code>crate</code></li> </ul> <p>See: Imports and modules (reference).</p>"},{"location":"language/tutorials/book/05_modules_and_imports/#try-it","title":"Try it","text":"<ol> <li>Add another function in <code>strings.incn</code> (for example <code>whisper</code>).</li> <li>Mark it <code>pub</code> and import it into <code>main.incn</code>.</li> <li>Call both functions.</li> </ol> One possible solution <pre><code># strings.incn\npub def shout(s: str) -&gt; str:\n    return s.strip().upper()\n\npub def whisper(s: str) -&gt; str:\n    return s.strip().lower()\n\n# main.incn\nfrom strings import shout, whisper\n\ndef main() -&gt; None:\n    println(shout(\"  hello  \"))    # outputs: HELLO\n    println(whisper(\"  HELLO  \"))  # outputs: hello\n</code></pre>"},{"location":"language/tutorials/book/05_modules_and_imports/#what-to-learn-next","title":"What to learn next","text":"<ul> <li>Explanation: Imports and modules</li> <li>How-to: Imports and modules (how-to)</li> <li>Reference: Imports and modules (reference)</li> </ul>"},{"location":"language/tutorials/book/05_modules_and_imports/#next","title":"Next","text":"<p>Back: 4. Control flow</p> <p>Next chapter: 6. Errors (Result/Option and <code>?</code>)</p>"},{"location":"language/tutorials/book/06_errors/","title":"6. Errors (Result/Option and <code>?</code>)","text":"<p>Incan uses explicit error values (<code>Result</code> and <code>Option</code>) instead of Python-style exceptions.</p>"},{"location":"language/tutorials/book/06_errors/#resultt-e","title":"<code>Result[T, E]</code>","text":"<p>Use <code>Result</code> for operations that can fail.</p> <pre><code>def read_username() -&gt; Result[str, str]:\n    name = input(\"Name: \").strip()\n    if len(name) == 0:\n        return Err(\"name must not be empty\")\n    return Ok(name)\n</code></pre> <p>Handle it with <code>match</code>:</p> <pre><code>def main() -&gt; None:\n    match read_username():\n        case Ok(name): println(f\"hello, {name}\")\n        case Err(e): println(f\"error: {e}\")\n</code></pre>"},{"location":"language/tutorials/book/06_errors/#optiont","title":"<code>Option[T]</code>","text":"<p>Use <code>Option</code> for \u201cvalue may be absent\u201d:</p> <p><code>Option[T]</code> has two variants:</p> <ul> <li><code>Some(value)</code> \u2014 value is present</li> <li><code>None</code> \u2014 value is absent</li> </ul> <p>You create a present value by wrapping it: <code>Some(x)</code>.</p> <pre><code>def first(items: List[str]) -&gt; Option[str]:\n    if len(items) == 0:\n        return None\n    return Some(items[0])\n</code></pre> <p>You handle it with <code>match</code> by destructuring <code>Some(...)</code>.</p> <pre><code>def main() -&gt; None:\n    match first([\"a\", \"b\"]):\n        case Some(x): println(f\"first={x}\")\n        case None: println(\"empty\")\n</code></pre> <p>Coming from Python?</p> <p>In Python typing, you\u2019d usually express \u201cmay be missing\u201d as:</p> <p><pre><code>from typing import Optional\n\ndef first(items: list[str]) -&gt; Optional[str]:\n    return items[0] if items else None\n</code></pre> In Python, <code>Optional[T]</code> is mostly a type-hinting/tooling concept. In Incan, <code>Option[T]</code> is an explicit enum that the compiler can reason about and enforce.</p>"},{"location":"language/tutorials/book/06_errors/#propagating-errors-with","title":"Propagating errors with <code>?</code>","text":"<p>The <code>?</code> operator returns early on <code>Err</code>, otherwise unwraps the <code>Ok</code> value:</p> <pre><code>def greet_user() -&gt; Result[None, str]:\n    name = read_username()?\n    println(f\"hello, {name}\")\n    return Ok(None)\n</code></pre>"},{"location":"language/tutorials/book/06_errors/#structured-errors-recommended","title":"Structured errors (recommended)","text":"<p>Prefer structured errors over strings when the caller should branch on error kinds:</p> <pre><code>enum NameError:\n    Empty\n\ndef normalize(name: str) -&gt; Result[str, NameError]:\n    cleaned = name.strip()\n    if len(cleaned) == 0:\n        return Err(NameError.Empty)\n    return Ok(cleaned.lower())\n</code></pre>"},{"location":"language/tutorials/book/06_errors/#try-it","title":"Try it","text":"<ol> <li>Write <code>def safe_div(a: float, b: float) -&gt; Result[float, str]</code>.</li> <li>Write <code>def first(items: List[str]) -&gt; Option[str]</code> and handle <code>None</code> vs <code>Some(...)</code> with <code>match</code>.</li> <li>Write <code>def parse_and_divide(n: float, s: str) -&gt; Result[float, str]</code> that uses <code>?</code> to parse <code>s</code> into a <code>float</code>,    then calls <code>safe_div</code>.</li> </ol> One possible solution <pre><code>def safe_div(a: float, b: float) -&gt; Result[float, str]:\n    if b == 0.0:\n        return Err(\"division by zero\")\n    return Ok(a / b)\n\ndef first(items: List[str]) -&gt; Option[str]:\n    if len(items) == 0:\n        return None\n    return Some(items[0])\n\ndef parse_and_divide(n: float, s: str) -&gt; Result[float, str]:\n    denom = float(s)?\n    return safe_div(n, denom)\n\ndef main() -&gt; None:\n    match first([\"a\", \"b\"]):\n        case Some(x): println(f\"first={x}\")\n        case None: println(\"empty\")\n\n    match parse_and_divide(10.0, \"2.0\"):\n        case Ok(x): println(f\"10 / 2 = {x}\")\n        case Err(e): println(f\"error: {e}\")\n</code></pre>"},{"location":"language/tutorials/book/06_errors/#what-to-learn-next","title":"What to learn next","text":"<ul> <li>Results, Options, and the <code>?</code> operator (deep dive): Error Handling</li> <li>Common error message patterns: Error Messages</li> </ul>"},{"location":"language/tutorials/book/06_errors/#next","title":"Next","text":"<p>Back: 5. Modules and imports</p> <p>Next chapter: 7. Strings and formatting</p>"},{"location":"language/tutorials/book/07_strings_and_formatting/","title":"7. Strings and formatting","text":"<p>Strings are <code>str</code>, and you\u2019ll often build output using f-strings.</p>"},{"location":"language/tutorials/book/07_strings_and_formatting/#string-methods","title":"String methods","text":"<pre><code>def main() -&gt; None:\n    raw = \"  Alice  \"\n    cleaned = raw.strip().lower()\n    println(cleaned)\n</code></pre>"},{"location":"language/tutorials/book/07_strings_and_formatting/#f-strings-interpolation","title":"F-strings (interpolation)","text":"<pre><code>def main() -&gt; None:\n    name = \"Alice\"\n    age = 30\n    println(f\"{name} age={age}\")\n</code></pre>"},{"location":"language/tutorials/book/07_strings_and_formatting/#try-it","title":"Try it","text":"<ol> <li>Normalize an input string with <code>strip().lower()</code>.</li> <li>Build an output line using an f-string.</li> <li>Use one string method you didn\u2019t use yet (for example <code>upper()</code>).</li> </ol> One possible solution <pre><code>def main() -&gt; None:\n    raw = \"  Alice  \"\n    cleaned = raw.strip().lower()\n    println(f\"cleaned={cleaned}\")\n    println(cleaned.upper())\n</code></pre>"},{"location":"language/tutorials/book/07_strings_and_formatting/#where-to-learn-more","title":"Where to learn more","text":"<ul> <li>Full strings guide: Strings</li> </ul>"},{"location":"language/tutorials/book/07_strings_and_formatting/#next","title":"Next","text":"<p>Back: 6. Errors (Result/Option and <code>?</code>)</p> <p>Next chapter: 8. Collections and iteration</p>"},{"location":"language/tutorials/book/08_collections_and_iteration/","title":"8. Collections and iteration","text":"<p>Incan has Python-like collections and a familiar <code>for</code> loop.</p> <p>Coming from Rust?</p> <p>Incan\u2019s built-in collections compile to the standard Rust collections:</p> <ul> <li><code>list[T]</code> / <code>List[T]</code> \u2192 <code>Vec&lt;T&gt;</code></li> <li><code>dict[K, V]</code> / <code>Dict[K, V]</code> \u2192 <code>HashMap&lt;K, V&gt;</code></li> <li><code>set[T]</code> / <code>Set[T]</code> \u2192 <code>HashSet&lt;T&gt;</code></li> </ul> <p>(See the prelude type mapping in the imports/modules reference for details.)</p>"},{"location":"language/tutorials/book/08_collections_and_iteration/#lists","title":"Lists","text":"<pre><code>def main() -&gt; None:\n    xs = [1, 2, 3]\n    println(f\"first={xs[0]}\")\n</code></pre>"},{"location":"language/tutorials/book/08_collections_and_iteration/#dicts","title":"Dicts","text":"<pre><code>def main() -&gt; None:\n    scores = dict([(\"alice\", 10), (\"bob\", 7)])\n    println(f\"alice={scores['alice']}\")\n</code></pre>"},{"location":"language/tutorials/book/08_collections_and_iteration/#sets","title":"Sets","text":"<p>Use a set to deduplicate values:</p> <pre><code>def main() -&gt; None:\n    names = [\"Alice\", \"Bob\", \"Alice\"]\n    unique = set(names)\n    println(f\"unique_count={len(unique)}\")\n</code></pre>"},{"location":"language/tutorials/book/08_collections_and_iteration/#iteration-with-for","title":"Iteration with <code>for</code>","text":"<pre><code>def main() -&gt; None:\n    names = [\"Alice\", \"Bob\", \"Cara\"]\n    for name in names:\n        println(name)\n</code></pre>"},{"location":"language/tutorials/book/08_collections_and_iteration/#comprehensions-quick-transforms","title":"Comprehensions (quick transforms)","text":"<p>Use comprehensions to build a new list/dict from an existing collection:</p> <pre><code>def main() -&gt; None:\n    names = [\" Alice \", \"Bob\", \" Cara \"]\n\n    normalized = [name.strip().lower() for name in names]\n    counts = {name: 1 for name in normalized}\n\n    println(f\"normalized={normalized:?}\")\n    println(f\"counts={counts:?}\")\n</code></pre>"},{"location":"language/tutorials/book/08_collections_and_iteration/#try-it","title":"Try it","text":"<ol> <li>Read a list of names, normalize (<code>strip().lower()</code>), and print them.</li> <li>Create a <code>dict[str, int]</code> of counts for how often each name appears.</li> <li>Use a <code>set</code> to print only unique names.</li> </ol> One possible solution <pre><code>def main() -&gt; None:\n    names = [\"Alice\", \"Alice\", \"Bob\", \"Bob\", \"Cara\"]\n\n    # 1) Normalize + print\n    normalized = [name.strip().lower() for name in names]\n    for name in normalized:\n        println(name)\n\n    # 2) Count occurrences\n    name_counts: Dict[str, int] = {}\n    for name in normalized:\n        current_count = name_counts.get(name).unwrap_or(0)\n        name_counts[name] = current_count + 1\n\n    # 3) Deduplicate + print counts (set iteration order is not guaranteed)\n    unique = set(normalized)\n    for name in unique:\n        println(f\"{name}: {name_counts.get(name).unwrap()}\")\n</code></pre>"},{"location":"language/tutorials/book/08_collections_and_iteration/#where-to-learn-more","title":"Where to learn more","text":"<ul> <li>Strings and slicing: Strings</li> <li>Control flow overview: Control flow</li> </ul>"},{"location":"language/tutorials/book/08_collections_and_iteration/#next","title":"Next","text":"<p>Back: 7. Strings and formatting</p> <p>Next chapter: 9. Enums and better <code>match</code></p>"},{"location":"language/tutorials/book/09_enums/","title":"9. Enums and better <code>match</code>","text":"<p>Enums let you represent \u201cone of several shapes\u201d as a real type, and <code>match</code> lets you handle it exhaustively.</p>"},{"location":"language/tutorials/book/09_enums/#a-small-command-enum","title":"A small command enum","text":"<pre><code>enum Command:\n    Add(int)\n    Remove(int)\n    List\n</code></pre> <p>Coming from Python?</p> <p>Python\u2019s <code>Enum</code> is mostly \u201cnamed constants\u201d. If you want variants that carry different data, Python often uses: strings, <code>dataclass</code> hierarchies, or <code>Union</code> types.</p> <p>In Incan, <code>enum</code> variants can carry data (like <code>Add(int)</code>), and <code>match</code> gives you an exhaustive, compiler-checked way to handle every case.</p>"},{"location":"language/tutorials/book/09_enums/#matching-on-enums","title":"Matching on enums","text":"<pre><code>def run(cmd: Command) -&gt; None:\n    match cmd:\n        Add(x) =&gt; println(f\"add {x}\")\n        Remove(x) =&gt; println(f\"remove {x}\")\n        List =&gt; println(\"list\")\n\ndef main() -&gt; None:\n    run(Command.Add(1))     # outputs: add 1\n    run(Command.Remove(1))  # outputs: remove 1\n    run(Command.List)       # outputs: list\n</code></pre>"},{"location":"language/tutorials/book/09_enums/#why-this-matters","title":"Why this matters","text":"<p>Unlike a stringly-typed \u201ccommand name\u201d, enums:</p> <ul> <li>prevent typos</li> <li>make invalid states unrepresentable</li> <li>give you exhaustive <code>match</code> checking</li> </ul>"},{"location":"language/tutorials/book/09_enums/#try-it","title":"Try it","text":"<ol> <li>Add a <code>Clear</code> variant and update the <code>match</code> accordingly.</li> <li>Add a <code>Rename(str)</code> variant and print the new name.</li> </ol> One possible solution <pre><code>enum Command:\n    Add(int)\n    Remove(int)\n    Rename(str)\n    Clear\n    List\n\ndef run(cmd: Command) -&gt; None:\n    match cmd:\n        Add(x) =&gt; println(f\"add {x}\")\n        Remove(x) =&gt; println(f\"remove {x}\")\n        Rename(name) =&gt; println(f\"rename {name}\")\n        Clear =&gt; println(\"clear\")\n        List =&gt; println(\"list\")\n</code></pre>"},{"location":"language/tutorials/book/09_enums/#where-to-learn-more","title":"Where to learn more","text":"<ul> <li>Enums deep dive: Enums</li> </ul>"},{"location":"language/tutorials/book/09_enums/#next","title":"Next","text":"<p>Back: 8. Collections and iteration</p> <p>Next chapter: 10. Models vs classes</p>"},{"location":"language/tutorials/book/10_models_vs_classes/","title":"10. Models vs classes","text":"<p>Incan has two \u201ctypes with fields\u201d:</p> <ul> <li><code>model</code>: data-first (great for DTOs, configs, payloads)</li> <li><code>class</code>: behavior-first (methods + possible mutation)</li> </ul> <p>Coming from Python?</p> <p>A <code>model</code> is closest to a Python <code>@dataclass</code> (or a Pydantic <code>Basemodel</code>) in spirit: you declare fields, and you get a constructor automatically.</p> <p>In Incan you don\u2019t write an <code>__init__</code>/init method. You construct values with keyword arguments matching the declared fields (as shown below), and you can give fields default values in the declaration when needed. For validation or alternate  construction, write a separate helper/factory function (often returning <code>Result</code>).</p>"},{"location":"language/tutorials/book/10_models_vs_classes/#a-simple-model","title":"A simple model","text":"<pre><code>model User:\n    name: str\n    age: int\n\ndef main() -&gt; None:\n    u = User(name=\"Alice\", age=30)\n    println(f\"{u.name} age={u.age}\")\n</code></pre>"},{"location":"language/tutorials/book/10_models_vs_classes/#a-simple-class","title":"A simple class","text":"<pre><code>class Counter:\n    value: int\n\n    def increment(mut self) -&gt; None:\n        self.value += 1\n\ndef main() -&gt; None:\n    c = Counter(value=0)\n    c.increment()\n    c.increment()\n    println(f\"value={c.value}\")  # outputs: value=2\n</code></pre>"},{"location":"language/tutorials/book/10_models_vs_classes/#try-it","title":"Try it","text":"<ol> <li>Create a <code>model Product</code> with <code>name</code> and <code>price</code>.</li> <li>Create a <code>class Cart</code> with a list of products and a method to compute a total.</li> <li>Print the total.</li> </ol> One possible solution <pre><code>model Product:\n    name: str\n    price: float\n\nclass Cart:\n    items: list[Product]\n\n    def total(self) -&gt; float:\n        total = 0.0\n        for item in self.items:\n            total = total + item.price\n        return total\n\ndef main() -&gt; None:\n    cart = Cart(items=[\n        Product(name=\"Book\", price=10.0),\n        Product(name=\"Pen\", price=2.5),\n    ])\n    println(f\"total={cart.total()}\")\n</code></pre>"},{"location":"language/tutorials/book/10_models_vs_classes/#where-to-learn-more","title":"Where to learn more","text":"<ul> <li>Full guide and decision table: Models &amp; Classes</li> </ul>"},{"location":"language/tutorials/book/10_models_vs_classes/#next","title":"Next","text":"<p>Back: 9. Enums and better <code>match</code></p> <p>Next chapter: 11. Traits and derives</p>"},{"location":"language/tutorials/book/11_traits_and_derives/","title":"11. Traits and derives","text":"<p>Traits describe shared behavior. Derives automatically generate common behavior for your types.</p>"},{"location":"language/tutorials/book/11_traits_and_derives/#derives-add-behavior-without-boilerplate","title":"Derives: add behavior without boilerplate","text":"<p>Derives add behavior to a type. One of the most common is <code>Debug</code>, which lets you print a structured representation of a value.</p> <p>Coming from Python?</p> <p>Derives are like getting common \u201cdunder methods\u201d (<code>__repr__</code>, <code>__eq__</code>, etc.) without writing them by hand.</p> <pre><code>@derive(Debug)\nmodel Point:\n    x: int\n    y: int\n\ndef main() -&gt; None:\n    p = Point(x=1, y=2)\n    println(f\"{p:?}\")\n</code></pre>"},{"location":"language/tutorials/book/11_traits_and_derives/#debug-formatting","title":"Debug formatting (<code>:?</code>)","text":"<p>The <code>:?</code> inside an f-string means \u201cdebug formatting\u201d.</p> <p>Coming from Python?</p> <p>Debug formatting (<code>:?</code>) is like Python\u2019s <code>__repr__</code>: it shows the type name and fields in a structured format.</p>"},{"location":"language/tutorials/book/11_traits_and_derives/#traits-shared-contracts","title":"Traits: shared contracts","text":"<p>Traits let you define a shared contract. In a trait, a method can either:</p> <ul> <li>Use <code>...</code> to mean \u201cimplementers must provide this\u201d (required methds)</li> <li>Provide a default implementation (Rust-like default methods)</li> </ul> <p>Coming from Python?</p> <p>Traits are like a typed interface (represented in Python by a <code>Protocol</code> or <code>abc.ABC</code>): \u201canything that implements these methods can be treated as this capability\u201d.</p> <p>Example:</p> <pre><code>trait Greetable:\n    # Required method: implementers must provide this\n    def name(self) -&gt; str: ...\n\n    # Default method: implementers can provide this\n    def greet(self) -&gt; str:\n        return f\"Hello, {self.name()}!\"\n\nmodel User with Greetable:\n    username: str\n\n    def name(self) -&gt; str:\n        return self.username\n\ndef main() -&gt; None:\n    u = User(username=\"alice\")\n    println(u.greet())  # outputs: Hello, alice!\n</code></pre>"},{"location":"language/tutorials/book/11_traits_and_derives/#try-it","title":"Try it","text":"<ol> <li>Add a second derived type and print it with <code>:?</code>.</li> <li>Create a small trait (for example <code>Describable</code>) and implement it for a model.</li> <li>Call the trait method.</li> </ol> One possible solution <pre><code>@derive(Debug)\nmodel Point:\n    x: int\n    y: int\n\ntrait Describable:\n    def describe(self) -&gt; str: ...\n\nmodel User with Describable:\n    username: str\n\n    def describe(self) -&gt; str:\n        return f\"user={self.username}\"\n\ndef main() -&gt; None:\n    println(f\"{Point(x=1, y=2):?}\")\n    println(User(username=\"alice\").describe())\n</code></pre>"},{"location":"language/tutorials/book/11_traits_and_derives/#where-to-learn-more","title":"Where to learn more","text":"<ul> <li>Derives and traits (full reference): Derives &amp; Traits</li> </ul>"},{"location":"language/tutorials/book/11_traits_and_derives/#next","title":"Next","text":"<p>Back: 10. Models vs classes</p> <p>Next chapter: 12. Newtypes (stronger types).</p>"},{"location":"language/tutorials/book/12_newtypes/","title":"12. Newtypes (stronger types)","text":"<p>A newtype is a \u201czero-cost wrapper\u201d around another type. It lets you create distinct types that the compiler won\u2019t let you accidentally mix up.</p>"},{"location":"language/tutorials/book/12_newtypes/#why-newtypes","title":"Why newtypes?","text":"<p>If two values share the same underlying type (like <code>int</code>), it\u2019s easy to mix them up by accident.</p> <p>With newtypes, the compiler helps you keep them straight:</p> <pre><code>type UserId = newtype int\ntype ProductId = newtype int\n\ndef get_user_name(user_id: UserId) -&gt; str:\n    return f\"user={user_id.0}\"\n\ndef get_product_name(product_id: ProductId) -&gt; str:\n    return f\"product={product_id.0}\"\n\ndef main() -&gt; None:\n    user_id = UserId(42)\n    product_id = ProductId(100)\n\n    println(get_user_name(user_id))\n    println(get_product_name(product_id))\n\n    # If you accidentally swap them, the compiler can catch it:\n    # println(get_user_name(product_id))\n</code></pre> <p>Coming from Python?</p> <p>This is similar to creating a tiny wrapper class just to avoid mixing up values, but with less runtime overhead and better static checking.</p>"},{"location":"language/tutorials/book/12_newtypes/#constructing-and-unwrapping","title":"Constructing and unwrapping","text":"<p>You construct a newtype by calling it like a function: <code>UserId(42)</code>.</p>"},{"location":"language/tutorials/book/12_newtypes/#validated-construction","title":"Validated construction","text":"<p>Newtypes can optionally define a reserved validation hook:</p> <pre><code>type Attempts = newtype int:\n    def from_underlying(n: int) -&gt; Result[Attempts, str]:\n        if n &lt;= 0:\n            return Err(\"attempts must be &gt;= 1\")\n        return Ok(Attempts(n))\n</code></pre> <p>If a newtype defines <code>from_underlying</code>, then calling it like <code>Attempts(5)</code> performs checked construction (it calls <code>Attempts.from_underlying(5)</code> and panics if it returns <code>Err(...)</code>). This is a stepping stone toward the full v0.2 RFC behavior.</p> <p>To access the wrapped value, use <code>.0</code>:</p> <pre><code>def main() -&gt; None:\n    user_id = UserId(42)\n    println(f\"{user_id.0}\")\n</code></pre>"},{"location":"language/tutorials/book/12_newtypes/#validation-with-result","title":"Validation with <code>Result</code>","text":"<p>Newtypes are great for values that should satisfy an invariant (like \u201cmust be positive\u201d).</p> <p>One common pattern is to provide a constructor helper that returns <code>Result</code>:</p> <pre><code>type UserId = newtype int\n\ndef make_positive_id(n: int) -&gt; Result[UserId, str]:\n    if n &gt; 0:\n        return Ok(UserId(n))\n    return Err(\"ID must be positive\")\n</code></pre> <p>You can then use <code>match</code> (or <code>?</code> if you\u2019re inside a function returning <code>Result</code>) to handle failures.</p>"},{"location":"language/tutorials/book/12_newtypes/#methods-on-newtypes","title":"Methods on newtypes","text":"<p>Newtypes can also define methods:</p> <pre><code>enum EmailError:\n    MissingAt\n\ntype Email = newtype str:\n    def from_underlying(v: str) -&gt; Result[Email, EmailError]:\n        \"\"\"Validate an email address by checking for the presence of an @ symbol\"\"\"\n        if \"@\" not in v:\n            return Err(EmailError.MissingAt)\n        return Ok(Email(v.lower()))\n\ndef main() -&gt; None:\n    match Email.from_underlying(\"Alice@Example.com\"):\n        Ok(email) =&gt; println(f\"email={email.0}\")\n        Err(_) =&gt; println(\"invalid email\")\n</code></pre>"},{"location":"language/tutorials/book/12_newtypes/#try-it","title":"Try it","text":"<ol> <li>Define <code>type CartItems = newtype List[str]</code>.</li> <li>Write <code>def non_empty(items: List[str]) -&gt; Result[CartItems, str]</code> that rejects empty lists.</li> <li>In <code>main()</code>, call it with both <code>[]</code> and <code>[\"a\"]</code> and print either the error or the first item.</li> </ol> One possible solution <pre><code>type CartItems = newtype List[str]\n\ndef non_empty(items: List[str]) -&gt; Result[CartItems, str]:\n    if len(items) == 0:\n        return Err(\"must not be empty\")\n    return Ok(CartItems(items))\n\ndef main() -&gt; None:\n    match non_empty([]):\n        Ok(items) =&gt; println(f\"first={items.0[0]}\")\n        Err(e) =&gt; println(f\"error: {e}\")\n\n    match non_empty([\"a\"]):\n        Ok(items) =&gt; println(f\"first={items.0[0]}\")\n        Err(e) =&gt; println(f\"error: {e}\")\n</code></pre>"},{"location":"language/tutorials/book/12_newtypes/#where-to-learn-more","title":"Where to learn more","text":"<ul> <li>Longer example in the repository: <code>examples/intermediate/newtypes.incn</code></li> </ul>"},{"location":"language/tutorials/book/12_newtypes/#next","title":"Next","text":"<p>Back: 11. Traits and derives</p> <p>Next: return to Start here or continue in the Language Guide.</p>"},{"location":"release_notes/","title":"Release notes","text":"<p>This section tracks user-facing changes in Incan across releases.</p>"},{"location":"release_notes/#docs-versioning-model","title":"Docs versioning model","text":"<ul> <li>dev: docs built from <code>main</code></li> <li>released: docs built from tags, exposed as minor versions (e.g. <code>0.1</code>)</li> </ul>"},{"location":"release_notes/#releases","title":"Releases","text":"<ul> <li>Release 0.1</li> </ul> <p>See also:</p> <ul> <li>Stability policy</li> </ul>"},{"location":"release_notes/0_1/","title":"Release 0.1","text":"<p>This is the first published minor release line for Incan.</p> <p>Incan is in beta: expect evolution as the language and toolchain stabilize. See the Stability policy for what changes are allowed in minor vs patch releases.</p>"},{"location":"release_notes/0_1/#highlights","title":"Highlights","text":"<ul> <li>A complete docs site (Start here, Tooling, Language Guide, Reference), built with MkDocs</li> <li>A make-first developer workflow (<code>make install</code>, <code>make smoke-test</code>)</li> <li>A usable CLI surface: <code>incan build</code>, <code>incan run</code>, <code>incan fmt</code>, <code>incan test</code></li> <li>A generated language reference to keep documentation and implementation aligned</li> </ul>"},{"location":"release_notes/0_1/#getting-started-recommended","title":"Getting started (recommended)","text":"<ul> <li>Start at: Language and Tooling</li> <li>For \u201cfirst steps\u201d workflows, use the CLI and Make targets referenced there.</li> </ul>"},{"location":"release_notes/0_1/#looking-for-contributors","title":"Looking for contributors?","text":"<p>Incan is still early and we\u2019d love help\u2014whether that\u2019s improving docs, fixing bugs, or implementing RFC-backed features.</p> <ul> <li>Start here: Contributing</li> <li>Good places to start:<ul> <li>docs fixes and examples</li> <li>compiler diagnostics and error messages</li> <li>small stdlib improvements</li> </ul> </li> </ul>"},{"location":"release_notes/0_1/#added-user-facing","title":"Added (user-facing)","text":"<ul> <li>Docs site (Start here, Tooling, Language Guide, Reference)</li> <li>Core CLI workflow: build/run/format/test (<code>incan build</code>, <code>incan run</code>, <code>incan fmt</code>, <code>incan test</code>)</li> </ul>"},{"location":"release_notes/0_1/#known-limitations-01","title":"Known limitations (0.1)","text":"<p>Incan is still evolving. A few things you may run into:</p> <ul> <li>Some compiler/language features described in RFCs may be partially implemented.</li> <li>Rust interop is available, but crate support is gated by a \u201cknown-good\u201d list (see: Rust interop).</li> </ul>"},{"location":"release_notes/0_1/#breaking-changes","title":"Breaking changes","text":"<ul> <li>This is a <code>0.x</code> release line; minor releases may introduce new language/tooling features.</li> <li>Patch releases must not introduce new language features (see: Stability policy).</li> </ul>"},{"location":"release_notes/0_1/#rfcs-implemented","title":"RFCs implemented","text":"<ul> <li>RFC 000: Incan Core Language RFC (Phase 1)</li> <li>RFC 008: Const Bindings</li> </ul>"},{"location":"start_here/","title":"Start here","text":"<p>If you\u2019re new to Incan, start here.</p> <p>Beta</p> <p>Incan is currently in Beta.</p> <p>What this means for you:</p> <ul> <li>Things may change quickly (especially ergonomics and tooling).</li> <li>Some pages may be incomplete; prefer the canonical entrypoints (Start here, Tooling start here, Language start here).</li> <li>If the docs imply a feature exists but you can\u2019t find it, treat it as either:<ul> <li>overpromise (docs should label as future), or</li> <li>discoverability gap (docs should link better), or</li> <li>product gap (feature not implemented yet).</li> </ul> </li> </ul> <p>Keep an eye on the GitHub Releases for new releases and changes.</p>"},{"location":"start_here/#not-sure-where-you-fit","title":"Not sure where you fit?","text":"<p>Choose by goal:</p> <ul> <li>Try it now: Getting Started (make-first install/build/run + hello world)<ul> <li>If anything fails: Troubleshooting</li> </ul> </li> <li>Learn the basics: The Incan Book (Basics)</li> <li>Look something up: Language reference (generated) + CLI reference</li> <li>Set up tooling: Tooling start here</li> <li>Contribute: Contributing start here</li> </ul>"},{"location":"start_here/#choose-a-path","title":"Choose a path","text":"<ul> <li>Coming from Python (apps)</li> <li>Coming from Rust (evaluator)</li> <li>Pipelines &amp; automation</li> <li>Beginner</li> </ul> <p>Note: these \u201cStart here\u201d pages are routing + framing only; canonical content lives in Language/Tooling/Contributing.</p>"},{"location":"start_here/beginner/","title":"Beginner path","text":"<p>This page is a routing guide for new programmers or readers new to programming-with-types.</p>"},{"location":"start_here/beginner/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust (1.85+): install via rustup</li> <li><code>git</code> + <code>make</code>: for the canonical Getting Started workflow</li> <li>Recommended: Editor setup (fast feedback while learning)</li> </ul>"},{"location":"start_here/beginner/#what-you-should-do-next","title":"What you should do next","text":"<ul> <li>Install/build/run (make-first) and run your first file: Getting Started</li> <li>Understand where builds go and what\u2019s generated: Projects today</li> <li>If anything fails: Troubleshooting</li> <li>Follow the basics tutorial track: The Incan Book (Basics)</li> <li>Keep a glossary handy: Glossary</li> <li>Use tooling early (editor/LSP) to get fast feedback: Editor setup</li> </ul>"},{"location":"start_here/beginner/#guardrails","title":"Guardrails","text":"<ul> <li>Don\u2019t start with the generated reference; use it later as a lookup tool.</li> <li>Don\u2019t start with RFCs; those are design records for contributors.</li> </ul>"},{"location":"start_here/coming_from_python/","title":"Coming from Python (apps)","text":"<p>This page is a routing guide for Python developers building apps/services.</p>"},{"location":"start_here/coming_from_python/#what-you-should-do-next","title":"What you should do next","text":"<ul> <li>Install/build/run (make-first): Getting Started</li> <li>If anything fails: Troubleshooting</li> <li>Learn the basics: The Incan Book (Basics)</li> <li>Build your first API: Build your first API</li> <li>Multi-file apps: Imports and modules (how-to)</li> <li>Set up your workflow:<ul> <li>Formatting</li> <li>Testing</li> <li>Editor setup (LSP, syntax highlighting)</li> </ul> </li> </ul>"},{"location":"start_here/coming_from_python/#explanation","title":"Explanation","text":"<ul> <li>Why Incan?</li> <li>How Incan works</li> </ul>"},{"location":"start_here/coming_from_python/#mental-model-translations-high-level","title":"Mental model translations (high level)","text":"<ul> <li>errors: exceptions vs Result/Option (see: Error Handling)</li> <li>models: dataclasses/Pydantic vs models/derives (see: Models &amp; Classes)</li> <li>interfaces: Protocols/ABCs vs traits/derives (see: Derives &amp; Traits)</li> <li>async: asyncio mental model mapping (see: Async Programming)</li> </ul>"},{"location":"start_here/coming_from_rust/","title":"Coming from Rust (evaluator)","text":"<p>This page is a routing guide for Rust-first evaluators.</p>"},{"location":"start_here/coming_from_rust/#what-you-should-do-next","title":"What you should do next","text":"<ul> <li>Quickstart: Getting Started (make-first, with fallback when needed)</li> <li>Explanation:<ul> <li>Why Incan?</li> <li>Why not just Rust?</li> <li>How Incan works</li> </ul> </li> <li>Interop: Rust Interop</li> <li>Projects today: Projects today</li> <li>Reference surfaces:<ul> <li>Language reference (generated)</li> <li>CLI reference</li> </ul> </li> <li>Stability: Stability policy + Release notes</li> <li>Evolution surfaces:<ul> <li>Contributing start here</li> <li>Incan Contributor Book (Advanced)</li> <li>RFC index</li> <li>Roadmap</li> </ul> </li> </ul>"},{"location":"start_here/coming_from_rust/#what-to-look-for","title":"What to look for","text":"<ul> <li>Clear boundaries: what exists today vs roadmap (especially for WASM/frontend)</li> <li>\u201cStable vs experimental\u201d labeling without forcing you to read RFCs first</li> </ul>"},{"location":"start_here/pipelines_and_automation/","title":"Pipelines &amp; automation","text":"<p>This page is a routing guide for step/pipeline-style workflows (automation, reproducibility, CI-friendly runs).</p>"},{"location":"start_here/pipelines_and_automation/#what-you-should-do-next","title":"What you should do next","text":"<ul> <li>Quickstart: Getting Started (make-first)</li> <li>Pipeline tutorial: Pipeline mini-project</li> <li>CI entrypoint (projects): CI &amp; automation</li> <li>CI entrypoint (contributors): CI &amp; automation (repository)</li> <li>Tooling workflow:<ul> <li>Testing</li> <li>Formatting</li> <li>LSP</li> </ul> </li> <li>Language foundations for \u201cstructured automation\u201d:<ul> <li>Error Handling</li> <li>Imports &amp; Modules</li> <li>File I/O</li> </ul> </li> </ul>"},{"location":"start_here/pipelines_and_automation/#what-to-look-for","title":"What to look for","text":"<ul> <li>Deterministic commands and outputs (exit codes, reproducible runs)</li> <li>Honest \u201cwhat exists today\u201d vs \u201cfuture\u201d labeling (no implied platform integrations)</li> </ul>"},{"location":"start_here/pipelines_and_automation/#works-today-use-this-for-pipelines","title":"Works today (use this for pipelines)","text":"<ul> <li><code>incan fmt --check</code> for CI formatting enforcement</li> <li><code>incan test</code> with basic filtering (<code>-k</code>) and CI-friendly exit codes</li> <li><code>incan run</code> for deterministic single-program runs (exit code follows the program)</li> </ul> <p>If you are contributing to the Incan repository itself, the CI entrypoints are <code>make check</code> / <code>make test</code> / <code>make smoke-test</code> (see: CI &amp; automation (repository)).</p>"},{"location":"start_here/pipelines_and_automation/#not-yet-planned-dont-rely-on-it-for-automation","title":"Not yet / planned (don\u2019t rely on it for automation)","text":"<ul> <li>Project config + lockfiles (<code>incan.toml</code>, dependency pinning, reproducible dependency resolution)</li> <li>First-class \u201cproject lifecycle\u201d commands (<code>incan init/new/doctor</code>)</li> <li>Offline/locked build workflows built into the CLI (enterprise constraints)</li> </ul>"},{"location":"tooling/","title":"Tooling: Start here","text":"<p>This section covers the Incan tooling experience:</p> <ul> <li>CLI (build/run/fmt/test)</li> <li>editor setup and LSP</li> </ul> <p>If you\u2019re not sure where you fit, start at Start here.</p>"},{"location":"tooling/#tutorials-learn","title":"Tutorials (learn)","text":"<ul> <li>Getting Started</li> </ul>"},{"location":"tooling/#how-to-guides-do","title":"How-to guides (do)","text":"<ul> <li>Editor Setup</li> <li>LSP</li> <li>Formatting</li> <li>Testing</li> </ul>"},{"location":"tooling/#reference-look-up","title":"Reference (look up)","text":"<p>Single source of truth pages under Tooling:</p> <ul> <li>Install/build/run (make-first)</li> <li>CLI reference (commands/flags/env vars)</li> </ul>"},{"location":"tooling/#canonical-commands-make-first","title":"Canonical commands (make-first)","text":"Recommended: install to PATHFallback: no install <pre><code>make install\nincan --version\n</code></pre> <p>Notes:</p> <ul> <li><code>make install</code> installs <code>incan</code> to <code>~/.cargo/bin</code>.</li> <li>If <code>incan</code> is not found, make sure <code>~/.cargo/bin</code> is on your <code>PATH</code>.</li> </ul> <pre><code>make release\n./target/release/incan --version\n</code></pre>"},{"location":"tooling/#notes","title":"Notes","text":"<ul> <li>We prefer repository <code>make</code> targets in docs wherever possible.</li> </ul>"},{"location":"tooling/explanation/lsp_architecture/","title":"LSP architecture","text":"<p>This page explains how the Incan Language Server works internally.</p>"},{"location":"tooling/explanation/lsp_architecture/#high-level-design","title":"High-level design","text":"<p>The LSP is built with tower-lsp and reuses Incan's compiler frontend.</p> <pre><code>flowchart LR\n  editor[\"Editor&lt;br/&gt;(VS Code)\"]\n\n  subgraph lsp[\"incan-lsp\"]\n    direction TB\n    lexer[\"Lexer\"]\n    parser[\"Parser\"]\n    tc[\"TypeChecker\"]\n    lexer --&gt; parser --&gt; tc\n  end\n\n  editor &lt;--&gt; |stdio| lexer</code></pre> <p>On each file change, the LSP runs the compiler pipeline and reports:</p> <ul> <li>lexer errors (tokenization failures)</li> <li>parser errors (syntax errors)</li> <li>type errors (type mismatches, unknown symbols, etc.)</li> </ul>"},{"location":"tooling/explanation/projects_today/","title":"Projects today (current reality)","text":"<p>This page explains how \u201cprojects\u201d work in Incan today, and what is planned next.</p>"},{"location":"tooling/explanation/projects_today/#the-current-model","title":"The current model","text":"<p>Incan source files (<code>.incn</code>) are the source of truth.</p> <p>When you run:</p> <pre><code>incan build path/to/main.incn\n</code></pre> <p>Incan generates a Rust project and builds it via Cargo.</p> <p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre>"},{"location":"tooling/explanation/projects_today/#where-outputs-go","title":"Where outputs go","text":"<p>On build, Incan prints the generated project directory and the compiled binary path. In practice, outputs live under:</p> <ul> <li>Generated Rust project: <code>target/incan/&lt;name&gt;/</code></li> <li>Built binary: <code>target/incan/&lt;name&gt;/target/release/&lt;name&gt;</code></li> </ul> <p>See: CLI reference.</p>"},{"location":"tooling/explanation/projects_today/#what-gets-regenerated","title":"What gets regenerated","text":"<p>The generated Rust project under <code>target/incan/</code> is tool-managed output. Treat it as generated:</p> <ul> <li>It is safe to delete: <code>rm -rf target/incan/</code></li> <li>Manual edits inside <code>target/incan/&lt;name&gt;/</code> may be overwritten on the next build</li> </ul>"},{"location":"tooling/explanation/projects_today/#dependencies-today","title":"Dependencies (today)","text":"<ul> <li>For <code>rust::</code> imports, the toolchain uses a curated \u201cknown-good\u201d mapping for versions/features.</li> <li>If a crate is not in the known-good list, you\u2019ll need to request adding it (issue/PR) until the dependency system is   expanded.</li> </ul> <p>See: Rust Interop and RFC 013.</p>"},{"location":"tooling/explanation/projects_today/#whats-planned","title":"What\u2019s planned","text":"<p>Future work aims to make the project lifecycle explicit and reproducible:</p> <ul> <li><code>incan.toml</code> project config + lockfiles: RFC 013</li> <li>\u201cProject lifecycle\u201d commands (<code>incan init/new/doctor</code>): RFC 015</li> </ul>"},{"location":"tooling/how-to/ci_and_automation/","title":"CI &amp; automation (projects / CLI-first)","text":"<p>This page collects the canonical, CI-friendly commands for Incan projects (using the <code>incan</code> CLI).</p> <p>If you\u2019re running CI for the Incan compiler/tooling repository, see: CI &amp; automation (repository).</p>"},{"location":"tooling/how-to/ci_and_automation/#recommended-commands","title":"Recommended commands","text":""},{"location":"tooling/how-to/ci_and_automation/#type-check-fast-gate","title":"Type check (fast gate)","text":"<p>Type-check a program without building/running it (default action when no subcommand is provided):</p> <pre><code>incan path/to/main.incn\n</code></pre>"},{"location":"tooling/how-to/ci_and_automation/#format-ci-mode","title":"Format (CI mode)","text":"<p>Check formatting without modifying files:</p> <pre><code>incan fmt --check .\n</code></pre> <p>See also: Formatting and CLI reference.</p>"},{"location":"tooling/how-to/ci_and_automation/#tests","title":"Tests","text":"<p>Run all tests:</p> <pre><code>incan test .\n</code></pre> <p>See also: Testing and CLI reference.</p>"},{"location":"tooling/how-to/ci_and_automation/#run-an-incn-file","title":"Run an incn file","text":"<p>Run a program and use its exit code as the CI result:</p> <pre><code>incan run path/to/main.incn\n</code></pre>"},{"location":"tooling/how-to/ci_and_automation/#github-actions-example","title":"GitHub Actions example","text":"<pre><code>- name: Type check\n  run: incan path/to/main.incn\n\n- name: Format (CI)\n  run: incan fmt --check .\n\n- name: Tests\n  run: incan test .\n</code></pre>"},{"location":"tooling/how-to/editor_setup/","title":"Editor &amp; IDE Setup","text":"<p>Note: Incan-specific tooling is in development. This guide will be updated as the tooling improves.</p> <p>On this page:</p> <ul> <li>Syntax Highlighting</li> <li>Language Server (LSP)</li> <li>Format on Save</li> <li>Recommended Extensions</li> </ul>"},{"location":"tooling/how-to/editor_setup/#syntax-highlighting","title":"Syntax Highlighting","text":"<p> Example of Incan Syntax Highlighting in VS Code</p>"},{"location":"tooling/how-to/editor_setup/#vs-code-cursor-recommended","title":"VS Code / Cursor (Recommended)","text":"<p>The Incan extension provides full syntax highlighting for <code>.incn</code> files.</p> <p>Installation:</p> <ol> <li>Copy the <code>editors/vscode/</code> folder to your VS Code extensions directory:</li> </ol> <pre><code># macOS/Linux\ncp -r editors/vscode ~/.vscode/extensions/incan-language\n\n# Or for Cursor\ncp -r editors/vscode ~/.cursor/extensions/incan-language\n</code></pre> <ol> <li> <p>Restart VS Code/Cursor</p> </li> <li> <p>Open any <code>.incn</code> file - syntax highlighting should work automatically</p> </li> </ol> <p>Features:</p> <ul> <li>Full syntax highlighting for all Incan constructs</li> <li>Keywords: <code>model</code>, <code>class</code>, <code>trait</code>, <code>enum</code>, <code>newtype</code>, <code>async</code>, <code>await</code></li> <li>Rust-style operators: <code>?</code>, <code>::</code></li> <li>F-string interpolation highlighting</li> <li>Type annotations</li> <li>Decorators (<code>@derive</code>, <code>@skip</code>, etc.)</li> <li>Markdown code block highlighting for <code>incan</code> language</li> <li>LSP integration - Diagnostics, hover, go-to-definition (requires incan-lsp)</li> </ul> <p>See <code>editors/vscode/README.md</code> for full details.</p> <p>Alternative: Use Python highlighting</p> <p>If you don't want to install the extension:</p> <ol> <li>Open Settings (<code>Cmd/Ctrl</code> + <code>,</code>)</li> <li>Search for \"files.associations\"</li> <li>Add: <code>\"*.incn\": \"python\"</code></li> </ol> <p>Note: Although most of the syntax for Incan is supported by Python, using Python highlighting will not provide the full Incan experience. It's a good way to 'get started' quickly without installing the extension.</p>"},{"location":"tooling/how-to/editor_setup/#vimneovim","title":"Vim/Neovim","text":"<p>Add to your config:</p> <pre><code>\" Associate .incn files with Python syntax\nautocmd BufNewFile,BufRead *.incn set filetype=python\n</code></pre>"},{"location":"tooling/how-to/editor_setup/#jetbrains-ides-pycharm-intellij","title":"JetBrains IDEs (PyCharm, IntelliJ)","text":"<ol> <li>Go to Settings \u2192 Editor \u2192 File Types</li> <li>Find \"Python\" and add <code>*.incn</code> to registered patterns</li> </ol>"},{"location":"tooling/how-to/editor_setup/#language-server-lsp","title":"Language Server (LSP)","text":"<p>The Incan Language Server provides IDE integration:</p> <ul> <li>Real-time diagnostics - See errors as you type</li> <li>Hover information - View types and signatures</li> <li>Go-to-definition - Jump to symbol definitions</li> <li>Completions - Keywords and symbols</li> </ul> <p>See Language Server for setup instructions.</p>"},{"location":"tooling/how-to/editor_setup/#format-on-save","title":"Format on Save","text":""},{"location":"tooling/how-to/editor_setup/#vs-code-cursor","title":"VS Code / Cursor","text":"<p>Once the Incan extension is available, format-on-save will be supported.</p> <p>For now, you can set up a task or use a file watcher:</p> <pre><code>// .vscode/tasks.json\n{\n  \"version\": \"2.0.0\",\n  \"tasks\": [\n    {\n      \"label\": \"Format Incan\",\n      \"type\": \"shell\",\n      \"command\": \"incan fmt ${file}\",\n      \"group\": \"build\",\n      \"presentation\": {\n        \"reveal\": \"silent\"\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"tooling/how-to/editor_setup/#recommended-extensions","title":"Recommended Extensions","text":"<ul> <li>Error Lens - Inline error display</li> <li>TODO Highlight - Track TODOs in code</li> </ul>"},{"location":"tooling/how-to/editor_setup/#next-steps","title":"Next Steps","text":"<ul> <li>Formatting Guide - Code style and <code>incan fmt</code></li> <li>Language Guide - Learn Incan syntax and features</li> <li>Examples - Sample programs</li> </ul>"},{"location":"tooling/how-to/formatting/","title":"Incan Code Formatting","text":"<p>The <code>incan fmt</code> command formats Incan source code following a consistent style inspired by Ruff and Black.</p>"},{"location":"tooling/how-to/formatting/#quick-start","title":"Quick Start","text":"<p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre> <p>Repo formatting vs Incan formatting</p> <ul> <li>Use <code>incan fmt</code> to format Incan source files (<code>.incn</code>).</li> <li>Use <code>make fmt</code> to format the Rust compiler/tooling code in this repository.</li> </ul> <pre><code># Format a single file\nincan fmt myfile.incn\n\n# Format all .incn files in a directory\nincan fmt src/\n\n# Check if files need formatting (CI mode)\nincan fmt --check .\n\n# Show what would change without modifying\nincan fmt --diff myfile.incn\n</code></pre> <p><code>--diff</code> output can look empty for EOF-only changes</p> <p>If the only change is at end-of-file (like adding/removing a trailing newline), some diff viewers may not display an obvious change even though <code>incan fmt</code> would update the file.</p>"},{"location":"tooling/how-to/formatting/#style-guide","title":"Style Guide","text":""},{"location":"tooling/how-to/formatting/#indentation","title":"Indentation","text":"<ul> <li>4 spaces per indentation level</li> <li>No tabs</li> </ul> <pre><code>def calculate(x: int) -&gt; int:\n    if x &gt; 0:\n        return x * 2\n    return 0\n</code></pre>"},{"location":"tooling/how-to/formatting/#line-length","title":"Line Length","text":"<ul> <li>120 characters target (best-effort, not strictly enforced)</li> <li>Long lines are wrapped after opening parentheses/brackets where possible</li> <li>Manual wrapping may be needed for very long expressions</li> </ul>"},{"location":"tooling/how-to/formatting/#blank-lines","title":"Blank Lines","text":"<ul> <li>2 blank lines between top-level declarations (functions, classes, models, traits)</li> <li>1 blank line between methods within a class/model</li> </ul> <pre><code>def first_function() -&gt; None:\n    pass\n\n\ndef second_function() -&gt; None:\n    pass\n\n\nmodel User:\n    name: str\n    age: int\n\n    def greet(self) -&gt; str:\n        return f\"Hello, {self.name}\"\n\n    def is_adult(self) -&gt; bool:\n        return self.age &gt;= 18\n</code></pre>"},{"location":"tooling/how-to/formatting/#spacing","title":"Spacing","text":"<ul> <li>Spaces around binary operators: <code>a + b</code>, not <code>a+b</code></li> <li>No space after function name: <code>foo(x)</code>, not <code>foo (x)</code></li> <li>Space after comma: <code>foo(a, b)</code>, not <code>foo(a,b)</code></li> <li>Space after colon in type annotations: <code>x: int</code>, not <code>x:int</code></li> <li>No space around <code>=</code> in named arguments: <code>User(name=\"Alice\")</code>, not <code>User(name = \"Alice\")</code></li> </ul>"},{"location":"tooling/how-to/formatting/#strings","title":"Strings","text":"<ul> <li>Double quotes preferred for strings</li> <li>Single quotes preserved if already used</li> </ul>"},{"location":"tooling/how-to/formatting/#trailing-commas","title":"Trailing Commas","text":"<ul> <li>Added in multi-line constructs for cleaner diffs</li> </ul>"},{"location":"tooling/how-to/formatting/#docstrings","title":"Docstrings","text":"<ul> <li>Single-line docstrings on one line: <code>\"\"\"Brief description\"\"\"</code></li> <li>Multi-line docstrings with content on separate lines:</li> </ul> <pre><code>\"\"\"\nThis is a longer docstring.\n\nIt can span multiple lines.\n\"\"\"\n</code></pre>"},{"location":"tooling/how-to/formatting/#cli-options","title":"CLI Options","text":"Option Description <code>incan fmt &lt;path&gt;</code> Format file(s) in place <code>--check</code> Exit non-zero if files would be reformatted (useful for CI) <code>--diff</code> Show what would change without modifying files"},{"location":"tooling/how-to/formatting/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success (no changes needed, or formatting complete) 1 Files need formatting (with <code>--check</code>) or errors occurred"},{"location":"tooling/how-to/formatting/#ci-integration","title":"CI Integration","text":"<p>Add to your CI pipeline to enforce consistent formatting:</p> <pre><code># GitHub Actions example\n- name: Check formatting\n  run: incan fmt --check .\n</code></pre>"},{"location":"tooling/how-to/formatting/#configuration","title":"Configuration","text":"<p>Currently, formatting options use sensible defaults based on Ruff/Black conventions. Configuration file support (e.g., <code>incan.toml</code>) is planned for future releases.</p> <p>Default settings:</p> <ul> <li>Indent: 4 spaces</li> <li>Line length: 120 characters</li> <li>Quote style: Double quotes</li> <li>Trailing commas: Yes (in multi-line)</li> </ul>"},{"location":"tooling/how-to/formatting/#limitations","title":"Limitations","text":""},{"location":"tooling/how-to/formatting/#parse-required","title":"Parse-required","text":"<p>The formatter requires valid syntax. Unlike some formatters that can handle partial/broken code, <code>incan fmt</code> operates on the parsed AST and cannot format files with syntax errors.</p> <p>If a file has errors, you'll see:</p> <pre><code>Error formatting myfile.incn: Parser error: [...]\n</code></pre> <p>Fix syntax errors before formatting.</p>"},{"location":"tooling/how-to/formatting/#line-length-is-best-effort","title":"Line length is best-effort","text":"<p>The 120-character line length is a target, not a strict limit. The formatter doesn't automatically wrap all long lines. Some constructs (very long strings, complex expressions) may exceed the target and require manual formatting.</p>"},{"location":"tooling/how-to/formatting/#next-steps","title":"Next Steps","text":"<ul> <li>Language Guide - Learn Incan syntax and features</li> <li>Examples - Sample programs</li> <li>testing - Test runner and fixtures</li> </ul>"},{"location":"tooling/how-to/install_and_run/","title":"Install, build, and run (make-first)","text":"<p>This page documents the canonical way to build/install/run Incan from this repository.</p>"},{"location":"tooling/how-to/install_and_run/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust (1.85+): install via rustup</li> <li><code>git</code>: to clone the repository</li> <li><code>make</code>: for the canonical make-first workflow</li> </ul> <p>These instructions assume a Unix-like shell environment (macOS/Linux). If you\u2019re on Windows, use WSL or adapt the commands.</p>"},{"location":"tooling/how-to/install_and_run/#get-the-repo-run-from-repo-root","title":"Get the repo (run from repo root)","text":"<p>Run the commands on this page from the repository root (the directory containing <code>Makefile</code>):</p> <pre><code>git clone https://github.com/dannys-code-corner/incan.git\ncd incan\n</code></pre>"},{"location":"tooling/how-to/install_and_run/#canonical-command-flow","title":"Canonical command flow","text":"Recommended: install to PATHFallback: no install <pre><code>make install\nincan --version\n</code></pre> <p>Notes:</p> <ul> <li><code>make install</code> installs <code>incan</code> to <code>~/.cargo/bin</code>.</li> <li>If <code>incan</code> is not found, make sure <code>~/.cargo/bin</code> is on your <code>PATH</code>.</li> </ul> <pre><code>make release\n./target/release/incan --version\n</code></pre>"},{"location":"tooling/how-to/install_and_run/#run-a-file","title":"Run a file","text":"<p>If you used <code>make install</code>:</p> <pre><code>incan run hello.incn\n</code></pre> <p>If you used the no-install fallback:</p> <pre><code>./target/release/incan run hello.incn\n</code></pre>"},{"location":"tooling/how-to/lsp/","title":"Incan Language Server (LSP)","text":"<p>The Incan Language Server provides IDE integration for real-time feedback while coding.</p>"},{"location":"tooling/how-to/lsp/#features","title":"Features","text":"Feature Description Diagnostics Real-time errors, warnings, and hints as you type Hover View function signatures, types, and documentation Go-to-Definition Jump to symbol definitions (Cmd/Ctrl + Click) Completions Autocomplete for keywords and symbols"},{"location":"tooling/how-to/lsp/#installation","title":"Installation","text":""},{"location":"tooling/how-to/lsp/#1-build-the-lsp-server","title":"1. Build the LSP Server","text":"<pre><code>cd /path/to/incan-programming-language\nmake lsp\n</code></pre>"},{"location":"tooling/how-to/lsp/#2-add-to-path","title":"2. Add to PATH","text":"<p>Add the binary to your PATH:</p> <pre><code># Add to .bashrc, .zshrc, or your shell profile\nexport PATH=\"$PATH:/path/to/incan-programming-language/target/release\"\n</code></pre> <p>Or symlink it:</p> <pre><code>sudo ln -s /path/to/incan-programming-language/target/release/incan-lsp /usr/local/bin/\n</code></pre>"},{"location":"tooling/how-to/lsp/#3-install-vs-code-extension","title":"3. Install VS Code Extension","text":"<p>See Editor Setup for VS Code/Cursor extension installation.</p>"},{"location":"tooling/how-to/lsp/#usage","title":"Usage","text":"<p>Once installed, the LSP activates automatically when you open <code>.incn</code> files.</p>"},{"location":"tooling/how-to/lsp/#real-time-diagnostics","title":"Real-time Diagnostics","text":"<p>Errors appear as you type with helpful hints:</p> <pre><code>type error: Type mismatch: expected 'Result[str, str]', found 'str'\n  --&gt; file.incn:8:5\n\nnote: In Incan, functions that can fail return Result[T, E]\nhint: Wrap the value with Ok(...) to return success\n</code></pre>"},{"location":"tooling/how-to/lsp/#hover-information","title":"Hover Information","text":"<p>Hover over any symbol to see its type:</p> <pre><code>def process(data: List[str]) -&gt; Result[int, Error]\n</code></pre>"},{"location":"tooling/how-to/lsp/#go-to-definition","title":"Go-to-Definition","text":"<ul> <li>VS Code/Cursor: Cmd+Click (macOS) or Ctrl+Click (Windows/Linux)</li> <li>Keyboard: F12 or Ctrl+Click</li> </ul> <p>Works for:</p> <ul> <li>Functions</li> <li>Models</li> <li>Classes</li> <li>Traits</li> <li>Enums</li> <li>Newtypes</li> </ul>"},{"location":"tooling/how-to/lsp/#completions","title":"Completions","text":"<p>Trigger completions with Ctrl+Space or by typing:</p> <ul> <li><code>.</code> for field/method access</li> <li><code>:</code> for type annotations</li> </ul> <p>Suggestions include:</p> <ul> <li>Incan keywords (<code>def</code>, <code>model</code>, <code>class</code>, etc.)</li> <li>Symbols from current file</li> <li>Built-in types (<code>Result</code>, <code>Option</code>, etc.)</li> </ul>"},{"location":"tooling/how-to/lsp/#configuration","title":"Configuration","text":""},{"location":"tooling/how-to/lsp/#vs-code-settings","title":"VS Code Settings","text":"<pre><code>{\n  \"incan.lsp.enabled\": true,\n  \"incan.lsp.path\": \"/path/to/incan-lsp\"\n}\n</code></pre> Setting Default Description <code>incan.lsp.enabled</code> <code>true</code> Enable/disable the language server <code>incan.lsp.path</code> <code>\"\"</code> Custom path to incan-lsp (uses PATH if empty)"},{"location":"tooling/how-to/lsp/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tooling/how-to/lsp/#lsp-not-starting","title":"LSP Not Starting","text":"<ol> <li> <p>Check binary exists:</p> <pre><code>which incan-lsp\n# or\nincan-lsp --version\n</code></pre> </li> <li> <p>Check VS Code output:</p> <ul> <li>View \u2192 Output \u2192 Select \"Incan Language Server\"</li> </ul> </li> <li> <p>Verify extension is active:</p> <ul> <li>Extensions panel \u2192 Search \"Incan\" \u2192 Check it's enabled</li> </ul> </li> </ol>"},{"location":"tooling/how-to/lsp/#no-diagnostics","title":"No Diagnostics","text":"<ul> <li>Ensure the file has <code>.incn</code> extension</li> <li>Check for syntax errors that prevent parsing</li> <li>Try reloading the window (Cmd/Ctrl + Shift + P \u2192 \"Reload Window\")</li> </ul>"},{"location":"tooling/how-to/lsp/#hover-not-working","title":"Hover Not Working","text":"<ul> <li>LSP must successfully parse the file first</li> <li>Check for diagnostics/errors in the file</li> <li>Ensure cursor is on a symbol (function name, type name, etc.)</li> </ul>"},{"location":"tooling/how-to/lsp/#see-also","title":"See also","text":"<ul> <li>Architecture: LSP architecture</li> <li>Reference: LSP protocol support</li> </ul>"},{"location":"tooling/how-to/testing/","title":"Testing in Incan","text":"<p>Incan provides a pytest-like testing experience with <code>incan test</code>.</p>"},{"location":"tooling/how-to/testing/#quick-start","title":"Quick Start","text":"<p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre> <p>If something fails</p> <p>If you run into errors, see Troubleshooting. If it still looks like a bug, please file an issue on GitHub.</p> <p>Create a test file (must be named <code>test_*.incn</code> or <code>*_test.incn</code>):</p> <pre><code>\"\"\"Test file for math operations\"\"\"\n\ndef add(a: int, b: int) -&gt; int:\n    return a + b\n\n\ndef test_addition() -&gt; None:\n    result = add(2, 3)\n    assert_eq(result, 5)\n\n\ndef test_subtraction() -&gt; None:\n    result = 10 - 3\n    assert_eq(result, 7)\n</code></pre> <p>Run tests:</p> <pre><code>incan test tests/\n</code></pre>"},{"location":"tooling/how-to/testing/#test-discovery","title":"Test Discovery","text":"<p>Tests are discovered automatically:</p> <ul> <li>Files: Named <code>test_*.incn</code> or <code>*_test.incn</code></li> <li>Functions: Named <code>def test_*()</code></li> </ul> <pre><code>my_project/\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 main.incn\n\u2514\u2500\u2500 tests/\n    \u251c\u2500\u2500 test_math.incn      # \u2713 discovered\n    \u251c\u2500\u2500 test_strings.incn   # \u2713 discovered\n    \u2514\u2500\u2500 helpers.incn        # \u2717 not a test file\n</code></pre>"},{"location":"tooling/how-to/testing/#assertions","title":"Assertions","text":"<p>Use assertion functions (not Python-style <code>assert expr</code>):</p> <pre><code># Equality\nassert_eq(actual, expected)\nassert_ne(actual, other)\n\n# Boolean\nassert_true(condition)\nassert_false(condition)\n\n# With custom message\nassert_eq(result, 42, \"calculation was wrong\")\n\n# Explicit failure\nfail(\"this test should not reach here\")\n</code></pre>"},{"location":"tooling/how-to/testing/#markers","title":"Markers","text":""},{"location":"tooling/how-to/testing/#skip-skip-a-test","title":"@skip - Skip a test","text":"<pre><code>@skip(\"not implemented yet\")\ndef test_future_feature() -&gt; None:\n    pass\n</code></pre> <p>Output: <code>test_future_feature SKIPPED (not implemented yet)</code></p>"},{"location":"tooling/how-to/testing/#xfail-expected-failure","title":"@xfail - Expected failure","text":"<pre><code>@xfail(\"known bug #123\")\ndef test_known_issue() -&gt; None:\n    assert_eq(buggy_function(), \"fixed\")\n</code></pre> <p>If test fails: <code>XFAIL</code> (expected) If test passes: <code>XPASS</code> (unexpected - reported as failure)</p>"},{"location":"tooling/how-to/testing/#slow-mark-slow-tests","title":"@slow - Mark slow tests","text":"<pre><code>@slow\ndef test_integration() -&gt; None:\n    # Long-running test\n    pass\n</code></pre> <p>Slow tests are excluded by default. Include with <code>--slow</code>.</p>"},{"location":"tooling/how-to/testing/#cli-options","title":"CLI Options","text":"<pre><code># Run all tests in directory\nincan test tests/\n\n# Run specific file\nincan test tests/test_math.incn\n\n# Filter by keyword\nincan test -k \"addition\"\n\n# Verbose output (show timing)\nincan test -v\n\n# Stop on first failure\nincan test -x\n\n# Include slow tests\nincan test --slow\n</code></pre>"},{"location":"tooling/how-to/testing/#output-format","title":"Output Format","text":"<pre><code>=================== test session starts ===================\ncollected 4 item(s)\n\ntest_math.incn::test_addition PASSED\ntest_math.incn::test_subtraction PASSED\ntest_math.incn::test_division FAILED\ntest_math.incn::test_future SKIPPED (not implemented)\n\n=================== FAILURES ===================\n___________ test_division ___________\n\n    assertion failed: `assert_eq(10 / 3, 3)`\n    left: 3.333...\n    right: 3\n\n    tests/test_math.incn::test_division\n\n=================== 2 passed, 1 failed, 1 skipped in 0.05s ===================\n</code></pre>"},{"location":"tooling/how-to/testing/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 All tests passed 1 One or more tests failed"},{"location":"tooling/how-to/testing/#ci-integration","title":"CI Integration","text":"<pre><code># GitHub Actions\n- name: Run tests\n  run: incan test tests/\n</code></pre>"},{"location":"tooling/how-to/testing/#fixtures","title":"Fixtures","text":"<p>Fixtures provide setup/teardown and dependency injection for tests.</p>"},{"location":"tooling/how-to/testing/#basic-fixture","title":"Basic Fixture","text":"<pre><code>from testing import fixture\n\n@fixture\ndef database() -&gt; Database:\n    \"\"\"Provides a test database.\"\"\"\n    db = Database.connect(\"test.db\")\n    yield db          # Test runs here\n    db.close()        # Teardown (always runs, even on failure)\n\ndef test_insert(database: Database) -&gt; None:\n    database.insert(\"key\", \"value\")\n    assert_eq(database.get(\"key\"), \"value\")\n</code></pre>"},{"location":"tooling/how-to/testing/#fixture-scopes","title":"Fixture Scopes","text":"<p>Control when fixtures are created/destroyed:</p> <pre><code>@fixture(scope=\"function\")  # Default: new per test\ndef temp_file() -&gt; str:\n    ...\n\n@fixture(scope=\"module\")    # Shared across file\ndef shared_client() -&gt; Client:\n    ...\n\n@fixture(scope=\"session\")   # Shared across entire run\ndef global_config() -&gt; Config:\n    ...\n</code></pre>"},{"location":"tooling/how-to/testing/#fixture-dependencies","title":"Fixture Dependencies","text":"<p>Fixtures can depend on other fixtures:</p> <pre><code>@fixture\ndef config() -&gt; Config:\n    return Config.load(\"test.toml\")\n\n@fixture\ndef database(config: Config) -&gt; Database:\n    # config fixture is automatically injected\n    return Database.connect(config.db_url)\n\ndef test_query(database: Database) -&gt; None:\n    result = database.query(\"SELECT 1\")\n    assert_eq(result, 1)\n</code></pre>"},{"location":"tooling/how-to/testing/#autouse-fixtures","title":"Autouse Fixtures","text":"<p>Auto-apply fixtures to all tests in scope:</p> <pre><code>@fixture(autouse=true)\ndef setup_logging() -&gt; None:\n    \"\"\"Automatically applied to all tests in this file.\"\"\"\n    logging.set_level(\"DEBUG\")\n    yield\n    logging.set_level(\"INFO\")\n</code></pre>"},{"location":"tooling/how-to/testing/#parametrize","title":"Parametrize","text":"<p>Run a test with multiple parameter sets:</p> <pre><code>from testing import parametrize\n\n@parametrize(\"a, b, expected\", [\n    (1, 2, 3),\n    (0, 0, 0),\n    (-1, 1, 0),\n    (100, 200, 300),\n])\ndef test_add(a: int, b: int, expected: int) -&gt; None:\n    assert_eq(add(a, b), expected)\n</code></pre> <p>Output:</p> <pre><code>test_math.incn::test_add[1-2-3] PASSED\ntest_math.incn::test_add[0-0-0] PASSED\ntest_math.incn::test_add[-1-1-0] PASSED\ntest_math.incn::test_add[100-200-300] PASSED\n</code></pre>"},{"location":"tooling/how-to/testing/#named-test-ids","title":"Named Test IDs","text":"<pre><code>@parametrize(\"input, expected\", [\n    (\"hello\", \"HELLO\"),\n    (\"World\", \"WORLD\"),\n    (\"\", \"\"),\n], ids=[\"lowercase\", \"mixed\", \"empty\"])\ndef test_upper(input: str, expected: str) -&gt; None:\n    assert_eq(input.upper(), expected)\n</code></pre>"},{"location":"tooling/how-to/testing/#combining-fixtures-and-parametrize","title":"Combining Fixtures and Parametrize","text":"<pre><code>@fixture\ndef database() -&gt; Database:\n    db = Database.connect(\"test.db\")\n    yield db\n    db.close()\n\n@parametrize(\"key, value\", [\n    (\"name\", \"Alice\"),\n    (\"age\", \"30\"),\n])\ndef test_insert(database: Database, key: str, value: str) -&gt; None:\n    database.insert(key, value)\n    assert_eq(database.get(key), value)\n</code></pre>"},{"location":"tooling/how-to/testing/#async-tests-coming-soon","title":"Async Tests (Coming Soon)","text":"<p>Support for async test functions and fixtures with Tokio:</p> <pre><code>from testing import fixture\n\n@fixture\nasync def http_server() -&gt; ServerHandle:\n    server = await start_server(port=0)\n    yield server\n    await server.shutdown()\n\nasync def test_endpoint(http_server: ServerHandle) -&gt; None:\n    response = await fetch(f\"http://localhost:{http_server.port}/health\")\n    assert_eq(response.status, 200)\n</code></pre>"},{"location":"tooling/how-to/testing/#best-practices","title":"Best Practices","text":"<ol> <li>One assertion per test - Makes failures easier to diagnose</li> <li>Descriptive test names - <code>test_user_creation_with_invalid_email_fails</code></li> <li>Keep tests fast - Mark slow tests with <code>@slow</code></li> <li>Use xfail for known bugs - Track them without blocking CI</li> </ol>"},{"location":"tooling/how-to/troubleshooting/","title":"Troubleshooting","text":"<p>This page collects common \u201cit didn\u2019t work\u201d fixes when getting started with Incan from this repository.</p>"},{"location":"tooling/how-to/troubleshooting/#incan-command-not-found-after-make-install","title":"<code>incan: command not found</code> after <code>make install</code>","text":"<ul> <li><code>make install</code> installs <code>incan</code> into <code>~/.cargo/bin</code>.</li> <li>Ensure <code>~/.cargo/bin</code> is on your <code>PATH</code>.</li> </ul> <p>Check:</p> <pre><code>ls -la ~/.cargo/bin/incan\necho \"$PATH\"\nwhich incan || true\n</code></pre>"},{"location":"tooling/how-to/troubleshooting/#i-didnt-run-make-install-no-install-fallback","title":"I didn\u2019t run <code>make install</code> (no-install fallback)","text":"<p>If you\u2019re using the no-install fallback, run commands from the repository root and invoke:</p> <pre><code>./target/release/incan ...\n</code></pre> <p>If <code>./target/release/incan</code> does not exist yet, build it first:</p> <pre><code>make release\n</code></pre>"},{"location":"tooling/how-to/troubleshooting/#builds-are-slow-the-first-time","title":"Builds are slow the first time","text":"<p>The first <code>make release</code> (or first <code>incan build</code>) will compile Rust dependencies and can take a few minutes.</p>"},{"location":"tooling/how-to/troubleshooting/#cargo-needs-internet-access-for-dependencies","title":"Cargo needs internet access for dependencies","text":"<p>Some builds may download Rust crates via Cargo on first run. Ensure your environment can reach crates.io (or your configured proxy/mirror).</p>"},{"location":"tooling/how-to/troubleshooting/#macos-toolchainlinker-issues","title":"macOS: toolchain/linker issues","text":"<p>If you see errors about a missing C toolchain or linker, install Xcode Command Line Tools:</p> <pre><code>xcode-select --install\n</code></pre>"},{"location":"tooling/how-to/troubleshooting/#still-stuck","title":"Still stuck?","text":"<p>If you\u2019re still stuck, please open an issue and include:</p> <ul> <li>your OS and architecture</li> <li>the exact commands you ran</li> <li>the full error output</li> </ul>"},{"location":"tooling/reference/cli_reference/","title":"CLI reference","text":"<p>This is the authoritative CLI reference for <code>incan</code> (commands, flags, paths, and environment variables).</p> <p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre>"},{"location":"tooling/reference/cli_reference/#usage","title":"Usage","text":"<p>Top-level usage:</p> <pre><code>incan [OPTIONS] [FILE] [COMMAND]\n</code></pre> <ul> <li>If you pass a <code>FILE</code> without a subcommand, <code>incan</code> type-checks it (default action).</li> </ul> <p>Commands:</p> <ul> <li><code>build</code> - Compile to Rust and build an executable</li> <li><code>run</code> - Compile and run a program</li> <li><code>fmt</code> - Format Incan source files</li> <li><code>test</code> - Run tests (pytest-style)</li> </ul>"},{"location":"tooling/reference/cli_reference/#global-options-debug","title":"Global options (debug)","text":"<p>These flags take a file and run a debug pipeline stage:</p> <pre><code>incan --lex path/to/file.incn\nincan --parse path/to/file.incn\nincan --check path/to/file.incn\nincan --emit-rust path/to/file.incn\n</code></pre> <p>Strict mode:</p> <pre><code>incan --strict --emit-rust path/to/file.incn\n</code></pre>"},{"location":"tooling/reference/cli_reference/#commands","title":"Commands","text":""},{"location":"tooling/reference/cli_reference/#incan-build","title":"<code>incan build</code>","text":"<p>Usage:</p> <pre><code>incan build &lt;FILE&gt; [OUTPUT_DIR]\n</code></pre> <p>Behavior:</p> <ul> <li>Prints the generated Rust project path (example): <code>target/incan/&lt;name&gt;/</code></li> <li>Builds the generated Rust project and prints the binary path (example):   <code>target/incan/&lt;name&gt;/target/release/&lt;name&gt;</code></li> </ul> <p>Example:</p> <pre><code>incan build examples/simple/hello.incn\n</code></pre>"},{"location":"tooling/reference/cli_reference/#incan-run","title":"<code>incan run</code>","text":"<p>Usage:</p> <pre><code>incan run [OPTIONS] [FILE]\n</code></pre> <p>Run a file:</p> <pre><code>incan run path/to/file.incn\n</code></pre> <p>Run inline code:</p> <pre><code>incan run -c \"import this\"\n</code></pre>"},{"location":"tooling/reference/cli_reference/#incan-fmt","title":"<code>incan fmt</code>","text":"<p>Usage:</p> <pre><code>incan fmt [OPTIONS] [PATH]\n</code></pre> <p>Examples:</p> <pre><code># Format files in place\nincan fmt .\n\n# Check formatting without modifying (CI mode)\nincan fmt --check .\n\n# Show what would change without modifying files\nincan fmt --diff path/to/file.incn\n</code></pre>"},{"location":"tooling/reference/cli_reference/#incan-test","title":"<code>incan test</code>","text":"<p>Usage:</p> <pre><code>incan test [OPTIONS] [PATH]\n</code></pre> <p>Examples:</p> <pre><code># Run all tests in a directory\nincan test tests/\n\n# Run all tests under a path (default: .)\nincan test .\n\n# Filter tests by keyword expression\nincan test -k \"addition\"\n\n# Verbose output (include timing)\nincan test -v\n\n# Stop on first failure\nincan test -x\n\n# Include slow tests\nincan test --slow\n</code></pre>"},{"location":"tooling/reference/cli_reference/#outputs-and-paths","title":"Outputs and paths","text":"<p>Build outputs:</p> <ul> <li>Generated Rust project: <code>target/incan/&lt;name&gt;/</code></li> <li>Built binary: <code>target/incan/&lt;name&gt;/target/release/&lt;name&gt;</code></li> </ul> <p>Cleaning:</p> <pre><code>rm -rf target/incan/\n</code></pre>"},{"location":"tooling/reference/cli_reference/#environment-variables","title":"Environment variables","text":"<ul> <li><code>INCAN_STDLIB</code>: override the stdlib directory (usually auto-detected; set only if detection fails).</li> <li><code>INCAN_FANCY_ERRORS</code>: enable \u201cfancy\u201d diagnostics rendering (presence-based; output may change).</li> <li><code>INCAN_EMIT_SERVICE=1</code>: toggle codegen emit mode (internal/debug; not stable).</li> </ul>"},{"location":"tooling/reference/cli_reference/#exit-codes","title":"Exit codes","text":"<p>General rule: success is exit code 0; errors are non-zero.</p> <p>Specific behavior:</p> <ul> <li><code>incan run</code>: returns the program\u2019s exit code.</li> <li><code>incan test</code>:<ul> <li>returns 0 if all tests pass</li> <li>returns 0 if test files exist but no tests are collected</li> <li>returns 1 if no test files are discovered under the provided path</li> <li>returns 1 if any tests fail or an xfail unexpectedly passes (XPASS)</li> </ul> </li> <li><code>incan fmt --check</code>: returns 1 if any files would be reformatted.</li> <li><code>incan build</code> / <code>incan --check</code> / debug flags: return 1 on compile/build errors.</li> </ul>"},{"location":"tooling/reference/cli_reference/#drift-prevention-maintainers","title":"Drift prevention (maintainers)","text":"<p>Before a release, verify the docs stay aligned with the real CLI surface:</p> <ul> <li>Compare <code>incan --help</code> and <code>incan {build,run,fmt,test} --help</code> against this page.</li> </ul>"},{"location":"tooling/reference/lsp_protocol_support/","title":"LSP protocol support","text":"<p>This page lists which LSP methods are currently implemented.</p>"},{"location":"tooling/reference/lsp_protocol_support/#supported-methods","title":"Supported methods","text":"Method Status <code>textDocument/didOpen</code> Supported <code>textDocument/didChange</code> Supported <code>textDocument/didClose</code> Supported <code>textDocument/hover</code> Supported <code>textDocument/definition</code> Supported <code>textDocument/completion</code> Supported (basic) <code>textDocument/references</code> Planned <code>textDocument/rename</code> Planned <code>textDocument/formatting</code> Planned <p>To learn more about LSP, see the Language Server Protocol specification. See also: LSP architecture.</p>"},{"location":"tooling/tutorials/getting_started/","title":"Getting Started with Incan","text":""},{"location":"tooling/tutorials/getting_started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust (1.85+): install via rustup</li> <li><code>git</code>: to clone the repository</li> <li><code>make</code>: for the canonical make-first workflow</li> </ul> <p>These instructions assume a Unix-like shell environment (macOS/Linux). If you\u2019re on Windows, use WSL:</p> <ul> <li>WSL install guide: <code>https://learn.microsoft.com/windows/wsl/install</code></li> </ul>"},{"location":"tooling/tutorials/getting_started/#installbuildrun-canonical","title":"Install/build/run (canonical)","text":"<p>Follow: Install, build, and run.</p>"},{"location":"tooling/tutorials/getting_started/#your-first-program","title":"Your First Program","text":"<p>Create a file <code>hello.incn</code>:</p> <pre><code>def main() -&gt; None:\n    println(\"Hello, Incan!\")\n</code></pre> <p>Run it:</p> <p>If you used <code>make install</code>:</p> <pre><code>incan run hello.incn\n</code></pre> <p>If you used the no-install fallback:</p> <pre><code>./target/release/incan run hello.incn\n</code></pre>"},{"location":"tooling/tutorials/getting_started/#project-structure","title":"Project Structure","text":"<p>A typical Incan project is just a folder of <code>.incn</code> files (and optionally <code>tests/</code>):</p> <pre><code>my_project/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main.incn      # Entry point\n\u2502   \u2514\u2500\u2500 utils.incn     # Additional modules\n\u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 test_utils.incn\n\u2514\u2500\u2500 incan.toml         # Project config (planned)\n</code></pre> <p>Note: <code>incan.toml</code> is planned and not required to get started today.</p>"},{"location":"tooling/tutorials/getting_started/#next-steps","title":"Next Steps","text":"<ul> <li>Formatting Guide - Code style and <code>incan fmt</code></li> <li>CLI Reference - Commands, flags, and environment variables</li> <li>Projects today - Where builds go, what is regenerated, and what\u2019s planned</li> <li>Troubleshooting - Common setup and \u201cit didn\u2019t work\u201d fixes</li> <li>Language: Start here - Learn Incan syntax and patterns</li> <li>Stability policy - Versioning expectations and \u201cSince\u201d semantics</li> <li>Examples - Sample programs</li> </ul>"},{"location":"tooling/tutorials/pipeline_mini_project/","title":"Pipeline mini-project (tutorial)","text":"<p>This tutorial is a lightweight, CI-friendly walkthrough for \u201cstep-based\u201d automation in Incan.</p> <p>Prerequisite: Install, build, and run.</p>"},{"location":"tooling/tutorials/pipeline_mini_project/#goal","title":"Goal","text":"<p>Write a small program that:</p> <ul> <li>defines a step-like function with typed inputs/outputs</li> <li>returns typed failures (<code>Result</code>)</li> <li>can be tested and run deterministically</li> </ul>"},{"location":"tooling/tutorials/pipeline_mini_project/#step-1-create-a-file","title":"Step 1: Create a file","text":"<p>Create this small project layout:</p> <pre><code>my_project/\n\u251c\u2500\u2500 pipeline_step.incn\n\u2514\u2500\u2500 tests/\n    \u2514\u2500\u2500 test_pipeline_step.incn\n</code></pre> <p>Run the commands below from <code>my_project/</code> (this matters for module resolution).</p> <p>Create <code>pipeline_step.incn</code>:</p> <pre><code>\"\"\"\nA tiny step-style function that validates input and returns a typed error.\n\"\"\"\n\ndef normalize_name(name: str) -&gt; Result[str, str]:\n    if len(name.strip()) == 0:\n        return Err(\"name must not be empty\")\n    return Ok(name.strip().lower())\n\n\ndef main() -&gt; None:\n    result = normalize_name(\"  Alice  \")\n    match result:\n        case Ok(value): println(f\"ok: {value}\")\n        case Err(e): println(f\"err: {e}\")\n</code></pre>"},{"location":"tooling/tutorials/pipeline_mini_project/#step-2-run-it","title":"Step 2: Run it","text":"<pre><code>incan run pipeline_step.incn\n</code></pre> <p>No-install fallback</p> <p>If you did not run <code>make install</code>, you can still run the <code>incan</code> binary directly:</p> <ul> <li>from the repository root:</li> </ul> <pre><code>./target/release/incan ...\n</code></pre> <ul> <li>or via an absolute path (from anywhere):</li> </ul> <pre><code>/absolute/path/to/incan run path/to/file.incn\n</code></pre>"},{"location":"tooling/tutorials/pipeline_mini_project/#step-3-test-it","title":"Step 3: Test it","text":"<p>Create <code>tests/test_pipeline_step.incn</code>:</p> <pre><code>from ..pipeline_step import normalize_name\n\ndef test_normalize_name_ok() -&gt; None:\n    assert_eq(normalize_name(\"  Alice  \"), Ok(\"alice\"))\n\ndef test_normalize_name_err() -&gt; None:\n    assert_eq(normalize_name(\"   \"), Err(\"name must not be empty\"))\n</code></pre> <p>Run:</p> <pre><code>incan test tests/\n</code></pre>"},{"location":"tooling/tutorials/pipeline_mini_project/#next","title":"Next","text":"<ul> <li>Typed errors: Error Handling</li> <li>Multi-file layouts: Imports and modules (how-to)</li> <li>CI entrypoint: CI &amp; automation</li> <li>Contributing CI entrypoints (repo): CI &amp; automation (repository)</li> </ul>"},{"location":"tags/","title":"Tags","text":"<p>This page is generated by the MkDocs tags plugin.</p> <p>Use tags to browse content by:</p> <ul> <li>audience (language/tooling/contributing)</li> <li>doc type (tutorial/how-to/reference/explanation)</li> <li>persona (python/rust/beginner/pipelines/etc.)</li> </ul>"}]}